{
  "test_name": "test_02_clamp_values",
  "kernel_name": "clamp_values",
  "python_source": "@wp.kernel\ndef clamp_values(x: wp.array(dtype=float),\n                 min_val: float,\n                 max_val: float,\n                 y: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < min_val:\n        val = min_val\n    if val > max_val:\n        val = max_val\n    y[tid] = val\n",
  "cpp_code": "\n#define WP_TILE_BLOCK_DIM 1\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(task_index, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, task_index, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, task_index, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, task_index, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\nstruct Particle_9de5ed98\n{\n    wp::vec_t<3, wp::float32> pos;\n    wp::vec_t<3, wp::float32> vel;\n    wp::float32 mass;\n\n\n    Particle_9de5ed98() = default;\n    CUDA_CALLABLE Particle_9de5ed98(wp::vec_t<3, wp::float32> const& pos,\n    wp::vec_t<3, wp::float32> const& vel = {},\n    wp::float32 const& mass = {})\n        : pos{pos}\n        , vel{vel}\n        , mass{mass}\n\n    {\n    }\n\n    CUDA_CALLABLE Particle_9de5ed98& operator += (const Particle_9de5ed98& rhs)\n    {    pos += rhs.pos;\n    vel += rhs.vel;\n    mass += rhs.mass;\n\n        return *this;}\n\n};\n\nstatic CUDA_CALLABLE void adj_Particle_9de5ed98(wp::vec_t<3, wp::float32> const&,\n    wp::vec_t<3, wp::float32> const&,\n    wp::float32 const&,\n    wp::vec_t<3, wp::float32> & adj_pos,\n    wp::vec_t<3, wp::float32> & adj_vel,\n    wp::float32 & adj_mass,\n    Particle_9de5ed98 & adj_ret)\n{\n    adj_pos += adj_ret.pos;\n    adj_vel += adj_ret.vel;\n    adj_mass += adj_ret.mass;\n}\n\n// Required when compiling adjoints.\nCUDA_CALLABLE Particle_9de5ed98 add(const Particle_9de5ed98& a, const Particle_9de5ed98& b)\n{\n    return Particle_9de5ed98();\n}\n\nCUDA_CALLABLE void adj_atomic_add(Particle_9de5ed98* p, Particle_9de5ed98 t)\n{\n    wp::adj_atomic_add(&p->pos, t.pos);\n    wp::adj_atomic_add(&p->vel, t.vel);\n    wp::adj_atomic_add(&p->mass, t.mass);\n}\n\n\nstruct wp_args_wave_simulation_053e6d1a {\n    wp::array_t<wp::float32> x;\n    wp::float32 t;\n    wp::float32 amplitude;\n    wp::float32 frequency;\n    wp::float32 phase;\n    wp::array_t<wp::float32> output;\n};\n\n\nvoid wave_simulation_053e6d1a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_wave_simulation_053e6d1a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::float32 var_t = _wp_args->t;\n    wp::float32 var_amplitude = _wp_args->amplitude;\n    wp::float32 var_frequency = _wp_args->frequency;\n    wp::float32 var_phase = _wp_args->phase;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.5;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    wp::float32 var_15;\n    wp::float32 var_16;\n    wp::float32 var_17;\n    const wp::float32 var_18 = 0.25;\n    wp::float32 var_19;\n    const wp::float32 var_20 = 3.0;\n    wp::float32 var_21;\n    wp::float32 var_22;\n    wp::float32 var_23;\n    wp::float32 var_24;\n    wp::float32 var_25;\n    //---------\n    // forward\n    // def wave_simulation(x: wp.array(dtype=float),                                          <L 107>\n    // tid = wp.tid()                                                                         <L 113>\n    var_0 = builtin_tid1d();\n    // pos = x[tid]                                                                           <L 114>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // wave = amplitude * wp.sin(frequency * pos + phase + t)                                 <L 117>\n    var_4 = wp::mul(var_frequency, var_2);\n    var_5 = wp::add(var_4, var_phase);\n    var_6 = wp::add(var_5, var_t);\n    var_7 = wp::sin(var_6);\n    var_8 = wp::mul(var_amplitude, var_7);\n    // wave = wave + 0.5 * amplitude * wp.sin(2.0 * frequency * pos + phase)                  <L 120>\n    var_10 = wp::mul(var_9, var_amplitude);\n    var_12 = wp::mul(var_11, var_frequency);\n    var_13 = wp::mul(var_12, var_2);\n    var_14 = wp::add(var_13, var_phase);\n    var_15 = wp::sin(var_14);\n    var_16 = wp::mul(var_10, var_15);\n    var_17 = wp::add(var_8, var_16);\n    // wave = wave + 0.25 * amplitude * wp.cos(3.0 * frequency * pos)                         <L 121>\n    var_19 = wp::mul(var_18, var_amplitude);\n    var_21 = wp::mul(var_20, var_frequency);\n    var_22 = wp::mul(var_21, var_2);\n    var_23 = wp::cos(var_22);\n    var_24 = wp::mul(var_19, var_23);\n    var_25 = wp::add(var_17, var_24);\n    // output[tid] = wave                                                                     <L 123>\n    wp::array_store(var_output, var_0, var_25);\n}\n\n\n\nvoid wave_simulation_053e6d1a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_wave_simulation_053e6d1a *_wp_args,\n    wp_args_wave_simulation_053e6d1a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::float32 var_t = _wp_args->t;\n    wp::float32 var_amplitude = _wp_args->amplitude;\n    wp::float32 var_frequency = _wp_args->frequency;\n    wp::float32 var_phase = _wp_args->phase;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::float32 adj_t = _wp_adj_args->t;\n    wp::float32 adj_amplitude = _wp_adj_args->amplitude;\n    wp::float32 adj_frequency = _wp_adj_args->frequency;\n    wp::float32 adj_phase = _wp_adj_args->phase;\n    wp::array_t<wp::float32> adj_output = _wp_adj_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.5;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    wp::float32 var_15;\n    wp::float32 var_16;\n    wp::float32 var_17;\n    const wp::float32 var_18 = 0.25;\n    wp::float32 var_19;\n    const wp::float32 var_20 = 3.0;\n    wp::float32 var_21;\n    wp::float32 var_22;\n    wp::float32 var_23;\n    wp::float32 var_24;\n    wp::float32 var_25;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    wp::float32 adj_15 = {};\n    wp::float32 adj_16 = {};\n    wp::float32 adj_17 = {};\n    wp::float32 adj_18 = {};\n    wp::float32 adj_19 = {};\n    wp::float32 adj_20 = {};\n    wp::float32 adj_21 = {};\n    wp::float32 adj_22 = {};\n    wp::float32 adj_23 = {};\n    wp::float32 adj_24 = {};\n    wp::float32 adj_25 = {};\n    //---------\n    // forward\n    // def wave_simulation(x: wp.array(dtype=float),                                          <L 107>\n    // tid = wp.tid()                                                                         <L 113>\n    var_0 = builtin_tid1d();\n    // pos = x[tid]                                                                           <L 114>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // wave = amplitude * wp.sin(frequency * pos + phase + t)                                 <L 117>\n    var_4 = wp::mul(var_frequency, var_2);\n    var_5 = wp::add(var_4, var_phase);\n    var_6 = wp::add(var_5, var_t);\n    var_7 = wp::sin(var_6);\n    var_8 = wp::mul(var_amplitude, var_7);\n    // wave = wave + 0.5 * amplitude * wp.sin(2.0 * frequency * pos + phase)                  <L 120>\n    var_10 = wp::mul(var_9, var_amplitude);\n    var_12 = wp::mul(var_11, var_frequency);\n    var_13 = wp::mul(var_12, var_2);\n    var_14 = wp::add(var_13, var_phase);\n    var_15 = wp::sin(var_14);\n    var_16 = wp::mul(var_10, var_15);\n    var_17 = wp::add(var_8, var_16);\n    // wave = wave + 0.25 * amplitude * wp.cos(3.0 * frequency * pos)                         <L 121>\n    var_19 = wp::mul(var_18, var_amplitude);\n    var_21 = wp::mul(var_20, var_frequency);\n    var_22 = wp::mul(var_21, var_2);\n    var_23 = wp::cos(var_22);\n    var_24 = wp::mul(var_19, var_23);\n    var_25 = wp::add(var_17, var_24);\n    // output[tid] = wave                                                                     <L 123>\n    // wp::array_store(var_output, var_0, var_25);\n    //---------\n    // reverse\n    wp::adj_array_store(var_output, var_0, var_25, adj_output, adj_0, adj_25);\n    // adj: output[tid] = wave                                                                <L 123>\n    wp::adj_add(var_17, var_24, adj_17, adj_24, adj_25);\n    wp::adj_mul(var_19, var_23, adj_19, adj_23, adj_24);\n    wp::adj_cos(var_22, adj_22, adj_23);\n    wp::adj_mul(var_21, var_2, adj_21, adj_2, adj_22);\n    wp::adj_mul(var_20, var_frequency, adj_20, adj_frequency, adj_21);\n    wp::adj_mul(var_18, var_amplitude, adj_18, adj_amplitude, adj_19);\n    // adj: wave = wave + 0.25 * amplitude * wp.cos(3.0 * frequency * pos)                    <L 121>\n    wp::adj_add(var_8, var_16, adj_8, adj_16, adj_17);\n    wp::adj_mul(var_10, var_15, adj_10, adj_15, adj_16);\n    wp::adj_sin(var_14, adj_14, adj_15);\n    wp::adj_add(var_13, var_phase, adj_13, adj_phase, adj_14);\n    wp::adj_mul(var_12, var_2, adj_12, adj_2, adj_13);\n    wp::adj_mul(var_11, var_frequency, adj_11, adj_frequency, adj_12);\n    wp::adj_mul(var_9, var_amplitude, adj_9, adj_amplitude, adj_10);\n    // adj: wave = wave + 0.5 * amplitude * wp.sin(2.0 * frequency * pos + phase)             <L 120>\n    wp::adj_mul(var_amplitude, var_7, adj_amplitude, adj_7, adj_8);\n    wp::adj_sin(var_6, adj_6, adj_7);\n    wp::adj_add(var_5, var_t, adj_5, adj_t, adj_6);\n    wp::adj_add(var_4, var_phase, adj_4, adj_phase, adj_5);\n    wp::adj_mul(var_frequency, var_2, adj_frequency, adj_2, adj_4);\n    // adj: wave = amplitude * wp.sin(frequency * pos + phase + t)                            <L 117>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: pos = x[tid]                                                                      <L 114>\n    // adj: tid = wp.tid()                                                                    <L 113>\n    // adj: def wave_simulation(x: wp.array(dtype=float),                                     <L 107>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void wave_simulation_053e6d1a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_wave_simulation_053e6d1a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        wave_simulation_053e6d1a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void wave_simulation_053e6d1a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_wave_simulation_053e6d1a *_wp_args,\n    wp_args_wave_simulation_053e6d1a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        wave_simulation_053e6d1a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_matrix_multiply_kernel_fe2e5f9d {\n    wp::array_t<wp::float32> A;\n    wp::array_t<wp::float32> B;\n    wp::array_t<wp::float32> C;\n};\n\n\nvoid matrix_multiply_kernel_fe2e5f9d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_A = _wp_args->A;\n    wp::array_t<wp::float32> var_B = _wp_args->B;\n    wp::array_t<wp::float32> var_C = _wp_args->C;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::int32 var_1;\n    wp::shape_t* var_2;\n    const wp::int32 var_3 = 1;\n    wp::int32 var_4;\n    wp::shape_t var_5;\n    const wp::float32 var_6 = 0.0;\n    wp::float32 var_7;\n    wp::range_t var_8;\n    wp::int32 var_9;\n    wp::float32* var_10;\n    wp::float32* var_11;\n    wp::float32 var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    wp::float32 var_15;\n    //---------\n    // forward\n    // def matrix_multiply_kernel(A: wp.array2d(dtype=float),                                 <L 92>\n    // i, j = wp.tid()                                                                        <L 95>\n    builtin_tid2d(var_0, var_1);\n    // n = A.shape[1]  # columns of A                                                         <L 97>\n    var_2 = &(var_A.shape);\n    var_5 = wp::load(var_2);\n    var_4 = wp::extract(var_5, var_3);\n    // sum_val = float(0.0)                                                                   <L 98>\n    var_7 = wp::float(var_6);\n    // for k in range(n):                                                                     <L 100>\n    var_8 = wp::range(var_4);\n    start_for_0:;\n        if (iter_cmp(var_8) == 0) goto end_for_0;\n        var_9 = wp::iter_next(var_8);\n        // sum_val = sum_val + A[i, k] * B[k, j]                                              <L 101>\n        var_10 = wp::address(var_A, var_0, var_9);\n        var_11 = wp::address(var_B, var_9, var_1);\n        var_13 = wp::load(var_10);\n        var_14 = wp::load(var_11);\n        var_12 = wp::mul(var_13, var_14);\n        var_15 = wp::add(var_7, var_12);\n        wp::assign(var_7, var_15);\n        goto start_for_0;\n    end_for_0:;\n    // C[i, j] = sum_val                                                                      <L 103>\n    wp::array_store(var_C, var_0, var_1, var_7);\n}\n\n\n\nvoid matrix_multiply_kernel_fe2e5f9d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_args,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_A = _wp_args->A;\n    wp::array_t<wp::float32> var_B = _wp_args->B;\n    wp::array_t<wp::float32> var_C = _wp_args->C;\n    wp::array_t<wp::float32> adj_A = _wp_adj_args->A;\n    wp::array_t<wp::float32> adj_B = _wp_adj_args->B;\n    wp::array_t<wp::float32> adj_C = _wp_adj_args->C;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::int32 var_1;\n    wp::shape_t* var_2;\n    const wp::int32 var_3 = 1;\n    wp::int32 var_4;\n    wp::shape_t var_5;\n    const wp::float32 var_6 = 0.0;\n    wp::float32 var_7;\n    wp::range_t var_8;\n    wp::int32 var_9;\n    wp::float32* var_10;\n    wp::float32* var_11;\n    wp::float32 var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    wp::float32 var_15;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::shape_t adj_2 = {};\n    wp::int32 adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::shape_t adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::range_t adj_8 = {};\n    wp::int32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    wp::float32 adj_15 = {};\n    //---------\n    // forward\n    // def matrix_multiply_kernel(A: wp.array2d(dtype=float),                                 <L 92>\n    // i, j = wp.tid()                                                                        <L 95>\n    builtin_tid2d(var_0, var_1);\n    // n = A.shape[1]  # columns of A                                                         <L 97>\n    var_2 = &(var_A.shape);\n    var_5 = wp::load(var_2);\n    var_4 = wp::extract(var_5, var_3);\n    // sum_val = float(0.0)                                                                   <L 98>\n    var_7 = wp::float(var_6);\n    // for k in range(n):                                                                     <L 100>\n    var_8 = wp::range(var_4);\n    // C[i, j] = sum_val                                                                      <L 103>\n    // wp::array_store(var_C, var_0, var_1, var_7);\n    //---------\n    // reverse\n    wp::adj_array_store(var_C, var_0, var_1, var_7, adj_C, adj_0, adj_1, adj_7);\n    // adj: C[i, j] = sum_val                                                                 <L 103>\n    var_8 = wp::iter_reverse(var_8);\n    start_for_0:;\n        if (iter_cmp(var_8) == 0) goto end_for_0;\n        var_9 = wp::iter_next(var_8);\n    \tadj_10 = {};\n    \tadj_11 = {};\n    \tadj_12 = {};\n    \tadj_13 = {};\n    \tadj_14 = {};\n    \tadj_15 = {};\n        // sum_val = sum_val + A[i, k] * B[k, j]                                              <L 101>\n        var_10 = wp::address(var_A, var_0, var_9);\n        var_11 = wp::address(var_B, var_9, var_1);\n        var_13 = wp::load(var_10);\n        var_14 = wp::load(var_11);\n        var_12 = wp::mul(var_13, var_14);\n        var_15 = wp::add(var_7, var_12);\n        wp::assign(var_7, var_15);\n        wp::adj_assign(var_7, var_15, adj_7, adj_15);\n        wp::adj_add(var_7, var_12, adj_7, adj_12, adj_15);\n        wp::adj_mul(var_13, var_14, adj_10, adj_11, adj_12);\n        wp::adj_address(var_B, var_9, var_1, adj_B, adj_9, adj_1, adj_11);\n        wp::adj_address(var_A, var_0, var_9, adj_A, adj_0, adj_9, adj_10);\n        // adj: sum_val = sum_val + A[i, k] * B[k, j]                                         <L 101>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_4, adj_4, adj_8);\n    // adj: for k in range(n):                                                                <L 100>\n    wp::adj_float(var_6, adj_6, adj_7);\n    // adj: sum_val = float(0.0)                                                              <L 98>\n    wp::adj_extract(var_5, var_3, adj_2, adj_3, adj_4);\n    adj_A.shape = adj_2;\n    // adj: n = A.shape[1]  # columns of A                                                    <L 97>\n    // adj: i, j = wp.tid()                                                                   <L 95>\n    // adj: def matrix_multiply_kernel(A: wp.array2d(dtype=float),                            <L 92>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void matrix_multiply_kernel_fe2e5f9d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        matrix_multiply_kernel_fe2e5f9d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void matrix_multiply_kernel_fe2e5f9d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_args,\n    wp_args_matrix_multiply_kernel_fe2e5f9d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        matrix_multiply_kernel_fe2e5f9d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_bit_operations_fc19086f {\n    wp::array_t<wp::int32> a;\n    wp::array_t<wp::int32> b;\n    wp::array_t<wp::int32> result;\n};\n\n\nvoid bit_operations_fc19086f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_bit_operations_fc19086f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::int32> var_a = _wp_args->a;\n    wp::array_t<wp::int32> var_b = _wp_args->b;\n    wp::array_t<wp::int32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::int32* var_1;\n    wp::int32 var_2;\n    wp::int32 var_3;\n    wp::int32* var_4;\n    wp::int32 var_5;\n    wp::int32 var_6;\n    wp::int32 var_7;\n    wp::int32 var_8;\n    wp::int32 var_9;\n    wp::int32 var_10;\n    wp::int32 var_11;\n    //---------\n    // forward\n    // def bit_operations(a: wp.array(dtype=int),                                             <L 127>\n    // tid = wp.tid()                                                                         <L 130>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 132>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 133>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // and_result = x & y                                                                     <L 136>\n    var_7 = wp::bit_and(var_2, var_5);\n    // or_result = x | y                                                                      <L 137>\n    var_8 = wp::bit_or(var_2, var_5);\n    // xor_result = x ^ y                                                                     <L 138>\n    var_9 = wp::bit_xor(var_2, var_5);\n    // result[tid] = (and_result + or_result) ^ xor_result                                    <L 141>\n    var_10 = wp::add(var_7, var_8);\n    var_11 = wp::bit_xor(var_10, var_9);\n    wp::array_store(var_result, var_0, var_11);\n}\n\n\n\nvoid bit_operations_fc19086f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_bit_operations_fc19086f *_wp_args,\n    wp_args_bit_operations_fc19086f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::int32> var_a = _wp_args->a;\n    wp::array_t<wp::int32> var_b = _wp_args->b;\n    wp::array_t<wp::int32> var_result = _wp_args->result;\n    wp::array_t<wp::int32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::int32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::int32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::int32* var_1;\n    wp::int32 var_2;\n    wp::int32 var_3;\n    wp::int32* var_4;\n    wp::int32 var_5;\n    wp::int32 var_6;\n    wp::int32 var_7;\n    wp::int32 var_8;\n    wp::int32 var_9;\n    wp::int32 var_10;\n    wp::int32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::int32 adj_2 = {};\n    wp::int32 adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::int32 adj_5 = {};\n    wp::int32 adj_6 = {};\n    wp::int32 adj_7 = {};\n    wp::int32 adj_8 = {};\n    wp::int32 adj_9 = {};\n    wp::int32 adj_10 = {};\n    wp::int32 adj_11 = {};\n    //---------\n    // forward\n    // def bit_operations(a: wp.array(dtype=int),                                             <L 127>\n    // tid = wp.tid()                                                                         <L 130>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 132>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 133>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // and_result = x & y                                                                     <L 136>\n    var_7 = wp::bit_and(var_2, var_5);\n    // or_result = x | y                                                                      <L 137>\n    var_8 = wp::bit_or(var_2, var_5);\n    // xor_result = x ^ y                                                                     <L 138>\n    var_9 = wp::bit_xor(var_2, var_5);\n    // result[tid] = (and_result + or_result) ^ xor_result                                    <L 141>\n    var_10 = wp::add(var_7, var_8);\n    var_11 = wp::bit_xor(var_10, var_9);\n    // wp::array_store(var_result, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_result, var_0, var_11, adj_result, adj_0, adj_11);\n    wp::adj_add(var_7, var_8, adj_7, adj_8, adj_10);\n    // adj: result[tid] = (and_result + or_result) ^ xor_result                               <L 141>\n    // adj: xor_result = x ^ y                                                                <L 138>\n    // adj: or_result = x | y                                                                 <L 137>\n    // adj: and_result = x & y                                                                <L 136>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 133>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 132>\n    // adj: tid = wp.tid()                                                                    <L 130>\n    // adj: def bit_operations(a: wp.array(dtype=int),                                        <L 127>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void bit_operations_fc19086f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_bit_operations_fc19086f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        bit_operations_fc19086f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void bit_operations_fc19086f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_bit_operations_fc19086f *_wp_args,\n    wp_args_bit_operations_fc19086f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        bit_operations_fc19086f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_classify_and_transform_e01e53a0 {\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n};\n\n\nvoid classify_and_transform_e01e53a0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_classify_and_transform_e01e53a0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    wp::float32 var_5;\n    const wp::float32 var_6 = 1.0;\n    const wp::float32 var_7 = -1.0;\n    bool var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 0.0;\n    bool var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    const wp::float32 var_15 = 1.0;\n    bool var_16;\n    wp::float32 var_17;\n    wp::float32 var_18;\n    const wp::float32 var_19 = 10.0;\n    bool var_20;\n    wp::float32 var_21;\n    wp::float32 var_22;\n    wp::float32 var_23;\n    wp::float32 var_24;\n    wp::float32 var_25;\n    wp::float32 var_26;\n    wp::float32 var_27;\n    //---------\n    // forward\n    // def classify_and_transform(x: wp.array(dtype=float),                                   <L 65>\n    // tid = wp.tid()                                                                         <L 67>\n    var_0 = builtin_tid1d();\n    // val = x[tid]                                                                           <L 68>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // result = float(0.0)                                                                    <L 70>\n    var_5 = wp::float(var_4);\n    // if val < -1.0:                                                                         <L 72>\n    var_8 = (var_2 < var_7);\n    if (var_8) {\n        // result = wp.exp(val)                                                               <L 74>\n        var_9 = wp::exp(var_2);\n    }\n    var_10 = wp::where(var_8, var_9, var_5);\n    if (!var_8) {\n        // elif val < 0.0:                                                                    <L 75>\n        var_12 = (var_2 < var_11);\n        if (var_12) {\n            // result = val * val                                                             <L 77>\n            var_13 = wp::mul(var_2, var_2);\n        }\n        var_14 = wp::where(var_12, var_13, var_10);\n        if (!var_12) {\n            // elif val < 1.0:                                                                <L 78>\n            var_16 = (var_2 < var_15);\n            if (var_16) {\n                // result = val                                                               <L 80>\n                var_17 = wp::copy(var_2);\n            }\n            var_18 = wp::where(var_16, var_17, var_14);\n            if (!var_16) {\n                // elif val < 10.0:                                                           <L 81>\n                var_20 = (var_2 < var_19);\n                if (var_20) {\n                    // result = wp.sqrt(val)                                                  <L 83>\n                    var_21 = wp::sqrt(var_2);\n                }\n                var_22 = wp::where(var_20, var_21, var_18);\n                if (!var_20) {\n                    // result = wp.log(val)                                                   <L 86>\n                    var_23 = wp::log(var_2);\n                }\n                var_24 = wp::where(var_20, var_22, var_23);\n            }\n            var_25 = wp::where(var_16, var_18, var_24);\n        }\n        var_26 = wp::where(var_12, var_14, var_25);\n    }\n    var_27 = wp::where(var_8, var_10, var_26);\n    // y[tid] = result                                                                        <L 88>\n    wp::array_store(var_y, var_0, var_27);\n}\n\n\n\nvoid classify_and_transform_e01e53a0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_classify_and_transform_e01e53a0 *_wp_args,\n    wp_args_classify_and_transform_e01e53a0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    wp::float32 var_5;\n    const wp::float32 var_6 = 1.0;\n    const wp::float32 var_7 = -1.0;\n    bool var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 0.0;\n    bool var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    const wp::float32 var_15 = 1.0;\n    bool var_16;\n    wp::float32 var_17;\n    wp::float32 var_18;\n    const wp::float32 var_19 = 10.0;\n    bool var_20;\n    wp::float32 var_21;\n    wp::float32 var_22;\n    wp::float32 var_23;\n    wp::float32 var_24;\n    wp::float32 var_25;\n    wp::float32 var_26;\n    wp::float32 var_27;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    bool adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    wp::float32 adj_15 = {};\n    bool adj_16 = {};\n    wp::float32 adj_17 = {};\n    wp::float32 adj_18 = {};\n    wp::float32 adj_19 = {};\n    bool adj_20 = {};\n    wp::float32 adj_21 = {};\n    wp::float32 adj_22 = {};\n    wp::float32 adj_23 = {};\n    wp::float32 adj_24 = {};\n    wp::float32 adj_25 = {};\n    wp::float32 adj_26 = {};\n    wp::float32 adj_27 = {};\n    //---------\n    // forward\n    // def classify_and_transform(x: wp.array(dtype=float),                                   <L 65>\n    // tid = wp.tid()                                                                         <L 67>\n    var_0 = builtin_tid1d();\n    // val = x[tid]                                                                           <L 68>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // result = float(0.0)                                                                    <L 70>\n    var_5 = wp::float(var_4);\n    // if val < -1.0:                                                                         <L 72>\n    var_8 = (var_2 < var_7);\n    if (var_8) {\n        // result = wp.exp(val)                                                               <L 74>\n        var_9 = wp::exp(var_2);\n    }\n    var_10 = wp::where(var_8, var_9, var_5);\n    if (!var_8) {\n        // elif val < 0.0:                                                                    <L 75>\n        var_12 = (var_2 < var_11);\n        if (var_12) {\n            // result = val * val                                                             <L 77>\n            var_13 = wp::mul(var_2, var_2);\n        }\n        var_14 = wp::where(var_12, var_13, var_10);\n        if (!var_12) {\n            // elif val < 1.0:                                                                <L 78>\n            var_16 = (var_2 < var_15);\n            if (var_16) {\n                // result = val                                                               <L 80>\n                var_17 = wp::copy(var_2);\n            }\n            var_18 = wp::where(var_16, var_17, var_14);\n            if (!var_16) {\n                // elif val < 10.0:                                                           <L 81>\n                var_20 = (var_2 < var_19);\n                if (var_20) {\n                    // result = wp.sqrt(val)                                                  <L 83>\n                    var_21 = wp::sqrt(var_2);\n                }\n                var_22 = wp::where(var_20, var_21, var_18);\n                if (!var_20) {\n                    // result = wp.log(val)                                                   <L 86>\n                    var_23 = wp::log(var_2);\n                }\n                var_24 = wp::where(var_20, var_22, var_23);\n            }\n            var_25 = wp::where(var_16, var_18, var_24);\n        }\n        var_26 = wp::where(var_12, var_14, var_25);\n    }\n    var_27 = wp::where(var_8, var_10, var_26);\n    // y[tid] = result                                                                        <L 88>\n    // wp::array_store(var_y, var_0, var_27);\n    //---------\n    // reverse\n    wp::adj_array_store(var_y, var_0, var_27, adj_y, adj_0, adj_27);\n    // adj: y[tid] = result                                                                   <L 88>\n    wp::adj_where(var_8, var_10, var_26, adj_8, adj_10, adj_26, adj_27);\n    if (!var_8) {\n        wp::adj_where(var_12, var_14, var_25, adj_12, adj_14, adj_25, adj_26);\n        if (!var_12) {\n            wp::adj_where(var_16, var_18, var_24, adj_16, adj_18, adj_24, adj_25);\n            if (!var_16) {\n                wp::adj_where(var_20, var_22, var_23, adj_20, adj_22, adj_23, adj_24);\n                if (!var_20) {\n                    wp::adj_log(var_2, adj_2, adj_23);\n                    // adj: result = wp.log(val)                                              <L 86>\n                }\n                wp::adj_where(var_20, var_21, var_18, adj_20, adj_21, adj_18, adj_22);\n                if (var_20) {\n                    wp::adj_sqrt(var_2, var_21, adj_2, adj_21);\n                    // adj: result = wp.sqrt(val)                                             <L 83>\n                }\n                // adj: elif val < 10.0:                                                      <L 81>\n            }\n            wp::adj_where(var_16, var_17, var_14, adj_16, adj_17, adj_14, adj_18);\n            if (var_16) {\n                wp::adj_copy(var_2, adj_2, adj_17);\n                // adj: result = val                                                          <L 80>\n            }\n            // adj: elif val < 1.0:                                                           <L 78>\n        }\n        wp::adj_where(var_12, var_13, var_10, adj_12, adj_13, adj_10, adj_14);\n        if (var_12) {\n            wp::adj_mul(var_2, var_2, adj_2, adj_2, adj_13);\n            // adj: result = val * val                                                        <L 77>\n        }\n        // adj: elif val < 0.0:                                                               <L 75>\n    }\n    wp::adj_where(var_8, var_9, var_5, adj_8, adj_9, adj_5, adj_10);\n    if (var_8) {\n        wp::adj_exp(var_2, var_9, adj_2, adj_9);\n        // adj: result = wp.exp(val)                                                          <L 74>\n    }\n    // adj: if val < -1.0:                                                                    <L 72>\n    wp::adj_float(var_4, adj_4, adj_5);\n    // adj: result = float(0.0)                                                               <L 70>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: val = x[tid]                                                                      <L 68>\n    // adj: tid = wp.tid()                                                                    <L 67>\n    // adj: def classify_and_transform(x: wp.array(dtype=float),                              <L 65>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void classify_and_transform_e01e53a0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_classify_and_transform_e01e53a0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        classify_and_transform_e01e53a0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void classify_and_transform_e01e53a0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_classify_and_transform_e01e53a0 *_wp_args,\n    wp_args_classify_and_transform_e01e53a0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        classify_and_transform_e01e53a0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_quaternion_rotate_e2a1b1a9 {\n    wp::array_t<wp::quat_t<wp::float32>> quaternions;\n    wp::array_t<wp::vec_t<3, wp::float32>> vectors;\n    wp::array_t<wp::vec_t<3, wp::float32>> output;\n};\n\n\nvoid quaternion_rotate_e2a1b1a9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::quat_t<wp::float32>> var_quaternions = _wp_args->quaternions;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_vectors = _wp_args->vectors;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_output = _wp_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::quat_t<wp::float32>* var_1;\n    wp::quat_t<wp::float32> var_2;\n    wp::quat_t<wp::float32> var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::vec_t<3, wp::float32> var_7;\n    //---------\n    // forward\n    // def quaternion_rotate(quaternions: wp.array(dtype=wp.quat),                            <L 200>\n    // tid = wp.tid()                                                                         <L 203>\n    var_0 = builtin_tid1d();\n    // q = quaternions[tid]                                                                   <L 205>\n    var_1 = wp::address(var_quaternions, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // v = vectors[tid]                                                                       <L 206>\n    var_4 = wp::address(var_vectors, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // rotated = wp.quat_rotate(q, v)                                                         <L 209>\n    var_7 = wp::quat_rotate(var_2, var_5);\n    // output[tid] = rotated                                                                  <L 211>\n    wp::array_store(var_output, var_0, var_7);\n}\n\n\n\nvoid quaternion_rotate_e2a1b1a9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_args,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::quat_t<wp::float32>> var_quaternions = _wp_args->quaternions;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_vectors = _wp_args->vectors;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_output = _wp_args->output;\n    wp::array_t<wp::quat_t<wp::float32>> adj_quaternions = _wp_adj_args->quaternions;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_vectors = _wp_adj_args->vectors;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_output = _wp_adj_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::quat_t<wp::float32>* var_1;\n    wp::quat_t<wp::float32> var_2;\n    wp::quat_t<wp::float32> var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::vec_t<3, wp::float32> var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::quat_t<wp::float32> adj_1 = {};\n    wp::quat_t<wp::float32> adj_2 = {};\n    wp::quat_t<wp::float32> adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    wp::vec_t<3, wp::float32> adj_6 = {};\n    wp::vec_t<3, wp::float32> adj_7 = {};\n    //---------\n    // forward\n    // def quaternion_rotate(quaternions: wp.array(dtype=wp.quat),                            <L 200>\n    // tid = wp.tid()                                                                         <L 203>\n    var_0 = builtin_tid1d();\n    // q = quaternions[tid]                                                                   <L 205>\n    var_1 = wp::address(var_quaternions, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // v = vectors[tid]                                                                       <L 206>\n    var_4 = wp::address(var_vectors, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // rotated = wp.quat_rotate(q, v)                                                         <L 209>\n    var_7 = wp::quat_rotate(var_2, var_5);\n    // output[tid] = rotated                                                                  <L 211>\n    // wp::array_store(var_output, var_0, var_7);\n    //---------\n    // reverse\n    wp::adj_array_store(var_output, var_0, var_7, adj_output, adj_0, adj_7);\n    // adj: output[tid] = rotated                                                             <L 211>\n    wp::adj_quat_rotate(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: rotated = wp.quat_rotate(q, v)                                                    <L 209>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_vectors, var_0, adj_vectors, adj_0, adj_4);\n    // adj: v = vectors[tid]                                                                  <L 206>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_quaternions, var_0, adj_quaternions, adj_0, adj_1);\n    // adj: q = quaternions[tid]                                                              <L 205>\n    // adj: tid = wp.tid()                                                                    <L 203>\n    // adj: def quaternion_rotate(quaternions: wp.array(dtype=wp.quat),                       <L 200>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void quaternion_rotate_e2a1b1a9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        quaternion_rotate_e2a1b1a9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void quaternion_rotate_e2a1b1a9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_args,\n    wp_args_quaternion_rotate_e2a1b1a9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        quaternion_rotate_e2a1b1a9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_update_particles_4723dcbc {\n    wp::array_t<Particle_9de5ed98> particles;\n    wp::float32 dt;\n};\n\n\nvoid update_particles_4723dcbc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_update_particles_4723dcbc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<Particle_9de5ed98> var_particles = _wp_args->particles;\n    wp::float32 var_dt = _wp_args->dt;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    Particle_9de5ed98* var_1;\n    Particle_9de5ed98 var_2;\n    Particle_9de5ed98 var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32>* var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::vec_t<3, wp::float32> var_7;\n    wp::vec_t<3, wp::float32> var_8;\n    wp::vec_t<3, wp::float32> var_9;\n    wp::vec_t<3, wp::float32>* var_10;\n    const wp::float32 var_11 = 0.0;\n    const wp::float32 var_12 = 9.8;\n    const wp::float32 var_13 = -9.8;\n    const wp::float32 var_14 = 0.0;\n    wp::vec_t<3, wp::float32> var_15;\n    wp::vec_t<3, wp::float32>* var_16;\n    wp::vec_t<3, wp::float32> var_17;\n    wp::vec_t<3, wp::float32> var_18;\n    wp::vec_t<3, wp::float32> var_19;\n    wp::vec_t<3, wp::float32>* var_20;\n    //---------\n    // forward\n    // def update_particles(particles: wp.array(dtype=Particle),                              <L 22>\n    // tid = wp.tid()                                                                         <L 24>\n    var_0 = builtin_tid1d();\n    // p = particles[tid]                                                                     <L 25>\n    var_1 = wp::address(var_particles, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // p.pos = p.pos + p.vel * dt                                                             <L 28>\n    var_4 = &(var_2.pos);\n    var_5 = &(var_2.vel);\n    var_7 = wp::load(var_5);\n    var_6 = wp::mul(var_7, var_dt);\n    var_9 = wp::load(var_4);\n    var_8 = wp::add(var_9, var_6);\n    var_10 = &(var_2.pos);\n    wp::store(var_10, var_8);\n    // gravity = wp.vec3(0.0, -9.8, 0.0)                                                      <L 31>\n    var_15 = wp::vec_t<3, wp::float32>(var_11, var_13, var_14);\n    // p.vel = p.vel + gravity * dt                                                           <L 32>\n    var_16 = &(var_2.vel);\n    var_17 = wp::mul(var_15, var_dt);\n    var_19 = wp::load(var_16);\n    var_18 = wp::add(var_19, var_17);\n    var_20 = &(var_2.vel);\n    wp::store(var_20, var_18);\n    // particles[tid] = p                                                                     <L 34>\n    wp::array_store(var_particles, var_0, var_2);\n}\n\n\n\nvoid update_particles_4723dcbc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_update_particles_4723dcbc *_wp_args,\n    wp_args_update_particles_4723dcbc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<Particle_9de5ed98> var_particles = _wp_args->particles;\n    wp::float32 var_dt = _wp_args->dt;\n    wp::array_t<Particle_9de5ed98> adj_particles = _wp_adj_args->particles;\n    wp::float32 adj_dt = _wp_adj_args->dt;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    Particle_9de5ed98* var_1;\n    Particle_9de5ed98 var_2;\n    Particle_9de5ed98 var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32>* var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::vec_t<3, wp::float32> var_7;\n    wp::vec_t<3, wp::float32> var_8;\n    wp::vec_t<3, wp::float32> var_9;\n    wp::vec_t<3, wp::float32>* var_10;\n    const wp::float32 var_11 = 0.0;\n    const wp::float32 var_12 = 9.8;\n    const wp::float32 var_13 = -9.8;\n    const wp::float32 var_14 = 0.0;\n    wp::vec_t<3, wp::float32> var_15;\n    wp::vec_t<3, wp::float32>* var_16;\n    wp::vec_t<3, wp::float32> var_17;\n    wp::vec_t<3, wp::float32> var_18;\n    wp::vec_t<3, wp::float32> var_19;\n    wp::vec_t<3, wp::float32>* var_20;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    Particle_9de5ed98 adj_1 = {};\n    Particle_9de5ed98 adj_2 = {};\n    Particle_9de5ed98 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    wp::vec_t<3, wp::float32> adj_6 = {};\n    wp::vec_t<3, wp::float32> adj_7 = {};\n    wp::vec_t<3, wp::float32> adj_8 = {};\n    wp::vec_t<3, wp::float32> adj_9 = {};\n    wp::vec_t<3, wp::float32> adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    wp::vec_t<3, wp::float32> adj_15 = {};\n    wp::vec_t<3, wp::float32> adj_16 = {};\n    wp::vec_t<3, wp::float32> adj_17 = {};\n    wp::vec_t<3, wp::float32> adj_18 = {};\n    wp::vec_t<3, wp::float32> adj_19 = {};\n    wp::vec_t<3, wp::float32> adj_20 = {};\n    //---------\n    // forward\n    // def update_particles(particles: wp.array(dtype=Particle),                              <L 22>\n    // tid = wp.tid()                                                                         <L 24>\n    var_0 = builtin_tid1d();\n    // p = particles[tid]                                                                     <L 25>\n    var_1 = wp::address(var_particles, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // p.pos = p.pos + p.vel * dt                                                             <L 28>\n    var_4 = &(var_2.pos);\n    var_5 = &(var_2.vel);\n    var_7 = wp::load(var_5);\n    var_6 = wp::mul(var_7, var_dt);\n    var_9 = wp::load(var_4);\n    var_8 = wp::add(var_9, var_6);\n    var_10 = &(var_2.pos);\n    // wp::store(var_10, var_8);\n    // gravity = wp.vec3(0.0, -9.8, 0.0)                                                      <L 31>\n    var_15 = wp::vec_t<3, wp::float32>(var_11, var_13, var_14);\n    // p.vel = p.vel + gravity * dt                                                           <L 32>\n    var_16 = &(var_2.vel);\n    var_17 = wp::mul(var_15, var_dt);\n    var_19 = wp::load(var_16);\n    var_18 = wp::add(var_19, var_17);\n    var_20 = &(var_2.vel);\n    // wp::store(var_20, var_18);\n    // particles[tid] = p                                                                     <L 34>\n    // wp::array_store(var_particles, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_particles, var_0, var_2, adj_particles, adj_0, adj_2);\n    // adj: particles[tid] = p                                                                <L 34>\n    adj_2.vel += adj_20;\n    wp::adj_add(var_19, var_17, adj_16, adj_17, adj_18);\n    wp::adj_mul(var_15, var_dt, adj_15, adj_dt, adj_17);\n    adj_2.vel += adj_16;\n    // adj: p.vel = p.vel + gravity * dt                                                      <L 32>\n    wp::adj_vec_t(var_11, var_13, var_14, adj_11, adj_13, adj_14, adj_15);\n    // adj: gravity = wp.vec3(0.0, -9.8, 0.0)                                                 <L 31>\n    adj_2.pos += adj_10;\n    wp::adj_add(var_9, var_6, adj_4, adj_6, adj_8);\n    wp::adj_mul(var_7, var_dt, adj_5, adj_dt, adj_6);\n    adj_2.vel += adj_5;\n    adj_2.pos += adj_4;\n    // adj: p.pos = p.pos + p.vel * dt                                                        <L 28>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_particles, var_0, adj_particles, adj_0, adj_1);\n    // adj: p = particles[tid]                                                                <L 25>\n    // adj: tid = wp.tid()                                                                    <L 24>\n    // adj: def update_particles(particles: wp.array(dtype=Particle),                         <L 22>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void update_particles_4723dcbc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_update_particles_4723dcbc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        update_particles_4723dcbc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void update_particles_4723dcbc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_update_particles_4723dcbc *_wp_args,\n    wp_args_update_particles_4723dcbc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        update_particles_4723dcbc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_binary_search_97cfe0f8 {\n    wp::array_t<wp::float32> sorted_array;\n    wp::float32 target;\n    wp::array_t<wp::int32> result;\n};\n\n\nvoid binary_search_97cfe0f8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_binary_search_97cfe0f8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_sorted_array = _wp_args->sorted_array;\n    wp::float32 var_target = _wp_args->target;\n    wp::array_t<wp::int32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    bool var_2;\n    wp::shape_t* var_3;\n    const wp::int32 var_4 = 0;\n    wp::int32 var_5;\n    wp::shape_t var_6;\n    const wp::int32 var_7 = 0;\n    wp::int32 var_8;\n    const wp::int32 var_9 = 1;\n    wp::int32 var_10;\n    wp::int32 var_11;\n    const wp::int32 var_12 = 1;\n    const wp::int32 var_13 = -1;\n    wp::int32 var_14;\n    bool var_15;\n    wp::int32 var_16;\n    const wp::int32 var_17 = 2;\n    wp::int32 var_18;\n    wp::float32* var_19;\n    wp::float32 var_20;\n    wp::float32 var_21;\n    bool var_22;\n    wp::int32 var_23;\n    bool var_24;\n    const wp::int32 var_25 = 1;\n    wp::int32 var_26;\n    wp::int32 var_27;\n    const wp::int32 var_28 = 1;\n    wp::int32 var_29;\n    wp::int32 var_30;\n    wp::int32 var_31;\n    wp::int32 var_32;\n    const wp::int32 var_33 = 0;\n    //---------\n    // forward\n    // def binary_search(sorted_array: wp.array(dtype=float),                                 <L 38>\n    // tid = wp.tid()                                                                         <L 41>\n    var_0 = builtin_tid1d();\n    // if tid == 0:  # Only first thread does the search                                      <L 43>\n    var_2 = (var_0 == var_1);\n    if (var_2) {\n        // n = sorted_array.shape[0]                                                          <L 44>\n        var_3 = &(var_sorted_array.shape);\n        var_6 = wp::load(var_3);\n        var_5 = wp::extract(var_6, var_4);\n        // left = int(0)                                                                      <L 45>\n        var_8 = wp::int(var_7);\n        // right = int(n - 1)                                                                 <L 46>\n        var_10 = wp::sub(var_5, var_9);\n        var_11 = wp::int(var_10);\n        // found = int(-1)                                                                    <L 47>\n        var_14 = wp::int(var_13);\n        // while left <= right:                                                               <L 49>\n    start_while_0:;\n        var_15 = (var_8 <= var_11);\n    if ((var_15) == false) goto end_while_0;\n            // mid = (left + right) // 2                                                      <L 50>\n            var_16 = wp::add(var_8, var_11);\n            var_18 = wp::floordiv(var_16, var_17);\n            // mid_val = sorted_array[mid]                                                    <L 51>\n            var_19 = wp::address(var_sorted_array, var_18);\n            var_21 = wp::load(var_19);\n            var_20 = wp::copy(var_21);\n            // if mid_val == target:                                                          <L 53>\n            var_22 = (var_20 == var_target);\n            if (var_22) {\n                // found = mid                                                                <L 54>\n                var_23 = wp::copy(var_18);\n                // break                                                                      <L 55>\n                wp::assign(var_14, var_23);\n                goto end_while_0;\n            }\n            if (!var_22) {\n                // elif mid_val < target:                                                     <L 56>\n                var_24 = (var_20 < var_target);\n                if (var_24) {\n                    // left = mid + 1                                                         <L 57>\n                    var_26 = wp::add(var_18, var_25);\n                }\n                var_27 = wp::where(var_24, var_26, var_8);\n                if (!var_24) {\n                    // right = mid - 1                                                        <L 59>\n                    var_29 = wp::sub(var_18, var_28);\n                }\n                var_30 = wp::where(var_24, var_11, var_29);\n            }\n            var_31 = wp::where(var_22, var_8, var_27);\n            var_32 = wp::where(var_22, var_11, var_30);\n            wp::assign(var_8, var_31);\n            wp::assign(var_11, var_32);\n    goto start_while_0;\n    end_while_0:;\n        // result[0] = found                                                                  <L 61>\n        wp::array_store(var_result, var_33, var_14);\n    }\n}\n\n\n\nvoid binary_search_97cfe0f8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_binary_search_97cfe0f8 *_wp_args,\n    wp_args_binary_search_97cfe0f8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_sorted_array = _wp_args->sorted_array;\n    wp::float32 var_target = _wp_args->target;\n    wp::array_t<wp::int32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_sorted_array = _wp_adj_args->sorted_array;\n    wp::float32 adj_target = _wp_adj_args->target;\n    wp::array_t<wp::int32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    bool var_2;\n    wp::shape_t* var_3;\n    const wp::int32 var_4 = 0;\n    wp::int32 var_5;\n    wp::shape_t var_6;\n    const wp::int32 var_7 = 0;\n    wp::int32 var_8;\n    const wp::int32 var_9 = 1;\n    wp::int32 var_10;\n    wp::int32 var_11;\n    const wp::int32 var_12 = 1;\n    const wp::int32 var_13 = -1;\n    wp::int32 var_14;\n    bool var_15;\n    wp::int32 var_16;\n    const wp::int32 var_17 = 2;\n    wp::int32 var_18;\n    wp::float32* var_19;\n    wp::float32 var_20;\n    wp::float32 var_21;\n    bool var_22;\n    wp::int32 var_23;\n    bool var_24;\n    const wp::int32 var_25 = 1;\n    wp::int32 var_26;\n    wp::int32 var_27;\n    const wp::int32 var_28 = 1;\n    wp::int32 var_29;\n    wp::int32 var_30;\n    wp::int32 var_31;\n    wp::int32 var_32;\n    const wp::int32 var_33 = 0;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    bool adj_2 = {};\n    wp::shape_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::int32 adj_5 = {};\n    wp::shape_t adj_6 = {};\n    wp::int32 adj_7 = {};\n    wp::int32 adj_8 = {};\n    wp::int32 adj_9 = {};\n    wp::int32 adj_10 = {};\n    wp::int32 adj_11 = {};\n    wp::int32 adj_12 = {};\n    wp::int32 adj_13 = {};\n    wp::int32 adj_14 = {};\n    bool adj_15 = {};\n    wp::int32 adj_16 = {};\n    wp::int32 adj_17 = {};\n    wp::int32 adj_18 = {};\n    wp::float32 adj_19 = {};\n    wp::float32 adj_20 = {};\n    wp::float32 adj_21 = {};\n    bool adj_22 = {};\n    wp::int32 adj_23 = {};\n    bool adj_24 = {};\n    wp::int32 adj_25 = {};\n    wp::int32 adj_26 = {};\n    wp::int32 adj_27 = {};\n    wp::int32 adj_28 = {};\n    wp::int32 adj_29 = {};\n    wp::int32 adj_30 = {};\n    wp::int32 adj_31 = {};\n    wp::int32 adj_32 = {};\n    wp::int32 adj_33 = {};\n    //---------\n    // forward\n    // def binary_search(sorted_array: wp.array(dtype=float),                                 <L 38>\n    // tid = wp.tid()                                                                         <L 41>\n    var_0 = builtin_tid1d();\n    // if tid == 0:  # Only first thread does the search                                      <L 43>\n    var_2 = (var_0 == var_1);\n    if (var_2) {\n        // n = sorted_array.shape[0]                                                          <L 44>\n        var_3 = &(var_sorted_array.shape);\n        var_6 = wp::load(var_3);\n        var_5 = wp::extract(var_6, var_4);\n        // left = int(0)                                                                      <L 45>\n        var_8 = wp::int(var_7);\n        // right = int(n - 1)                                                                 <L 46>\n        var_10 = wp::sub(var_5, var_9);\n        var_11 = wp::int(var_10);\n        // found = int(-1)                                                                    <L 47>\n        var_14 = wp::int(var_13);\n        // while left <= right:                                                               <L 49>\n        // result[0] = found                                                                  <L 61>\n        // wp::array_store(var_result, var_33, var_14);\n    }\n    //---------\n    // reverse\n    if (var_2) {\n        wp::adj_array_store(var_result, var_33, var_14, adj_result, adj_33, adj_14);\n        // adj: result[0] = found                                                             <L 61>\n    start_while_0:;\n        var_15 = (var_8 <= var_11);\n    if ((var_15) == false) goto end_while_0;\n    adj_16 = {};\n    adj_17 = {};\n    adj_18 = {};\n    adj_19 = {};\n    adj_20 = {};\n    adj_21 = {};\n    adj_22 = {};\n    adj_23 = {};\n    adj_24 = {};\n    adj_25 = {};\n    adj_26 = {};\n    adj_27 = {};\n    adj_28 = {};\n    adj_29 = {};\n    adj_30 = {};\n    adj_31 = {};\n    adj_32 = {};\n            // mid = (left + right) // 2                                                      <L 50>\n            var_16 = wp::add(var_8, var_11);\n            var_18 = wp::floordiv(var_16, var_17);\n            // mid_val = sorted_array[mid]                                                    <L 51>\n            var_19 = wp::address(var_sorted_array, var_18);\n            var_21 = wp::load(var_19);\n            var_20 = wp::copy(var_21);\n            // if mid_val == target:                                                          <L 53>\n            var_22 = (var_20 == var_target);\n            if (var_22) {\n                // found = mid                                                                <L 54>\n                var_23 = wp::copy(var_18);\n                // break                                                                      <L 55>\n                wp::assign(var_14, var_23);\n                goto end_while_0;\n            }\n            if (!var_22) {\n                // elif mid_val < target:                                                     <L 56>\n                var_24 = (var_20 < var_target);\n                if (var_24) {\n                    // left = mid + 1                                                         <L 57>\n                    var_26 = wp::add(var_18, var_25);\n                }\n                var_27 = wp::where(var_24, var_26, var_8);\n                if (!var_24) {\n                    // right = mid - 1                                                        <L 59>\n                    var_29 = wp::sub(var_18, var_28);\n                }\n                var_30 = wp::where(var_24, var_11, var_29);\n            }\n            var_31 = wp::where(var_22, var_8, var_27);\n            var_32 = wp::where(var_22, var_11, var_30);\n            wp::assign(var_8, var_31);\n            wp::assign(var_11, var_32);\n            wp::adj_assign(var_11, var_32, adj_11, adj_32);\n            wp::adj_assign(var_8, var_31, adj_8, adj_31);\n            wp::adj_where(var_22, var_11, var_30, adj_22, adj_11, adj_30, adj_32);\n            wp::adj_where(var_22, var_8, var_27, adj_22, adj_8, adj_27, adj_31);\n            if (!var_22) {\n                wp::adj_where(var_24, var_11, var_29, adj_24, adj_11, adj_29, adj_30);\n                if (!var_24) {\n                    wp::adj_sub(var_18, var_28, adj_18, adj_28, adj_29);\n                    // adj: right = mid - 1                                                   <L 59>\n                }\n                wp::adj_where(var_24, var_26, var_8, adj_24, adj_26, adj_8, adj_27);\n                if (var_24) {\n                    wp::adj_add(var_18, var_25, adj_18, adj_25, adj_26);\n                    // adj: left = mid + 1                                                    <L 57>\n                }\n                // adj: elif mid_val < target:                                                <L 56>\n            }\n            if (var_22) {\n                wp::adj_assign(var_14, var_23, adj_14, adj_23);\n                // adj: break                                                                 <L 55>\n                wp::adj_copy(var_18, adj_18, adj_23);\n                // adj: found = mid                                                           <L 54>\n            }\n            // adj: if mid_val == target:                                                     <L 53>\n            wp::adj_copy(var_21, adj_19, adj_20);\n            wp::adj_address(var_sorted_array, var_18, adj_sorted_array, adj_18, adj_19);\n            // adj: mid_val = sorted_array[mid]                                               <L 51>\n            wp::adj_add(var_8, var_11, adj_8, adj_11, adj_16);\n            // adj: mid = (left + right) // 2                                                 <L 50>\n    goto start_while_0;\n    end_while_0:;\n        // adj: while left <= right:                                                          <L 49>\n        wp::adj_int(var_13, adj_13, adj_14);\n        // adj: found = int(-1)                                                               <L 47>\n        wp::adj_int(var_10, adj_10, adj_11);\n        wp::adj_sub(var_5, var_9, adj_5, adj_9, adj_10);\n        // adj: right = int(n - 1)                                                            <L 46>\n        wp::adj_int(var_7, adj_7, adj_8);\n        // adj: left = int(0)                                                                 <L 45>\n        wp::adj_extract(var_6, var_4, adj_3, adj_4, adj_5);\n        adj_sorted_array.shape = adj_3;\n        // adj: n = sorted_array.shape[0]                                                     <L 44>\n    }\n    // adj: if tid == 0:  # Only first thread does the search                                 <L 43>\n    // adj: tid = wp.tid()                                                                    <L 41>\n    // adj: def binary_search(sorted_array: wp.array(dtype=float),                            <L 38>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void binary_search_97cfe0f8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_binary_search_97cfe0f8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        binary_search_97cfe0f8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void binary_search_97cfe0f8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_binary_search_97cfe0f8 *_wp_args,\n    wp_args_binary_search_97cfe0f8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        binary_search_97cfe0f8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_atomic_accumulate_eccd3338 {\n    wp::array_t<wp::float32> input;\n    wp::array_t<wp::float32> output;\n    wp::float32 bin_size;\n};\n\n\nvoid atomic_accumulate_eccd3338_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_atomic_accumulate_eccd3338 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_input = _wp_args->input;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    wp::float32 var_bin_size = _wp_args->bin_size;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::int32 var_5;\n    const wp::int32 var_6 = 0;\n    bool var_7;\n    wp::shape_t* var_8;\n    const wp::int32 var_9 = 0;\n    wp::int32 var_10;\n    wp::shape_t var_11;\n    bool var_12;\n    bool var_13;\n    const wp::float32 var_14 = 1.0;\n    wp::float32 var_15;\n    //---------\n    // forward\n    // def atomic_accumulate(input: wp.array(dtype=float),                                    <L 164>\n    // tid = wp.tid()                                                                         <L 167>\n    var_0 = builtin_tid1d();\n    // val = input[tid]                                                                       <L 168>\n    var_1 = wp::address(var_input, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // bin_idx = int(val / bin_size)                                                          <L 171>\n    var_4 = wp::div(var_2, var_bin_size);\n    var_5 = wp::int(var_4);\n    // if bin_idx >= 0 and bin_idx < output.shape[0]:                                         <L 174>\n    var_7 = (var_5 >= var_6);\n    var_8 = &(var_output.shape);\n    var_11 = wp::load(var_8);\n    var_10 = wp::extract(var_11, var_9);\n    var_12 = (var_5 < var_10);\n    var_13 = var_7 && var_12;\n    if (var_13) {\n        // wp.atomic_add(output, bin_idx, 1.0)                                                <L 175>\n        var_15 = wp::atomic_add(var_output, var_5, var_14);\n    }\n}\n\n\n\nvoid atomic_accumulate_eccd3338_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_atomic_accumulate_eccd3338 *_wp_args,\n    wp_args_atomic_accumulate_eccd3338 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_input = _wp_args->input;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    wp::float32 var_bin_size = _wp_args->bin_size;\n    wp::array_t<wp::float32> adj_input = _wp_adj_args->input;\n    wp::array_t<wp::float32> adj_output = _wp_adj_args->output;\n    wp::float32 adj_bin_size = _wp_adj_args->bin_size;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::int32 var_5;\n    const wp::int32 var_6 = 0;\n    bool var_7;\n    wp::shape_t* var_8;\n    const wp::int32 var_9 = 0;\n    wp::int32 var_10;\n    wp::shape_t var_11;\n    bool var_12;\n    bool var_13;\n    const wp::float32 var_14 = 1.0;\n    wp::float32 var_15;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::int32 adj_5 = {};\n    wp::int32 adj_6 = {};\n    bool adj_7 = {};\n    wp::shape_t adj_8 = {};\n    wp::int32 adj_9 = {};\n    wp::int32 adj_10 = {};\n    wp::shape_t adj_11 = {};\n    bool adj_12 = {};\n    bool adj_13 = {};\n    wp::float32 adj_14 = {};\n    wp::float32 adj_15 = {};\n    //---------\n    // forward\n    // def atomic_accumulate(input: wp.array(dtype=float),                                    <L 164>\n    // tid = wp.tid()                                                                         <L 167>\n    var_0 = builtin_tid1d();\n    // val = input[tid]                                                                       <L 168>\n    var_1 = wp::address(var_input, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // bin_idx = int(val / bin_size)                                                          <L 171>\n    var_4 = wp::div(var_2, var_bin_size);\n    var_5 = wp::int(var_4);\n    // if bin_idx >= 0 and bin_idx < output.shape[0]:                                         <L 174>\n    var_7 = (var_5 >= var_6);\n    var_8 = &(var_output.shape);\n    var_11 = wp::load(var_8);\n    var_10 = wp::extract(var_11, var_9);\n    var_12 = (var_5 < var_10);\n    var_13 = var_7 && var_12;\n    if (var_13) {\n        // wp.atomic_add(output, bin_idx, 1.0)                                                <L 175>\n        // var_15 = wp::atomic_add(var_output, var_5, var_14);\n    }\n    //---------\n    // reverse\n    if (var_13) {\n        wp::adj_atomic_add(var_output, var_5, var_14, adj_output, adj_5, adj_14, adj_15);\n        // adj: wp.atomic_add(output, bin_idx, 1.0)                                           <L 175>\n    }\n    wp::adj_extract(var_11, var_9, adj_8, adj_9, adj_10);\n    adj_output.shape = adj_8;\n    // adj: if bin_idx >= 0 and bin_idx < output.shape[0]:                                    <L 174>\n    wp::adj_int(var_4, adj_4, adj_5);\n    wp::adj_div(var_2, var_bin_size, var_4, adj_2, adj_bin_size, adj_4);\n    // adj: bin_idx = int(val / bin_size)                                                     <L 171>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_input, var_0, adj_input, adj_0, adj_1);\n    // adj: val = input[tid]                                                                  <L 168>\n    // adj: tid = wp.tid()                                                                    <L 167>\n    // adj: def atomic_accumulate(input: wp.array(dtype=float),                               <L 164>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void atomic_accumulate_eccd3338_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_atomic_accumulate_eccd3338 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        atomic_accumulate_eccd3338_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void atomic_accumulate_eccd3338_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_atomic_accumulate_eccd3338 *_wp_args,\n    wp_args_atomic_accumulate_eccd3338 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        atomic_accumulate_eccd3338_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_bounds_and_clamp_47f36714 {\n    wp::array_t<wp::float32> values;\n    wp::array_t<wp::float32> lower;\n    wp::array_t<wp::float32> upper;\n    wp::array_t<wp::float32> output;\n};\n\n\nvoid bounds_and_clamp_47f36714_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_bounds_and_clamp_47f36714 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_values = _wp_args->values;\n    wp::array_t<wp::float32> var_lower = _wp_args->lower;\n    wp::array_t<wp::float32> var_upper = _wp_args->upper;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    wp::float32* var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def bounds_and_clamp(values: wp.array(dtype=float),                                    <L 145>\n    // tid = wp.tid()                                                                         <L 149>\n    var_0 = builtin_tid1d();\n    // val = values[tid]                                                                      <L 151>\n    var_1 = wp::address(var_values, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // lo = lower[tid]                                                                        <L 152>\n    var_4 = wp::address(var_lower, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // hi = upper[tid]                                                                        <L 153>\n    var_7 = wp::address(var_upper, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::copy(var_9);\n    // val = wp.max(val, lo)                                                                  <L 156>\n    var_10 = wp::max(var_2, var_5);\n    // val = wp.min(val, hi)                                                                  <L 157>\n    var_11 = wp::min(var_10, var_8);\n    // output[tid] = wp.clamp(values[tid], lo, hi)                                            <L 160>\n    var_12 = wp::address(var_values, var_0);\n    var_14 = wp::load(var_12);\n    var_13 = wp::clamp(var_14, var_5, var_8);\n    wp::array_store(var_output, var_0, var_13);\n}\n\n\n\nvoid bounds_and_clamp_47f36714_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_bounds_and_clamp_47f36714 *_wp_args,\n    wp_args_bounds_and_clamp_47f36714 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_values = _wp_args->values;\n    wp::array_t<wp::float32> var_lower = _wp_args->lower;\n    wp::array_t<wp::float32> var_upper = _wp_args->upper;\n    wp::array_t<wp::float32> var_output = _wp_args->output;\n    wp::array_t<wp::float32> adj_values = _wp_adj_args->values;\n    wp::array_t<wp::float32> adj_lower = _wp_adj_args->lower;\n    wp::array_t<wp::float32> adj_upper = _wp_adj_args->upper;\n    wp::array_t<wp::float32> adj_output = _wp_adj_args->output;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    wp::float32* var_12;\n    wp::float32 var_13;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def bounds_and_clamp(values: wp.array(dtype=float),                                    <L 145>\n    // tid = wp.tid()                                                                         <L 149>\n    var_0 = builtin_tid1d();\n    // val = values[tid]                                                                      <L 151>\n    var_1 = wp::address(var_values, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // lo = lower[tid]                                                                        <L 152>\n    var_4 = wp::address(var_lower, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // hi = upper[tid]                                                                        <L 153>\n    var_7 = wp::address(var_upper, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::copy(var_9);\n    // val = wp.max(val, lo)                                                                  <L 156>\n    var_10 = wp::max(var_2, var_5);\n    // val = wp.min(val, hi)                                                                  <L 157>\n    var_11 = wp::min(var_10, var_8);\n    // output[tid] = wp.clamp(values[tid], lo, hi)                                            <L 160>\n    var_12 = wp::address(var_values, var_0);\n    var_14 = wp::load(var_12);\n    var_13 = wp::clamp(var_14, var_5, var_8);\n    // wp::array_store(var_output, var_0, var_13);\n    //---------\n    // reverse\n    wp::adj_array_store(var_output, var_0, var_13, adj_output, adj_0, adj_13);\n    wp::adj_clamp(var_14, var_5, var_8, adj_12, adj_5, adj_8, adj_13);\n    wp::adj_address(var_values, var_0, adj_values, adj_0, adj_12);\n    // adj: output[tid] = wp.clamp(values[tid], lo, hi)                                       <L 160>\n    wp::adj_min(var_10, var_8, adj_10, adj_8, adj_11);\n    // adj: val = wp.min(val, hi)                                                             <L 157>\n    wp::adj_max(var_2, var_5, adj_2, adj_5, adj_10);\n    // adj: val = wp.max(val, lo)                                                             <L 156>\n    wp::adj_copy(var_9, adj_7, adj_8);\n    wp::adj_address(var_upper, var_0, adj_upper, adj_0, adj_7);\n    // adj: hi = upper[tid]                                                                   <L 153>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_lower, var_0, adj_lower, adj_0, adj_4);\n    // adj: lo = lower[tid]                                                                   <L 152>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_values, var_0, adj_values, adj_0, adj_1);\n    // adj: val = values[tid]                                                                 <L 151>\n    // adj: tid = wp.tid()                                                                    <L 149>\n    // adj: def bounds_and_clamp(values: wp.array(dtype=float),                               <L 145>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void bounds_and_clamp_47f36714_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_bounds_and_clamp_47f36714 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        bounds_and_clamp_47f36714_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void bounds_and_clamp_47f36714_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_bounds_and_clamp_47f36714 *_wp_args,\n    wp_args_bounds_and_clamp_47f36714 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        bounds_and_clamp_47f36714_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\nstruct wp_args_vector_operations_1b1ac562 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> dot_out;\n    wp::array_t<wp::vec_t<3, wp::float32>> cross_out;\n    wp::array_t<wp::float32> length_out;\n};\n\n\nvoid vector_operations_1b1ac562_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vector_operations_1b1ac562 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_dot_out = _wp_args->dot_out;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_cross_out = _wp_args->cross_out;\n    wp::array_t<wp::float32> var_length_out = _wp_args->length_out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32> var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::float32 var_7;\n    wp::vec_t<3, wp::float32> var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def vector_operations(a: wp.array(dtype=wp.vec3),                                      <L 179>\n    // tid = wp.tid()                                                                         <L 184>\n    var_0 = builtin_tid1d();\n    // v1 = a[tid]                                                                            <L 186>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // v2 = b[tid]                                                                            <L 187>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // dot_out[tid] = wp.dot(v1, v2)                                                          <L 190>\n    var_7 = wp::dot(var_2, var_5);\n    wp::array_store(var_dot_out, var_0, var_7);\n    // cross_out[tid] = wp.cross(v1, v2)                                                      <L 193>\n    var_8 = wp::cross(var_2, var_5);\n    wp::array_store(var_cross_out, var_0, var_8);\n    // length_out[tid] = wp.length(v1)                                                        <L 196>\n    var_9 = wp::length(var_2);\n    wp::array_store(var_length_out, var_0, var_9);\n}\n\n\n\nvoid vector_operations_1b1ac562_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vector_operations_1b1ac562 *_wp_args,\n    wp_args_vector_operations_1b1ac562 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_dot_out = _wp_args->dot_out;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_cross_out = _wp_args->cross_out;\n    wp::array_t<wp::float32> var_length_out = _wp_args->length_out;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_dot_out = _wp_adj_args->dot_out;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_cross_out = _wp_adj_args->cross_out;\n    wp::array_t<wp::float32> adj_length_out = _wp_adj_args->length_out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32> var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    wp::vec_t<3, wp::float32>* var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    wp::vec_t<3, wp::float32> var_6;\n    wp::float32 var_7;\n    wp::vec_t<3, wp::float32> var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    wp::vec_t<3, wp::float32> adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::vec_t<3, wp::float32> adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def vector_operations(a: wp.array(dtype=wp.vec3),                                      <L 179>\n    // tid = wp.tid()                                                                         <L 184>\n    var_0 = builtin_tid1d();\n    // v1 = a[tid]                                                                            <L 186>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // v2 = b[tid]                                                                            <L 187>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // dot_out[tid] = wp.dot(v1, v2)                                                          <L 190>\n    var_7 = wp::dot(var_2, var_5);\n    // wp::array_store(var_dot_out, var_0, var_7);\n    // cross_out[tid] = wp.cross(v1, v2)                                                      <L 193>\n    var_8 = wp::cross(var_2, var_5);\n    // wp::array_store(var_cross_out, var_0, var_8);\n    // length_out[tid] = wp.length(v1)                                                        <L 196>\n    var_9 = wp::length(var_2);\n    // wp::array_store(var_length_out, var_0, var_9);\n    //---------\n    // reverse\n    wp::adj_array_store(var_length_out, var_0, var_9, adj_length_out, adj_0, adj_9);\n    wp::adj_length(var_2, var_9, adj_2, adj_9);\n    // adj: length_out[tid] = wp.length(v1)                                                   <L 196>\n    wp::adj_array_store(var_cross_out, var_0, var_8, adj_cross_out, adj_0, adj_8);\n    wp::adj_cross(var_2, var_5, adj_2, adj_5, adj_8);\n    // adj: cross_out[tid] = wp.cross(v1, v2)                                                 <L 193>\n    wp::adj_array_store(var_dot_out, var_0, var_7, adj_dot_out, adj_0, adj_7);\n    wp::adj_dot(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: dot_out[tid] = wp.dot(v1, v2)                                                     <L 190>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: v2 = b[tid]                                                                       <L 187>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: v1 = a[tid]                                                                       <L 186>\n    // adj: tid = wp.tid()                                                                    <L 184>\n    // adj: def vector_operations(a: wp.array(dtype=wp.vec3),                                 <L 179>\n    return;\n}\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vector_operations_1b1ac562_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vector_operations_1b1ac562 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vector_operations_1b1ac562_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vector_operations_1b1ac562_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vector_operations_1b1ac562 *_wp_args,\n    wp_args_vector_operations_1b1ac562 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vector_operations_1b1ac562_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n",
  "meta": "{\"wave_simulation_053e6d1a_cuda_kernel_forward_smem_bytes\": 0, \"wave_simulation_053e6d1a_cuda_kernel_backward_smem_bytes\": 0, \"matrix_multiply_kernel_fe2e5f9d_cuda_kernel_forward_smem_bytes\": 0, \"matrix_multiply_kernel_fe2e5f9d_cuda_kernel_backward_smem_bytes\": 0, \"bit_operations_fc19086f_cuda_kernel_forward_smem_bytes\": 0, \"bit_operations_fc19086f_cuda_kernel_backward_smem_bytes\": 0, \"classify_and_transform_e01e53a0_cuda_kernel_forward_smem_bytes\": 0, \"classify_and_transform_e01e53a0_cuda_kernel_backward_smem_bytes\": 0, \"quaternion_rotate_e2a1b1a9_cuda_kernel_forward_smem_bytes\": 0, \"quaternion_rotate_e2a1b1a9_cuda_kernel_backward_smem_bytes\": 0, \"update_particles_4723dcbc_cuda_kernel_forward_smem_bytes\": 0, \"update_particles_4723dcbc_cuda_kernel_backward_smem_bytes\": 0, \"binary_search_97cfe0f8_cuda_kernel_forward_smem_bytes\": 0, \"binary_search_97cfe0f8_cuda_kernel_backward_smem_bytes\": 0, \"atomic_accumulate_eccd3338_cuda_kernel_forward_smem_bytes\": 0, \"atomic_accumulate_eccd3338_cuda_kernel_backward_smem_bytes\": 0, \"bounds_and_clamp_47f36714_cuda_kernel_forward_smem_bytes\": 0, \"bounds_and_clamp_47f36714_cuda_kernel_backward_smem_bytes\": 0, \"vector_operations_1b1ac562_cuda_kernel_forward_smem_bytes\": 0, \"vector_operations_1b1ac562_cuda_kernel_backward_smem_bytes\": 0}",
  "module_hash": "e32b46b"
}