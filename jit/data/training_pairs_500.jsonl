{"id": 0, "kernel_name": "compound_ptzr", "python": "@wp.kernel\ndef compound_ptzr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ptzr_0722e405 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ptzr_0722e405_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ptzr_0722e405 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ptzr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ptzr_0722e405_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ptzr_0722e405 *_wp_args,\n    wp_args_compound_ptzr_0722e405 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ptzr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ptzr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ptzr_0722e405_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ptzr_0722e405 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ptzr_0722e405_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ptzr_0722e405_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ptzr_0722e405 *_wp_args,\n    wp_args_compound_ptzr_0722e405 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ptzr_0722e405_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 1, "kernel_name": "reduce_jvdp", "python": "@wp.kernel\ndef reduce_jvdp(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jvdp_f12efc13 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jvdp_f12efc13_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvdp_f12efc13 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jvdp(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jvdp_f12efc13_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvdp_f12efc13 *_wp_args,\n    wp_args_reduce_jvdp_f12efc13 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jvdp(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jvdp(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jvdp_f12efc13_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvdp_f12efc13 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvdp_f12efc13_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jvdp_f12efc13_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvdp_f12efc13 *_wp_args,\n    wp_args_reduce_jvdp_f12efc13 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvdp_f12efc13_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 2, "kernel_name": "vec_kcay", "python": "@wp.kernel\ndef vec_kcay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kcay_8817edcb {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kcay_8817edcb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kcay_8817edcb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kcay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kcay_8817edcb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kcay_8817edcb *_wp_args,\n    wp_args_vec_kcay_8817edcb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kcay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kcay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kcay_8817edcb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kcay_8817edcb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kcay_8817edcb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kcay_8817edcb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kcay_8817edcb *_wp_args,\n    wp_args_vec_kcay_8817edcb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kcay_8817edcb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 3, "kernel_name": "branch_waek", "python": "@wp.kernel\ndef branch_waek(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.11:\n        b[tid] = val - 0.9\n    else:\n        b[tid] = val - 2.0", "cpp": "struct wp_args_branch_waek_0a55a078 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_waek_0a55a078_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_waek_0a55a078 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    const wp::float32 var_5 = -0.11;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.0;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_waek(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.11:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.9                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.0                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_waek_0a55a078_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_waek_0a55a078 *_wp_args,\n    wp_args_branch_waek_0a55a078 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    const wp::float32 var_5 = -0.11;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.0;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_waek(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.11:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.9                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.0                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.0                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 0.9                                                            <L 8>\n    }\n    // adj: if val > -0.11:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_waek(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_waek_0a55a078_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_waek_0a55a078 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_waek_0a55a078_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_waek_0a55a078_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_waek_0a55a078 *_wp_args,\n    wp_args_branch_waek_0a55a078 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_waek_0a55a078_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 4, "kernel_name": "compound_pqzv", "python": "@wp.kernel\ndef compound_pqzv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pqzv_cc5ae30d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pqzv_cc5ae30d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pqzv_cc5ae30d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pqzv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pqzv_cc5ae30d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pqzv_cc5ae30d *_wp_args,\n    wp_args_compound_pqzv_cc5ae30d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pqzv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pqzv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pqzv_cc5ae30d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pqzv_cc5ae30d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pqzv_cc5ae30d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pqzv_cc5ae30d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pqzv_cc5ae30d *_wp_args,\n    wp_args_compound_pqzv_cc5ae30d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pqzv_cc5ae30d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 5, "kernel_name": "nested_unlh", "python": "@wp.kernel\ndef nested_unlh(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.13:\n        if val > 1.23:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_unlh_d22f6fa5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_unlh_d22f6fa5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_unlh_d22f6fa5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    const wp::float32 var_5 = -0.13;\n    bool var_6;\n    const wp::float32 var_7 = 1.23;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_unlh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.13:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.23:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_unlh_d22f6fa5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_unlh_d22f6fa5 *_wp_args,\n    wp_args_nested_unlh_d22f6fa5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    const wp::float32 var_5 = -0.13;\n    bool var_6;\n    const wp::float32 var_7 = 1.23;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_unlh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.13:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.23:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.23:                                                                <L 8>\n    }\n    // adj: if val > -0.13:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_unlh(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_unlh_d22f6fa5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_unlh_d22f6fa5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_unlh_d22f6fa5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_unlh_d22f6fa5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_unlh_d22f6fa5 *_wp_args,\n    wp_args_nested_unlh_d22f6fa5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_unlh_d22f6fa5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 6, "kernel_name": "branch_geuz", "python": "@wp.kernel\ndef branch_geuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.27:\n        b[tid] = val + 0.7\n    else:\n        b[tid] = val + 0.5", "cpp": "struct wp_args_branch_geuz_c355cc33 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_geuz_c355cc33_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_geuz_c355cc33 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.27;\n    bool var_5;\n    const wp::float32 var_6 = 0.7;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.5;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_geuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.27:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 0.7                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.5                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_geuz_c355cc33_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_geuz_c355cc33 *_wp_args,\n    wp_args_branch_geuz_c355cc33 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.27;\n    bool var_5;\n    const wp::float32 var_6 = 0.7;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.5;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_geuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.27:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 0.7                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.5                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 0.5                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 0.7                                                            <L 8>\n    }\n    // adj: if val > 0.27:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_geuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_geuz_c355cc33_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_geuz_c355cc33 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_geuz_c355cc33_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_geuz_c355cc33_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_geuz_c355cc33 *_wp_args,\n    wp_args_branch_geuz_c355cc33 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_geuz_c355cc33_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 7, "kernel_name": "loop_ghoi", "python": "@wp.kernel\ndef loop_ghoi(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_ghoi_014f03a9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_ghoi_014f03a9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ghoi_014f03a9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_ghoi(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_ghoi_014f03a9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ghoi_014f03a9 *_wp_args,\n    wp_args_loop_ghoi_014f03a9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_ghoi(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_ghoi(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_ghoi_014f03a9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ghoi_014f03a9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ghoi_014f03a9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_ghoi_014f03a9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ghoi_014f03a9 *_wp_args,\n    wp_args_loop_ghoi_014f03a9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ghoi_014f03a9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 8, "kernel_name": "unary_dmmi", "python": "@wp.kernel\ndef unary_dmmi(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_dmmi_4017cdbe {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dmmi_4017cdbe_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dmmi_4017cdbe *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dmmi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dmmi_4017cdbe_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dmmi_4017cdbe *_wp_args,\n    wp_args_unary_dmmi_4017cdbe *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dmmi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dmmi(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dmmi_4017cdbe_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dmmi_4017cdbe *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dmmi_4017cdbe_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dmmi_4017cdbe_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dmmi_4017cdbe *_wp_args,\n    wp_args_unary_dmmi_4017cdbe *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dmmi_4017cdbe_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 9, "kernel_name": "reduce_iicv", "python": "@wp.kernel\ndef reduce_iicv(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iicv_8e6ce526 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iicv_8e6ce526_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iicv_8e6ce526 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iicv(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iicv_8e6ce526_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iicv_8e6ce526 *_wp_args,\n    wp_args_reduce_iicv_8e6ce526 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iicv(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iicv(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iicv_8e6ce526_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iicv_8e6ce526 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iicv_8e6ce526_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iicv_8e6ce526_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iicv_8e6ce526 *_wp_args,\n    wp_args_reduce_iicv_8e6ce526 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iicv_8e6ce526_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 10, "kernel_name": "nested_ohij", "python": "@wp.kernel\ndef nested_ohij(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.06:\n        if val > 1.21:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ohij_1604b4b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ohij_1604b4b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohij_1604b4b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 1.21;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ohij(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.21:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ohij_1604b4b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohij_1604b4b6 *_wp_args,\n    wp_args_nested_ohij_1604b4b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 1.21;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ohij(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.21:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.21:                                                                <L 8>\n    }\n    // adj: if val > -0.06:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ohij(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ohij_1604b4b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohij_1604b4b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohij_1604b4b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ohij_1604b4b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohij_1604b4b6 *_wp_args,\n    wp_args_nested_ohij_1604b4b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohij_1604b4b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 11, "kernel_name": "unary_dnvt", "python": "@wp.kernel\ndef unary_dnvt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_dnvt_6dd29575 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dnvt_6dd29575_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dnvt_6dd29575 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dnvt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dnvt_6dd29575_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dnvt_6dd29575 *_wp_args,\n    wp_args_unary_dnvt_6dd29575 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dnvt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dnvt(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dnvt_6dd29575_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dnvt_6dd29575 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dnvt_6dd29575_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dnvt_6dd29575_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dnvt_6dd29575 *_wp_args,\n    wp_args_unary_dnvt_6dd29575 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dnvt_6dd29575_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 12, "kernel_name": "multi_ltuo", "python": "@wp.kernel\ndef multi_ltuo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_ltuo_bc87006f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_ltuo_bc87006f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ltuo_bc87006f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_ltuo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_ltuo_bc87006f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ltuo_bc87006f *_wp_args,\n    wp_args_multi_ltuo_bc87006f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_ltuo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_ltuo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_ltuo_bc87006f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ltuo_bc87006f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ltuo_bc87006f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_ltuo_bc87006f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ltuo_bc87006f *_wp_args,\n    wp_args_multi_ltuo_bc87006f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ltuo_bc87006f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 13, "kernel_name": "reduce_jcjr", "python": "@wp.kernel\ndef reduce_jcjr(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jcjr_32c672ab {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jcjr_32c672ab_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jcjr_32c672ab *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jcjr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jcjr_32c672ab_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jcjr_32c672ab *_wp_args,\n    wp_args_reduce_jcjr_32c672ab *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jcjr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jcjr(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jcjr_32c672ab_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jcjr_32c672ab *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jcjr_32c672ab_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jcjr_32c672ab_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jcjr_32c672ab *_wp_args,\n    wp_args_reduce_jcjr_32c672ab *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jcjr_32c672ab_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 14, "kernel_name": "vec_kozg", "python": "@wp.kernel\ndef vec_kozg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kozg_47ca9a6f {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kozg_47ca9a6f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kozg_47ca9a6f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kozg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kozg_47ca9a6f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kozg_47ca9a6f *_wp_args,\n    wp_args_vec_kozg_47ca9a6f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kozg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kozg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kozg_47ca9a6f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kozg_47ca9a6f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kozg_47ca9a6f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kozg_47ca9a6f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kozg_47ca9a6f *_wp_args,\n    wp_args_vec_kozg_47ca9a6f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kozg_47ca9a6f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 15, "kernel_name": "unary_dfov", "python": "@wp.kernel\ndef unary_dfov(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dfov_f6c5468c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dfov_f6c5468c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dfov_f6c5468c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dfov(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dfov_f6c5468c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dfov_f6c5468c *_wp_args,\n    wp_args_unary_dfov_f6c5468c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dfov(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dfov(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dfov_f6c5468c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dfov_f6c5468c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dfov_f6c5468c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dfov_f6c5468c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dfov_f6c5468c *_wp_args,\n    wp_args_unary_dfov_f6c5468c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dfov_f6c5468c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 16, "kernel_name": "multi_lbre", "python": "@wp.kernel\ndef multi_lbre(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lbre_4b6cbddd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lbre_4b6cbddd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lbre_4b6cbddd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lbre(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lbre_4b6cbddd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lbre_4b6cbddd *_wp_args,\n    wp_args_multi_lbre_4b6cbddd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lbre(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lbre(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lbre_4b6cbddd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lbre_4b6cbddd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lbre_4b6cbddd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lbre_4b6cbddd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lbre_4b6cbddd *_wp_args,\n    wp_args_multi_lbre_4b6cbddd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lbre_4b6cbddd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 17, "kernel_name": "compound_qoln", "python": "@wp.kernel\ndef compound_qoln(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qoln_b0023201 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qoln_b0023201_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qoln_b0023201 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qoln(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qoln_b0023201_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qoln_b0023201 *_wp_args,\n    wp_args_compound_qoln_b0023201 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qoln(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qoln(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qoln_b0023201_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qoln_b0023201 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qoln_b0023201_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qoln_b0023201_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qoln_b0023201 *_wp_args,\n    wp_args_compound_qoln_b0023201 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qoln_b0023201_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 18, "kernel_name": "nested_nfjo", "python": "@wp.kernel\ndef nested_nfjo(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.17:\n        if val > 1.31:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nfjo_e61e1190 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nfjo_e61e1190_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nfjo_e61e1190 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    bool var_5;\n    const wp::float32 var_6 = 1.31;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_nfjo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.17:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.31:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_nfjo_e61e1190_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nfjo_e61e1190 *_wp_args,\n    wp_args_nested_nfjo_e61e1190 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    bool var_5;\n    const wp::float32 var_6 = 1.31;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_nfjo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.17:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.31:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.31:                                                                <L 8>\n    }\n    // adj: if val > 0.17:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nfjo(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nfjo_e61e1190_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nfjo_e61e1190 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nfjo_e61e1190_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nfjo_e61e1190_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nfjo_e61e1190 *_wp_args,\n    wp_args_nested_nfjo_e61e1190 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nfjo_e61e1190_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 19, "kernel_name": "multi_mcrg", "python": "@wp.kernel\ndef multi_mcrg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_mcrg_f43cf58f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mcrg_f43cf58f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mcrg_f43cf58f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mcrg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mcrg_f43cf58f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mcrg_f43cf58f *_wp_args,\n    wp_args_multi_mcrg_f43cf58f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mcrg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mcrg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mcrg_f43cf58f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mcrg_f43cf58f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mcrg_f43cf58f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mcrg_f43cf58f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mcrg_f43cf58f *_wp_args,\n    wp_args_multi_mcrg_f43cf58f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mcrg_f43cf58f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 20, "kernel_name": "scalar_arr_tcze", "python": "@wp.kernel\ndef scalar_arr_tcze(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_tcze_dea6797f {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_tcze_dea6797f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_tcze(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_tcze_dea6797f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_args,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_tcze(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_tcze(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_tcze_dea6797f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tcze_dea6797f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_tcze_dea6797f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_args,\n    wp_args_scalar_arr_tcze_dea6797f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tcze_dea6797f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 21, "kernel_name": "compound_oudv", "python": "@wp.kernel\ndef compound_oudv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_oudv_2faf3f40 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_oudv_2faf3f40_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_oudv_2faf3f40 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_oudv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_oudv_2faf3f40_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_oudv_2faf3f40 *_wp_args,\n    wp_args_compound_oudv_2faf3f40 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_oudv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_oudv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_oudv_2faf3f40_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_oudv_2faf3f40 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_oudv_2faf3f40_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_oudv_2faf3f40_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_oudv_2faf3f40 *_wp_args,\n    wp_args_compound_oudv_2faf3f40 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_oudv_2faf3f40_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 22, "kernel_name": "multi_slvi", "python": "@wp.kernel\ndef multi_slvi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_slvi_c2340f69 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_slvi_c2340f69_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_slvi_c2340f69 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_slvi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_slvi_c2340f69_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_slvi_c2340f69 *_wp_args,\n    wp_args_multi_slvi_c2340f69 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_slvi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_slvi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_slvi_c2340f69_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_slvi_c2340f69 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_slvi_c2340f69_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_slvi_c2340f69_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_slvi_c2340f69 *_wp_args,\n    wp_args_multi_slvi_c2340f69 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_slvi_c2340f69_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 23, "kernel_name": "unary_qerx", "python": "@wp.kernel\ndef unary_qerx(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_qerx_34c9b66e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_qerx_34c9b66e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_qerx_34c9b66e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_qerx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_qerx_34c9b66e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_qerx_34c9b66e *_wp_args,\n    wp_args_unary_qerx_34c9b66e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_qerx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_qerx(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_qerx_34c9b66e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_qerx_34c9b66e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_qerx_34c9b66e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_qerx_34c9b66e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_qerx_34c9b66e *_wp_args,\n    wp_args_unary_qerx_34c9b66e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_qerx_34c9b66e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 24, "kernel_name": "unary_daqb", "python": "@wp.kernel\ndef unary_daqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_daqb_6854a965 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_daqb_6854a965_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_daqb_6854a965 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_daqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_daqb_6854a965_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_daqb_6854a965 *_wp_args,\n    wp_args_unary_daqb_6854a965 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_daqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_daqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_daqb_6854a965_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_daqb_6854a965 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_daqb_6854a965_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_daqb_6854a965_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_daqb_6854a965 *_wp_args,\n    wp_args_unary_daqb_6854a965 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_daqb_6854a965_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 25, "kernel_name": "multi_mezi", "python": "@wp.kernel\ndef multi_mezi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mezi_d968e792 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mezi_d968e792_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mezi_d968e792 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mezi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mezi_d968e792_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mezi_d968e792 *_wp_args,\n    wp_args_multi_mezi_d968e792 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mezi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mezi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mezi_d968e792_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mezi_d968e792 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mezi_d968e792_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mezi_d968e792_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mezi_d968e792 *_wp_args,\n    wp_args_multi_mezi_d968e792 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mezi_d968e792_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 26, "kernel_name": "compound_ovjr", "python": "@wp.kernel\ndef compound_ovjr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ovjr_0ff5c5ee {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ovjr_0ff5c5ee_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ovjr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ovjr_0ff5c5ee_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_args,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ovjr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ovjr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ovjr_0ff5c5ee_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ovjr_0ff5c5ee_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ovjr_0ff5c5ee_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_args,\n    wp_args_compound_ovjr_0ff5c5ee *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ovjr_0ff5c5ee_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 27, "kernel_name": "branch_fqrk", "python": "@wp.kernel\ndef branch_fqrk(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.84:\n        b[tid] = val + 2.9\n    else:\n        b[tid] = val + 1.7", "cpp": "struct wp_args_branch_fqrk_1799af21 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fqrk_1799af21_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqrk_1799af21 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.84;\n    const wp::float32 var_5 = -0.84;\n    bool var_6;\n    const wp::float32 var_7 = 2.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fqrk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.84:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fqrk_1799af21_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqrk_1799af21 *_wp_args,\n    wp_args_branch_fqrk_1799af21 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.84;\n    const wp::float32 var_5 = -0.84;\n    bool var_6;\n    const wp::float32 var_7 = 2.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fqrk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.84:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 1.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 2.9                                                            <L 8>\n    }\n    // adj: if val > -0.84:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fqrk(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fqrk_1799af21_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqrk_1799af21 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqrk_1799af21_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fqrk_1799af21_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqrk_1799af21 *_wp_args,\n    wp_args_branch_fqrk_1799af21 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqrk_1799af21_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 28, "kernel_name": "reduce_ifed", "python": "@wp.kernel\ndef reduce_ifed(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ifed_a4bb9362 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ifed_a4bb9362_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ifed_a4bb9362 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ifed(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ifed_a4bb9362_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ifed_a4bb9362 *_wp_args,\n    wp_args_reduce_ifed_a4bb9362 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ifed(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ifed(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ifed_a4bb9362_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ifed_a4bb9362 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ifed_a4bb9362_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ifed_a4bb9362_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ifed_a4bb9362 *_wp_args,\n    wp_args_reduce_ifed_a4bb9362 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ifed_a4bb9362_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 29, "kernel_name": "unary_eltf", "python": "@wp.kernel\ndef unary_eltf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_eltf_1b986a4b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_eltf_1b986a4b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eltf_1b986a4b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_eltf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_eltf_1b986a4b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eltf_1b986a4b *_wp_args,\n    wp_args_unary_eltf_1b986a4b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_eltf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_eltf(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_eltf_1b986a4b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eltf_1b986a4b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eltf_1b986a4b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_eltf_1b986a4b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eltf_1b986a4b *_wp_args,\n    wp_args_unary_eltf_1b986a4b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eltf_1b986a4b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 30, "kernel_name": "compound_phtx", "python": "@wp.kernel\ndef compound_phtx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_phtx_e7da26b8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_phtx_e7da26b8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_phtx_e7da26b8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_phtx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_phtx_e7da26b8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_phtx_e7da26b8 *_wp_args,\n    wp_args_compound_phtx_e7da26b8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_phtx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_phtx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_phtx_e7da26b8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_phtx_e7da26b8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_phtx_e7da26b8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_phtx_e7da26b8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_phtx_e7da26b8 *_wp_args,\n    wp_args_compound_phtx_e7da26b8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_phtx_e7da26b8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 31, "kernel_name": "reduce_jzsd", "python": "@wp.kernel\ndef reduce_jzsd(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jzsd_a7c0cbbf {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jzsd_a7c0cbbf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jzsd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jzsd_a7c0cbbf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_args,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jzsd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jzsd(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jzsd_a7c0cbbf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jzsd_a7c0cbbf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jzsd_a7c0cbbf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_args,\n    wp_args_reduce_jzsd_a7c0cbbf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jzsd_a7c0cbbf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 32, "kernel_name": "elementwise_aske", "python": "@wp.kernel\ndef elementwise_aske(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_aske_3577b8dc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aske_3577b8dc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aske_3577b8dc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aske(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aske_3577b8dc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aske_3577b8dc *_wp_args,\n    wp_args_elementwise_aske_3577b8dc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aske(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aske(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aske_3577b8dc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aske_3577b8dc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aske_3577b8dc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aske_3577b8dc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aske_3577b8dc *_wp_args,\n    wp_args_elementwise_aske_3577b8dc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aske_3577b8dc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 33, "kernel_name": "nested_ofrs", "python": "@wp.kernel\ndef nested_ofrs(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.0:\n        if val > 1.4:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ofrs_97f92dd3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ofrs_97f92dd3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ofrs_97f92dd3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_ofrs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.0:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.4:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_ofrs_97f92dd3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ofrs_97f92dd3 *_wp_args,\n    wp_args_nested_ofrs_97f92dd3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_ofrs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.0:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.4:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.4:                                                                 <L 8>\n    }\n    // adj: if val > 0.0:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ofrs(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ofrs_97f92dd3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ofrs_97f92dd3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ofrs_97f92dd3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ofrs_97f92dd3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ofrs_97f92dd3 *_wp_args,\n    wp_args_nested_ofrs_97f92dd3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ofrs_97f92dd3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 34, "kernel_name": "nested_ntuu", "python": "@wp.kernel\ndef nested_ntuu(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.11:\n        if val > 1.49:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ntuu_62c7bb85 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ntuu_62c7bb85_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ntuu_62c7bb85 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    bool var_5;\n    const wp::float32 var_6 = 1.49;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_ntuu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.11:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.49:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_ntuu_62c7bb85_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ntuu_62c7bb85 *_wp_args,\n    wp_args_nested_ntuu_62c7bb85 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    bool var_5;\n    const wp::float32 var_6 = 1.49;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_ntuu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.11:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.49:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.49:                                                                <L 8>\n    }\n    // adj: if val > 0.11:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ntuu(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ntuu_62c7bb85_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ntuu_62c7bb85 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ntuu_62c7bb85_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ntuu_62c7bb85_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ntuu_62c7bb85 *_wp_args,\n    wp_args_nested_ntuu_62c7bb85 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ntuu_62c7bb85_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 35, "kernel_name": "nested_upei", "python": "@wp.kernel\ndef nested_upei(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.12:\n        if val > 1.29:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_upei_58e7e254 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_upei_58e7e254_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_upei_58e7e254 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.29;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_upei(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.29:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_upei_58e7e254_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_upei_58e7e254 *_wp_args,\n    wp_args_nested_upei_58e7e254 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.29;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_upei(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.29:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.29:                                                                <L 8>\n    }\n    // adj: if val > -0.12:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_upei(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_upei_58e7e254_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_upei_58e7e254 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_upei_58e7e254_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_upei_58e7e254_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_upei_58e7e254 *_wp_args,\n    wp_args_nested_upei_58e7e254 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_upei_58e7e254_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 36, "kernel_name": "reduce_inyz", "python": "@wp.kernel\ndef reduce_inyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_inyz_df16434e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_inyz_df16434e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_inyz_df16434e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_inyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_inyz_df16434e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_inyz_df16434e *_wp_args,\n    wp_args_reduce_inyz_df16434e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_inyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_inyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_inyz_df16434e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_inyz_df16434e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_inyz_df16434e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_inyz_df16434e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_inyz_df16434e *_wp_args,\n    wp_args_reduce_inyz_df16434e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_inyz_df16434e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 37, "kernel_name": "unary_dkln", "python": "@wp.kernel\ndef unary_dkln(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dkln_e7d4fe34 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dkln_e7d4fe34_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dkln_e7d4fe34 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dkln(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dkln_e7d4fe34_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dkln_e7d4fe34 *_wp_args,\n    wp_args_unary_dkln_e7d4fe34 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dkln(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dkln(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dkln_e7d4fe34_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dkln_e7d4fe34 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dkln_e7d4fe34_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dkln_e7d4fe34_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dkln_e7d4fe34 *_wp_args,\n    wp_args_unary_dkln_e7d4fe34 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dkln_e7d4fe34_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 38, "kernel_name": "scalar_arr_cqyq", "python": "@wp.kernel\ndef scalar_arr_cqyq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_cqyq_cd1f10cc {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cqyq_cd1f10cc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cqyq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cqyq_cd1f10cc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_args,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cqyq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cqyq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cqyq_cd1f10cc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cqyq_cd1f10cc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cqyq_cd1f10cc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_args,\n    wp_args_scalar_arr_cqyq_cd1f10cc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cqyq_cd1f10cc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 39, "kernel_name": "branch_glfv", "python": "@wp.kernel\ndef branch_glfv(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.41:\n        b[tid] = val * 1.6\n    else:\n        b[tid] = val + 0.6", "cpp": "struct wp_args_branch_glfv_f672547e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_glfv_f672547e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_glfv_f672547e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.41;\n    const wp::float32 var_5 = -0.41;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.6;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_glfv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.41:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.6                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_glfv_f672547e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_glfv_f672547e *_wp_args,\n    wp_args_branch_glfv_f672547e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.41;\n    const wp::float32 var_5 = -0.41;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.6;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_glfv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.41:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.6                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 0.6                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 1.6                                                            <L 8>\n    }\n    // adj: if val > -0.41:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_glfv(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_glfv_f672547e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_glfv_f672547e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_glfv_f672547e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_glfv_f672547e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_glfv_f672547e *_wp_args,\n    wp_args_branch_glfv_f672547e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_glfv_f672547e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 40, "kernel_name": "scalar_arr_sikp", "python": "@wp.kernel\ndef scalar_arr_sikp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_sikp_d5caf741 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_sikp_d5caf741_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_sikp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_sikp_d5caf741_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_args,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_sikp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_sikp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_sikp_d5caf741_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_sikp_d5caf741_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_sikp_d5caf741_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_args,\n    wp_args_scalar_arr_sikp_d5caf741 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_sikp_d5caf741_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 41, "kernel_name": "vec_witm", "python": "@wp.kernel\ndef vec_witm(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_witm_14605a78 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_witm_14605a78_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_witm_14605a78 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_witm(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_witm_14605a78_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_witm_14605a78 *_wp_args,\n    wp_args_vec_witm_14605a78 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_witm(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_witm(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_witm_14605a78_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_witm_14605a78 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_witm_14605a78_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_witm_14605a78_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_witm_14605a78 *_wp_args,\n    wp_args_vec_witm_14605a78 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_witm_14605a78_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 42, "kernel_name": "reduce_jjgz", "python": "@wp.kernel\ndef reduce_jjgz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jjgz_e58af7ad {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jjgz_e58af7ad_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jjgz_e58af7ad *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jjgz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jjgz_e58af7ad_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jjgz_e58af7ad *_wp_args,\n    wp_args_reduce_jjgz_e58af7ad *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jjgz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jjgz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jjgz_e58af7ad_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jjgz_e58af7ad *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jjgz_e58af7ad_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jjgz_e58af7ad_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jjgz_e58af7ad *_wp_args,\n    wp_args_reduce_jjgz_e58af7ad *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jjgz_e58af7ad_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 43, "kernel_name": "scalar_arr_cilg", "python": "@wp.kernel\ndef scalar_arr_cilg(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_cilg_320464cc {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cilg_320464cc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cilg_320464cc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cilg(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cilg_320464cc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cilg_320464cc *_wp_args,\n    wp_args_scalar_arr_cilg_320464cc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cilg(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cilg(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cilg_320464cc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cilg_320464cc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cilg_320464cc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cilg_320464cc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cilg_320464cc *_wp_args,\n    wp_args_scalar_arr_cilg_320464cc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cilg_320464cc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 44, "kernel_name": "branch_fmrw", "python": "@wp.kernel\ndef branch_fmrw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.98:\n        b[tid] = val * 2.9\n    else:\n        b[tid] = val * 3.0", "cpp": "struct wp_args_branch_fmrw_6966d8e5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fmrw_6966d8e5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fmrw_6966d8e5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.98;\n    const wp::float32 var_5 = -0.98;\n    bool var_6;\n    const wp::float32 var_7 = 2.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fmrw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.98:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 3.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fmrw_6966d8e5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fmrw_6966d8e5 *_wp_args,\n    wp_args_branch_fmrw_6966d8e5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.98;\n    const wp::float32 var_5 = -0.98;\n    bool var_6;\n    const wp::float32 var_7 = 2.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fmrw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.98:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 3.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 3.0                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 2.9                                                            <L 8>\n    }\n    // adj: if val > -0.98:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fmrw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fmrw_6966d8e5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fmrw_6966d8e5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fmrw_6966d8e5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fmrw_6966d8e5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fmrw_6966d8e5 *_wp_args,\n    wp_args_branch_fmrw_6966d8e5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fmrw_6966d8e5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 45, "kernel_name": "loop_hqat", "python": "@wp.kernel\ndef loop_hqat(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hqat_402e2386 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hqat_402e2386_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hqat_402e2386 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hqat(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hqat_402e2386_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hqat_402e2386 *_wp_args,\n    wp_args_loop_hqat_402e2386 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hqat(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hqat(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hqat_402e2386_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hqat_402e2386 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hqat_402e2386_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hqat_402e2386_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hqat_402e2386 *_wp_args,\n    wp_args_loop_hqat_402e2386 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hqat_402e2386_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 46, "kernel_name": "reduce_imoz", "python": "@wp.kernel\ndef reduce_imoz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_imoz_b08097fa {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_imoz_b08097fa_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_imoz_b08097fa *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_imoz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_imoz_b08097fa_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_imoz_b08097fa *_wp_args,\n    wp_args_reduce_imoz_b08097fa *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_imoz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_imoz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_imoz_b08097fa_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_imoz_b08097fa *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_imoz_b08097fa_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_imoz_b08097fa_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_imoz_b08097fa *_wp_args,\n    wp_args_reduce_imoz_b08097fa *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_imoz_b08097fa_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 47, "kernel_name": "multi_mgvu", "python": "@wp.kernel\ndef multi_mgvu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mgvu_9db9d882 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mgvu_9db9d882_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mgvu_9db9d882 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mgvu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mgvu_9db9d882_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mgvu_9db9d882 *_wp_args,\n    wp_args_multi_mgvu_9db9d882 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mgvu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mgvu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mgvu_9db9d882_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mgvu_9db9d882 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mgvu_9db9d882_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mgvu_9db9d882_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mgvu_9db9d882 *_wp_args,\n    wp_args_multi_mgvu_9db9d882 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mgvu_9db9d882_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 48, "kernel_name": "elementwise_qmhm", "python": "@wp.kernel\ndef elementwise_qmhm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_qmhm_4bad2fb9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_qmhm_4bad2fb9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_qmhm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_qmhm_4bad2fb9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_args,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_qmhm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_qmhm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_qmhm_4bad2fb9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_qmhm_4bad2fb9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_qmhm_4bad2fb9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_args,\n    wp_args_elementwise_qmhm_4bad2fb9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_qmhm_4bad2fb9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 49, "kernel_name": "elementwise_aslt", "python": "@wp.kernel\ndef elementwise_aslt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_aslt_448c10b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aslt_448c10b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aslt_448c10b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aslt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aslt_448c10b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aslt_448c10b6 *_wp_args,\n    wp_args_elementwise_aslt_448c10b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aslt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aslt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aslt_448c10b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aslt_448c10b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aslt_448c10b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aslt_448c10b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aslt_448c10b6 *_wp_args,\n    wp_args_elementwise_aslt_448c10b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aslt_448c10b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 50, "kernel_name": "unary_eodw", "python": "@wp.kernel\ndef unary_eodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_eodw_146a1df0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_eodw_146a1df0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eodw_146a1df0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_eodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_eodw_146a1df0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eodw_146a1df0 *_wp_args,\n    wp_args_unary_eodw_146a1df0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_eodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_eodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_eodw_146a1df0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eodw_146a1df0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eodw_146a1df0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_eodw_146a1df0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eodw_146a1df0 *_wp_args,\n    wp_args_unary_eodw_146a1df0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eodw_146a1df0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 51, "kernel_name": "reduce_jztl", "python": "@wp.kernel\ndef reduce_jztl(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jztl_74e9d47d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jztl_74e9d47d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jztl_74e9d47d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jztl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jztl_74e9d47d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jztl_74e9d47d *_wp_args,\n    wp_args_reduce_jztl_74e9d47d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jztl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jztl(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jztl_74e9d47d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jztl_74e9d47d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jztl_74e9d47d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jztl_74e9d47d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jztl_74e9d47d *_wp_args,\n    wp_args_reduce_jztl_74e9d47d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jztl_74e9d47d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 52, "kernel_name": "multi_lmmc", "python": "@wp.kernel\ndef multi_lmmc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lmmc_b7fe2755 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lmmc_b7fe2755_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lmmc_b7fe2755 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lmmc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lmmc_b7fe2755_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lmmc_b7fe2755 *_wp_args,\n    wp_args_multi_lmmc_b7fe2755 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lmmc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lmmc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lmmc_b7fe2755_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lmmc_b7fe2755 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lmmc_b7fe2755_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lmmc_b7fe2755_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lmmc_b7fe2755 *_wp_args,\n    wp_args_multi_lmmc_b7fe2755 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lmmc_b7fe2755_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 53, "kernel_name": "multi_mrtl", "python": "@wp.kernel\ndef multi_mrtl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_mrtl_9870a302 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mrtl_9870a302_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mrtl_9870a302 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mrtl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mrtl_9870a302_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mrtl_9870a302 *_wp_args,\n    wp_args_multi_mrtl_9870a302 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mrtl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mrtl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mrtl_9870a302_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mrtl_9870a302 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mrtl_9870a302_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mrtl_9870a302_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mrtl_9870a302 *_wp_args,\n    wp_args_multi_mrtl_9870a302 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mrtl_9870a302_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 54, "kernel_name": "scalar_arr_sxco", "python": "@wp.kernel\ndef scalar_arr_sxco(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_sxco_2e4af82a {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_sxco_2e4af82a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_sxco(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_sxco_2e4af82a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_args,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_sxco(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_sxco(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_sxco_2e4af82a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_sxco_2e4af82a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_sxco_2e4af82a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_args,\n    wp_args_scalar_arr_sxco_2e4af82a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_sxco_2e4af82a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 55, "kernel_name": "compound_ppyx", "python": "@wp.kernel\ndef compound_ppyx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ppyx_68078713 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ppyx_68078713_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ppyx_68078713 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ppyx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ppyx_68078713_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ppyx_68078713 *_wp_args,\n    wp_args_compound_ppyx_68078713 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ppyx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ppyx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ppyx_68078713_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ppyx_68078713 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ppyx_68078713_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ppyx_68078713_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ppyx_68078713 *_wp_args,\n    wp_args_compound_ppyx_68078713 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ppyx_68078713_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 56, "kernel_name": "elementwise_yyor", "python": "@wp.kernel\ndef elementwise_yyor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_yyor_6f1b19d6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_yyor_6f1b19d6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_yyor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_yyor_6f1b19d6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_args,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_yyor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_yyor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_yyor_6f1b19d6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yyor_6f1b19d6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_yyor_6f1b19d6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_args,\n    wp_args_elementwise_yyor_6f1b19d6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yyor_6f1b19d6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 57, "kernel_name": "scalar_arr_bizt", "python": "@wp.kernel\ndef scalar_arr_bizt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_bizt_b420d528 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bizt_b420d528_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bizt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bizt_b420d528_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_args,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bizt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bizt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bizt_b420d528_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bizt_b420d528_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bizt_b420d528_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_args,\n    wp_args_scalar_arr_bizt_b420d528 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bizt_b420d528_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 58, "kernel_name": "branch_fjst", "python": "@wp.kernel\ndef branch_fjst(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.85:\n        b[tid] = val + 1.0\n    else:\n        b[tid] = val + 1.2", "cpp": "struct wp_args_branch_fjst_459c1397 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fjst_459c1397_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fjst_459c1397 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.85;\n    const wp::float32 var_5 = -0.85;\n    bool var_6;\n    const wp::float32 var_7 = 1.0;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.2;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fjst(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.85:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.0                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fjst_459c1397_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fjst_459c1397 *_wp_args,\n    wp_args_branch_fjst_459c1397 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.85;\n    const wp::float32 var_5 = -0.85;\n    bool var_6;\n    const wp::float32 var_7 = 1.0;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.2;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fjst(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.85:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.0                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 1.2                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 1.0                                                            <L 8>\n    }\n    // adj: if val > -0.85:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fjst(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fjst_459c1397_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fjst_459c1397 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fjst_459c1397_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fjst_459c1397_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fjst_459c1397 *_wp_args,\n    wp_args_branch_fjst_459c1397 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fjst_459c1397_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 59, "kernel_name": "loop_hhlh", "python": "@wp.kernel\ndef loop_hhlh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hhlh_40e0747a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hhlh_40e0747a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hhlh_40e0747a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hhlh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hhlh_40e0747a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hhlh_40e0747a *_wp_args,\n    wp_args_loop_hhlh_40e0747a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hhlh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hhlh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hhlh_40e0747a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hhlh_40e0747a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hhlh_40e0747a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hhlh_40e0747a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hhlh_40e0747a *_wp_args,\n    wp_args_loop_hhlh_40e0747a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hhlh_40e0747a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 60, "kernel_name": "multi_mnam", "python": "@wp.kernel\ndef multi_mnam(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mnam_c65b0dbc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mnam_c65b0dbc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mnam_c65b0dbc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mnam(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mnam_c65b0dbc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mnam_c65b0dbc *_wp_args,\n    wp_args_multi_mnam_c65b0dbc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mnam(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mnam(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mnam_c65b0dbc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mnam_c65b0dbc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mnam_c65b0dbc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mnam_c65b0dbc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mnam_c65b0dbc *_wp_args,\n    wp_args_multi_mnam_c65b0dbc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mnam_c65b0dbc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 61, "kernel_name": "vec_qlzy", "python": "@wp.kernel\ndef vec_qlzy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_qlzy_783fde0f {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_qlzy_783fde0f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qlzy_783fde0f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_qlzy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_qlzy_783fde0f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qlzy_783fde0f *_wp_args,\n    wp_args_vec_qlzy_783fde0f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_qlzy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_qlzy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_qlzy_783fde0f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qlzy_783fde0f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qlzy_783fde0f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_qlzy_783fde0f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qlzy_783fde0f *_wp_args,\n    wp_args_vec_qlzy_783fde0f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qlzy_783fde0f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 62, "kernel_name": "vec_lqke", "python": "@wp.kernel\ndef vec_lqke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_lqke_3c1be9a3 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_lqke_3c1be9a3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lqke_3c1be9a3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_lqke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_lqke_3c1be9a3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lqke_3c1be9a3 *_wp_args,\n    wp_args_vec_lqke_3c1be9a3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_lqke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lqke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lqke_3c1be9a3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lqke_3c1be9a3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lqke_3c1be9a3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lqke_3c1be9a3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lqke_3c1be9a3 *_wp_args,\n    wp_args_vec_lqke_3c1be9a3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lqke_3c1be9a3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 63, "kernel_name": "branch_fwzf", "python": "@wp.kernel\ndef branch_fwzf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.91:\n        b[tid] = val - 1.4\n    else:\n        b[tid] = val - 1.8", "cpp": "struct wp_args_branch_fwzf_7a68bfb3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fwzf_7a68bfb3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.91;\n    const wp::float32 var_5 = -0.91;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.8;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fwzf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.91:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fwzf_7a68bfb3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_args,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.91;\n    const wp::float32 var_5 = -0.91;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.8;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fwzf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.91:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 1.8                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.4                                                            <L 8>\n    }\n    // adj: if val > -0.91:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fwzf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fwzf_7a68bfb3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fwzf_7a68bfb3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fwzf_7a68bfb3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_args,\n    wp_args_branch_fwzf_7a68bfb3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fwzf_7a68bfb3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 64, "kernel_name": "compound_yyho", "python": "@wp.kernel\ndef compound_yyho(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_yyho_c5c6d93c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_yyho_c5c6d93c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yyho_c5c6d93c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_yyho(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_yyho_c5c6d93c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yyho_c5c6d93c *_wp_args,\n    wp_args_compound_yyho_c5c6d93c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_yyho(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_yyho(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_yyho_c5c6d93c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yyho_c5c6d93c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yyho_c5c6d93c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_yyho_c5c6d93c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yyho_c5c6d93c *_wp_args,\n    wp_args_compound_yyho_c5c6d93c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yyho_c5c6d93c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 65, "kernel_name": "compound_wfvb", "python": "@wp.kernel\ndef compound_wfvb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_wfvb_6fc86a41 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_wfvb_6fc86a41_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wfvb_6fc86a41 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_wfvb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_wfvb_6fc86a41_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wfvb_6fc86a41 *_wp_args,\n    wp_args_compound_wfvb_6fc86a41 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_wfvb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_wfvb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_wfvb_6fc86a41_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wfvb_6fc86a41 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wfvb_6fc86a41_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_wfvb_6fc86a41_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wfvb_6fc86a41 *_wp_args,\n    wp_args_compound_wfvb_6fc86a41 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wfvb_6fc86a41_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 66, "kernel_name": "reduce_jcjb", "python": "@wp.kernel\ndef reduce_jcjb(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jcjb_8269059e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jcjb_8269059e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jcjb_8269059e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jcjb(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jcjb_8269059e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jcjb_8269059e *_wp_args,\n    wp_args_reduce_jcjb_8269059e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jcjb(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jcjb(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jcjb_8269059e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jcjb_8269059e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jcjb_8269059e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jcjb_8269059e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jcjb_8269059e *_wp_args,\n    wp_args_reduce_jcjb_8269059e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jcjb_8269059e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 67, "kernel_name": "reduce_jjiw", "python": "@wp.kernel\ndef reduce_jjiw(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jjiw_d549d1b4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jjiw_d549d1b4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jjiw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jjiw_d549d1b4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_args,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jjiw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jjiw(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jjiw_d549d1b4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jjiw_d549d1b4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jjiw_d549d1b4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_args,\n    wp_args_reduce_jjiw_d549d1b4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jjiw_d549d1b4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 68, "kernel_name": "elementwise_acph", "python": "@wp.kernel\ndef elementwise_acph(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_acph_84b31dc4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_acph_84b31dc4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_acph_84b31dc4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_acph(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_acph_84b31dc4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_acph_84b31dc4 *_wp_args,\n    wp_args_elementwise_acph_84b31dc4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_acph(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_acph(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_acph_84b31dc4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_acph_84b31dc4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_acph_84b31dc4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_acph_84b31dc4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_acph_84b31dc4 *_wp_args,\n    wp_args_elementwise_acph_84b31dc4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_acph_84b31dc4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 69, "kernel_name": "reduce_ipjc", "python": "@wp.kernel\ndef reduce_ipjc(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ipjc_ad3d2075 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ipjc_ad3d2075_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ipjc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ipjc_ad3d2075_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_args,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ipjc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ipjc(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ipjc_ad3d2075_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ipjc_ad3d2075_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ipjc_ad3d2075_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_args,\n    wp_args_reduce_ipjc_ad3d2075 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ipjc_ad3d2075_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 70, "kernel_name": "loop_xygo", "python": "@wp.kernel\ndef loop_xygo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_xygo_a89d702a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_xygo_a89d702a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_xygo_a89d702a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_xygo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_xygo_a89d702a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_xygo_a89d702a *_wp_args,\n    wp_args_loop_xygo_a89d702a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_xygo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_xygo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_xygo_a89d702a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_xygo_a89d702a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_xygo_a89d702a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_xygo_a89d702a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_xygo_a89d702a *_wp_args,\n    wp_args_loop_xygo_a89d702a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_xygo_a89d702a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 71, "kernel_name": "branch_fxlp", "python": "@wp.kernel\ndef branch_fxlp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.96:\n        b[tid] = val - 2.7\n    else:\n        b[tid] = val + 1.5", "cpp": "struct wp_args_branch_fxlp_58c38b92 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fxlp_58c38b92_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fxlp_58c38b92 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 2.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.5;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fxlp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fxlp_58c38b92_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fxlp_58c38b92 *_wp_args,\n    wp_args_branch_fxlp_58c38b92 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 2.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.5;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fxlp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 1.5                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 2.7                                                            <L 8>\n    }\n    // adj: if val > -0.96:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fxlp(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fxlp_58c38b92_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fxlp_58c38b92 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fxlp_58c38b92_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fxlp_58c38b92_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fxlp_58c38b92 *_wp_args,\n    wp_args_branch_fxlp_58c38b92 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fxlp_58c38b92_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 72, "kernel_name": "elementwise_wlse", "python": "@wp.kernel\ndef elementwise_wlse(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_wlse_0e44c7db {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_wlse_0e44c7db_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wlse_0e44c7db *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_wlse(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_wlse_0e44c7db_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wlse_0e44c7db *_wp_args,\n    wp_args_elementwise_wlse_0e44c7db *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_wlse(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_wlse(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_wlse_0e44c7db_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wlse_0e44c7db *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wlse_0e44c7db_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_wlse_0e44c7db_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wlse_0e44c7db *_wp_args,\n    wp_args_elementwise_wlse_0e44c7db *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wlse_0e44c7db_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 73, "kernel_name": "scalar_arr_yryv", "python": "@wp.kernel\ndef scalar_arr_yryv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_yryv_828839b2 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_yryv_828839b2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_yryv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_yryv_828839b2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_args,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_yryv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_yryv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_yryv_828839b2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_yryv_828839b2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_yryv_828839b2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_args,\n    wp_args_scalar_arr_yryv_828839b2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_yryv_828839b2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 74, "kernel_name": "elementwise_afun", "python": "@wp.kernel\ndef elementwise_afun(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_afun_d5fbe047 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_afun_d5fbe047_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_afun_d5fbe047 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_afun(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_afun_d5fbe047_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_afun_d5fbe047 *_wp_args,\n    wp_args_elementwise_afun_d5fbe047 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_afun(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_afun(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_afun_d5fbe047_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_afun_d5fbe047 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_afun_d5fbe047_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_afun_d5fbe047_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_afun_d5fbe047 *_wp_args,\n    wp_args_elementwise_afun_d5fbe047 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_afun_d5fbe047_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 75, "kernel_name": "compound_pmcz", "python": "@wp.kernel\ndef compound_pmcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pmcz_33b899b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pmcz_33b899b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pmcz_33b899b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pmcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pmcz_33b899b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pmcz_33b899b6 *_wp_args,\n    wp_args_compound_pmcz_33b899b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pmcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pmcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pmcz_33b899b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pmcz_33b899b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pmcz_33b899b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pmcz_33b899b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pmcz_33b899b6 *_wp_args,\n    wp_args_compound_pmcz_33b899b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pmcz_33b899b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 76, "kernel_name": "compound_upvo", "python": "@wp.kernel\ndef compound_upvo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_upvo_4b658968 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_upvo_4b658968_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_upvo_4b658968 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_upvo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_upvo_4b658968_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_upvo_4b658968 *_wp_args,\n    wp_args_compound_upvo_4b658968 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_upvo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_upvo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_upvo_4b658968_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_upvo_4b658968 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_upvo_4b658968_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_upvo_4b658968_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_upvo_4b658968 *_wp_args,\n    wp_args_compound_upvo_4b658968 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_upvo_4b658968_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 77, "kernel_name": "scalar_arr_czty", "python": "@wp.kernel\ndef scalar_arr_czty(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_czty_f03c2bc6 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_czty_f03c2bc6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_czty(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_czty_f03c2bc6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_args,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_czty(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_czty(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_czty_f03c2bc6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czty_f03c2bc6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_czty_f03c2bc6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_args,\n    wp_args_scalar_arr_czty_f03c2bc6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czty_f03c2bc6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 78, "kernel_name": "vec_zrrt", "python": "@wp.kernel\ndef vec_zrrt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_zrrt_31149028 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_zrrt_31149028_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zrrt_31149028 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_zrrt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_zrrt_31149028_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zrrt_31149028 *_wp_args,\n    wp_args_vec_zrrt_31149028 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_zrrt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_zrrt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_zrrt_31149028_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zrrt_31149028 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zrrt_31149028_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_zrrt_31149028_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zrrt_31149028 *_wp_args,\n    wp_args_vec_zrrt_31149028 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zrrt_31149028_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 79, "kernel_name": "reduce_iius", "python": "@wp.kernel\ndef reduce_iius(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iius_1ebb7602 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iius_1ebb7602_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iius_1ebb7602 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iius(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iius_1ebb7602_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iius_1ebb7602 *_wp_args,\n    wp_args_reduce_iius_1ebb7602 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iius(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iius(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iius_1ebb7602_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iius_1ebb7602 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iius_1ebb7602_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iius_1ebb7602_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iius_1ebb7602 *_wp_args,\n    wp_args_reduce_iius_1ebb7602 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iius_1ebb7602_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 80, "kernel_name": "elementwise_wmek", "python": "@wp.kernel\ndef elementwise_wmek(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_wmek_764efb44 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_wmek_764efb44_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wmek_764efb44 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_wmek(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_wmek_764efb44_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wmek_764efb44 *_wp_args,\n    wp_args_elementwise_wmek_764efb44 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_wmek(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_wmek(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_wmek_764efb44_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wmek_764efb44 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wmek_764efb44_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_wmek_764efb44_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wmek_764efb44 *_wp_args,\n    wp_args_elementwise_wmek_764efb44 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wmek_764efb44_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 81, "kernel_name": "branch_frky", "python": "@wp.kernel\ndef branch_frky(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.12:\n        b[tid] = val - 1.2\n    else:\n        b[tid] = val - 2.8", "cpp": "struct wp_args_branch_frky_1f4fbc12 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_frky_1f4fbc12_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frky_1f4fbc12 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.8;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_frky(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.2                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_frky_1f4fbc12_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frky_1f4fbc12 *_wp_args,\n    wp_args_branch_frky_1f4fbc12 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.8;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_frky(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.2                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.8                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.2                                                            <L 8>\n    }\n    // adj: if val > -0.12:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_frky(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_frky_1f4fbc12_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frky_1f4fbc12 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frky_1f4fbc12_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_frky_1f4fbc12_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frky_1f4fbc12 *_wp_args,\n    wp_args_branch_frky_1f4fbc12 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frky_1f4fbc12_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 82, "kernel_name": "scalar_arr_cgkh", "python": "@wp.kernel\ndef scalar_arr_cgkh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_cgkh_4feaafef {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cgkh_4feaafef_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cgkh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cgkh_4feaafef_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_args,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cgkh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cgkh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cgkh_4feaafef_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cgkh_4feaafef_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cgkh_4feaafef_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_args,\n    wp_args_scalar_arr_cgkh_4feaafef *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cgkh_4feaafef_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 83, "kernel_name": "vec_ldtj", "python": "@wp.kernel\ndef vec_ldtj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_ldtj_27598463 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_ldtj_27598463_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ldtj_27598463 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_ldtj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_ldtj_27598463_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ldtj_27598463 *_wp_args,\n    wp_args_vec_ldtj_27598463 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_ldtj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ldtj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ldtj_27598463_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ldtj_27598463 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ldtj_27598463_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ldtj_27598463_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ldtj_27598463 *_wp_args,\n    wp_args_vec_ldtj_27598463 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ldtj_27598463_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 84, "kernel_name": "compound_pjjs", "python": "@wp.kernel\ndef compound_pjjs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pjjs_d4454b26 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pjjs_d4454b26_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pjjs_d4454b26 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pjjs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pjjs_d4454b26_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pjjs_d4454b26 *_wp_args,\n    wp_args_compound_pjjs_d4454b26 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pjjs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pjjs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pjjs_d4454b26_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pjjs_d4454b26 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pjjs_d4454b26_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pjjs_d4454b26_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pjjs_d4454b26 *_wp_args,\n    wp_args_compound_pjjs_d4454b26 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pjjs_d4454b26_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 85, "kernel_name": "nested_oqqf", "python": "@wp.kernel\ndef nested_oqqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.25:\n        if val > 0.68:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_oqqf_42ac2bd4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_oqqf_42ac2bd4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 0.68;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_oqqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.68:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_oqqf_42ac2bd4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_args,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 0.68;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_oqqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.68:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.68:                                                                <L 8>\n    }\n    // adj: if val > -0.25:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_oqqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_oqqf_42ac2bd4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oqqf_42ac2bd4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_oqqf_42ac2bd4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_args,\n    wp_args_nested_oqqf_42ac2bd4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oqqf_42ac2bd4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 86, "kernel_name": "elementwise_bufv", "python": "@wp.kernel\ndef elementwise_bufv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bufv_318194fc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bufv_318194fc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bufv_318194fc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bufv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bufv_318194fc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bufv_318194fc *_wp_args,\n    wp_args_elementwise_bufv_318194fc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bufv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bufv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bufv_318194fc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bufv_318194fc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bufv_318194fc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bufv_318194fc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bufv_318194fc *_wp_args,\n    wp_args_elementwise_bufv_318194fc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bufv_318194fc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 87, "kernel_name": "compound_spdb", "python": "@wp.kernel\ndef compound_spdb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_spdb_17172048 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_spdb_17172048_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_spdb_17172048 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_spdb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_spdb_17172048_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_spdb_17172048 *_wp_args,\n    wp_args_compound_spdb_17172048 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_spdb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_spdb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_spdb_17172048_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_spdb_17172048 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_spdb_17172048_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_spdb_17172048_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_spdb_17172048 *_wp_args,\n    wp_args_compound_spdb_17172048 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_spdb_17172048_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 88, "kernel_name": "scalar_arr_bgwl", "python": "@wp.kernel\ndef scalar_arr_bgwl(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_bgwl_2c4fb6ca {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bgwl_2c4fb6ca_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bgwl(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bgwl_2c4fb6ca_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_args,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bgwl(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bgwl(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bgwl_2c4fb6ca_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bgwl_2c4fb6ca_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bgwl_2c4fb6ca_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_args,\n    wp_args_scalar_arr_bgwl_2c4fb6ca *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bgwl_2c4fb6ca_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 89, "kernel_name": "scalar_arr_uchk", "python": "@wp.kernel\ndef scalar_arr_uchk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_uchk_8e77f664 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_uchk_8e77f664_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_uchk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_uchk_8e77f664_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_args,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_uchk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_uchk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_uchk_8e77f664_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_uchk_8e77f664_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_uchk_8e77f664_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_args,\n    wp_args_scalar_arr_uchk_8e77f664 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_uchk_8e77f664_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 90, "kernel_name": "scalar_arr_wqbv", "python": "@wp.kernel\ndef scalar_arr_wqbv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_wqbv_e4936e48 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_wqbv_e4936e48_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_wqbv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_wqbv_e4936e48_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_args,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_wqbv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_wqbv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_wqbv_e4936e48_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wqbv_e4936e48_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_wqbv_e4936e48_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_args,\n    wp_args_scalar_arr_wqbv_e4936e48 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wqbv_e4936e48_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 91, "kernel_name": "loop_yluk", "python": "@wp.kernel\ndef loop_yluk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_yluk_d45a05f0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_yluk_d45a05f0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yluk_d45a05f0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_yluk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_yluk_d45a05f0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yluk_d45a05f0 *_wp_args,\n    wp_args_loop_yluk_d45a05f0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_yluk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_yluk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_yluk_d45a05f0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yluk_d45a05f0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yluk_d45a05f0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_yluk_d45a05f0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yluk_d45a05f0 *_wp_args,\n    wp_args_loop_yluk_d45a05f0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yluk_d45a05f0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 92, "kernel_name": "vec_kzaa", "python": "@wp.kernel\ndef vec_kzaa(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kzaa_1ca25b62 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kzaa_1ca25b62_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzaa_1ca25b62 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kzaa(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kzaa_1ca25b62_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzaa_1ca25b62 *_wp_args,\n    wp_args_vec_kzaa_1ca25b62 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kzaa(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kzaa(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kzaa_1ca25b62_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzaa_1ca25b62 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzaa_1ca25b62_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kzaa_1ca25b62_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzaa_1ca25b62 *_wp_args,\n    wp_args_vec_kzaa_1ca25b62 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzaa_1ca25b62_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 93, "kernel_name": "elementwise_brmo", "python": "@wp.kernel\ndef elementwise_brmo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_brmo_22d831e7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_brmo_22d831e7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_brmo_22d831e7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_brmo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_brmo_22d831e7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_brmo_22d831e7 *_wp_args,\n    wp_args_elementwise_brmo_22d831e7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_brmo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_brmo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_brmo_22d831e7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_brmo_22d831e7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_brmo_22d831e7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_brmo_22d831e7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_brmo_22d831e7 *_wp_args,\n    wp_args_elementwise_brmo_22d831e7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_brmo_22d831e7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 94, "kernel_name": "reduce_xjqf", "python": "@wp.kernel\ndef reduce_xjqf(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xjqf_2aba188b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xjqf_2aba188b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xjqf_2aba188b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xjqf(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xjqf_2aba188b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xjqf_2aba188b *_wp_args,\n    wp_args_reduce_xjqf_2aba188b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xjqf(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xjqf(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xjqf_2aba188b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xjqf_2aba188b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xjqf_2aba188b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xjqf_2aba188b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xjqf_2aba188b *_wp_args,\n    wp_args_reduce_xjqf_2aba188b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xjqf_2aba188b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 95, "kernel_name": "scalar_arr_bmie", "python": "@wp.kernel\ndef scalar_arr_bmie(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_bmie_2a93ef97 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bmie_2a93ef97_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bmie(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bmie_2a93ef97_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_args,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bmie(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bmie(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bmie_2a93ef97_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bmie_2a93ef97_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bmie_2a93ef97_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_args,\n    wp_args_scalar_arr_bmie_2a93ef97 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bmie_2a93ef97_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 96, "kernel_name": "reduce_isnm", "python": "@wp.kernel\ndef reduce_isnm(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_isnm_b6dd539f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_isnm_b6dd539f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_isnm_b6dd539f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_isnm(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_isnm_b6dd539f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_isnm_b6dd539f *_wp_args,\n    wp_args_reduce_isnm_b6dd539f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_isnm(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_isnm(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_isnm_b6dd539f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_isnm_b6dd539f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_isnm_b6dd539f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_isnm_b6dd539f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_isnm_b6dd539f *_wp_args,\n    wp_args_reduce_isnm_b6dd539f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_isnm_b6dd539f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 97, "kernel_name": "elementwise_amgf", "python": "@wp.kernel\ndef elementwise_amgf(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_amgf_501eb00b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_amgf_501eb00b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_amgf_501eb00b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_amgf(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_amgf_501eb00b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_amgf_501eb00b *_wp_args,\n    wp_args_elementwise_amgf_501eb00b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_amgf(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_amgf(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_amgf_501eb00b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_amgf_501eb00b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_amgf_501eb00b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_amgf_501eb00b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_amgf_501eb00b *_wp_args,\n    wp_args_elementwise_amgf_501eb00b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_amgf_501eb00b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 98, "kernel_name": "vec_tafs", "python": "@wp.kernel\ndef vec_tafs(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_tafs_15265c08 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_tafs_15265c08_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_tafs_15265c08 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_tafs(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_tafs_15265c08_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_tafs_15265c08 *_wp_args,\n    wp_args_vec_tafs_15265c08 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_tafs(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_tafs(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_tafs_15265c08_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_tafs_15265c08 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_tafs_15265c08_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_tafs_15265c08_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_tafs_15265c08 *_wp_args,\n    wp_args_vec_tafs_15265c08 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_tafs_15265c08_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 99, "kernel_name": "loop_ikeb", "python": "@wp.kernel\ndef loop_ikeb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_ikeb_42f62261 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_ikeb_42f62261_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ikeb_42f62261 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_ikeb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_ikeb_42f62261_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ikeb_42f62261 *_wp_args,\n    wp_args_loop_ikeb_42f62261 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_ikeb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_ikeb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_ikeb_42f62261_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ikeb_42f62261 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ikeb_42f62261_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_ikeb_42f62261_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ikeb_42f62261 *_wp_args,\n    wp_args_loop_ikeb_42f62261 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ikeb_42f62261_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 100, "kernel_name": "loop_xzdy", "python": "@wp.kernel\ndef loop_xzdy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_xzdy_f97b2432 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_xzdy_f97b2432_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_xzdy_f97b2432 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_xzdy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_xzdy_f97b2432_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_xzdy_f97b2432 *_wp_args,\n    wp_args_loop_xzdy_f97b2432 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_xzdy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_xzdy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_xzdy_f97b2432_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_xzdy_f97b2432 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_xzdy_f97b2432_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_xzdy_f97b2432_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_xzdy_f97b2432 *_wp_args,\n    wp_args_loop_xzdy_f97b2432 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_xzdy_f97b2432_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 101, "kernel_name": "branch_tgzh", "python": "@wp.kernel\ndef branch_tgzh(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.4:\n        b[tid] = val - 0.9\n    else:\n        b[tid] = val - 2.0", "cpp": "struct wp_args_branch_tgzh_e8033553 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_tgzh_e8033553_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_tgzh_e8033553 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    const wp::float32 var_5 = -0.4;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.0;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_tgzh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.4:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.9                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.0                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_tgzh_e8033553_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_tgzh_e8033553 *_wp_args,\n    wp_args_branch_tgzh_e8033553 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    const wp::float32 var_5 = -0.4;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.0;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_tgzh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.4:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.9                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.0                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.0                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 0.9                                                            <L 8>\n    }\n    // adj: if val > -0.4:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_tgzh(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_tgzh_e8033553_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_tgzh_e8033553 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_tgzh_e8033553_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_tgzh_e8033553_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_tgzh_e8033553 *_wp_args,\n    wp_args_branch_tgzh_e8033553 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_tgzh_e8033553_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 102, "kernel_name": "branch_rypw", "python": "@wp.kernel\ndef branch_rypw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.93:\n        b[tid] = val * 3.0\n    else:\n        b[tid] = val + 1.3", "cpp": "struct wp_args_branch_rypw_47bd269c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_rypw_47bd269c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_rypw_47bd269c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.93;\n    bool var_5;\n    const wp::float32 var_6 = 3.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.3;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_rypw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.93:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 3.0                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.3                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_rypw_47bd269c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_rypw_47bd269c *_wp_args,\n    wp_args_branch_rypw_47bd269c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.93;\n    bool var_5;\n    const wp::float32 var_6 = 3.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.3;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_rypw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.93:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 3.0                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.3                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 1.3                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 3.0                                                            <L 8>\n    }\n    // adj: if val > 0.93:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_rypw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_rypw_47bd269c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_rypw_47bd269c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_rypw_47bd269c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_rypw_47bd269c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_rypw_47bd269c *_wp_args,\n    wp_args_branch_rypw_47bd269c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_rypw_47bd269c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 103, "kernel_name": "reduce_ioce", "python": "@wp.kernel\ndef reduce_ioce(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ioce_39b854b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ioce_39b854b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ioce_39b854b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ioce(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ioce_39b854b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ioce_39b854b6 *_wp_args,\n    wp_args_reduce_ioce_39b854b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ioce(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ioce(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ioce_39b854b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ioce_39b854b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ioce_39b854b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ioce_39b854b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ioce_39b854b6 *_wp_args,\n    wp_args_reduce_ioce_39b854b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ioce_39b854b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 104, "kernel_name": "multi_qliv", "python": "@wp.kernel\ndef multi_qliv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_qliv_82fd99ea {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_qliv_82fd99ea_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_qliv_82fd99ea *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_qliv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_qliv_82fd99ea_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_qliv_82fd99ea *_wp_args,\n    wp_args_multi_qliv_82fd99ea *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_qliv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_qliv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_qliv_82fd99ea_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_qliv_82fd99ea *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_qliv_82fd99ea_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_qliv_82fd99ea_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_qliv_82fd99ea *_wp_args,\n    wp_args_multi_qliv_82fd99ea *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_qliv_82fd99ea_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 105, "kernel_name": "scalar_arr_bnoj", "python": "@wp.kernel\ndef scalar_arr_bnoj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_bnoj_08b8618e {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bnoj_08b8618e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bnoj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bnoj_08b8618e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_args,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bnoj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bnoj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bnoj_08b8618e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bnoj_08b8618e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bnoj_08b8618e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_args,\n    wp_args_scalar_arr_bnoj_08b8618e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bnoj_08b8618e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 106, "kernel_name": "unary_dxkp", "python": "@wp.kernel\ndef unary_dxkp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_dxkp_605ec52b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dxkp_605ec52b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dxkp_605ec52b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dxkp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dxkp_605ec52b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dxkp_605ec52b *_wp_args,\n    wp_args_unary_dxkp_605ec52b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dxkp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dxkp(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dxkp_605ec52b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dxkp_605ec52b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dxkp_605ec52b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dxkp_605ec52b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dxkp_605ec52b *_wp_args,\n    wp_args_unary_dxkp_605ec52b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dxkp_605ec52b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 107, "kernel_name": "elementwise_akjn", "python": "@wp.kernel\ndef elementwise_akjn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_akjn_e17ff0de {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_akjn_e17ff0de_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_akjn_e17ff0de *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_akjn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_akjn_e17ff0de_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_akjn_e17ff0de *_wp_args,\n    wp_args_elementwise_akjn_e17ff0de *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_akjn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_akjn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_akjn_e17ff0de_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_akjn_e17ff0de *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_akjn_e17ff0de_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_akjn_e17ff0de_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_akjn_e17ff0de *_wp_args,\n    wp_args_elementwise_akjn_e17ff0de *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_akjn_e17ff0de_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 108, "kernel_name": "compound_qkgm", "python": "@wp.kernel\ndef compound_qkgm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qkgm_01d9a236 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qkgm_01d9a236_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qkgm_01d9a236 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qkgm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qkgm_01d9a236_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qkgm_01d9a236 *_wp_args,\n    wp_args_compound_qkgm_01d9a236 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qkgm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qkgm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qkgm_01d9a236_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qkgm_01d9a236 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qkgm_01d9a236_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qkgm_01d9a236_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qkgm_01d9a236 *_wp_args,\n    wp_args_compound_qkgm_01d9a236 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qkgm_01d9a236_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 109, "kernel_name": "compound_qwmd", "python": "@wp.kernel\ndef compound_qwmd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qwmd_8bfb0b00 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qwmd_8bfb0b00_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qwmd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qwmd_8bfb0b00_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_args,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qwmd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qwmd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qwmd_8bfb0b00_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qwmd_8bfb0b00_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qwmd_8bfb0b00_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_args,\n    wp_args_compound_qwmd_8bfb0b00 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qwmd_8bfb0b00_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 110, "kernel_name": "vec_klmy", "python": "@wp.kernel\ndef vec_klmy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_klmy_309fb0d9 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_klmy_309fb0d9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_klmy_309fb0d9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_klmy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_klmy_309fb0d9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_klmy_309fb0d9 *_wp_args,\n    wp_args_vec_klmy_309fb0d9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_klmy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_klmy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_klmy_309fb0d9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_klmy_309fb0d9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_klmy_309fb0d9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_klmy_309fb0d9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_klmy_309fb0d9 *_wp_args,\n    wp_args_vec_klmy_309fb0d9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_klmy_309fb0d9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 111, "kernel_name": "branch_yhry", "python": "@wp.kernel\ndef branch_yhry(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.05:\n        b[tid] = val + 1.0\n    else:\n        b[tid] = val * 2.6", "cpp": "struct wp_args_branch_yhry_bf35ff6b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_yhry_bf35ff6b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_yhry_bf35ff6b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.05;\n    bool var_5;\n    const wp::float32 var_6 = 1.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.6;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_yhry(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.05:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 1.0                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_yhry_bf35ff6b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_yhry_bf35ff6b *_wp_args,\n    wp_args_branch_yhry_bf35ff6b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.05;\n    bool var_5;\n    const wp::float32 var_6 = 1.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.6;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_yhry(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.05:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 1.0                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 2.6                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 1.0                                                            <L 8>\n    }\n    // adj: if val > 0.05:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_yhry(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_yhry_bf35ff6b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_yhry_bf35ff6b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_yhry_bf35ff6b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_yhry_bf35ff6b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_yhry_bf35ff6b *_wp_args,\n    wp_args_branch_yhry_bf35ff6b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_yhry_bf35ff6b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 112, "kernel_name": "scalar_arr_cjbz", "python": "@wp.kernel\ndef scalar_arr_cjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_cjbz_0a00089b {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cjbz_0a00089b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cjbz_0a00089b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_args,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cjbz_0a00089b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cjbz_0a00089b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cjbz_0a00089b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_args,\n    wp_args_scalar_arr_cjbz_0a00089b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cjbz_0a00089b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 113, "kernel_name": "loop_rsvh", "python": "@wp.kernel\ndef loop_rsvh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_rsvh_6e040cc0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_rsvh_6e040cc0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_rsvh_6e040cc0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_rsvh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_rsvh_6e040cc0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_rsvh_6e040cc0 *_wp_args,\n    wp_args_loop_rsvh_6e040cc0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_rsvh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_rsvh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_rsvh_6e040cc0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_rsvh_6e040cc0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_rsvh_6e040cc0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_rsvh_6e040cc0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_rsvh_6e040cc0 *_wp_args,\n    wp_args_loop_rsvh_6e040cc0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_rsvh_6e040cc0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 114, "kernel_name": "elementwise_agmv", "python": "@wp.kernel\ndef elementwise_agmv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_agmv_8b960a58 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_agmv_8b960a58_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agmv_8b960a58 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_agmv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_agmv_8b960a58_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agmv_8b960a58 *_wp_args,\n    wp_args_elementwise_agmv_8b960a58 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_agmv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_agmv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_agmv_8b960a58_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agmv_8b960a58 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agmv_8b960a58_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_agmv_8b960a58_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agmv_8b960a58 *_wp_args,\n    wp_args_elementwise_agmv_8b960a58 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agmv_8b960a58_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 115, "kernel_name": "compound_pund", "python": "@wp.kernel\ndef compound_pund(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pund_a0668c4e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pund_a0668c4e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pund_a0668c4e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pund(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pund_a0668c4e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pund_a0668c4e *_wp_args,\n    wp_args_compound_pund_a0668c4e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pund(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pund(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pund_a0668c4e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pund_a0668c4e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pund_a0668c4e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pund_a0668c4e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pund_a0668c4e *_wp_args,\n    wp_args_compound_pund_a0668c4e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pund_a0668c4e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 116, "kernel_name": "elementwise_vgkq", "python": "@wp.kernel\ndef elementwise_vgkq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_vgkq_059e70c4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_vgkq_059e70c4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_vgkq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_vgkq_059e70c4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_args,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_vgkq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_vgkq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_vgkq_059e70c4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_vgkq_059e70c4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_vgkq_059e70c4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_args,\n    wp_args_elementwise_vgkq_059e70c4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_vgkq_059e70c4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 117, "kernel_name": "vec_kjhe", "python": "@wp.kernel\ndef vec_kjhe(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kjhe_ee9b5ae0 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kjhe_ee9b5ae0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kjhe(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kjhe_ee9b5ae0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_args,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kjhe(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kjhe(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kjhe_ee9b5ae0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjhe_ee9b5ae0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kjhe_ee9b5ae0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_args,\n    wp_args_vec_kjhe_ee9b5ae0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjhe_ee9b5ae0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 118, "kernel_name": "reduce_inon", "python": "@wp.kernel\ndef reduce_inon(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_inon_664f99e1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_inon_664f99e1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_inon_664f99e1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_inon(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_inon_664f99e1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_inon_664f99e1 *_wp_args,\n    wp_args_reduce_inon_664f99e1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_inon(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_inon(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_inon_664f99e1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_inon_664f99e1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_inon_664f99e1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_inon_664f99e1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_inon_664f99e1 *_wp_args,\n    wp_args_reduce_inon_664f99e1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_inon_664f99e1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 119, "kernel_name": "multi_wuyt", "python": "@wp.kernel\ndef multi_wuyt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_wuyt_3f2d5558 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_wuyt_3f2d5558_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wuyt_3f2d5558 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_wuyt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_wuyt_3f2d5558_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wuyt_3f2d5558 *_wp_args,\n    wp_args_multi_wuyt_3f2d5558 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_wuyt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_wuyt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_wuyt_3f2d5558_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wuyt_3f2d5558 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wuyt_3f2d5558_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_wuyt_3f2d5558_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wuyt_3f2d5558 *_wp_args,\n    wp_args_multi_wuyt_3f2d5558 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wuyt_3f2d5558_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 120, "kernel_name": "multi_xkks", "python": "@wp.kernel\ndef multi_xkks(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_xkks_60c1e860 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_xkks_60c1e860_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xkks_60c1e860 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_xkks(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_xkks_60c1e860_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xkks_60c1e860 *_wp_args,\n    wp_args_multi_xkks_60c1e860 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_xkks(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_xkks(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_xkks_60c1e860_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xkks_60c1e860 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xkks_60c1e860_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_xkks_60c1e860_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xkks_60c1e860 *_wp_args,\n    wp_args_multi_xkks_60c1e860 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xkks_60c1e860_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 121, "kernel_name": "compound_pvgb", "python": "@wp.kernel\ndef compound_pvgb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pvgb_2aa12904 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pvgb_2aa12904_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pvgb_2aa12904 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pvgb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pvgb_2aa12904_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pvgb_2aa12904 *_wp_args,\n    wp_args_compound_pvgb_2aa12904 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pvgb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pvgb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pvgb_2aa12904_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pvgb_2aa12904 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pvgb_2aa12904_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pvgb_2aa12904_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pvgb_2aa12904 *_wp_args,\n    wp_args_compound_pvgb_2aa12904 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pvgb_2aa12904_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 122, "kernel_name": "unary_udmn", "python": "@wp.kernel\ndef unary_udmn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_udmn_07cc59fe {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_udmn_07cc59fe_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_udmn_07cc59fe *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_udmn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_udmn_07cc59fe_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_udmn_07cc59fe *_wp_args,\n    wp_args_unary_udmn_07cc59fe *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_udmn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_udmn(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_udmn_07cc59fe_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_udmn_07cc59fe *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_udmn_07cc59fe_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_udmn_07cc59fe_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_udmn_07cc59fe *_wp_args,\n    wp_args_unary_udmn_07cc59fe *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_udmn_07cc59fe_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 123, "kernel_name": "reduce_jown", "python": "@wp.kernel\ndef reduce_jown(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jown_33c52b7c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jown_33c52b7c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jown_33c52b7c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jown(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jown_33c52b7c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jown_33c52b7c *_wp_args,\n    wp_args_reduce_jown_33c52b7c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jown(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jown(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jown_33c52b7c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jown_33c52b7c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jown_33c52b7c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jown_33c52b7c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jown_33c52b7c *_wp_args,\n    wp_args_reduce_jown_33c52b7c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jown_33c52b7c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 124, "kernel_name": "scalar_arr_czuj", "python": "@wp.kernel\ndef scalar_arr_czuj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_czuj_95ff2114 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_czuj_95ff2114_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_czuj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_czuj_95ff2114_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_args,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_czuj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_czuj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_czuj_95ff2114_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czuj_95ff2114_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_czuj_95ff2114_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_args,\n    wp_args_scalar_arr_czuj_95ff2114 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czuj_95ff2114_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 125, "kernel_name": "reduce_iotn", "python": "@wp.kernel\ndef reduce_iotn(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iotn_5805ca04 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iotn_5805ca04_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iotn_5805ca04 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iotn(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iotn_5805ca04_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iotn_5805ca04 *_wp_args,\n    wp_args_reduce_iotn_5805ca04 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iotn(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iotn(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iotn_5805ca04_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iotn_5805ca04 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iotn_5805ca04_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iotn_5805ca04_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iotn_5805ca04 *_wp_args,\n    wp_args_reduce_iotn_5805ca04 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iotn_5805ca04_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 126, "kernel_name": "loop_hbkr", "python": "@wp.kernel\ndef loop_hbkr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hbkr_70de4dcb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hbkr_70de4dcb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbkr_70de4dcb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hbkr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hbkr_70de4dcb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbkr_70de4dcb *_wp_args,\n    wp_args_loop_hbkr_70de4dcb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hbkr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hbkr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hbkr_70de4dcb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbkr_70de4dcb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbkr_70de4dcb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hbkr_70de4dcb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbkr_70de4dcb *_wp_args,\n    wp_args_loop_hbkr_70de4dcb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbkr_70de4dcb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 127, "kernel_name": "branch_ffav", "python": "@wp.kernel\ndef branch_ffav(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.02:\n        b[tid] = val * 1.9\n    else:\n        b[tid] = val + 2.3", "cpp": "struct wp_args_branch_ffav_815330b2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_ffav_815330b2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_ffav_815330b2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.3;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_ffav(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_ffav_815330b2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_ffav_815330b2 *_wp_args,\n    wp_args_branch_ffav_815330b2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.3;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_ffav(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.3                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 1.9                                                            <L 8>\n    }\n    // adj: if val > -0.02:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_ffav(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_ffav_815330b2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_ffav_815330b2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_ffav_815330b2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_ffav_815330b2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_ffav_815330b2 *_wp_args,\n    wp_args_branch_ffav_815330b2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_ffav_815330b2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 128, "kernel_name": "nested_oekb", "python": "@wp.kernel\ndef nested_oekb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.4:\n        if val > 0.84:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_oekb_fd26483e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_oekb_fd26483e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oekb_fd26483e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    const wp::float32 var_5 = -0.4;\n    bool var_6;\n    const wp::float32 var_7 = 0.84;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_oekb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.4:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.84:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_oekb_fd26483e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oekb_fd26483e *_wp_args,\n    wp_args_nested_oekb_fd26483e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    const wp::float32 var_5 = -0.4;\n    bool var_6;\n    const wp::float32 var_7 = 0.84;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_oekb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.4:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.84:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.84:                                                                <L 8>\n    }\n    // adj: if val > -0.4:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_oekb(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_oekb_fd26483e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oekb_fd26483e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oekb_fd26483e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_oekb_fd26483e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oekb_fd26483e *_wp_args,\n    wp_args_nested_oekb_fd26483e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oekb_fd26483e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 129, "kernel_name": "compound_rljh", "python": "@wp.kernel\ndef compound_rljh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_rljh_62411aee {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_rljh_62411aee_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rljh_62411aee *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_rljh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_rljh_62411aee_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rljh_62411aee *_wp_args,\n    wp_args_compound_rljh_62411aee *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_rljh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_rljh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_rljh_62411aee_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rljh_62411aee *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rljh_62411aee_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_rljh_62411aee_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rljh_62411aee *_wp_args,\n    wp_args_compound_rljh_62411aee *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rljh_62411aee_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 130, "kernel_name": "elementwise_wugm", "python": "@wp.kernel\ndef elementwise_wugm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_wugm_09aba589 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_wugm_09aba589_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wugm_09aba589 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_wugm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_wugm_09aba589_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_wugm_09aba589 *_wp_args,\n    wp_args_elementwise_wugm_09aba589 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_wugm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_wugm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_wugm_09aba589_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wugm_09aba589 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wugm_09aba589_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_wugm_09aba589_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_wugm_09aba589 *_wp_args,\n    wp_args_elementwise_wugm_09aba589 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_wugm_09aba589_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 131, "kernel_name": "nested_utkw", "python": "@wp.kernel\ndef nested_utkw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.12:\n        if val > 0.67:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_utkw_4cae50b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_utkw_4cae50b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_utkw_4cae50b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    bool var_5;\n    const wp::float32 var_6 = 0.67;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_utkw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.12:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.67:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_utkw_4cae50b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_utkw_4cae50b6 *_wp_args,\n    wp_args_nested_utkw_4cae50b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    bool var_5;\n    const wp::float32 var_6 = 0.67;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_utkw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.12:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.67:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.67:                                                                <L 8>\n    }\n    // adj: if val > 0.12:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_utkw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_utkw_4cae50b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_utkw_4cae50b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_utkw_4cae50b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_utkw_4cae50b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_utkw_4cae50b6 *_wp_args,\n    wp_args_nested_utkw_4cae50b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_utkw_4cae50b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 132, "kernel_name": "vec_yrsx", "python": "@wp.kernel\ndef vec_yrsx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_yrsx_2912c6f4 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_yrsx_2912c6f4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_yrsx_2912c6f4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_yrsx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_yrsx_2912c6f4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_yrsx_2912c6f4 *_wp_args,\n    wp_args_vec_yrsx_2912c6f4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_yrsx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_yrsx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_yrsx_2912c6f4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_yrsx_2912c6f4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_yrsx_2912c6f4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_yrsx_2912c6f4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_yrsx_2912c6f4 *_wp_args,\n    wp_args_vec_yrsx_2912c6f4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_yrsx_2912c6f4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 133, "kernel_name": "compound_yomd", "python": "@wp.kernel\ndef compound_yomd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_yomd_616cd3b8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_yomd_616cd3b8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yomd_616cd3b8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_yomd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_yomd_616cd3b8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yomd_616cd3b8 *_wp_args,\n    wp_args_compound_yomd_616cd3b8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_yomd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_yomd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_yomd_616cd3b8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yomd_616cd3b8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yomd_616cd3b8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_yomd_616cd3b8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yomd_616cd3b8 *_wp_args,\n    wp_args_compound_yomd_616cd3b8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yomd_616cd3b8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 134, "kernel_name": "unary_eaaa", "python": "@wp.kernel\ndef unary_eaaa(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_eaaa_08fb9c56 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_eaaa_08fb9c56_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eaaa_08fb9c56 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_eaaa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_eaaa_08fb9c56_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eaaa_08fb9c56 *_wp_args,\n    wp_args_unary_eaaa_08fb9c56 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_eaaa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_eaaa(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_eaaa_08fb9c56_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eaaa_08fb9c56 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eaaa_08fb9c56_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_eaaa_08fb9c56_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eaaa_08fb9c56 *_wp_args,\n    wp_args_unary_eaaa_08fb9c56 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eaaa_08fb9c56_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 135, "kernel_name": "reduce_jwyz", "python": "@wp.kernel\ndef reduce_jwyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jwyz_30b10e27 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jwyz_30b10e27_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jwyz_30b10e27 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jwyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jwyz_30b10e27_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jwyz_30b10e27 *_wp_args,\n    wp_args_reduce_jwyz_30b10e27 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jwyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jwyz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jwyz_30b10e27_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jwyz_30b10e27 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jwyz_30b10e27_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jwyz_30b10e27_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jwyz_30b10e27 *_wp_args,\n    wp_args_reduce_jwyz_30b10e27 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jwyz_30b10e27_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 136, "kernel_name": "vec_qysf", "python": "@wp.kernel\ndef vec_qysf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_qysf_66eebf36 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_qysf_66eebf36_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qysf_66eebf36 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_qysf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_qysf_66eebf36_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qysf_66eebf36 *_wp_args,\n    wp_args_vec_qysf_66eebf36 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_qysf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_qysf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_qysf_66eebf36_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qysf_66eebf36 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qysf_66eebf36_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_qysf_66eebf36_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qysf_66eebf36 *_wp_args,\n    wp_args_vec_qysf_66eebf36 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qysf_66eebf36_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 137, "kernel_name": "reduce_izvo", "python": "@wp.kernel\ndef reduce_izvo(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_izvo_5cdf3567 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_izvo_5cdf3567_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_izvo_5cdf3567 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_izvo(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_izvo_5cdf3567_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_izvo_5cdf3567 *_wp_args,\n    wp_args_reduce_izvo_5cdf3567 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_izvo(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_izvo(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_izvo_5cdf3567_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_izvo_5cdf3567 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_izvo_5cdf3567_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_izvo_5cdf3567_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_izvo_5cdf3567 *_wp_args,\n    wp_args_reduce_izvo_5cdf3567 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_izvo_5cdf3567_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 138, "kernel_name": "vec_kzgt", "python": "@wp.kernel\ndef vec_kzgt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kzgt_5af86f32 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kzgt_5af86f32_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzgt_5af86f32 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kzgt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kzgt_5af86f32_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzgt_5af86f32 *_wp_args,\n    wp_args_vec_kzgt_5af86f32 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kzgt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kzgt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kzgt_5af86f32_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzgt_5af86f32 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzgt_5af86f32_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kzgt_5af86f32_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzgt_5af86f32 *_wp_args,\n    wp_args_vec_kzgt_5af86f32 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzgt_5af86f32_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 139, "kernel_name": "unary_dstr", "python": "@wp.kernel\ndef unary_dstr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_dstr_30e346b5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dstr_30e346b5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dstr_30e346b5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dstr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dstr_30e346b5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dstr_30e346b5 *_wp_args,\n    wp_args_unary_dstr_30e346b5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dstr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dstr(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dstr_30e346b5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dstr_30e346b5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dstr_30e346b5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dstr_30e346b5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dstr_30e346b5 *_wp_args,\n    wp_args_unary_dstr_30e346b5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dstr_30e346b5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 140, "kernel_name": "multi_lrcr", "python": "@wp.kernel\ndef multi_lrcr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lrcr_9a42f28f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lrcr_9a42f28f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lrcr_9a42f28f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lrcr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lrcr_9a42f28f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lrcr_9a42f28f *_wp_args,\n    wp_args_multi_lrcr_9a42f28f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lrcr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lrcr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lrcr_9a42f28f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lrcr_9a42f28f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lrcr_9a42f28f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lrcr_9a42f28f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lrcr_9a42f28f *_wp_args,\n    wp_args_multi_lrcr_9a42f28f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lrcr_9a42f28f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 141, "kernel_name": "reduce_iync", "python": "@wp.kernel\ndef reduce_iync(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iync_0746f0ef {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iync_0746f0ef_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iync_0746f0ef *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iync(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iync_0746f0ef_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iync_0746f0ef *_wp_args,\n    wp_args_reduce_iync_0746f0ef *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iync(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iync(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iync_0746f0ef_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iync_0746f0ef *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iync_0746f0ef_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iync_0746f0ef_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iync_0746f0ef *_wp_args,\n    wp_args_reduce_iync_0746f0ef *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iync_0746f0ef_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 142, "kernel_name": "nested_yniq", "python": "@wp.kernel\ndef nested_yniq(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.24:\n        if val > 0.92:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_yniq_2c3af5fd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_yniq_2c3af5fd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_yniq_2c3af5fd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.24;\n    const wp::float32 var_5 = -0.24;\n    bool var_6;\n    const wp::float32 var_7 = 0.92;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_yniq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.24:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.92:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_yniq_2c3af5fd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_yniq_2c3af5fd *_wp_args,\n    wp_args_nested_yniq_2c3af5fd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.24;\n    const wp::float32 var_5 = -0.24;\n    bool var_6;\n    const wp::float32 var_7 = 0.92;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_yniq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.24:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.92:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.92:                                                                <L 8>\n    }\n    // adj: if val > -0.24:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_yniq(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_yniq_2c3af5fd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_yniq_2c3af5fd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_yniq_2c3af5fd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_yniq_2c3af5fd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_yniq_2c3af5fd *_wp_args,\n    wp_args_nested_yniq_2c3af5fd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_yniq_2c3af5fd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 143, "kernel_name": "elementwise_avla", "python": "@wp.kernel\ndef elementwise_avla(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_avla_8cf3f5ef {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_avla_8cf3f5ef_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_avla(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_avla_8cf3f5ef_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_args,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_avla(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_avla(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_avla_8cf3f5ef_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_avla_8cf3f5ef_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_avla_8cf3f5ef_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_args,\n    wp_args_elementwise_avla_8cf3f5ef *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_avla_8cf3f5ef_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 144, "kernel_name": "multi_llie", "python": "@wp.kernel\ndef multi_llie(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_llie_7a54d134 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_llie_7a54d134_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_llie_7a54d134 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_llie(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_llie_7a54d134_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_llie_7a54d134 *_wp_args,\n    wp_args_multi_llie_7a54d134 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_llie(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_llie(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_llie_7a54d134_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_llie_7a54d134 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_llie_7a54d134_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_llie_7a54d134_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_llie_7a54d134 *_wp_args,\n    wp_args_multi_llie_7a54d134 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_llie_7a54d134_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 145, "kernel_name": "reduce_vspy", "python": "@wp.kernel\ndef reduce_vspy(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_vspy_b7283b3f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_vspy_b7283b3f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_vspy_b7283b3f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_vspy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_vspy_b7283b3f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_vspy_b7283b3f *_wp_args,\n    wp_args_reduce_vspy_b7283b3f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_vspy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_vspy(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_vspy_b7283b3f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_vspy_b7283b3f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_vspy_b7283b3f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_vspy_b7283b3f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_vspy_b7283b3f *_wp_args,\n    wp_args_reduce_vspy_b7283b3f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_vspy_b7283b3f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 146, "kernel_name": "nested_zehd", "python": "@wp.kernel\ndef nested_zehd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.13:\n        if val > 1.34:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_zehd_f4ba165d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_zehd_f4ba165d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zehd_f4ba165d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    bool var_5;\n    const wp::float32 var_6 = 1.34;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_zehd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.13:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.34:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_zehd_f4ba165d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zehd_f4ba165d *_wp_args,\n    wp_args_nested_zehd_f4ba165d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    bool var_5;\n    const wp::float32 var_6 = 1.34;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_zehd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.13:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.34:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.34:                                                                <L 8>\n    }\n    // adj: if val > 0.13:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_zehd(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_zehd_f4ba165d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zehd_f4ba165d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zehd_f4ba165d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_zehd_f4ba165d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zehd_f4ba165d *_wp_args,\n    wp_args_nested_zehd_f4ba165d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zehd_f4ba165d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 147, "kernel_name": "reduce_vgqe", "python": "@wp.kernel\ndef reduce_vgqe(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_vgqe_433da287 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_vgqe_433da287_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_vgqe_433da287 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_vgqe(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_vgqe_433da287_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_vgqe_433da287 *_wp_args,\n    wp_args_reduce_vgqe_433da287 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_vgqe(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_vgqe(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_vgqe_433da287_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_vgqe_433da287 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_vgqe_433da287_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_vgqe_433da287_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_vgqe_433da287 *_wp_args,\n    wp_args_reduce_vgqe_433da287 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_vgqe_433da287_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 148, "kernel_name": "loop_hhds", "python": "@wp.kernel\ndef loop_hhds(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hhds_e9cfb5e4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hhds_e9cfb5e4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hhds(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hhds_e9cfb5e4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_args,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hhds(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hhds(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hhds_e9cfb5e4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hhds_e9cfb5e4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hhds_e9cfb5e4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_args,\n    wp_args_loop_hhds_e9cfb5e4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hhds_e9cfb5e4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 149, "kernel_name": "loop_hwde", "python": "@wp.kernel\ndef loop_hwde(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hwde_f2eb1139 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hwde_f2eb1139_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hwde_f2eb1139 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hwde(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hwde_f2eb1139_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hwde_f2eb1139 *_wp_args,\n    wp_args_loop_hwde_f2eb1139 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hwde(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hwde(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hwde_f2eb1139_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hwde_f2eb1139 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hwde_f2eb1139_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hwde_f2eb1139_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hwde_f2eb1139 *_wp_args,\n    wp_args_loop_hwde_f2eb1139 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hwde_f2eb1139_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 150, "kernel_name": "vec_kvdg", "python": "@wp.kernel\ndef vec_kvdg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kvdg_c4c56238 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kvdg_c4c56238_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kvdg_c4c56238 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kvdg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kvdg_c4c56238_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kvdg_c4c56238 *_wp_args,\n    wp_args_vec_kvdg_c4c56238 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kvdg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kvdg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kvdg_c4c56238_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kvdg_c4c56238 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kvdg_c4c56238_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kvdg_c4c56238_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kvdg_c4c56238 *_wp_args,\n    wp_args_vec_kvdg_c4c56238 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kvdg_c4c56238_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 151, "kernel_name": "branch_gpen", "python": "@wp.kernel\ndef branch_gpen(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.96:\n        b[tid] = val + 0.7\n    else:\n        b[tid] = val * 1.7", "cpp": "struct wp_args_branch_gpen_79ee803e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gpen_79ee803e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gpen_79ee803e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 0.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_gpen(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 0.7                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.7                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_gpen_79ee803e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gpen_79ee803e *_wp_args,\n    wp_args_branch_gpen_79ee803e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 0.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_gpen(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 0.7                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.7                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 1.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 0.7                                                            <L 8>\n    }\n    // adj: if val > -0.96:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gpen(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gpen_79ee803e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gpen_79ee803e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gpen_79ee803e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gpen_79ee803e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gpen_79ee803e *_wp_args,\n    wp_args_branch_gpen_79ee803e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gpen_79ee803e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 152, "kernel_name": "elementwise_agqe", "python": "@wp.kernel\ndef elementwise_agqe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_agqe_1fd2fe36 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_agqe_1fd2fe36_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_agqe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_agqe_1fd2fe36_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_args,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_agqe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_agqe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_agqe_1fd2fe36_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agqe_1fd2fe36_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_agqe_1fd2fe36_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_args,\n    wp_args_elementwise_agqe_1fd2fe36 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agqe_1fd2fe36_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 153, "kernel_name": "elementwise_bppc", "python": "@wp.kernel\ndef elementwise_bppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_bppc_f282763c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bppc_f282763c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bppc_f282763c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bppc_f282763c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bppc_f282763c *_wp_args,\n    wp_args_elementwise_bppc_f282763c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bppc_f282763c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bppc_f282763c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bppc_f282763c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bppc_f282763c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bppc_f282763c *_wp_args,\n    wp_args_elementwise_bppc_f282763c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bppc_f282763c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 154, "kernel_name": "reduce_iusu", "python": "@wp.kernel\ndef reduce_iusu(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iusu_d43c0c26 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iusu_d43c0c26_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iusu_d43c0c26 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iusu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iusu_d43c0c26_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iusu_d43c0c26 *_wp_args,\n    wp_args_reduce_iusu_d43c0c26 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iusu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iusu(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iusu_d43c0c26_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iusu_d43c0c26 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iusu_d43c0c26_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iusu_d43c0c26_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iusu_d43c0c26 *_wp_args,\n    wp_args_reduce_iusu_d43c0c26 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iusu_d43c0c26_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 155, "kernel_name": "nested_wazg", "python": "@wp.kernel\ndef nested_wazg(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.44:\n        if val > 0.59:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_wazg_616cc971 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_wazg_616cc971_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_wazg_616cc971 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.44;\n    bool var_5;\n    const wp::float32 var_6 = 0.59;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_wazg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.44:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.59:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_wazg_616cc971_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_wazg_616cc971 *_wp_args,\n    wp_args_nested_wazg_616cc971 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.44;\n    bool var_5;\n    const wp::float32 var_6 = 0.59;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_wazg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.44:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.59:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.59:                                                                <L 8>\n    }\n    // adj: if val > 0.44:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_wazg(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_wazg_616cc971_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_wazg_616cc971 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_wazg_616cc971_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_wazg_616cc971_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_wazg_616cc971 *_wp_args,\n    wp_args_nested_wazg_616cc971 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_wazg_616cc971_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 156, "kernel_name": "vec_slca", "python": "@wp.kernel\ndef vec_slca(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_slca_175512b9 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_slca_175512b9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_slca_175512b9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_slca(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_slca_175512b9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_slca_175512b9 *_wp_args,\n    wp_args_vec_slca_175512b9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_slca(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_slca(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_slca_175512b9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_slca_175512b9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_slca_175512b9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_slca_175512b9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_slca_175512b9 *_wp_args,\n    wp_args_vec_slca_175512b9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_slca_175512b9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 157, "kernel_name": "loop_gqxf", "python": "@wp.kernel\ndef loop_gqxf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gqxf_29fb0fe6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gqxf_29fb0fe6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gqxf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gqxf_29fb0fe6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_args,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gqxf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gqxf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gqxf_29fb0fe6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqxf_29fb0fe6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gqxf_29fb0fe6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_args,\n    wp_args_loop_gqxf_29fb0fe6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqxf_29fb0fe6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 158, "kernel_name": "scalar_arr_bpvv", "python": "@wp.kernel\ndef scalar_arr_bpvv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_bpvv_8fd23ed5 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bpvv_8fd23ed5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bpvv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bpvv_8fd23ed5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_args,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bpvv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bpvv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bpvv_8fd23ed5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bpvv_8fd23ed5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bpvv_8fd23ed5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_args,\n    wp_args_scalar_arr_bpvv_8fd23ed5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bpvv_8fd23ed5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 159, "kernel_name": "elementwise_urat", "python": "@wp.kernel\ndef elementwise_urat(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_urat_3dd03b9c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_urat_3dd03b9c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_urat_3dd03b9c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_urat(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_urat_3dd03b9c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_urat_3dd03b9c *_wp_args,\n    wp_args_elementwise_urat_3dd03b9c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_urat(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_urat(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_urat_3dd03b9c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_urat_3dd03b9c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_urat_3dd03b9c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_urat_3dd03b9c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_urat_3dd03b9c *_wp_args,\n    wp_args_elementwise_urat_3dd03b9c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_urat_3dd03b9c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 160, "kernel_name": "vec_lvke", "python": "@wp.kernel\ndef vec_lvke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_lvke_fb6efbe4 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_lvke_fb6efbe4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lvke_fb6efbe4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_lvke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_lvke_fb6efbe4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lvke_fb6efbe4 *_wp_args,\n    wp_args_vec_lvke_fb6efbe4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_lvke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lvke(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lvke_fb6efbe4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lvke_fb6efbe4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lvke_fb6efbe4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lvke_fb6efbe4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lvke_fb6efbe4 *_wp_args,\n    wp_args_vec_lvke_fb6efbe4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lvke_fb6efbe4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 161, "kernel_name": "loop_yqok", "python": "@wp.kernel\ndef loop_yqok(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_yqok_077c9eaa {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_yqok_077c9eaa_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yqok_077c9eaa *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_yqok(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_yqok_077c9eaa_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yqok_077c9eaa *_wp_args,\n    wp_args_loop_yqok_077c9eaa *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_yqok(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_yqok(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_yqok_077c9eaa_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yqok_077c9eaa *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yqok_077c9eaa_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_yqok_077c9eaa_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yqok_077c9eaa *_wp_args,\n    wp_args_loop_yqok_077c9eaa *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yqok_077c9eaa_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 162, "kernel_name": "vec_zpty", "python": "@wp.kernel\ndef vec_zpty(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_zpty_e86aa7df {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_zpty_e86aa7df_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zpty_e86aa7df *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_zpty(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_zpty_e86aa7df_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zpty_e86aa7df *_wp_args,\n    wp_args_vec_zpty_e86aa7df *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_zpty(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_zpty(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_zpty_e86aa7df_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zpty_e86aa7df *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zpty_e86aa7df_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_zpty_e86aa7df_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zpty_e86aa7df *_wp_args,\n    wp_args_vec_zpty_e86aa7df *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zpty_e86aa7df_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 163, "kernel_name": "nested_noqt", "python": "@wp.kernel\ndef nested_noqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.02:\n        if val > 1.11:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_noqt_80431514 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_noqt_80431514_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_noqt_80431514 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    bool var_5;\n    const wp::float32 var_6 = 1.11;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_noqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.02:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.11:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_noqt_80431514_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_noqt_80431514 *_wp_args,\n    wp_args_nested_noqt_80431514 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    bool var_5;\n    const wp::float32 var_6 = 1.11;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_noqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.02:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.11:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.11:                                                                <L 8>\n    }\n    // adj: if val > 0.02:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_noqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_noqt_80431514_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_noqt_80431514 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_noqt_80431514_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_noqt_80431514_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_noqt_80431514 *_wp_args,\n    wp_args_nested_noqt_80431514 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_noqt_80431514_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 164, "kernel_name": "elementwise_bsfv", "python": "@wp.kernel\ndef elementwise_bsfv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bsfv_ce8c8dfb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bsfv_ce8c8dfb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bsfv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bsfv_ce8c8dfb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_args,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bsfv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bsfv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bsfv_ce8c8dfb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bsfv_ce8c8dfb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bsfv_ce8c8dfb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_args,\n    wp_args_elementwise_bsfv_ce8c8dfb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bsfv_ce8c8dfb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 165, "kernel_name": "loop_hbsy", "python": "@wp.kernel\ndef loop_hbsy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hbsy_4d18c452 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hbsy_4d18c452_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbsy_4d18c452 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hbsy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hbsy_4d18c452_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbsy_4d18c452 *_wp_args,\n    wp_args_loop_hbsy_4d18c452 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hbsy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hbsy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hbsy_4d18c452_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbsy_4d18c452 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbsy_4d18c452_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hbsy_4d18c452_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbsy_4d18c452 *_wp_args,\n    wp_args_loop_hbsy_4d18c452 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbsy_4d18c452_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 166, "kernel_name": "reduce_xwvt", "python": "@wp.kernel\ndef reduce_xwvt(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xwvt_9a27e001 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xwvt_9a27e001_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xwvt_9a27e001 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xwvt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xwvt_9a27e001_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xwvt_9a27e001 *_wp_args,\n    wp_args_reduce_xwvt_9a27e001 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xwvt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xwvt(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xwvt_9a27e001_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xwvt_9a27e001 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xwvt_9a27e001_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xwvt_9a27e001_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xwvt_9a27e001 *_wp_args,\n    wp_args_reduce_xwvt_9a27e001 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xwvt_9a27e001_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 167, "kernel_name": "nested_tbvg", "python": "@wp.kernel\ndef nested_tbvg(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.0:\n        if val > 0.89:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_tbvg_2c316c5b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_tbvg_2c316c5b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_tbvg_2c316c5b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    bool var_5;\n    const wp::float32 var_6 = 0.89;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_tbvg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.0:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.89:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_tbvg_2c316c5b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_tbvg_2c316c5b *_wp_args,\n    wp_args_nested_tbvg_2c316c5b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.0;\n    bool var_5;\n    const wp::float32 var_6 = 0.89;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_tbvg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.0:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.89:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.89:                                                                <L 8>\n    }\n    // adj: if val > 0.0:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_tbvg(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_tbvg_2c316c5b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_tbvg_2c316c5b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_tbvg_2c316c5b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_tbvg_2c316c5b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_tbvg_2c316c5b *_wp_args,\n    wp_args_nested_tbvg_2c316c5b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_tbvg_2c316c5b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 168, "kernel_name": "multi_mwyw", "python": "@wp.kernel\ndef multi_mwyw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_mwyw_e89fd939 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mwyw_e89fd939_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mwyw_e89fd939 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mwyw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mwyw_e89fd939_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mwyw_e89fd939 *_wp_args,\n    wp_args_multi_mwyw_e89fd939 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mwyw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mwyw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mwyw_e89fd939_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mwyw_e89fd939 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mwyw_e89fd939_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mwyw_e89fd939_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mwyw_e89fd939 *_wp_args,\n    wp_args_multi_mwyw_e89fd939 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mwyw_e89fd939_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 169, "kernel_name": "compound_yook", "python": "@wp.kernel\ndef compound_yook(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_yook_c6c17573 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_yook_c6c17573_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yook_c6c17573 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_yook(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_yook_c6c17573_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_yook_c6c17573 *_wp_args,\n    wp_args_compound_yook_c6c17573 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_yook(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_yook(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_yook_c6c17573_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yook_c6c17573 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yook_c6c17573_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_yook_c6c17573_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_yook_c6c17573 *_wp_args,\n    wp_args_compound_yook_c6c17573 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_yook_c6c17573_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 170, "kernel_name": "loop_wnjx", "python": "@wp.kernel\ndef loop_wnjx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_wnjx_41214145 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_wnjx_41214145_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_wnjx_41214145 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_wnjx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_wnjx_41214145_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_wnjx_41214145 *_wp_args,\n    wp_args_loop_wnjx_41214145 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_wnjx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_wnjx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_wnjx_41214145_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_wnjx_41214145 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_wnjx_41214145_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_wnjx_41214145_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_wnjx_41214145 *_wp_args,\n    wp_args_loop_wnjx_41214145 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_wnjx_41214145_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 171, "kernel_name": "loop_hfpj", "python": "@wp.kernel\ndef loop_hfpj(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hfpj_aeaa46bf {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hfpj_aeaa46bf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hfpj_aeaa46bf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hfpj(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hfpj_aeaa46bf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hfpj_aeaa46bf *_wp_args,\n    wp_args_loop_hfpj_aeaa46bf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hfpj(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hfpj(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hfpj_aeaa46bf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hfpj_aeaa46bf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hfpj_aeaa46bf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hfpj_aeaa46bf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hfpj_aeaa46bf *_wp_args,\n    wp_args_loop_hfpj_aeaa46bf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hfpj_aeaa46bf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 172, "kernel_name": "reduce_ixwy", "python": "@wp.kernel\ndef reduce_ixwy(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ixwy_167c047a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ixwy_167c047a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixwy_167c047a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ixwy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ixwy_167c047a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixwy_167c047a *_wp_args,\n    wp_args_reduce_ixwy_167c047a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ixwy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ixwy(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ixwy_167c047a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixwy_167c047a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixwy_167c047a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ixwy_167c047a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixwy_167c047a *_wp_args,\n    wp_args_reduce_ixwy_167c047a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixwy_167c047a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 173, "kernel_name": "reduce_iogz", "python": "@wp.kernel\ndef reduce_iogz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iogz_387dd46a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iogz_387dd46a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iogz_387dd46a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iogz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iogz_387dd46a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iogz_387dd46a *_wp_args,\n    wp_args_reduce_iogz_387dd46a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iogz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iogz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iogz_387dd46a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iogz_387dd46a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iogz_387dd46a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iogz_387dd46a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iogz_387dd46a *_wp_args,\n    wp_args_reduce_iogz_387dd46a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iogz_387dd46a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 174, "kernel_name": "elementwise_bhzd", "python": "@wp.kernel\ndef elementwise_bhzd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_bhzd_0256c31f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bhzd_0256c31f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bhzd_0256c31f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bhzd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bhzd_0256c31f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bhzd_0256c31f *_wp_args,\n    wp_args_elementwise_bhzd_0256c31f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bhzd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bhzd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bhzd_0256c31f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bhzd_0256c31f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bhzd_0256c31f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bhzd_0256c31f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bhzd_0256c31f *_wp_args,\n    wp_args_elementwise_bhzd_0256c31f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bhzd_0256c31f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 175, "kernel_name": "branch_gzko", "python": "@wp.kernel\ndef branch_gzko(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.89:\n        b[tid] = val * 0.7\n    else:\n        b[tid] = val + 2.5", "cpp": "struct wp_args_branch_gzko_f11f5759 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gzko_f11f5759_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gzko_f11f5759 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.89;\n    const wp::float32 var_5 = -0.89;\n    bool var_6;\n    const wp::float32 var_7 = 0.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.5;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_gzko(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.89:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.7                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_gzko_f11f5759_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gzko_f11f5759 *_wp_args,\n    wp_args_branch_gzko_f11f5759 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.89;\n    const wp::float32 var_5 = -0.89;\n    bool var_6;\n    const wp::float32 var_7 = 0.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.5;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_gzko(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.89:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.7                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.5                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 0.7                                                            <L 8>\n    }\n    // adj: if val > -0.89:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gzko(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gzko_f11f5759_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gzko_f11f5759 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gzko_f11f5759_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gzko_f11f5759_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gzko_f11f5759 *_wp_args,\n    wp_args_branch_gzko_f11f5759 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gzko_f11f5759_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 176, "kernel_name": "multi_mhxq", "python": "@wp.kernel\ndef multi_mhxq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_mhxq_25d10d89 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mhxq_25d10d89_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mhxq_25d10d89 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mhxq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mhxq_25d10d89_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mhxq_25d10d89 *_wp_args,\n    wp_args_multi_mhxq_25d10d89 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mhxq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mhxq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mhxq_25d10d89_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mhxq_25d10d89 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mhxq_25d10d89_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mhxq_25d10d89_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mhxq_25d10d89 *_wp_args,\n    wp_args_multi_mhxq_25d10d89 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mhxq_25d10d89_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 177, "kernel_name": "nested_ncps", "python": "@wp.kernel\ndef nested_ncps(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.15:\n        if val > 1.08:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ncps_2aee6cc9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ncps_2aee6cc9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ncps_2aee6cc9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 1.08;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ncps(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.08:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ncps_2aee6cc9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ncps_2aee6cc9 *_wp_args,\n    wp_args_nested_ncps_2aee6cc9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 1.08;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ncps(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.08:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.08:                                                                <L 8>\n    }\n    // adj: if val > -0.15:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ncps(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ncps_2aee6cc9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ncps_2aee6cc9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ncps_2aee6cc9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ncps_2aee6cc9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ncps_2aee6cc9 *_wp_args,\n    wp_args_nested_ncps_2aee6cc9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ncps_2aee6cc9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 178, "kernel_name": "elementwise_bsar", "python": "@wp.kernel\ndef elementwise_bsar(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bsar_7f07cb6f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bsar_7f07cb6f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bsar(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bsar_7f07cb6f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_args,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bsar(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bsar(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bsar_7f07cb6f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bsar_7f07cb6f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bsar_7f07cb6f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_args,\n    wp_args_elementwise_bsar_7f07cb6f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bsar_7f07cb6f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 179, "kernel_name": "unary_evai", "python": "@wp.kernel\ndef unary_evai(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_evai_b98e4cda {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_evai_b98e4cda_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_evai_b98e4cda *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_evai(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_evai_b98e4cda_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_evai_b98e4cda *_wp_args,\n    wp_args_unary_evai_b98e4cda *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_evai(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_evai(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_evai_b98e4cda_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_evai_b98e4cda *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_evai_b98e4cda_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_evai_b98e4cda_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_evai_b98e4cda *_wp_args,\n    wp_args_unary_evai_b98e4cda *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_evai_b98e4cda_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 180, "kernel_name": "scalar_arr_uupi", "python": "@wp.kernel\ndef scalar_arr_uupi(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_uupi_624b7e23 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_uupi_624b7e23_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_uupi(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_uupi_624b7e23_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_args,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_uupi(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_uupi(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_uupi_624b7e23_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_uupi_624b7e23_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_uupi_624b7e23_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_args,\n    wp_args_scalar_arr_uupi_624b7e23 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_uupi_624b7e23_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 181, "kernel_name": "branch_edxj", "python": "@wp.kernel\ndef branch_edxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.47:\n        b[tid] = val - 1.7\n    else:\n        b[tid] = val - 2.5", "cpp": "struct wp_args_branch_edxj_3f942432 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_edxj_3f942432_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_edxj_3f942432 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.47;\n    bool var_5;\n    const wp::float32 var_6 = 1.7;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.5;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_edxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.47:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.7                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 2.5                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_edxj_3f942432_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_edxj_3f942432 *_wp_args,\n    wp_args_branch_edxj_3f942432 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.47;\n    bool var_5;\n    const wp::float32 var_6 = 1.7;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.5;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_edxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.47:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.7                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 2.5                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_sub(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val - 2.5                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_sub(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val - 1.7                                                            <L 8>\n    }\n    // adj: if val > 0.47:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_edxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_edxj_3f942432_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_edxj_3f942432 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_edxj_3f942432_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_edxj_3f942432_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_edxj_3f942432 *_wp_args,\n    wp_args_branch_edxj_3f942432 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_edxj_3f942432_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 182, "kernel_name": "reduce_zcgl", "python": "@wp.kernel\ndef reduce_zcgl(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_zcgl_048e8218 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_zcgl_048e8218_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zcgl_048e8218 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_zcgl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_zcgl_048e8218_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zcgl_048e8218 *_wp_args,\n    wp_args_reduce_zcgl_048e8218 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_zcgl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_zcgl(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_zcgl_048e8218_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zcgl_048e8218 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zcgl_048e8218_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_zcgl_048e8218_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zcgl_048e8218 *_wp_args,\n    wp_args_reduce_zcgl_048e8218 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zcgl_048e8218_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 183, "kernel_name": "scalar_arr_tchd", "python": "@wp.kernel\ndef scalar_arr_tchd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_tchd_718fbf06 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_tchd_718fbf06_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_tchd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_tchd_718fbf06_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_args,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_tchd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_tchd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_tchd_718fbf06_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tchd_718fbf06_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_tchd_718fbf06_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_args,\n    wp_args_scalar_arr_tchd_718fbf06 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tchd_718fbf06_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 184, "kernel_name": "nested_qknt", "python": "@wp.kernel\ndef nested_qknt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.29:\n        if val > 0.67:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_qknt_08e505b7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_qknt_08e505b7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_qknt_08e505b7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.29;\n    bool var_5;\n    const wp::float32 var_6 = 0.67;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_qknt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.29:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.67:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_qknt_08e505b7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_qknt_08e505b7 *_wp_args,\n    wp_args_nested_qknt_08e505b7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.29;\n    bool var_5;\n    const wp::float32 var_6 = 0.67;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_qknt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.29:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.67:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.67:                                                                <L 8>\n    }\n    // adj: if val > 0.29:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_qknt(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_qknt_08e505b7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_qknt_08e505b7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_qknt_08e505b7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_qknt_08e505b7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_qknt_08e505b7 *_wp_args,\n    wp_args_nested_qknt_08e505b7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_qknt_08e505b7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 185, "kernel_name": "scalar_arr_wppe", "python": "@wp.kernel\ndef scalar_arr_wppe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_wppe_81ada4cf {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_wppe_81ada4cf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_wppe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_wppe_81ada4cf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_args,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_wppe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_wppe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_wppe_81ada4cf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wppe_81ada4cf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_wppe_81ada4cf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_args,\n    wp_args_scalar_arr_wppe_81ada4cf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wppe_81ada4cf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 186, "kernel_name": "loop_iqrf", "python": "@wp.kernel\ndef loop_iqrf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_iqrf_793e363d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_iqrf_793e363d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_iqrf_793e363d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_iqrf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_iqrf_793e363d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_iqrf_793e363d *_wp_args,\n    wp_args_loop_iqrf_793e363d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_iqrf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_iqrf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_iqrf_793e363d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_iqrf_793e363d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_iqrf_793e363d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_iqrf_793e363d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_iqrf_793e363d *_wp_args,\n    wp_args_loop_iqrf_793e363d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_iqrf_793e363d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 187, "kernel_name": "multi_ymky", "python": "@wp.kernel\ndef multi_ymky(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_ymky_b01db5da {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_ymky_b01db5da_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ymky_b01db5da *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_ymky(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_ymky_b01db5da_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ymky_b01db5da *_wp_args,\n    wp_args_multi_ymky_b01db5da *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_ymky(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_ymky(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_ymky_b01db5da_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ymky_b01db5da *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ymky_b01db5da_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_ymky_b01db5da_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ymky_b01db5da *_wp_args,\n    wp_args_multi_ymky_b01db5da *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ymky_b01db5da_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 188, "kernel_name": "branch_fqix", "python": "@wp.kernel\ndef branch_fqix(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.14:\n        b[tid] = val + 2.4\n    else:\n        b[tid] = val + 1.9", "cpp": "struct wp_args_branch_fqix_ab78f843 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fqix_ab78f843_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqix_ab78f843 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    bool var_5;\n    const wp::float32 var_6 = 2.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fqix(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.14:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.4                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fqix_ab78f843_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqix_ab78f843 *_wp_args,\n    wp_args_branch_fqix_ab78f843 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    bool var_5;\n    const wp::float32 var_6 = 2.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fqix(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.14:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.4                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 1.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.4                                                            <L 8>\n    }\n    // adj: if val > 0.14:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fqix(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fqix_ab78f843_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqix_ab78f843 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqix_ab78f843_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fqix_ab78f843_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqix_ab78f843 *_wp_args,\n    wp_args_branch_fqix_ab78f843 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqix_ab78f843_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 189, "kernel_name": "vec_vumx", "python": "@wp.kernel\ndef vec_vumx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_vumx_2dd53e4f {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_vumx_2dd53e4f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_vumx_2dd53e4f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_vumx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_vumx_2dd53e4f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_vumx_2dd53e4f *_wp_args,\n    wp_args_vec_vumx_2dd53e4f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_vumx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_vumx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_vumx_2dd53e4f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_vumx_2dd53e4f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_vumx_2dd53e4f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_vumx_2dd53e4f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_vumx_2dd53e4f *_wp_args,\n    wp_args_vec_vumx_2dd53e4f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_vumx_2dd53e4f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 190, "kernel_name": "branch_uumy", "python": "@wp.kernel\ndef branch_uumy(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.78:\n        b[tid] = val * 0.6\n    else:\n        b[tid] = val * 0.8", "cpp": "struct wp_args_branch_uumy_b02b6746 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_uumy_b02b6746_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_uumy_b02b6746 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.78;\n    const wp::float32 var_5 = -0.78;\n    bool var_6;\n    const wp::float32 var_7 = 0.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.8;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_uumy(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.78:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.8                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_uumy_b02b6746_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_uumy_b02b6746 *_wp_args,\n    wp_args_branch_uumy_b02b6746 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.78;\n    const wp::float32 var_5 = -0.78;\n    bool var_6;\n    const wp::float32 var_7 = 0.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.8;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_uumy(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.78:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.8                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 0.8                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 0.6                                                            <L 8>\n    }\n    // adj: if val > -0.78:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_uumy(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_uumy_b02b6746_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_uumy_b02b6746 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_uumy_b02b6746_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_uumy_b02b6746_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_uumy_b02b6746 *_wp_args,\n    wp_args_branch_uumy_b02b6746 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_uumy_b02b6746_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 191, "kernel_name": "loop_hrwc", "python": "@wp.kernel\ndef loop_hrwc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hrwc_7bcc9815 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hrwc_7bcc9815_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hrwc_7bcc9815 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hrwc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hrwc_7bcc9815_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hrwc_7bcc9815 *_wp_args,\n    wp_args_loop_hrwc_7bcc9815 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hrwc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hrwc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hrwc_7bcc9815_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hrwc_7bcc9815 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hrwc_7bcc9815_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hrwc_7bcc9815_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hrwc_7bcc9815 *_wp_args,\n    wp_args_loop_hrwc_7bcc9815 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hrwc_7bcc9815_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 192, "kernel_name": "branch_eqyq", "python": "@wp.kernel\ndef branch_eqyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.29:\n        b[tid] = val * 2.9\n    else:\n        b[tid] = val * 2.4", "cpp": "struct wp_args_branch_eqyq_0dcbb5de {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_eqyq_0dcbb5de_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_eqyq_0dcbb5de *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.29;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.4;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_eqyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.29:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.4                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_eqyq_0dcbb5de_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_eqyq_0dcbb5de *_wp_args,\n    wp_args_branch_eqyq_0dcbb5de *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.29;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.4;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_eqyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.29:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.4                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 2.4                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 2.9                                                            <L 8>\n    }\n    // adj: if val > 0.29:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_eqyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_eqyq_0dcbb5de_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_eqyq_0dcbb5de *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_eqyq_0dcbb5de_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_eqyq_0dcbb5de_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_eqyq_0dcbb5de *_wp_args,\n    wp_args_branch_eqyq_0dcbb5de *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_eqyq_0dcbb5de_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 193, "kernel_name": "scalar_arr_cceh", "python": "@wp.kernel\ndef scalar_arr_cceh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_cceh_64c0caf1 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cceh_64c0caf1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cceh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cceh_64c0caf1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_args,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cceh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cceh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cceh_64c0caf1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cceh_64c0caf1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cceh_64c0caf1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_args,\n    wp_args_scalar_arr_cceh_64c0caf1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cceh_64c0caf1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 194, "kernel_name": "branch_frlz", "python": "@wp.kernel\ndef branch_frlz(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.22:\n        b[tid] = val * 0.6\n    else:\n        b[tid] = val + 0.9", "cpp": "struct wp_args_branch_frlz_6502fef3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_frlz_6502fef3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frlz_6502fef3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    bool var_5;\n    const wp::float32 var_6 = 0.6;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_frlz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.22:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_frlz_6502fef3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frlz_6502fef3 *_wp_args,\n    wp_args_branch_frlz_6502fef3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    bool var_5;\n    const wp::float32 var_6 = 0.6;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_frlz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.22:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 0.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 0.6                                                            <L 8>\n    }\n    // adj: if val > 0.22:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_frlz(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_frlz_6502fef3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frlz_6502fef3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frlz_6502fef3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_frlz_6502fef3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frlz_6502fef3 *_wp_args,\n    wp_args_branch_frlz_6502fef3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frlz_6502fef3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 195, "kernel_name": "vec_kjbo", "python": "@wp.kernel\ndef vec_kjbo(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kjbo_deda0b04 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kjbo_deda0b04_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjbo_deda0b04 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kjbo(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kjbo_deda0b04_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjbo_deda0b04 *_wp_args,\n    wp_args_vec_kjbo_deda0b04 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kjbo(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kjbo(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kjbo_deda0b04_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjbo_deda0b04 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjbo_deda0b04_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kjbo_deda0b04_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjbo_deda0b04 *_wp_args,\n    wp_args_vec_kjbo_deda0b04 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjbo_deda0b04_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 196, "kernel_name": "vec_lnbr", "python": "@wp.kernel\ndef vec_lnbr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_lnbr_095241ce {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_lnbr_095241ce_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lnbr_095241ce *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_lnbr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_lnbr_095241ce_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lnbr_095241ce *_wp_args,\n    wp_args_vec_lnbr_095241ce *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_lnbr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lnbr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lnbr_095241ce_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lnbr_095241ce *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lnbr_095241ce_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lnbr_095241ce_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lnbr_095241ce *_wp_args,\n    wp_args_vec_lnbr_095241ce *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lnbr_095241ce_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 197, "kernel_name": "scalar_arr_cdzp", "python": "@wp.kernel\ndef scalar_arr_cdzp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_cdzp_068a9741 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cdzp_068a9741_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cdzp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cdzp_068a9741_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_args,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cdzp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cdzp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cdzp_068a9741_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cdzp_068a9741_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cdzp_068a9741_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_args,\n    wp_args_scalar_arr_cdzp_068a9741 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cdzp_068a9741_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 198, "kernel_name": "multi_tytv", "python": "@wp.kernel\ndef multi_tytv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_tytv_9cda7fd3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_tytv_9cda7fd3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_tytv_9cda7fd3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_tytv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_tytv_9cda7fd3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_tytv_9cda7fd3 *_wp_args,\n    wp_args_multi_tytv_9cda7fd3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_tytv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_tytv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_tytv_9cda7fd3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_tytv_9cda7fd3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_tytv_9cda7fd3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_tytv_9cda7fd3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_tytv_9cda7fd3 *_wp_args,\n    wp_args_multi_tytv_9cda7fd3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_tytv_9cda7fd3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 199, "kernel_name": "multi_mjxt", "python": "@wp.kernel\ndef multi_mjxt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mjxt_98ecd9ff {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mjxt_98ecd9ff_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjxt_98ecd9ff *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mjxt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mjxt_98ecd9ff_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjxt_98ecd9ff *_wp_args,\n    wp_args_multi_mjxt_98ecd9ff *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mjxt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mjxt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mjxt_98ecd9ff_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjxt_98ecd9ff *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjxt_98ecd9ff_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mjxt_98ecd9ff_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjxt_98ecd9ff *_wp_args,\n    wp_args_multi_mjxt_98ecd9ff *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjxt_98ecd9ff_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 200, "kernel_name": "reduce_tdvy", "python": "@wp.kernel\ndef reduce_tdvy(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_tdvy_83ec0be7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_tdvy_83ec0be7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_tdvy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_tdvy_83ec0be7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_args,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_tdvy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_tdvy(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_tdvy_83ec0be7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tdvy_83ec0be7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_tdvy_83ec0be7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_args,\n    wp_args_reduce_tdvy_83ec0be7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tdvy_83ec0be7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 201, "kernel_name": "vec_kbha", "python": "@wp.kernel\ndef vec_kbha(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kbha_cdbec19d {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kbha_cdbec19d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kbha_cdbec19d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kbha(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kbha_cdbec19d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kbha_cdbec19d *_wp_args,\n    wp_args_vec_kbha_cdbec19d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kbha(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kbha(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kbha_cdbec19d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kbha_cdbec19d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kbha_cdbec19d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kbha_cdbec19d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kbha_cdbec19d *_wp_args,\n    wp_args_vec_kbha_cdbec19d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kbha_cdbec19d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 202, "kernel_name": "multi_mjfg", "python": "@wp.kernel\ndef multi_mjfg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_mjfg_ec9130ef {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mjfg_ec9130ef_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjfg_ec9130ef *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mjfg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mjfg_ec9130ef_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjfg_ec9130ef *_wp_args,\n    wp_args_multi_mjfg_ec9130ef *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mjfg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mjfg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mjfg_ec9130ef_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjfg_ec9130ef *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjfg_ec9130ef_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mjfg_ec9130ef_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjfg_ec9130ef *_wp_args,\n    wp_args_multi_mjfg_ec9130ef *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjfg_ec9130ef_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 203, "kernel_name": "elementwise_abkg", "python": "@wp.kernel\ndef elementwise_abkg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_abkg_f286621d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_abkg_f286621d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_abkg_f286621d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_abkg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_abkg_f286621d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_abkg_f286621d *_wp_args,\n    wp_args_elementwise_abkg_f286621d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_abkg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_abkg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_abkg_f286621d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_abkg_f286621d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_abkg_f286621d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_abkg_f286621d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_abkg_f286621d *_wp_args,\n    wp_args_elementwise_abkg_f286621d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_abkg_f286621d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 204, "kernel_name": "multi_xmif", "python": "@wp.kernel\ndef multi_xmif(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_xmif_85b0ce4f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_xmif_85b0ce4f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xmif_85b0ce4f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_xmif(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_xmif_85b0ce4f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xmif_85b0ce4f *_wp_args,\n    wp_args_multi_xmif_85b0ce4f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_xmif(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_xmif(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_xmif_85b0ce4f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xmif_85b0ce4f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xmif_85b0ce4f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_xmif_85b0ce4f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xmif_85b0ce4f *_wp_args,\n    wp_args_multi_xmif_85b0ce4f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xmif_85b0ce4f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 205, "kernel_name": "nested_sxei", "python": "@wp.kernel\ndef nested_sxei(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.36:\n        if val > 1.22:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_sxei_7a14f27e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_sxei_7a14f27e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_sxei_7a14f27e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    bool var_5;\n    const wp::float32 var_6 = 1.22;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_sxei(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.36:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.22:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_sxei_7a14f27e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_sxei_7a14f27e *_wp_args,\n    wp_args_nested_sxei_7a14f27e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    bool var_5;\n    const wp::float32 var_6 = 1.22;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_sxei(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.36:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.22:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.22:                                                                <L 8>\n    }\n    // adj: if val > 0.36:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_sxei(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_sxei_7a14f27e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_sxei_7a14f27e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_sxei_7a14f27e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_sxei_7a14f27e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_sxei_7a14f27e *_wp_args,\n    wp_args_nested_sxei_7a14f27e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_sxei_7a14f27e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 206, "kernel_name": "scalar_arr_ccku", "python": "@wp.kernel\ndef scalar_arr_ccku(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_ccku_78eff5a5 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ccku_78eff5a5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ccku(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_ccku_78eff5a5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_args,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ccku(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ccku(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ccku_78eff5a5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ccku_78eff5a5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ccku_78eff5a5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_args,\n    wp_args_scalar_arr_ccku_78eff5a5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ccku_78eff5a5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 207, "kernel_name": "vec_tsus", "python": "@wp.kernel\ndef vec_tsus(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_tsus_630d7869 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_tsus_630d7869_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_tsus_630d7869 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_tsus(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_tsus_630d7869_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_tsus_630d7869 *_wp_args,\n    wp_args_vec_tsus_630d7869 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_tsus(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_tsus(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_tsus_630d7869_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_tsus_630d7869 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_tsus_630d7869_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_tsus_630d7869_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_tsus_630d7869 *_wp_args,\n    wp_args_vec_tsus_630d7869 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_tsus_630d7869_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 208, "kernel_name": "loop_gkno", "python": "@wp.kernel\ndef loop_gkno(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gkno_3383c377 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gkno_3383c377_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gkno_3383c377 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gkno(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gkno_3383c377_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gkno_3383c377 *_wp_args,\n    wp_args_loop_gkno_3383c377 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gkno(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gkno(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gkno_3383c377_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gkno_3383c377 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gkno_3383c377_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gkno_3383c377_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gkno_3383c377 *_wp_args,\n    wp_args_loop_gkno_3383c377 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gkno_3383c377_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 209, "kernel_name": "unary_enns", "python": "@wp.kernel\ndef unary_enns(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_enns_516b9613 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_enns_516b9613_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_enns_516b9613 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_enns(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_enns_516b9613_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_enns_516b9613 *_wp_args,\n    wp_args_unary_enns_516b9613 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_enns(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_enns(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_enns_516b9613_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_enns_516b9613 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_enns_516b9613_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_enns_516b9613_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_enns_516b9613 *_wp_args,\n    wp_args_unary_enns_516b9613 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_enns_516b9613_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 210, "kernel_name": "unary_ddgp", "python": "@wp.kernel\ndef unary_ddgp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_ddgp_511ebca0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_ddgp_511ebca0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ddgp_511ebca0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_ddgp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_ddgp_511ebca0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ddgp_511ebca0 *_wp_args,\n    wp_args_unary_ddgp_511ebca0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_ddgp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_ddgp(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_ddgp_511ebca0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ddgp_511ebca0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ddgp_511ebca0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_ddgp_511ebca0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ddgp_511ebca0 *_wp_args,\n    wp_args_unary_ddgp_511ebca0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ddgp_511ebca0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 211, "kernel_name": "compound_pheb", "python": "@wp.kernel\ndef compound_pheb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pheb_eb67e826 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pheb_eb67e826_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pheb_eb67e826 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pheb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pheb_eb67e826_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pheb_eb67e826 *_wp_args,\n    wp_args_compound_pheb_eb67e826 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pheb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pheb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pheb_eb67e826_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pheb_eb67e826 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pheb_eb67e826_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pheb_eb67e826_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pheb_eb67e826 *_wp_args,\n    wp_args_compound_pheb_eb67e826 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pheb_eb67e826_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 212, "kernel_name": "reduce_tkmt", "python": "@wp.kernel\ndef reduce_tkmt(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_tkmt_bf88c310 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_tkmt_bf88c310_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tkmt_bf88c310 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_tkmt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_tkmt_bf88c310_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tkmt_bf88c310 *_wp_args,\n    wp_args_reduce_tkmt_bf88c310 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_tkmt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_tkmt(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_tkmt_bf88c310_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tkmt_bf88c310 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tkmt_bf88c310_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_tkmt_bf88c310_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tkmt_bf88c310 *_wp_args,\n    wp_args_reduce_tkmt_bf88c310 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tkmt_bf88c310_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 213, "kernel_name": "reduce_ifia", "python": "@wp.kernel\ndef reduce_ifia(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ifia_fcafb698 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ifia_fcafb698_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ifia_fcafb698 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ifia(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ifia_fcafb698_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ifia_fcafb698 *_wp_args,\n    wp_args_reduce_ifia_fcafb698 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ifia(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ifia(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ifia_fcafb698_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ifia_fcafb698 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ifia_fcafb698_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ifia_fcafb698_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ifia_fcafb698 *_wp_args,\n    wp_args_reduce_ifia_fcafb698 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ifia_fcafb698_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 214, "kernel_name": "multi_rlcq", "python": "@wp.kernel\ndef multi_rlcq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_rlcq_be0f27aa {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_rlcq_be0f27aa_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_rlcq_be0f27aa *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_rlcq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_rlcq_be0f27aa_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_rlcq_be0f27aa *_wp_args,\n    wp_args_multi_rlcq_be0f27aa *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_rlcq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_rlcq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_rlcq_be0f27aa_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_rlcq_be0f27aa *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_rlcq_be0f27aa_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_rlcq_be0f27aa_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_rlcq_be0f27aa *_wp_args,\n    wp_args_multi_rlcq_be0f27aa *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_rlcq_be0f27aa_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 215, "kernel_name": "vec_ryku", "python": "@wp.kernel\ndef vec_ryku(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_ryku_20745040 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_ryku_20745040_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ryku_20745040 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_ryku(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_ryku_20745040_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ryku_20745040 *_wp_args,\n    wp_args_vec_ryku_20745040 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_ryku(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ryku(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ryku_20745040_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ryku_20745040 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ryku_20745040_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ryku_20745040_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ryku_20745040 *_wp_args,\n    wp_args_vec_ryku_20745040 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ryku_20745040_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 216, "kernel_name": "loop_ruxl", "python": "@wp.kernel\ndef loop_ruxl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_ruxl_fdf23954 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_ruxl_fdf23954_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ruxl_fdf23954 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_ruxl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_ruxl_fdf23954_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_ruxl_fdf23954 *_wp_args,\n    wp_args_loop_ruxl_fdf23954 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_ruxl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_ruxl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_ruxl_fdf23954_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ruxl_fdf23954 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ruxl_fdf23954_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_ruxl_fdf23954_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_ruxl_fdf23954 *_wp_args,\n    wp_args_loop_ruxl_fdf23954 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_ruxl_fdf23954_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 217, "kernel_name": "unary_vupx", "python": "@wp.kernel\ndef unary_vupx(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_vupx_ad852234 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_vupx_ad852234_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_vupx_ad852234 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_vupx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_vupx_ad852234_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_vupx_ad852234 *_wp_args,\n    wp_args_unary_vupx_ad852234 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_vupx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_vupx(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_vupx_ad852234_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_vupx_ad852234 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_vupx_ad852234_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_vupx_ad852234_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_vupx_ad852234 *_wp_args,\n    wp_args_unary_vupx_ad852234 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_vupx_ad852234_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 218, "kernel_name": "vec_kdao", "python": "@wp.kernel\ndef vec_kdao(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kdao_d311282a {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kdao_d311282a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdao_d311282a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kdao(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kdao_d311282a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdao_d311282a *_wp_args,\n    wp_args_vec_kdao_d311282a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kdao(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kdao(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kdao_d311282a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdao_d311282a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdao_d311282a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kdao_d311282a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdao_d311282a *_wp_args,\n    wp_args_vec_kdao_d311282a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdao_d311282a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 219, "kernel_name": "unary_venr", "python": "@wp.kernel\ndef unary_venr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_venr_1b220d62 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_venr_1b220d62_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_venr_1b220d62 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_venr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_venr_1b220d62_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_venr_1b220d62 *_wp_args,\n    wp_args_unary_venr_1b220d62 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_venr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_venr(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_venr_1b220d62_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_venr_1b220d62 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_venr_1b220d62_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_venr_1b220d62_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_venr_1b220d62 *_wp_args,\n    wp_args_unary_venr_1b220d62 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_venr_1b220d62_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 220, "kernel_name": "branch_vfst", "python": "@wp.kernel\ndef branch_vfst(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.53:\n        b[tid] = val - 1.6\n    else:\n        b[tid] = val - 2.8", "cpp": "struct wp_args_branch_vfst_484b8a3a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_vfst_484b8a3a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_vfst_484b8a3a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.53;\n    const wp::float32 var_5 = -0.53;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.8;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_vfst(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.53:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_vfst_484b8a3a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_vfst_484b8a3a *_wp_args,\n    wp_args_branch_vfst_484b8a3a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.53;\n    const wp::float32 var_5 = -0.53;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.8;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_vfst(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.53:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.8                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.8                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.6                                                            <L 8>\n    }\n    // adj: if val > -0.53:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_vfst(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_vfst_484b8a3a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_vfst_484b8a3a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_vfst_484b8a3a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_vfst_484b8a3a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_vfst_484b8a3a *_wp_args,\n    wp_args_branch_vfst_484b8a3a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_vfst_484b8a3a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 221, "kernel_name": "branch_fuat", "python": "@wp.kernel\ndef branch_fuat(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.68:\n        b[tid] = val * 0.5\n    else:\n        b[tid] = val + 1.0", "cpp": "struct wp_args_branch_fuat_9b6fdb7d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fuat_9b6fdb7d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fuat_9b6fdb7d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.68;\n    bool var_5;\n    const wp::float32 var_6 = 0.5;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.0;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fuat(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.68:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.5                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.0                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fuat_9b6fdb7d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fuat_9b6fdb7d *_wp_args,\n    wp_args_branch_fuat_9b6fdb7d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.68;\n    bool var_5;\n    const wp::float32 var_6 = 0.5;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.0;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fuat(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.68:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.5                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.0                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 1.0                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 0.5                                                            <L 8>\n    }\n    // adj: if val > 0.68:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fuat(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fuat_9b6fdb7d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fuat_9b6fdb7d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fuat_9b6fdb7d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fuat_9b6fdb7d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fuat_9b6fdb7d *_wp_args,\n    wp_args_branch_fuat_9b6fdb7d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fuat_9b6fdb7d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 222, "kernel_name": "nested_zuhm", "python": "@wp.kernel\ndef nested_zuhm(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.17:\n        if val > 0.53:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_zuhm_21b3f9aa {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_zuhm_21b3f9aa_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zuhm_21b3f9aa *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    const wp::float32 var_5 = -0.17;\n    bool var_6;\n    const wp::float32 var_7 = 0.53;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_zuhm(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.17:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.53:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_zuhm_21b3f9aa_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zuhm_21b3f9aa *_wp_args,\n    wp_args_nested_zuhm_21b3f9aa *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    const wp::float32 var_5 = -0.17;\n    bool var_6;\n    const wp::float32 var_7 = 0.53;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_zuhm(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.17:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.53:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.53:                                                                <L 8>\n    }\n    // adj: if val > -0.17:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_zuhm(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_zuhm_21b3f9aa_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zuhm_21b3f9aa *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zuhm_21b3f9aa_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_zuhm_21b3f9aa_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zuhm_21b3f9aa *_wp_args,\n    wp_args_nested_zuhm_21b3f9aa *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zuhm_21b3f9aa_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 223, "kernel_name": "unary_rgfi", "python": "@wp.kernel\ndef unary_rgfi(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_rgfi_e54d8578 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_rgfi_e54d8578_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_rgfi_e54d8578 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_rgfi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_rgfi_e54d8578_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_rgfi_e54d8578 *_wp_args,\n    wp_args_unary_rgfi_e54d8578 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_rgfi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_rgfi(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_rgfi_e54d8578_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_rgfi_e54d8578 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_rgfi_e54d8578_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_rgfi_e54d8578_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_rgfi_e54d8578 *_wp_args,\n    wp_args_unary_rgfi_e54d8578 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_rgfi_e54d8578_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 224, "kernel_name": "loop_hbzm", "python": "@wp.kernel\ndef loop_hbzm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hbzm_245b354c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hbzm_245b354c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbzm_245b354c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hbzm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hbzm_245b354c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hbzm_245b354c *_wp_args,\n    wp_args_loop_hbzm_245b354c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hbzm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hbzm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hbzm_245b354c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbzm_245b354c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbzm_245b354c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hbzm_245b354c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hbzm_245b354c *_wp_args,\n    wp_args_loop_hbzm_245b354c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hbzm_245b354c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 225, "kernel_name": "elementwise_azvv", "python": "@wp.kernel\ndef elementwise_azvv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_azvv_7dd3452d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_azvv_7dd3452d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azvv_7dd3452d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_azvv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_azvv_7dd3452d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azvv_7dd3452d *_wp_args,\n    wp_args_elementwise_azvv_7dd3452d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_azvv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_azvv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_azvv_7dd3452d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azvv_7dd3452d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azvv_7dd3452d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_azvv_7dd3452d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azvv_7dd3452d *_wp_args,\n    wp_args_elementwise_azvv_7dd3452d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azvv_7dd3452d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 226, "kernel_name": "nested_nrdx", "python": "@wp.kernel\ndef nested_nrdx(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.3:\n        if val > 1.02:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nrdx_0b85f735 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nrdx_0b85f735_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nrdx_0b85f735 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.3;\n    const wp::float32 var_5 = -0.3;\n    bool var_6;\n    const wp::float32 var_7 = 1.02;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nrdx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.3:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.02:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nrdx_0b85f735_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nrdx_0b85f735 *_wp_args,\n    wp_args_nested_nrdx_0b85f735 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.3;\n    const wp::float32 var_5 = -0.3;\n    bool var_6;\n    const wp::float32 var_7 = 1.02;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nrdx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.3:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.02:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.02:                                                                <L 8>\n    }\n    // adj: if val > -0.3:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nrdx(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nrdx_0b85f735_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nrdx_0b85f735 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nrdx_0b85f735_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nrdx_0b85f735_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nrdx_0b85f735 *_wp_args,\n    wp_args_nested_nrdx_0b85f735 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nrdx_0b85f735_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 227, "kernel_name": "elementwise_ahmt", "python": "@wp.kernel\ndef elementwise_ahmt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_ahmt_99dabc4a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ahmt_99dabc4a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ahmt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ahmt_99dabc4a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_args,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ahmt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ahmt(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ahmt_99dabc4a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ahmt_99dabc4a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ahmt_99dabc4a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_args,\n    wp_args_elementwise_ahmt_99dabc4a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ahmt_99dabc4a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 228, "kernel_name": "nested_uxjy", "python": "@wp.kernel\ndef nested_uxjy(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.05:\n        if val > 0.51:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_uxjy_4824c885 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_uxjy_4824c885_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_uxjy_4824c885 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.05;\n    const wp::float32 var_5 = -0.05;\n    bool var_6;\n    const wp::float32 var_7 = 0.51;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_uxjy(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.05:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.51:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_uxjy_4824c885_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_uxjy_4824c885 *_wp_args,\n    wp_args_nested_uxjy_4824c885 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.05;\n    const wp::float32 var_5 = -0.05;\n    bool var_6;\n    const wp::float32 var_7 = 0.51;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_uxjy(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.05:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.51:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.51:                                                                <L 8>\n    }\n    // adj: if val > -0.05:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_uxjy(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_uxjy_4824c885_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_uxjy_4824c885 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_uxjy_4824c885_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_uxjy_4824c885_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_uxjy_4824c885 *_wp_args,\n    wp_args_nested_uxjy_4824c885 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_uxjy_4824c885_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 229, "kernel_name": "reduce_ivwj", "python": "@wp.kernel\ndef reduce_ivwj(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ivwj_f4c5c82a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ivwj_f4c5c82a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ivwj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ivwj_f4c5c82a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_args,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ivwj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ivwj(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ivwj_f4c5c82a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ivwj_f4c5c82a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ivwj_f4c5c82a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_args,\n    wp_args_reduce_ivwj_f4c5c82a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ivwj_f4c5c82a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 230, "kernel_name": "compound_xppc", "python": "@wp.kernel\ndef compound_xppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_xppc_25787fc4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_xppc_25787fc4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xppc_25787fc4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_xppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_xppc_25787fc4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xppc_25787fc4 *_wp_args,\n    wp_args_compound_xppc_25787fc4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_xppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_xppc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_xppc_25787fc4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xppc_25787fc4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xppc_25787fc4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_xppc_25787fc4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xppc_25787fc4 *_wp_args,\n    wp_args_compound_xppc_25787fc4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xppc_25787fc4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 231, "kernel_name": "vec_lbnr", "python": "@wp.kernel\ndef vec_lbnr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_lbnr_db12b070 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_lbnr_db12b070_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lbnr_db12b070 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_lbnr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_lbnr_db12b070_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lbnr_db12b070 *_wp_args,\n    wp_args_vec_lbnr_db12b070 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_lbnr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lbnr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lbnr_db12b070_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lbnr_db12b070 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lbnr_db12b070_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lbnr_db12b070_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lbnr_db12b070 *_wp_args,\n    wp_args_vec_lbnr_db12b070 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lbnr_db12b070_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 232, "kernel_name": "loop_halo", "python": "@wp.kernel\ndef loop_halo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_halo_90e77a9c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_halo_90e77a9c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_halo_90e77a9c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_halo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_halo_90e77a9c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_halo_90e77a9c *_wp_args,\n    wp_args_loop_halo_90e77a9c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_halo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_halo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_halo_90e77a9c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_halo_90e77a9c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_halo_90e77a9c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_halo_90e77a9c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_halo_90e77a9c *_wp_args,\n    wp_args_loop_halo_90e77a9c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_halo_90e77a9c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 233, "kernel_name": "reduce_tjzm", "python": "@wp.kernel\ndef reduce_tjzm(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_tjzm_540c2b9a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_tjzm_540c2b9a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tjzm_540c2b9a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_tjzm(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_tjzm_540c2b9a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_tjzm_540c2b9a *_wp_args,\n    wp_args_reduce_tjzm_540c2b9a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_tjzm(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_tjzm(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_tjzm_540c2b9a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tjzm_540c2b9a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tjzm_540c2b9a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_tjzm_540c2b9a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_tjzm_540c2b9a *_wp_args,\n    wp_args_reduce_tjzm_540c2b9a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_tjzm_540c2b9a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 234, "kernel_name": "nested_ohuf", "python": "@wp.kernel\ndef nested_ohuf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.26:\n        if val > 0.77:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ohuf_a2ff2ded {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ohuf_a2ff2ded_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohuf_a2ff2ded *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.26;\n    const wp::float32 var_5 = -0.26;\n    bool var_6;\n    const wp::float32 var_7 = 0.77;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ohuf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.26:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.77:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ohuf_a2ff2ded_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohuf_a2ff2ded *_wp_args,\n    wp_args_nested_ohuf_a2ff2ded *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.26;\n    const wp::float32 var_5 = -0.26;\n    bool var_6;\n    const wp::float32 var_7 = 0.77;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ohuf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.26:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.77:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.77:                                                                <L 8>\n    }\n    // adj: if val > -0.26:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ohuf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ohuf_a2ff2ded_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohuf_a2ff2ded *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohuf_a2ff2ded_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ohuf_a2ff2ded_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohuf_a2ff2ded *_wp_args,\n    wp_args_nested_ohuf_a2ff2ded *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohuf_a2ff2ded_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 235, "kernel_name": "reduce_ixzd", "python": "@wp.kernel\ndef reduce_ixzd(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ixzd_172ad558 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ixzd_172ad558_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixzd_172ad558 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ixzd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ixzd_172ad558_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixzd_172ad558 *_wp_args,\n    wp_args_reduce_ixzd_172ad558 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ixzd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ixzd(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ixzd_172ad558_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixzd_172ad558 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixzd_172ad558_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ixzd_172ad558_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixzd_172ad558 *_wp_args,\n    wp_args_reduce_ixzd_172ad558 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixzd_172ad558_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 236, "kernel_name": "elementwise_awjq", "python": "@wp.kernel\ndef elementwise_awjq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_awjq_a42d6c95 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_awjq_a42d6c95_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_awjq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_awjq_a42d6c95_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_args,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_awjq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_awjq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_awjq_a42d6c95_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_awjq_a42d6c95_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_awjq_a42d6c95_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_args,\n    wp_args_elementwise_awjq_a42d6c95 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_awjq_a42d6c95_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 237, "kernel_name": "vec_kdoy", "python": "@wp.kernel\ndef vec_kdoy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kdoy_cd656da1 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kdoy_cd656da1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdoy_cd656da1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kdoy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kdoy_cd656da1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdoy_cd656da1 *_wp_args,\n    wp_args_vec_kdoy_cd656da1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kdoy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kdoy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kdoy_cd656da1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdoy_cd656da1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdoy_cd656da1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kdoy_cd656da1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdoy_cd656da1 *_wp_args,\n    wp_args_vec_kdoy_cd656da1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdoy_cd656da1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 238, "kernel_name": "nested_ngoc", "python": "@wp.kernel\ndef nested_ngoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.11:\n        if val > 1.38:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ngoc_eb1ba93e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ngoc_eb1ba93e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ngoc_eb1ba93e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    bool var_5;\n    const wp::float32 var_6 = 1.38;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_ngoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.11:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.38:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_ngoc_eb1ba93e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ngoc_eb1ba93e *_wp_args,\n    wp_args_nested_ngoc_eb1ba93e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.11;\n    bool var_5;\n    const wp::float32 var_6 = 1.38;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_ngoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.11:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.38:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.38:                                                                <L 8>\n    }\n    // adj: if val > 0.11:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ngoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ngoc_eb1ba93e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ngoc_eb1ba93e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ngoc_eb1ba93e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ngoc_eb1ba93e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ngoc_eb1ba93e *_wp_args,\n    wp_args_nested_ngoc_eb1ba93e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ngoc_eb1ba93e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 239, "kernel_name": "branch_fvfa", "python": "@wp.kernel\ndef branch_fvfa(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.67:\n        b[tid] = val * 0.6\n    else:\n        b[tid] = val - 1.9", "cpp": "struct wp_args_branch_fvfa_9a7c85da {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fvfa_9a7c85da_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fvfa_9a7c85da *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.67;\n    bool var_5;\n    const wp::float32 var_6 = 0.6;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fvfa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.67:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.9                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fvfa_9a7c85da_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fvfa_9a7c85da *_wp_args,\n    wp_args_branch_fvfa_9a7c85da *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.67;\n    bool var_5;\n    const wp::float32 var_6 = 0.6;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fvfa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.67:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 0.6                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.9                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_sub(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val - 1.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 0.6                                                            <L 8>\n    }\n    // adj: if val > 0.67:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fvfa(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fvfa_9a7c85da_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fvfa_9a7c85da *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fvfa_9a7c85da_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fvfa_9a7c85da_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fvfa_9a7c85da *_wp_args,\n    wp_args_branch_fvfa_9a7c85da *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fvfa_9a7c85da_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 240, "kernel_name": "scalar_arr_dgtm", "python": "@wp.kernel\ndef scalar_arr_dgtm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_dgtm_76f0a01a {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_dgtm_76f0a01a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_dgtm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_dgtm_76f0a01a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_args,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_dgtm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_dgtm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_dgtm_76f0a01a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dgtm_76f0a01a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_dgtm_76f0a01a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_args,\n    wp_args_scalar_arr_dgtm_76f0a01a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dgtm_76f0a01a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 241, "kernel_name": "reduce_jizy", "python": "@wp.kernel\ndef reduce_jizy(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jizy_a61a9530 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jizy_a61a9530_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jizy_a61a9530 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jizy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jizy_a61a9530_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jizy_a61a9530 *_wp_args,\n    wp_args_reduce_jizy_a61a9530 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jizy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jizy(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jizy_a61a9530_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jizy_a61a9530 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jizy_a61a9530_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jizy_a61a9530_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jizy_a61a9530 *_wp_args,\n    wp_args_reduce_jizy_a61a9530 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jizy_a61a9530_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 242, "kernel_name": "loop_hdrs", "python": "@wp.kernel\ndef loop_hdrs(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hdrs_0f12abef {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hdrs_0f12abef_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hdrs_0f12abef *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hdrs(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hdrs_0f12abef_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hdrs_0f12abef *_wp_args,\n    wp_args_loop_hdrs_0f12abef *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hdrs(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hdrs(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hdrs_0f12abef_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hdrs_0f12abef *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hdrs_0f12abef_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hdrs_0f12abef_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hdrs_0f12abef *_wp_args,\n    wp_args_loop_hdrs_0f12abef *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hdrs_0f12abef_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 243, "kernel_name": "vec_kzph", "python": "@wp.kernel\ndef vec_kzph(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kzph_cffd2d3b {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kzph_cffd2d3b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzph_cffd2d3b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kzph(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kzph_cffd2d3b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kzph_cffd2d3b *_wp_args,\n    wp_args_vec_kzph_cffd2d3b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kzph(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kzph(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kzph_cffd2d3b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzph_cffd2d3b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzph_cffd2d3b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kzph_cffd2d3b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kzph_cffd2d3b *_wp_args,\n    wp_args_vec_kzph_cffd2d3b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kzph_cffd2d3b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 244, "kernel_name": "scalar_arr_bfnk", "python": "@wp.kernel\ndef scalar_arr_bfnk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_bfnk_f025cacc {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bfnk_f025cacc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bfnk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bfnk_f025cacc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_args,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bfnk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bfnk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bfnk_f025cacc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bfnk_f025cacc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bfnk_f025cacc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_args,\n    wp_args_scalar_arr_bfnk_f025cacc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bfnk_f025cacc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 245, "kernel_name": "multi_larv", "python": "@wp.kernel\ndef multi_larv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_larv_31dbce6a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_larv_31dbce6a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_larv_31dbce6a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_larv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_larv_31dbce6a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_larv_31dbce6a *_wp_args,\n    wp_args_multi_larv_31dbce6a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_larv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_larv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_larv_31dbce6a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_larv_31dbce6a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_larv_31dbce6a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_larv_31dbce6a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_larv_31dbce6a *_wp_args,\n    wp_args_multi_larv_31dbce6a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_larv_31dbce6a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 246, "kernel_name": "elementwise_tmls", "python": "@wp.kernel\ndef elementwise_tmls(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_tmls_9ce7931d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_tmls_9ce7931d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_tmls_9ce7931d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_tmls(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_tmls_9ce7931d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_tmls_9ce7931d *_wp_args,\n    wp_args_elementwise_tmls_9ce7931d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_tmls(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_tmls(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_tmls_9ce7931d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_tmls_9ce7931d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_tmls_9ce7931d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_tmls_9ce7931d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_tmls_9ce7931d *_wp_args,\n    wp_args_elementwise_tmls_9ce7931d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_tmls_9ce7931d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 247, "kernel_name": "nested_vbxj", "python": "@wp.kernel\ndef nested_vbxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.36:\n        if val > 1.44:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_vbxj_f25a1949 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_vbxj_f25a1949_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_vbxj_f25a1949 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    bool var_5;\n    const wp::float32 var_6 = 1.44;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_vbxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.36:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.44:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_vbxj_f25a1949_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_vbxj_f25a1949 *_wp_args,\n    wp_args_nested_vbxj_f25a1949 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    bool var_5;\n    const wp::float32 var_6 = 1.44;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_vbxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.36:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.44:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.44:                                                                <L 8>\n    }\n    // adj: if val > 0.36:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_vbxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_vbxj_f25a1949_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_vbxj_f25a1949 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_vbxj_f25a1949_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_vbxj_f25a1949_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_vbxj_f25a1949 *_wp_args,\n    wp_args_nested_vbxj_f25a1949 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_vbxj_f25a1949_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 248, "kernel_name": "vec_rtwt", "python": "@wp.kernel\ndef vec_rtwt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_rtwt_e709e413 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_rtwt_e709e413_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_rtwt_e709e413 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_rtwt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_rtwt_e709e413_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_rtwt_e709e413 *_wp_args,\n    wp_args_vec_rtwt_e709e413 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_rtwt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_rtwt(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_rtwt_e709e413_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_rtwt_e709e413 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_rtwt_e709e413_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_rtwt_e709e413_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_rtwt_e709e413 *_wp_args,\n    wp_args_vec_rtwt_e709e413 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_rtwt_e709e413_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 249, "kernel_name": "reduce_ixvq", "python": "@wp.kernel\ndef reduce_ixvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ixvq_a8f0fbba {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ixvq_a8f0fbba_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ixvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ixvq_a8f0fbba_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_args,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ixvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ixvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ixvq_a8f0fbba_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixvq_a8f0fbba_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ixvq_a8f0fbba_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_args,\n    wp_args_reduce_ixvq_a8f0fbba *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixvq_a8f0fbba_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 250, "kernel_name": "loop_hydr", "python": "@wp.kernel\ndef loop_hydr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hydr_23642750 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hydr_23642750_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hydr_23642750 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hydr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hydr_23642750_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hydr_23642750 *_wp_args,\n    wp_args_loop_hydr_23642750 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hydr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hydr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hydr_23642750_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hydr_23642750 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hydr_23642750_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hydr_23642750_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hydr_23642750 *_wp_args,\n    wp_args_loop_hydr_23642750 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hydr_23642750_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 251, "kernel_name": "scalar_arr_cbbn", "python": "@wp.kernel\ndef scalar_arr_cbbn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_cbbn_8ec89ab4 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cbbn_8ec89ab4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cbbn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cbbn_8ec89ab4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_args,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cbbn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cbbn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cbbn_8ec89ab4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cbbn_8ec89ab4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cbbn_8ec89ab4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_args,\n    wp_args_scalar_arr_cbbn_8ec89ab4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cbbn_8ec89ab4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 252, "kernel_name": "loop_wqfx", "python": "@wp.kernel\ndef loop_wqfx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_wqfx_74c8448d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_wqfx_74c8448d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_wqfx_74c8448d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_wqfx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_wqfx_74c8448d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_wqfx_74c8448d *_wp_args,\n    wp_args_loop_wqfx_74c8448d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_wqfx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_wqfx(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_wqfx_74c8448d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_wqfx_74c8448d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_wqfx_74c8448d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_wqfx_74c8448d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_wqfx_74c8448d *_wp_args,\n    wp_args_loop_wqfx_74c8448d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_wqfx_74c8448d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 253, "kernel_name": "scalar_arr_zgfh", "python": "@wp.kernel\ndef scalar_arr_zgfh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_zgfh_7c80b4c9 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_zgfh_7c80b4c9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_zgfh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_zgfh_7c80b4c9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_args,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_zgfh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_zgfh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_zgfh_7c80b4c9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_zgfh_7c80b4c9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_zgfh_7c80b4c9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_args,\n    wp_args_scalar_arr_zgfh_7c80b4c9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_zgfh_7c80b4c9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 254, "kernel_name": "nested_olps", "python": "@wp.kernel\ndef nested_olps(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.45:\n        if val > 0.54:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_olps_5a9002a4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_olps_5a9002a4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_olps_5a9002a4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.45;\n    bool var_5;\n    const wp::float32 var_6 = 0.54;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_olps(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.45:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.54:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_olps_5a9002a4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_olps_5a9002a4 *_wp_args,\n    wp_args_nested_olps_5a9002a4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.45;\n    bool var_5;\n    const wp::float32 var_6 = 0.54;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_olps(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.45:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.54:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.54:                                                                <L 8>\n    }\n    // adj: if val > 0.45:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_olps(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_olps_5a9002a4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_olps_5a9002a4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_olps_5a9002a4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_olps_5a9002a4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_olps_5a9002a4 *_wp_args,\n    wp_args_nested_olps_5a9002a4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_olps_5a9002a4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 255, "kernel_name": "branch_fzwe", "python": "@wp.kernel\ndef branch_fzwe(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.02:\n        b[tid] = val + 1.1\n    else:\n        b[tid] = val - 2.7", "cpp": "struct wp_args_branch_fzwe_f8130345 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fzwe_f8130345_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fzwe_f8130345 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.1;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fzwe(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.1                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.7                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fzwe_f8130345_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fzwe_f8130345 *_wp_args,\n    wp_args_branch_fzwe_f8130345 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.1;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fzwe(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.1                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.7                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 1.1                                                            <L 8>\n    }\n    // adj: if val > -0.02:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fzwe(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fzwe_f8130345_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fzwe_f8130345 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fzwe_f8130345_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fzwe_f8130345_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fzwe_f8130345 *_wp_args,\n    wp_args_branch_fzwe_f8130345 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fzwe_f8130345_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 256, "kernel_name": "scalar_arr_bpnm", "python": "@wp.kernel\ndef scalar_arr_bpnm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_bpnm_ea615443 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bpnm_ea615443_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bpnm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bpnm_ea615443_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_args,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bpnm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bpnm(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bpnm_ea615443_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bpnm_ea615443_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bpnm_ea615443_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_args,\n    wp_args_scalar_arr_bpnm_ea615443 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bpnm_ea615443_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 257, "kernel_name": "vec_kkew", "python": "@wp.kernel\ndef vec_kkew(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kkew_c53d6874 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kkew_c53d6874_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kkew_c53d6874 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kkew(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kkew_c53d6874_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kkew_c53d6874 *_wp_args,\n    wp_args_vec_kkew_c53d6874 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kkew(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kkew(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kkew_c53d6874_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kkew_c53d6874 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kkew_c53d6874_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kkew_c53d6874_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kkew_c53d6874 *_wp_args,\n    wp_args_vec_kkew_c53d6874 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kkew_c53d6874_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 258, "kernel_name": "branch_gfrc", "python": "@wp.kernel\ndef branch_gfrc(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.02:\n        b[tid] = val - 2.0\n    else:\n        b[tid] = val * 0.7", "cpp": "struct wp_args_branch_gfrc_bdedcfc1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gfrc_bdedcfc1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    bool var_5;\n    const wp::float32 var_6 = 2.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.7;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_gfrc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.02:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 2.0                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.7                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_gfrc_bdedcfc1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_args,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    bool var_5;\n    const wp::float32 var_6 = 2.0;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.7;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_gfrc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.02:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 2.0                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.7                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 0.7                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_sub(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val - 2.0                                                            <L 8>\n    }\n    // adj: if val > 0.02:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gfrc(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gfrc_bdedcfc1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gfrc_bdedcfc1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gfrc_bdedcfc1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_args,\n    wp_args_branch_gfrc_bdedcfc1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gfrc_bdedcfc1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 259, "kernel_name": "scalar_arr_dlpc", "python": "@wp.kernel\ndef scalar_arr_dlpc(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_dlpc_24a45f0e {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_dlpc_24a45f0e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_dlpc(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_dlpc_24a45f0e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_args,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_dlpc(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_dlpc(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_dlpc_24a45f0e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dlpc_24a45f0e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_dlpc_24a45f0e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_args,\n    wp_args_scalar_arr_dlpc_24a45f0e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dlpc_24a45f0e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 260, "kernel_name": "nested_qmkr", "python": "@wp.kernel\ndef nested_qmkr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.12:\n        if val > 0.83:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_qmkr_4a2abd29 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_qmkr_4a2abd29_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_qmkr_4a2abd29 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 0.83;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_qmkr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.83:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_qmkr_4a2abd29_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_qmkr_4a2abd29 *_wp_args,\n    wp_args_nested_qmkr_4a2abd29 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 0.83;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_qmkr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.83:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.83:                                                                <L 8>\n    }\n    // adj: if val > -0.12:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_qmkr(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_qmkr_4a2abd29_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_qmkr_4a2abd29 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_qmkr_4a2abd29_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_qmkr_4a2abd29_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_qmkr_4a2abd29 *_wp_args,\n    wp_args_nested_qmkr_4a2abd29 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_qmkr_4a2abd29_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 261, "kernel_name": "scalar_arr_ddhd", "python": "@wp.kernel\ndef scalar_arr_ddhd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_ddhd_2532f6f2 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ddhd_2532f6f2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ddhd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_ddhd_2532f6f2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_args,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ddhd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ddhd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ddhd_2532f6f2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ddhd_2532f6f2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ddhd_2532f6f2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_args,\n    wp_args_scalar_arr_ddhd_2532f6f2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ddhd_2532f6f2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 262, "kernel_name": "elementwise_bbqp", "python": "@wp.kernel\ndef elementwise_bbqp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_bbqp_d6761d10 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bbqp_d6761d10_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bbqp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bbqp_d6761d10_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_args,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bbqp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bbqp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bbqp_d6761d10_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bbqp_d6761d10_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bbqp_d6761d10_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_args,\n    wp_args_elementwise_bbqp_d6761d10 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bbqp_d6761d10_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 263, "kernel_name": "vec_khhd", "python": "@wp.kernel\ndef vec_khhd(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_khhd_9f8bae97 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_khhd_9f8bae97_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_khhd_9f8bae97 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_khhd(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_khhd_9f8bae97_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_khhd_9f8bae97 *_wp_args,\n    wp_args_vec_khhd_9f8bae97 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_khhd(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_khhd(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_khhd_9f8bae97_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_khhd_9f8bae97 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_khhd_9f8bae97_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_khhd_9f8bae97_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_khhd_9f8bae97 *_wp_args,\n    wp_args_vec_khhd_9f8bae97 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_khhd_9f8bae97_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 264, "kernel_name": "unary_epha", "python": "@wp.kernel\ndef unary_epha(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_epha_ec7af645 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_epha_ec7af645_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_epha_ec7af645 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_epha(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_epha_ec7af645_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_epha_ec7af645 *_wp_args,\n    wp_args_unary_epha_ec7af645 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_epha(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_epha(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_epha_ec7af645_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_epha_ec7af645 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_epha_ec7af645_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_epha_ec7af645_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_epha_ec7af645 *_wp_args,\n    wp_args_unary_epha_ec7af645 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_epha_ec7af645_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 265, "kernel_name": "reduce_jvwc", "python": "@wp.kernel\ndef reduce_jvwc(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jvwc_edf7d923 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jvwc_edf7d923_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvwc_edf7d923 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jvwc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jvwc_edf7d923_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvwc_edf7d923 *_wp_args,\n    wp_args_reduce_jvwc_edf7d923 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jvwc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jvwc(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jvwc_edf7d923_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvwc_edf7d923 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvwc_edf7d923_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jvwc_edf7d923_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvwc_edf7d923 *_wp_args,\n    wp_args_reduce_jvwc_edf7d923 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvwc_edf7d923_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 266, "kernel_name": "branch_fssn", "python": "@wp.kernel\ndef branch_fssn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.6:\n        b[tid] = val + 2.8\n    else:\n        b[tid] = val * 1.2", "cpp": "struct wp_args_branch_fssn_b8b85717 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fssn_b8b85717_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fssn_b8b85717 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.6;\n    bool var_5;\n    const wp::float32 var_6 = 2.8;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.2;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fssn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.6:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.8                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.2                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fssn_b8b85717_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fssn_b8b85717 *_wp_args,\n    wp_args_branch_fssn_b8b85717 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.6;\n    bool var_5;\n    const wp::float32 var_6 = 2.8;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.2;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fssn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.6:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.8                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.2                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 1.2                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.8                                                            <L 8>\n    }\n    // adj: if val > 0.6:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fssn(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fssn_b8b85717_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fssn_b8b85717 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fssn_b8b85717_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fssn_b8b85717_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fssn_b8b85717 *_wp_args,\n    wp_args_branch_fssn_b8b85717 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fssn_b8b85717_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 267, "kernel_name": "elementwise_beiy", "python": "@wp.kernel\ndef elementwise_beiy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_beiy_d9660c19 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_beiy_d9660c19_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_beiy_d9660c19 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_beiy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_beiy_d9660c19_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_beiy_d9660c19 *_wp_args,\n    wp_args_elementwise_beiy_d9660c19 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_beiy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_beiy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_beiy_d9660c19_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_beiy_d9660c19 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_beiy_d9660c19_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_beiy_d9660c19_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_beiy_d9660c19 *_wp_args,\n    wp_args_elementwise_beiy_d9660c19 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_beiy_d9660c19_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 268, "kernel_name": "loop_vhnf", "python": "@wp.kernel\ndef loop_vhnf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_vhnf_174510fe {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_vhnf_174510fe_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_vhnf_174510fe *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_vhnf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_vhnf_174510fe_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_vhnf_174510fe *_wp_args,\n    wp_args_loop_vhnf_174510fe *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_vhnf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_vhnf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_vhnf_174510fe_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_vhnf_174510fe *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_vhnf_174510fe_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_vhnf_174510fe_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_vhnf_174510fe *_wp_args,\n    wp_args_loop_vhnf_174510fe *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_vhnf_174510fe_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 269, "kernel_name": "reduce_ynsw", "python": "@wp.kernel\ndef reduce_ynsw(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ynsw_1c164ca0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ynsw_1c164ca0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ynsw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ynsw_1c164ca0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_args,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ynsw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ynsw(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ynsw_1c164ca0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ynsw_1c164ca0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ynsw_1c164ca0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_args,\n    wp_args_reduce_ynsw_1c164ca0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ynsw_1c164ca0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 270, "kernel_name": "reduce_jkcd", "python": "@wp.kernel\ndef reduce_jkcd(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jkcd_6456bfaf {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jkcd_6456bfaf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jkcd_6456bfaf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jkcd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jkcd_6456bfaf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jkcd_6456bfaf *_wp_args,\n    wp_args_reduce_jkcd_6456bfaf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jkcd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jkcd(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jkcd_6456bfaf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jkcd_6456bfaf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jkcd_6456bfaf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jkcd_6456bfaf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jkcd_6456bfaf *_wp_args,\n    wp_args_reduce_jkcd_6456bfaf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jkcd_6456bfaf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 271, "kernel_name": "loop_gszo", "python": "@wp.kernel\ndef loop_gszo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gszo_3e219e16 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gszo_3e219e16_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gszo_3e219e16 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gszo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gszo_3e219e16_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gszo_3e219e16 *_wp_args,\n    wp_args_loop_gszo_3e219e16 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gszo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gszo(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gszo_3e219e16_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gszo_3e219e16 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gszo_3e219e16_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gszo_3e219e16_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gszo_3e219e16 *_wp_args,\n    wp_args_loop_gszo_3e219e16 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gszo_3e219e16_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 272, "kernel_name": "multi_ldsn", "python": "@wp.kernel\ndef multi_ldsn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_ldsn_f9940c1b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_ldsn_f9940c1b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ldsn_f9940c1b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_ldsn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_ldsn_f9940c1b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ldsn_f9940c1b *_wp_args,\n    wp_args_multi_ldsn_f9940c1b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_ldsn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_ldsn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_ldsn_f9940c1b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ldsn_f9940c1b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ldsn_f9940c1b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_ldsn_f9940c1b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ldsn_f9940c1b *_wp_args,\n    wp_args_multi_ldsn_f9940c1b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ldsn_f9940c1b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 273, "kernel_name": "compound_pnko", "python": "@wp.kernel\ndef compound_pnko(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pnko_597e9388 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pnko_597e9388_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pnko_597e9388 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pnko(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pnko_597e9388_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pnko_597e9388 *_wp_args,\n    wp_args_compound_pnko_597e9388 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pnko(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pnko(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pnko_597e9388_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pnko_597e9388 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pnko_597e9388_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pnko_597e9388_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pnko_597e9388 *_wp_args,\n    wp_args_compound_pnko_597e9388 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pnko_597e9388_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 274, "kernel_name": "loop_hehc", "python": "@wp.kernel\ndef loop_hehc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hehc_199c1d7c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hehc_199c1d7c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hehc_199c1d7c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hehc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hehc_199c1d7c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hehc_199c1d7c *_wp_args,\n    wp_args_loop_hehc_199c1d7c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hehc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hehc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hehc_199c1d7c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hehc_199c1d7c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hehc_199c1d7c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hehc_199c1d7c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hehc_199c1d7c *_wp_args,\n    wp_args_loop_hehc_199c1d7c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hehc_199c1d7c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 275, "kernel_name": "elementwise_btbv", "python": "@wp.kernel\ndef elementwise_btbv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_btbv_c69deb16 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_btbv_c69deb16_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_btbv_c69deb16 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_btbv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_btbv_c69deb16_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_btbv_c69deb16 *_wp_args,\n    wp_args_elementwise_btbv_c69deb16 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_btbv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_btbv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_btbv_c69deb16_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_btbv_c69deb16 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_btbv_c69deb16_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_btbv_c69deb16_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_btbv_c69deb16 *_wp_args,\n    wp_args_elementwise_btbv_c69deb16 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_btbv_c69deb16_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 276, "kernel_name": "unary_vkcs", "python": "@wp.kernel\ndef unary_vkcs(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_vkcs_cbf6f13c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_vkcs_cbf6f13c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_vkcs_cbf6f13c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_vkcs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_vkcs_cbf6f13c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_vkcs_cbf6f13c *_wp_args,\n    wp_args_unary_vkcs_cbf6f13c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_vkcs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_vkcs(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_vkcs_cbf6f13c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_vkcs_cbf6f13c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_vkcs_cbf6f13c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_vkcs_cbf6f13c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_vkcs_cbf6f13c *_wp_args,\n    wp_args_unary_vkcs_cbf6f13c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_vkcs_cbf6f13c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 277, "kernel_name": "unary_enou", "python": "@wp.kernel\ndef unary_enou(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_enou_d4013434 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_enou_d4013434_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_enou_d4013434 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_enou(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_enou_d4013434_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_enou_d4013434 *_wp_args,\n    wp_args_unary_enou_d4013434 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_enou(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_enou(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_enou_d4013434_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_enou_d4013434 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_enou_d4013434_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_enou_d4013434_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_enou_d4013434 *_wp_args,\n    wp_args_unary_enou_d4013434 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_enou_d4013434_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 278, "kernel_name": "branch_xowp", "python": "@wp.kernel\ndef branch_xowp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.93:\n        b[tid] = val + 2.3\n    else:\n        b[tid] = val * 1.6", "cpp": "struct wp_args_branch_xowp_8895187b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_xowp_8895187b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_xowp_8895187b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.93;\n    bool var_5;\n    const wp::float32 var_6 = 2.3;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.6;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_xowp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.93:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.3                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_xowp_8895187b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_xowp_8895187b *_wp_args,\n    wp_args_branch_xowp_8895187b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.93;\n    bool var_5;\n    const wp::float32 var_6 = 2.3;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.6;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_xowp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.93:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.3                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 1.6                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.3                                                            <L 8>\n    }\n    // adj: if val > 0.93:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_xowp(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_xowp_8895187b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_xowp_8895187b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_xowp_8895187b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_xowp_8895187b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_xowp_8895187b *_wp_args,\n    wp_args_branch_xowp_8895187b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_xowp_8895187b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 279, "kernel_name": "compound_qnaj", "python": "@wp.kernel\ndef compound_qnaj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qnaj_d63dca37 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qnaj_d63dca37_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qnaj_d63dca37 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qnaj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qnaj_d63dca37_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qnaj_d63dca37 *_wp_args,\n    wp_args_compound_qnaj_d63dca37 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qnaj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qnaj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qnaj_d63dca37_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qnaj_d63dca37 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qnaj_d63dca37_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qnaj_d63dca37_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qnaj_d63dca37 *_wp_args,\n    wp_args_compound_qnaj_d63dca37 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qnaj_d63dca37_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 280, "kernel_name": "loop_qsvw", "python": "@wp.kernel\ndef loop_qsvw(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_qsvw_01637a42 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_qsvw_01637a42_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qsvw_01637a42 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_qsvw(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_qsvw_01637a42_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qsvw_01637a42 *_wp_args,\n    wp_args_loop_qsvw_01637a42 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_qsvw(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_qsvw(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_qsvw_01637a42_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qsvw_01637a42 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qsvw_01637a42_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_qsvw_01637a42_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qsvw_01637a42 *_wp_args,\n    wp_args_loop_qsvw_01637a42 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qsvw_01637a42_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 281, "kernel_name": "elementwise_asci", "python": "@wp.kernel\ndef elementwise_asci(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_asci_4e6d2457 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_asci_4e6d2457_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_asci_4e6d2457 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_asci(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_asci_4e6d2457_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_asci_4e6d2457 *_wp_args,\n    wp_args_elementwise_asci_4e6d2457 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_asci(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_asci(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_asci_4e6d2457_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_asci_4e6d2457 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_asci_4e6d2457_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_asci_4e6d2457_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_asci_4e6d2457 *_wp_args,\n    wp_args_elementwise_asci_4e6d2457 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_asci_4e6d2457_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 282, "kernel_name": "scalar_arr_cqmb", "python": "@wp.kernel\ndef scalar_arr_cqmb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_cqmb_dc1be10b {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cqmb_dc1be10b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cqmb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_cqmb_dc1be10b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_args,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cqmb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cqmb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cqmb_dc1be10b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cqmb_dc1be10b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cqmb_dc1be10b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_args,\n    wp_args_scalar_arr_cqmb_dc1be10b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cqmb_dc1be10b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 283, "kernel_name": "compound_upnq", "python": "@wp.kernel\ndef compound_upnq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_upnq_3f2773a3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_upnq_3f2773a3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_upnq_3f2773a3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_upnq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_upnq_3f2773a3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_upnq_3f2773a3 *_wp_args,\n    wp_args_compound_upnq_3f2773a3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_upnq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_upnq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_upnq_3f2773a3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_upnq_3f2773a3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_upnq_3f2773a3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_upnq_3f2773a3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_upnq_3f2773a3 *_wp_args,\n    wp_args_compound_upnq_3f2773a3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_upnq_3f2773a3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 284, "kernel_name": "reduce_xbsx", "python": "@wp.kernel\ndef reduce_xbsx(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xbsx_1928e1df {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xbsx_1928e1df_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xbsx_1928e1df *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xbsx(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xbsx_1928e1df_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xbsx_1928e1df *_wp_args,\n    wp_args_reduce_xbsx_1928e1df *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xbsx(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xbsx(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xbsx_1928e1df_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xbsx_1928e1df *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xbsx_1928e1df_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xbsx_1928e1df_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xbsx_1928e1df *_wp_args,\n    wp_args_reduce_xbsx_1928e1df *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xbsx_1928e1df_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 285, "kernel_name": "loop_gzjf", "python": "@wp.kernel\ndef loop_gzjf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gzjf_1654972c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gzjf_1654972c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gzjf_1654972c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gzjf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gzjf_1654972c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gzjf_1654972c *_wp_args,\n    wp_args_loop_gzjf_1654972c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gzjf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gzjf(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gzjf_1654972c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gzjf_1654972c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gzjf_1654972c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gzjf_1654972c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gzjf_1654972c *_wp_args,\n    wp_args_loop_gzjf_1654972c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gzjf_1654972c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 286, "kernel_name": "branch_vuwf", "python": "@wp.kernel\ndef branch_vuwf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.33:\n        b[tid] = val - 1.4\n    else:\n        b[tid] = val + 0.9", "cpp": "struct wp_args_branch_vuwf_e61b910a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_vuwf_e61b910a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_vuwf_e61b910a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.33;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_vuwf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.33:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_vuwf_e61b910a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_vuwf_e61b910a *_wp_args,\n    wp_args_branch_vuwf_e61b910a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.33;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_vuwf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.33:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 0.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_sub(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val - 1.4                                                            <L 8>\n    }\n    // adj: if val > 0.33:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_vuwf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_vuwf_e61b910a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_vuwf_e61b910a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_vuwf_e61b910a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_vuwf_e61b910a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_vuwf_e61b910a *_wp_args,\n    wp_args_branch_vuwf_e61b910a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_vuwf_e61b910a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 287, "kernel_name": "nested_opda", "python": "@wp.kernel\ndef nested_opda(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.39:\n        if val > 1.3:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_opda_2bdcf89a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_opda_2bdcf89a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_opda_2bdcf89a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_opda(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.3:                                                                      <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_opda_2bdcf89a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_opda_2bdcf89a *_wp_args,\n    wp_args_nested_opda_2bdcf89a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_opda(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.3:                                                                      <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.3:                                                                 <L 8>\n    }\n    // adj: if val > -0.39:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_opda(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_opda_2bdcf89a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_opda_2bdcf89a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_opda_2bdcf89a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_opda_2bdcf89a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_opda_2bdcf89a *_wp_args,\n    wp_args_nested_opda_2bdcf89a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_opda_2bdcf89a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 288, "kernel_name": "scalar_arr_crqb", "python": "@wp.kernel\ndef scalar_arr_crqb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_crqb_0a84aff4 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_crqb_0a84aff4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_crqb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_crqb_0a84aff4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_args,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_crqb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_crqb(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_crqb_0a84aff4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_crqb_0a84aff4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_crqb_0a84aff4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_args,\n    wp_args_scalar_arr_crqb_0a84aff4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_crqb_0a84aff4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 289, "kernel_name": "elementwise_blij", "python": "@wp.kernel\ndef elementwise_blij(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_blij_19e5f149 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_blij_19e5f149_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_blij_19e5f149 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_blij(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_blij_19e5f149_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_blij_19e5f149 *_wp_args,\n    wp_args_elementwise_blij_19e5f149 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_blij(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_blij(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_blij_19e5f149_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_blij_19e5f149 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_blij_19e5f149_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_blij_19e5f149_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_blij_19e5f149 *_wp_args,\n    wp_args_elementwise_blij_19e5f149 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_blij_19e5f149_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 290, "kernel_name": "loop_gkoe", "python": "@wp.kernel\ndef loop_gkoe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gkoe_3c58484c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gkoe_3c58484c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gkoe_3c58484c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gkoe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gkoe_3c58484c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gkoe_3c58484c *_wp_args,\n    wp_args_loop_gkoe_3c58484c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gkoe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gkoe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gkoe_3c58484c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gkoe_3c58484c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gkoe_3c58484c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gkoe_3c58484c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gkoe_3c58484c *_wp_args,\n    wp_args_loop_gkoe_3c58484c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gkoe_3c58484c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 291, "kernel_name": "loop_qhcc", "python": "@wp.kernel\ndef loop_qhcc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_qhcc_e204f2a6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_qhcc_e204f2a6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qhcc_e204f2a6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_qhcc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_qhcc_e204f2a6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qhcc_e204f2a6 *_wp_args,\n    wp_args_loop_qhcc_e204f2a6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_qhcc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_qhcc(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_qhcc_e204f2a6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qhcc_e204f2a6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qhcc_e204f2a6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_qhcc_e204f2a6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qhcc_e204f2a6 *_wp_args,\n    wp_args_loop_qhcc_e204f2a6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qhcc_e204f2a6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 292, "kernel_name": "reduce_itdd", "python": "@wp.kernel\ndef reduce_itdd(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_itdd_22565120 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_itdd_22565120_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_itdd_22565120 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_itdd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_itdd_22565120_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_itdd_22565120 *_wp_args,\n    wp_args_reduce_itdd_22565120 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_itdd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_itdd(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_itdd_22565120_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_itdd_22565120 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_itdd_22565120_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_itdd_22565120_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_itdd_22565120 *_wp_args,\n    wp_args_reduce_itdd_22565120 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_itdd_22565120_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 293, "kernel_name": "unary_uzdj", "python": "@wp.kernel\ndef unary_uzdj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_uzdj_919d4035 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_uzdj_919d4035_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_uzdj_919d4035 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_uzdj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_uzdj_919d4035_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_uzdj_919d4035 *_wp_args,\n    wp_args_unary_uzdj_919d4035 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_uzdj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_uzdj(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_uzdj_919d4035_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_uzdj_919d4035 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_uzdj_919d4035_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_uzdj_919d4035_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_uzdj_919d4035 *_wp_args,\n    wp_args_unary_uzdj_919d4035 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_uzdj_919d4035_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 294, "kernel_name": "reduce_zkoy", "python": "@wp.kernel\ndef reduce_zkoy(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_zkoy_3ac02da7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_zkoy_3ac02da7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_zkoy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_zkoy_3ac02da7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_args,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_zkoy(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_zkoy(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_zkoy_3ac02da7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zkoy_3ac02da7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_zkoy_3ac02da7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_args,\n    wp_args_reduce_zkoy_3ac02da7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zkoy_3ac02da7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 295, "kernel_name": "nested_ymle", "python": "@wp.kernel\ndef nested_ymle(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.06:\n        if val > 0.63:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ymle_d3cb1db5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ymle_d3cb1db5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ymle_d3cb1db5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 0.63;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ymle(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.63:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ymle_d3cb1db5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ymle_d3cb1db5 *_wp_args,\n    wp_args_nested_ymle_d3cb1db5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 0.63;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ymle(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.63:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.63:                                                                <L 8>\n    }\n    // adj: if val > -0.06:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ymle(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ymle_d3cb1db5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ymle_d3cb1db5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ymle_d3cb1db5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ymle_d3cb1db5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ymle_d3cb1db5 *_wp_args,\n    wp_args_nested_ymle_d3cb1db5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ymle_d3cb1db5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 296, "kernel_name": "loop_qhsd", "python": "@wp.kernel\ndef loop_qhsd(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_qhsd_f0ca5b62 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_qhsd_f0ca5b62_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_qhsd(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_qhsd_f0ca5b62_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_args,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_qhsd(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_qhsd(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_qhsd_f0ca5b62_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qhsd_f0ca5b62_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_qhsd_f0ca5b62_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_args,\n    wp_args_loop_qhsd_f0ca5b62 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qhsd_f0ca5b62_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 297, "kernel_name": "compound_parq", "python": "@wp.kernel\ndef compound_parq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_parq_e6d49194 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_parq_e6d49194_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_parq_e6d49194 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_parq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_parq_e6d49194_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_parq_e6d49194 *_wp_args,\n    wp_args_compound_parq_e6d49194 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_parq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_parq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_parq_e6d49194_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_parq_e6d49194 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_parq_e6d49194_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_parq_e6d49194_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_parq_e6d49194 *_wp_args,\n    wp_args_compound_parq_e6d49194 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_parq_e6d49194_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 298, "kernel_name": "elementwise_xnnc", "python": "@wp.kernel\ndef elementwise_xnnc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_xnnc_2445a0c9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_xnnc_2445a0c9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_xnnc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_xnnc_2445a0c9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_args,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_xnnc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_xnnc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_xnnc_2445a0c9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_xnnc_2445a0c9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_xnnc_2445a0c9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_args,\n    wp_args_elementwise_xnnc_2445a0c9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_xnnc_2445a0c9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 299, "kernel_name": "branch_gozb", "python": "@wp.kernel\ndef branch_gozb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.82:\n        b[tid] = val - 2.2\n    else:\n        b[tid] = val + 2.2", "cpp": "struct wp_args_branch_gozb_700b5bdb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gozb_700b5bdb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gozb_700b5bdb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.82;\n    const wp::float32 var_5 = -0.82;\n    bool var_6;\n    const wp::float32 var_7 = 2.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.2;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_gozb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.82:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.2                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_gozb_700b5bdb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gozb_700b5bdb *_wp_args,\n    wp_args_branch_gozb_700b5bdb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.82;\n    const wp::float32 var_5 = -0.82;\n    bool var_6;\n    const wp::float32 var_7 = 2.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.2;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_gozb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.82:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.2                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.2                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 2.2                                                            <L 8>\n    }\n    // adj: if val > -0.82:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gozb(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gozb_700b5bdb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gozb_700b5bdb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gozb_700b5bdb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gozb_700b5bdb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gozb_700b5bdb *_wp_args,\n    wp_args_branch_gozb_700b5bdb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gozb_700b5bdb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 300, "kernel_name": "multi_qmja", "python": "@wp.kernel\ndef multi_qmja(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_qmja_eb1ed5bc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_qmja_eb1ed5bc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_qmja_eb1ed5bc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_qmja(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_qmja_eb1ed5bc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_qmja_eb1ed5bc *_wp_args,\n    wp_args_multi_qmja_eb1ed5bc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_qmja(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_qmja(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_qmja_eb1ed5bc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_qmja_eb1ed5bc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_qmja_eb1ed5bc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_qmja_eb1ed5bc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_qmja_eb1ed5bc *_wp_args,\n    wp_args_multi_qmja_eb1ed5bc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_qmja_eb1ed5bc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 301, "kernel_name": "unary_ekzl", "python": "@wp.kernel\ndef unary_ekzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_ekzl_392afab0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_ekzl_392afab0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ekzl_392afab0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_ekzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_ekzl_392afab0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ekzl_392afab0 *_wp_args,\n    wp_args_unary_ekzl_392afab0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_ekzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_ekzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_ekzl_392afab0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ekzl_392afab0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ekzl_392afab0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_ekzl_392afab0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ekzl_392afab0 *_wp_args,\n    wp_args_unary_ekzl_392afab0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ekzl_392afab0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 302, "kernel_name": "elementwise_apwk", "python": "@wp.kernel\ndef elementwise_apwk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_apwk_c571e005 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_apwk_c571e005_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_apwk_c571e005 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_apwk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_apwk_c571e005_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_apwk_c571e005 *_wp_args,\n    wp_args_elementwise_apwk_c571e005 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_apwk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_apwk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_apwk_c571e005_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_apwk_c571e005 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_apwk_c571e005_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_apwk_c571e005_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_apwk_c571e005 *_wp_args,\n    wp_args_elementwise_apwk_c571e005 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_apwk_c571e005_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 303, "kernel_name": "loop_helz", "python": "@wp.kernel\ndef loop_helz(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_helz_b0589b1f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_helz_b0589b1f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_helz_b0589b1f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_helz(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_helz_b0589b1f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_helz_b0589b1f *_wp_args,\n    wp_args_loop_helz_b0589b1f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_helz(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_helz(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_helz_b0589b1f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_helz_b0589b1f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_helz_b0589b1f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_helz_b0589b1f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_helz_b0589b1f *_wp_args,\n    wp_args_loop_helz_b0589b1f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_helz_b0589b1f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 304, "kernel_name": "unary_doug", "python": "@wp.kernel\ndef unary_doug(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_doug_0a3a926e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_doug_0a3a926e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_doug_0a3a926e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_doug(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_doug_0a3a926e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_doug_0a3a926e *_wp_args,\n    wp_args_unary_doug_0a3a926e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_doug(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_doug(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_doug_0a3a926e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_doug_0a3a926e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_doug_0a3a926e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_doug_0a3a926e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_doug_0a3a926e *_wp_args,\n    wp_args_unary_doug_0a3a926e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_doug_0a3a926e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 305, "kernel_name": "loop_gqxe", "python": "@wp.kernel\ndef loop_gqxe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gqxe_f392e1af {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gqxe_f392e1af_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqxe_f392e1af *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gqxe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gqxe_f392e1af_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqxe_f392e1af *_wp_args,\n    wp_args_loop_gqxe_f392e1af *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gqxe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gqxe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gqxe_f392e1af_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqxe_f392e1af *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqxe_f392e1af_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gqxe_f392e1af_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqxe_f392e1af *_wp_args,\n    wp_args_loop_gqxe_f392e1af *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqxe_f392e1af_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 306, "kernel_name": "unary_ewpl", "python": "@wp.kernel\ndef unary_ewpl(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_ewpl_c5f72742 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_ewpl_c5f72742_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ewpl_c5f72742 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_ewpl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_ewpl_c5f72742_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ewpl_c5f72742 *_wp_args,\n    wp_args_unary_ewpl_c5f72742 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_ewpl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_ewpl(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_ewpl_c5f72742_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ewpl_c5f72742 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ewpl_c5f72742_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_ewpl_c5f72742_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ewpl_c5f72742 *_wp_args,\n    wp_args_unary_ewpl_c5f72742 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ewpl_c5f72742_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 307, "kernel_name": "scalar_arr_ycjd", "python": "@wp.kernel\ndef scalar_arr_ycjd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_ycjd_3bb00336 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ycjd_3bb00336_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ycjd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_ycjd_3bb00336_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_args,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ycjd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ycjd(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ycjd_3bb00336_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ycjd_3bb00336_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ycjd_3bb00336_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_args,\n    wp_args_scalar_arr_ycjd_3bb00336 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ycjd_3bb00336_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 308, "kernel_name": "compound_ptev", "python": "@wp.kernel\ndef compound_ptev(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ptev_1276eda0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ptev_1276eda0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ptev_1276eda0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ptev(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ptev_1276eda0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ptev_1276eda0 *_wp_args,\n    wp_args_compound_ptev_1276eda0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ptev(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ptev(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ptev_1276eda0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ptev_1276eda0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ptev_1276eda0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ptev_1276eda0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ptev_1276eda0 *_wp_args,\n    wp_args_compound_ptev_1276eda0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ptev_1276eda0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 309, "kernel_name": "reduce_jltz", "python": "@wp.kernel\ndef reduce_jltz(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jltz_595b8558 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jltz_595b8558_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jltz_595b8558 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jltz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jltz_595b8558_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jltz_595b8558 *_wp_args,\n    wp_args_reduce_jltz_595b8558 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jltz(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jltz(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jltz_595b8558_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jltz_595b8558 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jltz_595b8558_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jltz_595b8558_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jltz_595b8558 *_wp_args,\n    wp_args_reduce_jltz_595b8558 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jltz_595b8558_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 310, "kernel_name": "multi_lcpa", "python": "@wp.kernel\ndef multi_lcpa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_lcpa_1a1e8149 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lcpa_1a1e8149_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lcpa_1a1e8149 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lcpa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lcpa_1a1e8149_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lcpa_1a1e8149 *_wp_args,\n    wp_args_multi_lcpa_1a1e8149 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lcpa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lcpa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lcpa_1a1e8149_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lcpa_1a1e8149 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lcpa_1a1e8149_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lcpa_1a1e8149_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lcpa_1a1e8149 *_wp_args,\n    wp_args_multi_lcpa_1a1e8149 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lcpa_1a1e8149_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 311, "kernel_name": "branch_frfp", "python": "@wp.kernel\ndef branch_frfp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.5:\n        b[tid] = val + 2.2\n    else:\n        b[tid] = val + 0.8", "cpp": "struct wp_args_branch_frfp_7052cc37 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_frfp_7052cc37_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frfp_7052cc37 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.5;\n    bool var_5;\n    const wp::float32 var_6 = 2.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_frfp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.5:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.2                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.8                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_frfp_7052cc37_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_frfp_7052cc37 *_wp_args,\n    wp_args_branch_frfp_7052cc37 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.5;\n    bool var_5;\n    const wp::float32 var_6 = 2.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_frfp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.5:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.2                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 0.8                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 0.8                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.2                                                            <L 8>\n    }\n    // adj: if val > 0.5:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_frfp(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_frfp_7052cc37_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frfp_7052cc37 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frfp_7052cc37_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_frfp_7052cc37_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_frfp_7052cc37 *_wp_args,\n    wp_args_branch_frfp_7052cc37 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_frfp_7052cc37_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 312, "kernel_name": "multi_lcus", "python": "@wp.kernel\ndef multi_lcus(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lcus_8768c887 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lcus_8768c887_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lcus_8768c887 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lcus(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lcus_8768c887_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lcus_8768c887 *_wp_args,\n    wp_args_multi_lcus_8768c887 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lcus(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lcus(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lcus_8768c887_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lcus_8768c887 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lcus_8768c887_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lcus_8768c887_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lcus_8768c887 *_wp_args,\n    wp_args_multi_lcus_8768c887 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lcus_8768c887_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 313, "kernel_name": "vec_kwvf", "python": "@wp.kernel\ndef vec_kwvf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kwvf_2800d607 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kwvf_2800d607_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kwvf_2800d607 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kwvf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kwvf_2800d607_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kwvf_2800d607 *_wp_args,\n    wp_args_vec_kwvf_2800d607 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kwvf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kwvf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kwvf_2800d607_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kwvf_2800d607 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kwvf_2800d607_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kwvf_2800d607_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kwvf_2800d607 *_wp_args,\n    wp_args_vec_kwvf_2800d607 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kwvf_2800d607_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 314, "kernel_name": "compound_umch", "python": "@wp.kernel\ndef compound_umch(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_umch_1e006f0c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_umch_1e006f0c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_umch_1e006f0c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_umch(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_umch_1e006f0c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_umch_1e006f0c *_wp_args,\n    wp_args_compound_umch_1e006f0c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_umch(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_umch(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_umch_1e006f0c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_umch_1e006f0c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_umch_1e006f0c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_umch_1e006f0c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_umch_1e006f0c *_wp_args,\n    wp_args_compound_umch_1e006f0c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_umch_1e006f0c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 315, "kernel_name": "reduce_ixez", "python": "@wp.kernel\ndef reduce_ixez(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ixez_0ab8ee3b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ixez_0ab8ee3b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ixez(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ixez_0ab8ee3b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_args,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ixez(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ixez(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ixez_0ab8ee3b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixez_0ab8ee3b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ixez_0ab8ee3b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_args,\n    wp_args_reduce_ixez_0ab8ee3b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixez_0ab8ee3b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 316, "kernel_name": "multi_mbhx", "python": "@wp.kernel\ndef multi_mbhx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_mbhx_0f005288 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mbhx_0f005288_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mbhx_0f005288 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mbhx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mbhx_0f005288_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mbhx_0f005288 *_wp_args,\n    wp_args_multi_mbhx_0f005288 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mbhx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mbhx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mbhx_0f005288_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mbhx_0f005288 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mbhx_0f005288_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mbhx_0f005288_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mbhx_0f005288 *_wp_args,\n    wp_args_multi_mbhx_0f005288 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mbhx_0f005288_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 317, "kernel_name": "multi_lofg", "python": "@wp.kernel\ndef multi_lofg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lofg_4af4f7ea {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lofg_4af4f7ea_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lofg_4af4f7ea *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lofg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lofg_4af4f7ea_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lofg_4af4f7ea *_wp_args,\n    wp_args_multi_lofg_4af4f7ea *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lofg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lofg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lofg_4af4f7ea_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lofg_4af4f7ea *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lofg_4af4f7ea_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lofg_4af4f7ea_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lofg_4af4f7ea *_wp_args,\n    wp_args_multi_lofg_4af4f7ea *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lofg_4af4f7ea_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 318, "kernel_name": "vec_jgbv", "python": "@wp.kernel\ndef vec_jgbv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_jgbv_b7ec78fc {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_jgbv_b7ec78fc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jgbv_b7ec78fc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_jgbv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_jgbv_b7ec78fc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jgbv_b7ec78fc *_wp_args,\n    wp_args_vec_jgbv_b7ec78fc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_jgbv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_jgbv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_jgbv_b7ec78fc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jgbv_b7ec78fc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jgbv_b7ec78fc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_jgbv_b7ec78fc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jgbv_b7ec78fc *_wp_args,\n    wp_args_vec_jgbv_b7ec78fc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jgbv_b7ec78fc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 319, "kernel_name": "elementwise_ublg", "python": "@wp.kernel\ndef elementwise_ublg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_ublg_e9ef2e25 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ublg_e9ef2e25_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ublg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ublg_e9ef2e25_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_args,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ublg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ublg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ublg_e9ef2e25_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ublg_e9ef2e25_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ublg_e9ef2e25_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_args,\n    wp_args_elementwise_ublg_e9ef2e25 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ublg_e9ef2e25_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 320, "kernel_name": "nested_nxeq", "python": "@wp.kernel\ndef nested_nxeq(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.15:\n        if val > 1.17:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nxeq_d4be1f40 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nxeq_d4be1f40_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nxeq_d4be1f40 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 1.17;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nxeq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.17:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nxeq_d4be1f40_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nxeq_d4be1f40 *_wp_args,\n    wp_args_nested_nxeq_d4be1f40 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 1.17;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nxeq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.17:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.17:                                                                <L 8>\n    }\n    // adj: if val > -0.15:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nxeq(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nxeq_d4be1f40_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nxeq_d4be1f40 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nxeq_d4be1f40_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nxeq_d4be1f40_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nxeq_d4be1f40 *_wp_args,\n    wp_args_nested_nxeq_d4be1f40 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nxeq_d4be1f40_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 321, "kernel_name": "vec_ttlu", "python": "@wp.kernel\ndef vec_ttlu(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_ttlu_36a5097d {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_ttlu_36a5097d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ttlu_36a5097d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_ttlu(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_ttlu_36a5097d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ttlu_36a5097d *_wp_args,\n    wp_args_vec_ttlu_36a5097d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_ttlu(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ttlu(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ttlu_36a5097d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ttlu_36a5097d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ttlu_36a5097d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ttlu_36a5097d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ttlu_36a5097d *_wp_args,\n    wp_args_vec_ttlu_36a5097d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ttlu_36a5097d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 322, "kernel_name": "nested_ynnl", "python": "@wp.kernel\ndef nested_ynnl(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.28:\n        if val > 0.85:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ynnl_41a86ee7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ynnl_41a86ee7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ynnl_41a86ee7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.28;\n    const wp::float32 var_5 = -0.28;\n    bool var_6;\n    const wp::float32 var_7 = 0.85;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ynnl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.28:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.85:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ynnl_41a86ee7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ynnl_41a86ee7 *_wp_args,\n    wp_args_nested_ynnl_41a86ee7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.28;\n    const wp::float32 var_5 = -0.28;\n    bool var_6;\n    const wp::float32 var_7 = 0.85;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ynnl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.28:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.85:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.85:                                                                <L 8>\n    }\n    // adj: if val > -0.28:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ynnl(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ynnl_41a86ee7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ynnl_41a86ee7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ynnl_41a86ee7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ynnl_41a86ee7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ynnl_41a86ee7 *_wp_args,\n    wp_args_nested_ynnl_41a86ee7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ynnl_41a86ee7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 323, "kernel_name": "loop_gian", "python": "@wp.kernel\ndef loop_gian(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gian_fa14ef95 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gian_fa14ef95_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gian_fa14ef95 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gian(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gian_fa14ef95_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gian_fa14ef95 *_wp_args,\n    wp_args_loop_gian_fa14ef95 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gian(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gian(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gian_fa14ef95_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gian_fa14ef95 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gian_fa14ef95_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gian_fa14ef95_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gian_fa14ef95 *_wp_args,\n    wp_args_loop_gian_fa14ef95 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gian_fa14ef95_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 324, "kernel_name": "vec_jcuk", "python": "@wp.kernel\ndef vec_jcuk(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_jcuk_f44659da {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_jcuk_f44659da_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jcuk_f44659da *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_jcuk(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_jcuk_f44659da_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jcuk_f44659da *_wp_args,\n    wp_args_vec_jcuk_f44659da *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_jcuk(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_jcuk(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_jcuk_f44659da_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jcuk_f44659da *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jcuk_f44659da_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_jcuk_f44659da_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jcuk_f44659da *_wp_args,\n    wp_args_vec_jcuk_f44659da *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jcuk_f44659da_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 325, "kernel_name": "elementwise_sqjw", "python": "@wp.kernel\ndef elementwise_sqjw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_sqjw_cad5861c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_sqjw_cad5861c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_sqjw_cad5861c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_sqjw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_sqjw_cad5861c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_sqjw_cad5861c *_wp_args,\n    wp_args_elementwise_sqjw_cad5861c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_sqjw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_sqjw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_sqjw_cad5861c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_sqjw_cad5861c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_sqjw_cad5861c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_sqjw_cad5861c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_sqjw_cad5861c *_wp_args,\n    wp_args_elementwise_sqjw_cad5861c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_sqjw_cad5861c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 326, "kernel_name": "reduce_yfuu", "python": "@wp.kernel\ndef reduce_yfuu(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_yfuu_184a192b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_yfuu_184a192b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_yfuu_184a192b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_yfuu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_yfuu_184a192b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_yfuu_184a192b *_wp_args,\n    wp_args_reduce_yfuu_184a192b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_yfuu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_yfuu(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_yfuu_184a192b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_yfuu_184a192b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_yfuu_184a192b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_yfuu_184a192b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_yfuu_184a192b *_wp_args,\n    wp_args_reduce_yfuu_184a192b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_yfuu_184a192b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 327, "kernel_name": "nested_nfzl", "python": "@wp.kernel\ndef nested_nfzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.42:\n        if val > 1.39:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nfzl_2a0d765d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nfzl_2a0d765d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nfzl_2a0d765d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.42;\n    const wp::float32 var_5 = -0.42;\n    bool var_6;\n    const wp::float32 var_7 = 1.39;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nfzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.42:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.39:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nfzl_2a0d765d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nfzl_2a0d765d *_wp_args,\n    wp_args_nested_nfzl_2a0d765d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.42;\n    const wp::float32 var_5 = -0.42;\n    bool var_6;\n    const wp::float32 var_7 = 1.39;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nfzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.42:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.39:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.39:                                                                <L 8>\n    }\n    // adj: if val > -0.42:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nfzl(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nfzl_2a0d765d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nfzl_2a0d765d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nfzl_2a0d765d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nfzl_2a0d765d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nfzl_2a0d765d *_wp_args,\n    wp_args_nested_nfzl_2a0d765d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nfzl_2a0d765d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 328, "kernel_name": "loop_gmra", "python": "@wp.kernel\ndef loop_gmra(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gmra_e24a482f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gmra_e24a482f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gmra_e24a482f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gmra(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gmra_e24a482f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gmra_e24a482f *_wp_args,\n    wp_args_loop_gmra_e24a482f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gmra(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gmra(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gmra_e24a482f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gmra_e24a482f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gmra_e24a482f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gmra_e24a482f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gmra_e24a482f *_wp_args,\n    wp_args_loop_gmra_e24a482f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gmra_e24a482f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 329, "kernel_name": "multi_zvou", "python": "@wp.kernel\ndef multi_zvou(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_zvou_8e2ea3c2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_zvou_8e2ea3c2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_zvou(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_zvou_8e2ea3c2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_args,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_zvou(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_zvou(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_zvou_8e2ea3c2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_zvou_8e2ea3c2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_zvou_8e2ea3c2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_args,\n    wp_args_multi_zvou_8e2ea3c2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_zvou_8e2ea3c2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 330, "kernel_name": "branch_tvsx", "python": "@wp.kernel\ndef branch_tvsx(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.52:\n        b[tid] = val - 2.6\n    else:\n        b[tid] = val - 2.4", "cpp": "struct wp_args_branch_tvsx_e727daf0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_tvsx_e727daf0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_tvsx_e727daf0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.52;\n    const wp::float32 var_5 = -0.52;\n    bool var_6;\n    const wp::float32 var_7 = 2.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.4;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_tvsx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.52:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.4                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_tvsx_e727daf0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_tvsx_e727daf0 *_wp_args,\n    wp_args_branch_tvsx_e727daf0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.52;\n    const wp::float32 var_5 = -0.52;\n    bool var_6;\n    const wp::float32 var_7 = 2.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.4;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_tvsx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.52:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.4                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.4                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 2.6                                                            <L 8>\n    }\n    // adj: if val > -0.52:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_tvsx(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_tvsx_e727daf0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_tvsx_e727daf0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_tvsx_e727daf0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_tvsx_e727daf0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_tvsx_e727daf0 *_wp_args,\n    wp_args_branch_tvsx_e727daf0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_tvsx_e727daf0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 331, "kernel_name": "elementwise_aogi", "python": "@wp.kernel\ndef elementwise_aogi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_aogi_6e5f01e6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aogi_6e5f01e6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aogi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aogi_6e5f01e6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_args,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aogi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aogi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aogi_6e5f01e6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aogi_6e5f01e6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aogi_6e5f01e6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_args,\n    wp_args_elementwise_aogi_6e5f01e6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aogi_6e5f01e6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 332, "kernel_name": "elementwise_bmtd", "python": "@wp.kernel\ndef elementwise_bmtd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_bmtd_9f8faad0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bmtd_9f8faad0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bmtd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bmtd_9f8faad0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_args,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bmtd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bmtd(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bmtd_9f8faad0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bmtd_9f8faad0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bmtd_9f8faad0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_args,\n    wp_args_elementwise_bmtd_9f8faad0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bmtd_9f8faad0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 333, "kernel_name": "loop_sghe", "python": "@wp.kernel\ndef loop_sghe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_sghe_a07e1dfc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_sghe_a07e1dfc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_sghe_a07e1dfc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_sghe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_sghe_a07e1dfc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_sghe_a07e1dfc *_wp_args,\n    wp_args_loop_sghe_a07e1dfc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_sghe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_sghe(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_sghe_a07e1dfc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_sghe_a07e1dfc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_sghe_a07e1dfc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_sghe_a07e1dfc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_sghe_a07e1dfc *_wp_args,\n    wp_args_loop_sghe_a07e1dfc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_sghe_a07e1dfc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 334, "kernel_name": "unary_elgs", "python": "@wp.kernel\ndef unary_elgs(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_elgs_96613c2e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_elgs_96613c2e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_elgs_96613c2e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_elgs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_elgs_96613c2e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_elgs_96613c2e *_wp_args,\n    wp_args_unary_elgs_96613c2e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_elgs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_elgs(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_elgs_96613c2e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_elgs_96613c2e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_elgs_96613c2e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_elgs_96613c2e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_elgs_96613c2e *_wp_args,\n    wp_args_unary_elgs_96613c2e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_elgs_96613c2e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 335, "kernel_name": "elementwise_aduh", "python": "@wp.kernel\ndef elementwise_aduh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_aduh_9732c3c9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aduh_9732c3c9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aduh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aduh_9732c3c9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_args,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aduh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aduh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aduh_9732c3c9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aduh_9732c3c9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aduh_9732c3c9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_args,\n    wp_args_elementwise_aduh_9732c3c9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aduh_9732c3c9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 336, "kernel_name": "elementwise_axub", "python": "@wp.kernel\ndef elementwise_axub(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_axub_226d82c1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_axub_226d82c1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_axub_226d82c1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_axub(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_axub_226d82c1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_axub_226d82c1 *_wp_args,\n    wp_args_elementwise_axub_226d82c1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_axub(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_axub(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_axub_226d82c1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_axub_226d82c1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_axub_226d82c1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_axub_226d82c1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_axub_226d82c1 *_wp_args,\n    wp_args_elementwise_axub_226d82c1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_axub_226d82c1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 337, "kernel_name": "reduce_ixhc", "python": "@wp.kernel\ndef reduce_ixhc(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ixhc_475e94d8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ixhc_475e94d8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixhc_475e94d8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ixhc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ixhc_475e94d8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ixhc_475e94d8 *_wp_args,\n    wp_args_reduce_ixhc_475e94d8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ixhc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ixhc(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ixhc_475e94d8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixhc_475e94d8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixhc_475e94d8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ixhc_475e94d8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ixhc_475e94d8 *_wp_args,\n    wp_args_reduce_ixhc_475e94d8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ixhc_475e94d8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 338, "kernel_name": "nested_scwa", "python": "@wp.kernel\ndef nested_scwa(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.22:\n        if val > 1.48:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_scwa_2e7f2afe {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_scwa_2e7f2afe_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_scwa_2e7f2afe *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    const wp::float32 var_5 = -0.22;\n    bool var_6;\n    const wp::float32 var_7 = 1.48;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_scwa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.22:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.48:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_scwa_2e7f2afe_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_scwa_2e7f2afe *_wp_args,\n    wp_args_nested_scwa_2e7f2afe *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    const wp::float32 var_5 = -0.22;\n    bool var_6;\n    const wp::float32 var_7 = 1.48;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_scwa(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.22:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.48:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.48:                                                                <L 8>\n    }\n    // adj: if val > -0.22:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_scwa(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_scwa_2e7f2afe_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_scwa_2e7f2afe *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_scwa_2e7f2afe_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_scwa_2e7f2afe_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_scwa_2e7f2afe *_wp_args,\n    wp_args_nested_scwa_2e7f2afe *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_scwa_2e7f2afe_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 339, "kernel_name": "multi_vmpb", "python": "@wp.kernel\ndef multi_vmpb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_vmpb_65ddc9ff {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_vmpb_65ddc9ff_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_vmpb_65ddc9ff *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_vmpb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_vmpb_65ddc9ff_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_vmpb_65ddc9ff *_wp_args,\n    wp_args_multi_vmpb_65ddc9ff *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_vmpb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_vmpb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_vmpb_65ddc9ff_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_vmpb_65ddc9ff *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_vmpb_65ddc9ff_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_vmpb_65ddc9ff_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_vmpb_65ddc9ff *_wp_args,\n    wp_args_multi_vmpb_65ddc9ff *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_vmpb_65ddc9ff_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 340, "kernel_name": "loop_shxb", "python": "@wp.kernel\ndef loop_shxb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_shxb_8653dd31 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_shxb_8653dd31_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_shxb_8653dd31 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_shxb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_shxb_8653dd31_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_shxb_8653dd31 *_wp_args,\n    wp_args_loop_shxb_8653dd31 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_shxb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_shxb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_shxb_8653dd31_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_shxb_8653dd31 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_shxb_8653dd31_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_shxb_8653dd31_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_shxb_8653dd31 *_wp_args,\n    wp_args_loop_shxb_8653dd31 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_shxb_8653dd31_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 341, "kernel_name": "loop_thfm", "python": "@wp.kernel\ndef loop_thfm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_thfm_6ef35925 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_thfm_6ef35925_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_thfm_6ef35925 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_thfm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_thfm_6ef35925_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_thfm_6ef35925 *_wp_args,\n    wp_args_loop_thfm_6ef35925 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_thfm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_thfm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_thfm_6ef35925_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_thfm_6ef35925 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_thfm_6ef35925_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_thfm_6ef35925_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_thfm_6ef35925 *_wp_args,\n    wp_args_loop_thfm_6ef35925 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_thfm_6ef35925_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 342, "kernel_name": "nested_nkuz", "python": "@wp.kernel\ndef nested_nkuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.46:\n        if val > 1.22:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nkuz_c6e5ded2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nkuz_c6e5ded2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.46;\n    bool var_5;\n    const wp::float32 var_6 = 1.22;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_nkuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.46:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.22:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_nkuz_c6e5ded2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_args,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.46;\n    bool var_5;\n    const wp::float32 var_6 = 1.22;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_nkuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.46:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.22:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.22:                                                                <L 8>\n    }\n    // adj: if val > 0.46:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nkuz(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nkuz_c6e5ded2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nkuz_c6e5ded2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nkuz_c6e5ded2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_args,\n    wp_args_nested_nkuz_c6e5ded2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nkuz_c6e5ded2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 343, "kernel_name": "unary_efww", "python": "@wp.kernel\ndef unary_efww(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_efww_e0f02439 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_efww_e0f02439_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_efww_e0f02439 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_efww(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_efww_e0f02439_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_efww_e0f02439 *_wp_args,\n    wp_args_unary_efww_e0f02439 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_efww(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_efww(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_efww_e0f02439_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_efww_e0f02439 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_efww_e0f02439_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_efww_e0f02439_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_efww_e0f02439 *_wp_args,\n    wp_args_unary_efww_e0f02439 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_efww_e0f02439_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 344, "kernel_name": "compound_pfsv", "python": "@wp.kernel\ndef compound_pfsv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pfsv_3b980a92 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pfsv_3b980a92_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pfsv_3b980a92 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pfsv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pfsv_3b980a92_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pfsv_3b980a92 *_wp_args,\n    wp_args_compound_pfsv_3b980a92 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pfsv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pfsv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pfsv_3b980a92_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pfsv_3b980a92 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pfsv_3b980a92_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pfsv_3b980a92_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pfsv_3b980a92 *_wp_args,\n    wp_args_compound_pfsv_3b980a92 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pfsv_3b980a92_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 345, "kernel_name": "unary_dpeh", "python": "@wp.kernel\ndef unary_dpeh(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dpeh_15b80746 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dpeh_15b80746_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dpeh_15b80746 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dpeh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dpeh_15b80746_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dpeh_15b80746 *_wp_args,\n    wp_args_unary_dpeh_15b80746 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dpeh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dpeh(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dpeh_15b80746_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dpeh_15b80746 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dpeh_15b80746_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dpeh_15b80746_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dpeh_15b80746 *_wp_args,\n    wp_args_unary_dpeh_15b80746 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dpeh_15b80746_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 346, "kernel_name": "compound_uwdp", "python": "@wp.kernel\ndef compound_uwdp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_uwdp_e899114d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_uwdp_e899114d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_uwdp_e899114d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_uwdp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_uwdp_e899114d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_uwdp_e899114d *_wp_args,\n    wp_args_compound_uwdp_e899114d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_uwdp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_uwdp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_uwdp_e899114d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_uwdp_e899114d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_uwdp_e899114d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_uwdp_e899114d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_uwdp_e899114d *_wp_args,\n    wp_args_compound_uwdp_e899114d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_uwdp_e899114d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 347, "kernel_name": "reduce_qwoi", "python": "@wp.kernel\ndef reduce_qwoi(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_qwoi_3141022b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_qwoi_3141022b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_qwoi_3141022b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_qwoi(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_qwoi_3141022b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_qwoi_3141022b *_wp_args,\n    wp_args_reduce_qwoi_3141022b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_qwoi(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_qwoi(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_qwoi_3141022b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_qwoi_3141022b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_qwoi_3141022b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_qwoi_3141022b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_qwoi_3141022b *_wp_args,\n    wp_args_reduce_qwoi_3141022b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_qwoi_3141022b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 348, "kernel_name": "multi_mjdz", "python": "@wp.kernel\ndef multi_mjdz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_mjdz_2d96b3f6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mjdz_2d96b3f6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mjdz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mjdz_2d96b3f6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_args,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mjdz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mjdz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mjdz_2d96b3f6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjdz_2d96b3f6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mjdz_2d96b3f6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_args,\n    wp_args_multi_mjdz_2d96b3f6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mjdz_2d96b3f6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 349, "kernel_name": "compound_pmac", "python": "@wp.kernel\ndef compound_pmac(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pmac_e45cd872 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pmac_e45cd872_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pmac_e45cd872 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pmac(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pmac_e45cd872_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pmac_e45cd872 *_wp_args,\n    wp_args_compound_pmac_e45cd872 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pmac(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pmac(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pmac_e45cd872_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pmac_e45cd872 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pmac_e45cd872_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pmac_e45cd872_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pmac_e45cd872 *_wp_args,\n    wp_args_compound_pmac_e45cd872 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pmac_e45cd872_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 350, "kernel_name": "nested_roit", "python": "@wp.kernel\ndef nested_roit(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.12:\n        if val > 1.06:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_roit_e605f35e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_roit_e605f35e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_roit_e605f35e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.06;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_roit(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.06:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_roit_e605f35e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_roit_e605f35e *_wp_args,\n    wp_args_nested_roit_e605f35e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    const wp::float32 var_5 = -0.12;\n    bool var_6;\n    const wp::float32 var_7 = 1.06;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_roit(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.12:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.06:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.06:                                                                <L 8>\n    }\n    // adj: if val > -0.12:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_roit(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_roit_e605f35e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_roit_e605f35e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_roit_e605f35e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_roit_e605f35e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_roit_e605f35e *_wp_args,\n    wp_args_nested_roit_e605f35e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_roit_e605f35e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 351, "kernel_name": "reduce_yvji", "python": "@wp.kernel\ndef reduce_yvji(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_yvji_be2ab652 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_yvji_be2ab652_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_yvji_be2ab652 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_yvji(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_yvji_be2ab652_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_yvji_be2ab652 *_wp_args,\n    wp_args_reduce_yvji_be2ab652 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_yvji(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_yvji(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_yvji_be2ab652_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_yvji_be2ab652 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_yvji_be2ab652_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_yvji_be2ab652_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_yvji_be2ab652 *_wp_args,\n    wp_args_reduce_yvji_be2ab652 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_yvji_be2ab652_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 352, "kernel_name": "reduce_imeo", "python": "@wp.kernel\ndef reduce_imeo(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_imeo_c3b3c843 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_imeo_c3b3c843_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_imeo_c3b3c843 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_imeo(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_imeo_c3b3c843_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_imeo_c3b3c843 *_wp_args,\n    wp_args_reduce_imeo_c3b3c843 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_imeo(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_imeo(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_imeo_c3b3c843_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_imeo_c3b3c843 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_imeo_c3b3c843_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_imeo_c3b3c843_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_imeo_c3b3c843 *_wp_args,\n    wp_args_reduce_imeo_c3b3c843 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_imeo_c3b3c843_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 353, "kernel_name": "reduce_qmgh", "python": "@wp.kernel\ndef reduce_qmgh(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_qmgh_21c81e3d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_qmgh_21c81e3d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_qmgh_21c81e3d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_qmgh(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_qmgh_21c81e3d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_qmgh_21c81e3d *_wp_args,\n    wp_args_reduce_qmgh_21c81e3d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_qmgh(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_qmgh(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_qmgh_21c81e3d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_qmgh_21c81e3d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_qmgh_21c81e3d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_qmgh_21c81e3d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_qmgh_21c81e3d *_wp_args,\n    wp_args_reduce_qmgh_21c81e3d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_qmgh_21c81e3d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 354, "kernel_name": "compound_rpvm", "python": "@wp.kernel\ndef compound_rpvm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_rpvm_0b37b5de {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_rpvm_0b37b5de_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rpvm_0b37b5de *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_rpvm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_rpvm_0b37b5de_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rpvm_0b37b5de *_wp_args,\n    wp_args_compound_rpvm_0b37b5de *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_rpvm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_rpvm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_rpvm_0b37b5de_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rpvm_0b37b5de *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rpvm_0b37b5de_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_rpvm_0b37b5de_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rpvm_0b37b5de *_wp_args,\n    wp_args_compound_rpvm_0b37b5de *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rpvm_0b37b5de_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 355, "kernel_name": "vec_lxyx", "python": "@wp.kernel\ndef vec_lxyx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_lxyx_feabc448 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_lxyx_feabc448_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lxyx_feabc448 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_lxyx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_lxyx_feabc448_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lxyx_feabc448 *_wp_args,\n    wp_args_vec_lxyx_feabc448 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_lxyx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lxyx(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lxyx_feabc448_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lxyx_feabc448 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lxyx_feabc448_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lxyx_feabc448_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lxyx_feabc448 *_wp_args,\n    wp_args_vec_lxyx_feabc448 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lxyx_feabc448_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 356, "kernel_name": "branch_fyqb", "python": "@wp.kernel\ndef branch_fyqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.62:\n        b[tid] = val * 1.1\n    else:\n        b[tid] = val * 1.9", "cpp": "struct wp_args_branch_fyqb_8914fa16 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fyqb_8914fa16_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fyqb_8914fa16 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.62;\n    bool var_5;\n    const wp::float32 var_6 = 1.1;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fyqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.62:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.1                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.9                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fyqb_8914fa16_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fyqb_8914fa16 *_wp_args,\n    wp_args_branch_fyqb_8914fa16 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.62;\n    bool var_5;\n    const wp::float32 var_6 = 1.1;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fyqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.62:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.1                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.9                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 1.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 1.1                                                            <L 8>\n    }\n    // adj: if val > 0.62:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fyqb(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fyqb_8914fa16_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fyqb_8914fa16 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fyqb_8914fa16_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fyqb_8914fa16_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fyqb_8914fa16 *_wp_args,\n    wp_args_branch_fyqb_8914fa16 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fyqb_8914fa16_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 357, "kernel_name": "compound_zoro", "python": "@wp.kernel\ndef compound_zoro(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_zoro_62d782b3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_zoro_62d782b3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_zoro_62d782b3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_zoro(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_zoro_62d782b3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_zoro_62d782b3 *_wp_args,\n    wp_args_compound_zoro_62d782b3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_zoro(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_zoro(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_zoro_62d782b3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_zoro_62d782b3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_zoro_62d782b3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_zoro_62d782b3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_zoro_62d782b3 *_wp_args,\n    wp_args_compound_zoro_62d782b3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_zoro_62d782b3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 358, "kernel_name": "scalar_arr_cxwn", "python": "@wp.kernel\ndef scalar_arr_cxwn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_cxwn_993cef15 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cxwn_993cef15_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cxwn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cxwn_993cef15_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_args,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cxwn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cxwn(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cxwn_993cef15_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cxwn_993cef15_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cxwn_993cef15_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_args,\n    wp_args_scalar_arr_cxwn_993cef15 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cxwn_993cef15_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 359, "kernel_name": "nested_snub", "python": "@wp.kernel\ndef nested_snub(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.14:\n        if val > 0.69:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_snub_06a5e399 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_snub_06a5e399_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snub_06a5e399 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    const wp::float32 var_5 = -0.14;\n    bool var_6;\n    const wp::float32 var_7 = 0.69;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_snub(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.14:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.69:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_snub_06a5e399_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snub_06a5e399 *_wp_args,\n    wp_args_nested_snub_06a5e399 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    const wp::float32 var_5 = -0.14;\n    bool var_6;\n    const wp::float32 var_7 = 0.69;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_snub(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.14:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.69:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.69:                                                                <L 8>\n    }\n    // adj: if val > -0.14:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_snub(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_snub_06a5e399_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snub_06a5e399 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snub_06a5e399_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_snub_06a5e399_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snub_06a5e399 *_wp_args,\n    wp_args_nested_snub_06a5e399 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snub_06a5e399_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 360, "kernel_name": "reduce_xjzr", "python": "@wp.kernel\ndef reduce_xjzr(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xjzr_d349362c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xjzr_d349362c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xjzr_d349362c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xjzr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xjzr_d349362c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xjzr_d349362c *_wp_args,\n    wp_args_reduce_xjzr_d349362c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xjzr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xjzr(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xjzr_d349362c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xjzr_d349362c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xjzr_d349362c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xjzr_d349362c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xjzr_d349362c *_wp_args,\n    wp_args_reduce_xjzr_d349362c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xjzr_d349362c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 361, "kernel_name": "compound_qwem", "python": "@wp.kernel\ndef compound_qwem(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qwem_979c4c61 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qwem_979c4c61_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qwem_979c4c61 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qwem(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qwem_979c4c61_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qwem_979c4c61 *_wp_args,\n    wp_args_compound_qwem_979c4c61 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qwem(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qwem(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qwem_979c4c61_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qwem_979c4c61 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qwem_979c4c61_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qwem_979c4c61_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qwem_979c4c61 *_wp_args,\n    wp_args_compound_qwem_979c4c61 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qwem_979c4c61_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 362, "kernel_name": "scalar_arr_chxe", "python": "@wp.kernel\ndef scalar_arr_chxe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_chxe_6fa56e80 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_chxe_6fa56e80_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_chxe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_chxe_6fa56e80_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_args,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_chxe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_chxe(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_chxe_6fa56e80_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_chxe_6fa56e80_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_chxe_6fa56e80_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_args,\n    wp_args_scalar_arr_chxe_6fa56e80 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_chxe_6fa56e80_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 363, "kernel_name": "compound_tasi", "python": "@wp.kernel\ndef compound_tasi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_tasi_4559db59 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_tasi_4559db59_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_tasi_4559db59 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_tasi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_tasi_4559db59_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_tasi_4559db59 *_wp_args,\n    wp_args_compound_tasi_4559db59 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_tasi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_tasi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_tasi_4559db59_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_tasi_4559db59 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_tasi_4559db59_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_tasi_4559db59_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_tasi_4559db59 *_wp_args,\n    wp_args_compound_tasi_4559db59 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_tasi_4559db59_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 364, "kernel_name": "elementwise_aeud", "python": "@wp.kernel\ndef elementwise_aeud(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_aeud_c82e6889 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aeud_c82e6889_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aeud_c82e6889 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aeud(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aeud_c82e6889_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aeud_c82e6889 *_wp_args,\n    wp_args_elementwise_aeud_c82e6889 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aeud(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aeud(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aeud_c82e6889_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aeud_c82e6889 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aeud_c82e6889_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aeud_c82e6889_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aeud_c82e6889 *_wp_args,\n    wp_args_elementwise_aeud_c82e6889 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aeud_c82e6889_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 365, "kernel_name": "nested_ocan", "python": "@wp.kernel\ndef nested_ocan(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.22:\n        if val > 1.25:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ocan_c517140c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ocan_c517140c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ocan_c517140c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    const wp::float32 var_5 = -0.22;\n    bool var_6;\n    const wp::float32 var_7 = 1.25;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ocan(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.22:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.25:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ocan_c517140c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ocan_c517140c *_wp_args,\n    wp_args_nested_ocan_c517140c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.22;\n    const wp::float32 var_5 = -0.22;\n    bool var_6;\n    const wp::float32 var_7 = 1.25;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ocan(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.22:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.25:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.25:                                                                <L 8>\n    }\n    // adj: if val > -0.22:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ocan(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ocan_c517140c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ocan_c517140c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ocan_c517140c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ocan_c517140c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ocan_c517140c *_wp_args,\n    wp_args_nested_ocan_c517140c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ocan_c517140c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 366, "kernel_name": "compound_pklw", "python": "@wp.kernel\ndef compound_pklw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pklw_a05b1d3a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pklw_a05b1d3a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pklw_a05b1d3a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pklw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pklw_a05b1d3a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pklw_a05b1d3a *_wp_args,\n    wp_args_compound_pklw_a05b1d3a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pklw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pklw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pklw_a05b1d3a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pklw_a05b1d3a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pklw_a05b1d3a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pklw_a05b1d3a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pklw_a05b1d3a *_wp_args,\n    wp_args_compound_pklw_a05b1d3a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pklw_a05b1d3a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 367, "kernel_name": "scalar_arr_cpcr", "python": "@wp.kernel\ndef scalar_arr_cpcr(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_cpcr_ce9085d4 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cpcr_ce9085d4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cpcr(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cpcr_ce9085d4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_args,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cpcr(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cpcr(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cpcr_ce9085d4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cpcr_ce9085d4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cpcr_ce9085d4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_args,\n    wp_args_scalar_arr_cpcr_ce9085d4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cpcr_ce9085d4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 368, "kernel_name": "branch_golm", "python": "@wp.kernel\ndef branch_golm(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.88:\n        b[tid] = val - 0.6\n    else:\n        b[tid] = val + 2.3", "cpp": "struct wp_args_branch_golm_367c8f9a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_golm_367c8f9a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_golm_367c8f9a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.88;\n    const wp::float32 var_5 = -0.88;\n    bool var_6;\n    const wp::float32 var_7 = 0.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.3;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_golm(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.88:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_golm_367c8f9a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_golm_367c8f9a *_wp_args,\n    wp_args_branch_golm_367c8f9a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.88;\n    const wp::float32 var_5 = -0.88;\n    bool var_6;\n    const wp::float32 var_7 = 0.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.3;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_golm(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.88:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 0.6                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.3                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 0.6                                                            <L 8>\n    }\n    // adj: if val > -0.88:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_golm(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_golm_367c8f9a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_golm_367c8f9a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_golm_367c8f9a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_golm_367c8f9a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_golm_367c8f9a *_wp_args,\n    wp_args_branch_golm_367c8f9a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_golm_367c8f9a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 369, "kernel_name": "nested_oevg", "python": "@wp.kernel\ndef nested_oevg(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.1:\n        if val > 0.64:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_oevg_82765a7a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_oevg_82765a7a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oevg_82765a7a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    bool var_5;\n    const wp::float32 var_6 = 0.64;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_oevg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.1:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.64:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_oevg_82765a7a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_oevg_82765a7a *_wp_args,\n    wp_args_nested_oevg_82765a7a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    bool var_5;\n    const wp::float32 var_6 = 0.64;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_oevg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.1:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.64:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.64:                                                                <L 8>\n    }\n    // adj: if val > 0.1:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_oevg(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_oevg_82765a7a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oevg_82765a7a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oevg_82765a7a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_oevg_82765a7a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_oevg_82765a7a *_wp_args,\n    wp_args_nested_oevg_82765a7a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_oevg_82765a7a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 370, "kernel_name": "unary_erxu", "python": "@wp.kernel\ndef unary_erxu(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_erxu_cabb4f3a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_erxu_cabb4f3a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_erxu_cabb4f3a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_erxu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_erxu_cabb4f3a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_erxu_cabb4f3a *_wp_args,\n    wp_args_unary_erxu_cabb4f3a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_erxu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_erxu(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_erxu_cabb4f3a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_erxu_cabb4f3a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_erxu_cabb4f3a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_erxu_cabb4f3a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_erxu_cabb4f3a *_wp_args,\n    wp_args_unary_erxu_cabb4f3a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_erxu_cabb4f3a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 371, "kernel_name": "branch_qutw", "python": "@wp.kernel\ndef branch_qutw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.6:\n        b[tid] = val + 1.3\n    else:\n        b[tid] = val * 3.0", "cpp": "struct wp_args_branch_qutw_5ab5d0a6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_qutw_5ab5d0a6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.6;\n    const wp::float32 var_5 = -0.6;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_qutw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.6:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.3                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 3.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_qutw_5ab5d0a6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_args,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.6;\n    const wp::float32 var_5 = -0.6;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_qutw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.6:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.3                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 3.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 3.0                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 1.3                                                            <L 8>\n    }\n    // adj: if val > -0.6:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_qutw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_qutw_5ab5d0a6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qutw_5ab5d0a6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_qutw_5ab5d0a6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_args,\n    wp_args_branch_qutw_5ab5d0a6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qutw_5ab5d0a6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 372, "kernel_name": "compound_pill", "python": "@wp.kernel\ndef compound_pill(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pill_db4c0428 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pill_db4c0428_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pill_db4c0428 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pill(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pill_db4c0428_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pill_db4c0428 *_wp_args,\n    wp_args_compound_pill_db4c0428 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pill(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pill(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pill_db4c0428_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pill_db4c0428 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pill_db4c0428_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pill_db4c0428_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pill_db4c0428 *_wp_args,\n    wp_args_compound_pill_db4c0428 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pill_db4c0428_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 373, "kernel_name": "elementwise_bbiz", "python": "@wp.kernel\ndef elementwise_bbiz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bbiz_857f34b8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bbiz_857f34b8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bbiz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bbiz_857f34b8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_args,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bbiz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bbiz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bbiz_857f34b8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bbiz_857f34b8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bbiz_857f34b8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_args,\n    wp_args_elementwise_bbiz_857f34b8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bbiz_857f34b8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 374, "kernel_name": "branch_zbir", "python": "@wp.kernel\ndef branch_zbir(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.76:\n        b[tid] = val - 2.7\n    else:\n        b[tid] = val - 1.9", "cpp": "struct wp_args_branch_zbir_71662332 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_zbir_71662332_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_zbir_71662332 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.76;\n    const wp::float32 var_5 = -0.76;\n    bool var_6;\n    const wp::float32 var_7 = 2.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.9;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_zbir(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.76:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.9                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_zbir_71662332_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_zbir_71662332 *_wp_args,\n    wp_args_branch_zbir_71662332 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.76;\n    const wp::float32 var_5 = -0.76;\n    bool var_6;\n    const wp::float32 var_7 = 2.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.9;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_zbir(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.76:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 2.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.9                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 1.9                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 2.7                                                            <L 8>\n    }\n    // adj: if val > -0.76:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_zbir(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_zbir_71662332_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_zbir_71662332 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_zbir_71662332_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_zbir_71662332_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_zbir_71662332 *_wp_args,\n    wp_args_branch_zbir_71662332 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_zbir_71662332_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 375, "kernel_name": "compound_ypfp", "python": "@wp.kernel\ndef compound_ypfp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ypfp_f537e28d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ypfp_f537e28d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ypfp_f537e28d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ypfp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ypfp_f537e28d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ypfp_f537e28d *_wp_args,\n    wp_args_compound_ypfp_f537e28d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ypfp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ypfp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ypfp_f537e28d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ypfp_f537e28d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ypfp_f537e28d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ypfp_f537e28d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ypfp_f537e28d *_wp_args,\n    wp_args_compound_ypfp_f537e28d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ypfp_f537e28d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 376, "kernel_name": "loop_gyrv", "python": "@wp.kernel\ndef loop_gyrv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gyrv_c73998b9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gyrv_c73998b9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gyrv_c73998b9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gyrv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gyrv_c73998b9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gyrv_c73998b9 *_wp_args,\n    wp_args_loop_gyrv_c73998b9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gyrv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gyrv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gyrv_c73998b9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gyrv_c73998b9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gyrv_c73998b9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gyrv_c73998b9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gyrv_c73998b9 *_wp_args,\n    wp_args_loop_gyrv_c73998b9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gyrv_c73998b9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 377, "kernel_name": "scalar_arr_czrk", "python": "@wp.kernel\ndef scalar_arr_czrk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_czrk_738f39aa {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_czrk_738f39aa_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_czrk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_czrk_738f39aa_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_args,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_czrk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_czrk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_czrk_738f39aa_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czrk_738f39aa_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_czrk_738f39aa_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_args,\n    wp_args_scalar_arr_czrk_738f39aa *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_czrk_738f39aa_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 378, "kernel_name": "branch_fikk", "python": "@wp.kernel\ndef branch_fikk(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.1:\n        b[tid] = val * 1.1\n    else:\n        b[tid] = val + 2.2", "cpp": "struct wp_args_branch_fikk_6e4e5d0e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fikk_6e4e5d0e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fikk_6e4e5d0e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    const wp::float32 var_5 = -0.1;\n    bool var_6;\n    const wp::float32 var_7 = 1.1;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.2;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fikk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.1:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.1                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fikk_6e4e5d0e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fikk_6e4e5d0e *_wp_args,\n    wp_args_branch_fikk_6e4e5d0e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    const wp::float32 var_5 = -0.1;\n    bool var_6;\n    const wp::float32 var_7 = 1.1;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.2;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fikk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.1:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.1                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.2                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.2                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 1.1                                                            <L 8>\n    }\n    // adj: if val > -0.1:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fikk(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fikk_6e4e5d0e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fikk_6e4e5d0e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fikk_6e4e5d0e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fikk_6e4e5d0e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fikk_6e4e5d0e *_wp_args,\n    wp_args_branch_fikk_6e4e5d0e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fikk_6e4e5d0e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 379, "kernel_name": "reduce_jnei", "python": "@wp.kernel\ndef reduce_jnei(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jnei_13a257f0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jnei_13a257f0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jnei_13a257f0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jnei(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jnei_13a257f0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jnei_13a257f0 *_wp_args,\n    wp_args_reduce_jnei_13a257f0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jnei(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jnei(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jnei_13a257f0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jnei_13a257f0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jnei_13a257f0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jnei_13a257f0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jnei_13a257f0 *_wp_args,\n    wp_args_reduce_jnei_13a257f0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jnei_13a257f0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 380, "kernel_name": "nested_sngj", "python": "@wp.kernel\ndef nested_sngj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.15:\n        if val > 0.83:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_sngj_4f05031c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_sngj_4f05031c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_sngj_4f05031c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 0.83;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_sngj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.83:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_sngj_4f05031c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_sngj_4f05031c *_wp_args,\n    wp_args_nested_sngj_4f05031c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.15;\n    const wp::float32 var_5 = -0.15;\n    bool var_6;\n    const wp::float32 var_7 = 0.83;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_sngj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.15:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.83:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.83:                                                                <L 8>\n    }\n    // adj: if val > -0.15:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_sngj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_sngj_4f05031c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_sngj_4f05031c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_sngj_4f05031c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_sngj_4f05031c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_sngj_4f05031c *_wp_args,\n    wp_args_nested_sngj_4f05031c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_sngj_4f05031c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 381, "kernel_name": "multi_lkut", "python": "@wp.kernel\ndef multi_lkut(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lkut_7794e736 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lkut_7794e736_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lkut_7794e736 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lkut(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lkut_7794e736_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lkut_7794e736 *_wp_args,\n    wp_args_multi_lkut_7794e736 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lkut(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lkut(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lkut_7794e736_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lkut_7794e736 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lkut_7794e736_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lkut_7794e736_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lkut_7794e736 *_wp_args,\n    wp_args_multi_lkut_7794e736 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lkut_7794e736_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 382, "kernel_name": "unary_dfya", "python": "@wp.kernel\ndef unary_dfya(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_dfya_74fa57d9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dfya_74fa57d9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dfya_74fa57d9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dfya(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dfya_74fa57d9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dfya_74fa57d9 *_wp_args,\n    wp_args_unary_dfya_74fa57d9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dfya(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dfya(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dfya_74fa57d9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dfya_74fa57d9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dfya_74fa57d9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dfya_74fa57d9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dfya_74fa57d9 *_wp_args,\n    wp_args_unary_dfya_74fa57d9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dfya_74fa57d9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 383, "kernel_name": "loop_iabk", "python": "@wp.kernel\ndef loop_iabk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_iabk_76bf4eda {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_iabk_76bf4eda_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_iabk_76bf4eda *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_iabk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_iabk_76bf4eda_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_iabk_76bf4eda *_wp_args,\n    wp_args_loop_iabk_76bf4eda *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_iabk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_iabk(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_iabk_76bf4eda_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_iabk_76bf4eda *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_iabk_76bf4eda_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_iabk_76bf4eda_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_iabk_76bf4eda *_wp_args,\n    wp_args_loop_iabk_76bf4eda *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_iabk_76bf4eda_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 384, "kernel_name": "nested_xnoc", "python": "@wp.kernel\ndef nested_xnoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.49:\n        if val > 0.66:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_xnoc_aeb90114 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_xnoc_aeb90114_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_xnoc_aeb90114 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.49;\n    bool var_5;\n    const wp::float32 var_6 = 0.66;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_xnoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.49:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.66:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_xnoc_aeb90114_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_xnoc_aeb90114 *_wp_args,\n    wp_args_nested_xnoc_aeb90114 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.49;\n    bool var_5;\n    const wp::float32 var_6 = 0.66;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_xnoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.49:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.66:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.66:                                                                <L 8>\n    }\n    // adj: if val > 0.49:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_xnoc(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_xnoc_aeb90114_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_xnoc_aeb90114 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_xnoc_aeb90114_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_xnoc_aeb90114_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_xnoc_aeb90114 *_wp_args,\n    wp_args_nested_xnoc_aeb90114 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_xnoc_aeb90114_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 385, "kernel_name": "loop_uzgy", "python": "@wp.kernel\ndef loop_uzgy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_uzgy_b548dc03 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_uzgy_b548dc03_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_uzgy_b548dc03 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_uzgy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_uzgy_b548dc03_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_uzgy_b548dc03 *_wp_args,\n    wp_args_loop_uzgy_b548dc03 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_uzgy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_uzgy(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_uzgy_b548dc03_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_uzgy_b548dc03 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_uzgy_b548dc03_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_uzgy_b548dc03_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_uzgy_b548dc03 *_wp_args,\n    wp_args_loop_uzgy_b548dc03 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_uzgy_b548dc03_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 386, "kernel_name": "vec_ltwp", "python": "@wp.kernel\ndef vec_ltwp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_ltwp_a9463276 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_ltwp_a9463276_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ltwp_a9463276 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_ltwp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_ltwp_a9463276_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ltwp_a9463276 *_wp_args,\n    wp_args_vec_ltwp_a9463276 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_ltwp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ltwp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ltwp_a9463276_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ltwp_a9463276 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ltwp_a9463276_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ltwp_a9463276_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ltwp_a9463276 *_wp_args,\n    wp_args_vec_ltwp_a9463276 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ltwp_a9463276_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 387, "kernel_name": "reduce_jawj", "python": "@wp.kernel\ndef reduce_jawj(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jawj_7bac4ccd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jawj_7bac4ccd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jawj_7bac4ccd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jawj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jawj_7bac4ccd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jawj_7bac4ccd *_wp_args,\n    wp_args_reduce_jawj_7bac4ccd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jawj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jawj(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jawj_7bac4ccd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jawj_7bac4ccd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jawj_7bac4ccd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jawj_7bac4ccd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jawj_7bac4ccd *_wp_args,\n    wp_args_reduce_jawj_7bac4ccd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jawj_7bac4ccd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 388, "kernel_name": "elementwise_ayor", "python": "@wp.kernel\ndef elementwise_ayor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_ayor_4377523d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ayor_4377523d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ayor_4377523d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ayor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ayor_4377523d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ayor_4377523d *_wp_args,\n    wp_args_elementwise_ayor_4377523d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ayor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ayor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ayor_4377523d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ayor_4377523d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ayor_4377523d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ayor_4377523d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ayor_4377523d *_wp_args,\n    wp_args_elementwise_ayor_4377523d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ayor_4377523d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 389, "kernel_name": "branch_fduc", "python": "@wp.kernel\ndef branch_fduc(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -1.0:\n        b[tid] = val * 0.8\n    else:\n        b[tid] = val + 1.3", "cpp": "struct wp_args_branch_fduc_1e8650c6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fduc_1e8650c6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fduc_1e8650c6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 1.0;\n    const wp::float32 var_5 = -1.0;\n    bool var_6;\n    const wp::float32 var_7 = 0.8;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.3;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fduc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -1.0:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.8                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fduc_1e8650c6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fduc_1e8650c6 *_wp_args,\n    wp_args_branch_fduc_1e8650c6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 1.0;\n    const wp::float32 var_5 = -1.0;\n    bool var_6;\n    const wp::float32 var_7 = 0.8;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.3;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fduc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -1.0:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.8                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 1.3                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 1.3                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 0.8                                                            <L 8>\n    }\n    // adj: if val > -1.0:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fduc(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fduc_1e8650c6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fduc_1e8650c6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fduc_1e8650c6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fduc_1e8650c6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fduc_1e8650c6 *_wp_args,\n    wp_args_branch_fduc_1e8650c6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fduc_1e8650c6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 390, "kernel_name": "elementwise_abgj", "python": "@wp.kernel\ndef elementwise_abgj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_abgj_c8cda8a0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_abgj_c8cda8a0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_abgj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_abgj_c8cda8a0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_args,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_abgj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_abgj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_abgj_c8cda8a0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_abgj_c8cda8a0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_abgj_c8cda8a0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_args,\n    wp_args_elementwise_abgj_c8cda8a0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_abgj_c8cda8a0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 391, "kernel_name": "nested_whlw", "python": "@wp.kernel\ndef nested_whlw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.23:\n        if val > 0.97:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_whlw_cc15b058 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_whlw_cc15b058_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_whlw_cc15b058 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.23;\n    bool var_5;\n    const wp::float32 var_6 = 0.97;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_whlw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.23:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.97:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_whlw_cc15b058_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_whlw_cc15b058 *_wp_args,\n    wp_args_nested_whlw_cc15b058 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.23;\n    bool var_5;\n    const wp::float32 var_6 = 0.97;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_whlw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.23:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.97:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.97:                                                                <L 8>\n    }\n    // adj: if val > 0.23:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_whlw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_whlw_cc15b058_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_whlw_cc15b058 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_whlw_cc15b058_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_whlw_cc15b058_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_whlw_cc15b058 *_wp_args,\n    wp_args_nested_whlw_cc15b058 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_whlw_cc15b058_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 392, "kernel_name": "compound_qacy", "python": "@wp.kernel\ndef compound_qacy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qacy_8f7da786 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qacy_8f7da786_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qacy_8f7da786 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qacy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qacy_8f7da786_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qacy_8f7da786 *_wp_args,\n    wp_args_compound_qacy_8f7da786 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qacy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qacy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qacy_8f7da786_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qacy_8f7da786 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qacy_8f7da786_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qacy_8f7da786_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qacy_8f7da786 *_wp_args,\n    wp_args_compound_qacy_8f7da786 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qacy_8f7da786_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 393, "kernel_name": "nested_nxgo", "python": "@wp.kernel\ndef nested_nxgo(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.27:\n        if val > 1.38:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nxgo_196caab6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nxgo_196caab6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nxgo_196caab6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.27;\n    bool var_5;\n    const wp::float32 var_6 = 1.38;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_nxgo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.27:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.38:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_nxgo_196caab6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nxgo_196caab6 *_wp_args,\n    wp_args_nested_nxgo_196caab6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.27;\n    bool var_5;\n    const wp::float32 var_6 = 1.38;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_nxgo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.27:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.38:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.38:                                                                <L 8>\n    }\n    // adj: if val > 0.27:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nxgo(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nxgo_196caab6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nxgo_196caab6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nxgo_196caab6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nxgo_196caab6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nxgo_196caab6 *_wp_args,\n    wp_args_nested_nxgo_196caab6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nxgo_196caab6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 394, "kernel_name": "reduce_jlpl", "python": "@wp.kernel\ndef reduce_jlpl(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jlpl_77639aaf {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jlpl_77639aaf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jlpl_77639aaf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jlpl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jlpl_77639aaf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jlpl_77639aaf *_wp_args,\n    wp_args_reduce_jlpl_77639aaf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jlpl(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jlpl(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jlpl_77639aaf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jlpl_77639aaf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jlpl_77639aaf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jlpl_77639aaf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jlpl_77639aaf *_wp_args,\n    wp_args_reduce_jlpl_77639aaf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jlpl_77639aaf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 395, "kernel_name": "reduce_xklb", "python": "@wp.kernel\ndef reduce_xklb(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xklb_847e08bd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xklb_847e08bd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xklb_847e08bd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xklb(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xklb_847e08bd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xklb_847e08bd *_wp_args,\n    wp_args_reduce_xklb_847e08bd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xklb(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xklb(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xklb_847e08bd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xklb_847e08bd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xklb_847e08bd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xklb_847e08bd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xklb_847e08bd *_wp_args,\n    wp_args_reduce_xklb_847e08bd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xklb_847e08bd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 396, "kernel_name": "compound_ssrn", "python": "@wp.kernel\ndef compound_ssrn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ssrn_ae421615 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ssrn_ae421615_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ssrn_ae421615 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ssrn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ssrn_ae421615_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ssrn_ae421615 *_wp_args,\n    wp_args_compound_ssrn_ae421615 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ssrn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ssrn(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ssrn_ae421615_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ssrn_ae421615 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ssrn_ae421615_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ssrn_ae421615_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ssrn_ae421615 *_wp_args,\n    wp_args_compound_ssrn_ae421615 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ssrn_ae421615_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 397, "kernel_name": "elementwise_ancw", "python": "@wp.kernel\ndef elementwise_ancw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_ancw_0b3338ca {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ancw_0b3338ca_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ancw_0b3338ca *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ancw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ancw_0b3338ca_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ancw_0b3338ca *_wp_args,\n    wp_args_elementwise_ancw_0b3338ca *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ancw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ancw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ancw_0b3338ca_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ancw_0b3338ca *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ancw_0b3338ca_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ancw_0b3338ca_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ancw_0b3338ca *_wp_args,\n    wp_args_elementwise_ancw_0b3338ca *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ancw_0b3338ca_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 398, "kernel_name": "multi_mryl", "python": "@wp.kernel\ndef multi_mryl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_mryl_93911c8e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mryl_93911c8e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mryl_93911c8e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mryl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mryl_93911c8e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mryl_93911c8e *_wp_args,\n    wp_args_multi_mryl_93911c8e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mryl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mryl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mryl_93911c8e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mryl_93911c8e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mryl_93911c8e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mryl_93911c8e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mryl_93911c8e *_wp_args,\n    wp_args_multi_mryl_93911c8e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mryl_93911c8e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 399, "kernel_name": "branch_qkan", "python": "@wp.kernel\ndef branch_qkan(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.73:\n        b[tid] = val * 2.9\n    else:\n        b[tid] = val * 0.7", "cpp": "struct wp_args_branch_qkan_c2ce24e7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_qkan_c2ce24e7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qkan_c2ce24e7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.73;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.7;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_qkan(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.73:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.7                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_qkan_c2ce24e7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qkan_c2ce24e7 *_wp_args,\n    wp_args_branch_qkan_c2ce24e7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.73;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.7;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_qkan(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.73:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.9                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.7                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 0.7                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 2.9                                                            <L 8>\n    }\n    // adj: if val > 0.73:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_qkan(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_qkan_c2ce24e7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qkan_c2ce24e7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qkan_c2ce24e7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_qkan_c2ce24e7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qkan_c2ce24e7 *_wp_args,\n    wp_args_branch_qkan_c2ce24e7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qkan_c2ce24e7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 400, "kernel_name": "nested_svbi", "python": "@wp.kernel\ndef nested_svbi(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.12:\n        if val > 1.45:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_svbi_f66cb0bd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_svbi_f66cb0bd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_svbi_f66cb0bd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    bool var_5;\n    const wp::float32 var_6 = 1.45;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_svbi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.12:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.45:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_svbi_f66cb0bd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_svbi_f66cb0bd *_wp_args,\n    wp_args_nested_svbi_f66cb0bd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.12;\n    bool var_5;\n    const wp::float32 var_6 = 1.45;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_svbi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.12:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.45:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.45:                                                                <L 8>\n    }\n    // adj: if val > 0.12:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_svbi(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_svbi_f66cb0bd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_svbi_f66cb0bd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_svbi_f66cb0bd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_svbi_f66cb0bd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_svbi_f66cb0bd *_wp_args,\n    wp_args_nested_svbi_f66cb0bd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_svbi_f66cb0bd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 401, "kernel_name": "vec_kokf", "python": "@wp.kernel\ndef vec_kokf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kokf_d1fbda3d {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kokf_d1fbda3d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kokf_d1fbda3d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kokf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kokf_d1fbda3d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kokf_d1fbda3d *_wp_args,\n    wp_args_vec_kokf_d1fbda3d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kokf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kokf(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kokf_d1fbda3d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kokf_d1fbda3d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kokf_d1fbda3d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kokf_d1fbda3d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kokf_d1fbda3d *_wp_args,\n    wp_args_vec_kokf_d1fbda3d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kokf_d1fbda3d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 402, "kernel_name": "branch_fynr", "python": "@wp.kernel\ndef branch_fynr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.99:\n        b[tid] = val * 1.6\n    else:\n        b[tid] = val + 2.1", "cpp": "struct wp_args_branch_fynr_2acc4760 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fynr_2acc4760_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fynr_2acc4760 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.99;\n    const wp::float32 var_5 = -0.99;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.1;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fynr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.99:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.1                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fynr_2acc4760_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fynr_2acc4760 *_wp_args,\n    wp_args_branch_fynr_2acc4760 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.99;\n    const wp::float32 var_5 = -0.99;\n    bool var_6;\n    const wp::float32 var_7 = 1.6;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.1;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fynr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.99:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.6                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.1                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.1                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 1.6                                                            <L 8>\n    }\n    // adj: if val > -0.99:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fynr(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fynr_2acc4760_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fynr_2acc4760 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fynr_2acc4760_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fynr_2acc4760_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fynr_2acc4760 *_wp_args,\n    wp_args_branch_fynr_2acc4760 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fynr_2acc4760_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 403, "kernel_name": "vec_kxlg", "python": "@wp.kernel\ndef vec_kxlg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kxlg_df71132e {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kxlg_df71132e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kxlg_df71132e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kxlg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kxlg_df71132e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kxlg_df71132e *_wp_args,\n    wp_args_vec_kxlg_df71132e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kxlg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kxlg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kxlg_df71132e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kxlg_df71132e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kxlg_df71132e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kxlg_df71132e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kxlg_df71132e *_wp_args,\n    wp_args_vec_kxlg_df71132e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kxlg_df71132e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 404, "kernel_name": "vec_kaym", "python": "@wp.kernel\ndef vec_kaym(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kaym_4d319541 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kaym_4d319541_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kaym_4d319541 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kaym(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kaym_4d319541_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kaym_4d319541 *_wp_args,\n    wp_args_vec_kaym_4d319541 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kaym(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kaym(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kaym_4d319541_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kaym_4d319541 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kaym_4d319541_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kaym_4d319541_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kaym_4d319541 *_wp_args,\n    wp_args_vec_kaym_4d319541 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kaym_4d319541_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 405, "kernel_name": "scalar_arr_choj", "python": "@wp.kernel\ndef scalar_arr_choj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_choj_1938a12b {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_choj_1938a12b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_choj_1938a12b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_choj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_choj_1938a12b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_choj_1938a12b *_wp_args,\n    wp_args_scalar_arr_choj_1938a12b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_choj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_choj(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_choj_1938a12b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_choj_1938a12b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_choj_1938a12b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_choj_1938a12b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_choj_1938a12b *_wp_args,\n    wp_args_scalar_arr_choj_1938a12b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_choj_1938a12b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 406, "kernel_name": "elementwise_azhs", "python": "@wp.kernel\ndef elementwise_azhs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_azhs_4e2a2477 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_azhs_4e2a2477_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_azhs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_azhs_4e2a2477_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_args,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_azhs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_azhs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_azhs_4e2a2477_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azhs_4e2a2477_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_azhs_4e2a2477_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_args,\n    wp_args_elementwise_azhs_4e2a2477 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azhs_4e2a2477_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 407, "kernel_name": "elementwise_ajyv", "python": "@wp.kernel\ndef elementwise_ajyv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_ajyv_b9c60f14 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ajyv_b9c60f14_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ajyv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ajyv_b9c60f14_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_args,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ajyv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ajyv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ajyv_b9c60f14_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ajyv_b9c60f14_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ajyv_b9c60f14_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_args,\n    wp_args_elementwise_ajyv_b9c60f14 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ajyv_b9c60f14_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 408, "kernel_name": "vec_ucay", "python": "@wp.kernel\ndef vec_ucay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_ucay_13cbb4ab {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_ucay_13cbb4ab_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ucay_13cbb4ab *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_ucay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_ucay_13cbb4ab_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ucay_13cbb4ab *_wp_args,\n    wp_args_vec_ucay_13cbb4ab *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_ucay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ucay(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ucay_13cbb4ab_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ucay_13cbb4ab *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ucay_13cbb4ab_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ucay_13cbb4ab_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ucay_13cbb4ab *_wp_args,\n    wp_args_vec_ucay_13cbb4ab *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ucay_13cbb4ab_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 409, "kernel_name": "unary_druv", "python": "@wp.kernel\ndef unary_druv(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_druv_2d6c7e27 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_druv_2d6c7e27_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_druv_2d6c7e27 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_druv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_druv_2d6c7e27_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_druv_2d6c7e27 *_wp_args,\n    wp_args_unary_druv_2d6c7e27 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_druv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_druv(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_druv_2d6c7e27_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_druv_2d6c7e27 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_druv_2d6c7e27_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_druv_2d6c7e27_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_druv_2d6c7e27 *_wp_args,\n    wp_args_unary_druv_2d6c7e27 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_druv_2d6c7e27_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 410, "kernel_name": "vec_kodi", "python": "@wp.kernel\ndef vec_kodi(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kodi_541f1755 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kodi_541f1755_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kodi_541f1755 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kodi(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kodi_541f1755_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kodi_541f1755 *_wp_args,\n    wp_args_vec_kodi_541f1755 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kodi(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kodi(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kodi_541f1755_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kodi_541f1755 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kodi_541f1755_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kodi_541f1755_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kodi_541f1755 *_wp_args,\n    wp_args_vec_kodi_541f1755 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kodi_541f1755_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 411, "kernel_name": "elementwise_bmig", "python": "@wp.kernel\ndef elementwise_bmig(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_bmig_4783553a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bmig_4783553a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bmig_4783553a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bmig(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bmig_4783553a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bmig_4783553a *_wp_args,\n    wp_args_elementwise_bmig_4783553a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bmig(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bmig(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bmig_4783553a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bmig_4783553a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bmig_4783553a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bmig_4783553a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bmig_4783553a *_wp_args,\n    wp_args_elementwise_bmig_4783553a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bmig_4783553a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 412, "kernel_name": "loop_rzhp", "python": "@wp.kernel\ndef loop_rzhp(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_rzhp_389744a0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_rzhp_389744a0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_rzhp_389744a0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_rzhp(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_rzhp_389744a0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_rzhp_389744a0 *_wp_args,\n    wp_args_loop_rzhp_389744a0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_rzhp(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_rzhp(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_rzhp_389744a0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_rzhp_389744a0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_rzhp_389744a0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_rzhp_389744a0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_rzhp_389744a0 *_wp_args,\n    wp_args_loop_rzhp_389744a0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_rzhp_389744a0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 413, "kernel_name": "reduce_jomu", "python": "@wp.kernel\ndef reduce_jomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jomu_84800a7c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jomu_84800a7c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jomu_84800a7c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jomu_84800a7c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jomu_84800a7c *_wp_args,\n    wp_args_reduce_jomu_84800a7c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jomu_84800a7c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jomu_84800a7c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jomu_84800a7c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jomu_84800a7c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jomu_84800a7c *_wp_args,\n    wp_args_reduce_jomu_84800a7c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jomu_84800a7c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 414, "kernel_name": "unary_dsbs", "python": "@wp.kernel\ndef unary_dsbs(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dsbs_418a2aa9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dsbs_418a2aa9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dsbs_418a2aa9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dsbs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dsbs_418a2aa9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dsbs_418a2aa9 *_wp_args,\n    wp_args_unary_dsbs_418a2aa9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dsbs(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dsbs(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dsbs_418a2aa9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dsbs_418a2aa9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dsbs_418a2aa9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dsbs_418a2aa9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dsbs_418a2aa9 *_wp_args,\n    wp_args_unary_dsbs_418a2aa9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dsbs_418a2aa9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 415, "kernel_name": "elementwise_aehr", "python": "@wp.kernel\ndef elementwise_aehr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_aehr_5ad7c45e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aehr_5ad7c45e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aehr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aehr_5ad7c45e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_args,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aehr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aehr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aehr_5ad7c45e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aehr_5ad7c45e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aehr_5ad7c45e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_args,\n    wp_args_elementwise_aehr_5ad7c45e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aehr_5ad7c45e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 416, "kernel_name": "reduce_iibx", "python": "@wp.kernel\ndef reduce_iibx(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iibx_1afe26ac {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iibx_1afe26ac_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iibx_1afe26ac *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iibx(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iibx_1afe26ac_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iibx_1afe26ac *_wp_args,\n    wp_args_reduce_iibx_1afe26ac *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iibx(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iibx(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iibx_1afe26ac_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iibx_1afe26ac *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iibx_1afe26ac_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iibx_1afe26ac_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iibx_1afe26ac *_wp_args,\n    wp_args_reduce_iibx_1afe26ac *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iibx_1afe26ac_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 417, "kernel_name": "nested_nsbv", "python": "@wp.kernel\ndef nested_nsbv(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.39:\n        if val > 0.89:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nsbv_69bb320b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nsbv_69bb320b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nsbv_69bb320b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 0.89;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nsbv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.89:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nsbv_69bb320b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nsbv_69bb320b *_wp_args,\n    wp_args_nested_nsbv_69bb320b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 0.89;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nsbv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.89:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.89:                                                                <L 8>\n    }\n    // adj: if val > -0.39:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nsbv(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nsbv_69bb320b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nsbv_69bb320b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nsbv_69bb320b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nsbv_69bb320b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nsbv_69bb320b *_wp_args,\n    wp_args_nested_nsbv_69bb320b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nsbv_69bb320b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 418, "kernel_name": "nested_ruqf", "python": "@wp.kernel\ndef nested_ruqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.16:\n        if val > 1.3:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ruqf_dc769b36 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ruqf_dc769b36_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ruqf_dc769b36 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.16;\n    const wp::float32 var_5 = -0.16;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ruqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.16:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.3:                                                                      <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ruqf_dc769b36_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ruqf_dc769b36 *_wp_args,\n    wp_args_nested_ruqf_dc769b36 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.16;\n    const wp::float32 var_5 = -0.16;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ruqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.16:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.3:                                                                      <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.3:                                                                 <L 8>\n    }\n    // adj: if val > -0.16:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ruqf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ruqf_dc769b36_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ruqf_dc769b36 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ruqf_dc769b36_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ruqf_dc769b36_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ruqf_dc769b36 *_wp_args,\n    wp_args_nested_ruqf_dc769b36 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ruqf_dc769b36_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 419, "kernel_name": "elementwise_sjkj", "python": "@wp.kernel\ndef elementwise_sjkj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_sjkj_44bd0aa8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_sjkj_44bd0aa8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_sjkj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_sjkj_44bd0aa8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_args,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_sjkj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_sjkj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_sjkj_44bd0aa8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_sjkj_44bd0aa8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_sjkj_44bd0aa8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_args,\n    wp_args_elementwise_sjkj_44bd0aa8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_sjkj_44bd0aa8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 420, "kernel_name": "nested_xtsi", "python": "@wp.kernel\ndef nested_xtsi(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.19:\n        if val > 1.15:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_xtsi_46d5f047 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_xtsi_46d5f047_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_xtsi_46d5f047 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.19;\n    const wp::float32 var_5 = -0.19;\n    bool var_6;\n    const wp::float32 var_7 = 1.15;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_xtsi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.19:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.15:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_xtsi_46d5f047_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_xtsi_46d5f047 *_wp_args,\n    wp_args_nested_xtsi_46d5f047 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.19;\n    const wp::float32 var_5 = -0.19;\n    bool var_6;\n    const wp::float32 var_7 = 1.15;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_xtsi(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.19:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.15:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.15:                                                                <L 8>\n    }\n    // adj: if val > -0.19:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_xtsi(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_xtsi_46d5f047_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_xtsi_46d5f047 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_xtsi_46d5f047_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_xtsi_46d5f047_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_xtsi_46d5f047 *_wp_args,\n    wp_args_nested_xtsi_46d5f047 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_xtsi_46d5f047_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 421, "kernel_name": "unary_syxt", "python": "@wp.kernel\ndef unary_syxt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_syxt_ddf130cc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_syxt_ddf130cc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_syxt_ddf130cc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_syxt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_syxt_ddf130cc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_syxt_ddf130cc *_wp_args,\n    wp_args_unary_syxt_ddf130cc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_syxt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_syxt(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_syxt_ddf130cc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_syxt_ddf130cc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_syxt_ddf130cc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_syxt_ddf130cc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_syxt_ddf130cc *_wp_args,\n    wp_args_unary_syxt_ddf130cc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_syxt_ddf130cc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 422, "kernel_name": "nested_nvkn", "python": "@wp.kernel\ndef nested_nvkn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.25:\n        if val > 1.01:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nvkn_b954a637 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nvkn_b954a637_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nvkn_b954a637 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 1.01;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nvkn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.01:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nvkn_b954a637_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nvkn_b954a637 *_wp_args,\n    wp_args_nested_nvkn_b954a637 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 1.01;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nvkn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.01:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.01:                                                                <L 8>\n    }\n    // adj: if val > -0.25:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nvkn(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nvkn_b954a637_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nvkn_b954a637 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nvkn_b954a637_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nvkn_b954a637_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nvkn_b954a637 *_wp_args,\n    wp_args_nested_nvkn_b954a637 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nvkn_b954a637_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 423, "kernel_name": "compound_pthx", "python": "@wp.kernel\ndef compound_pthx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pthx_fbc5fe57 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pthx_fbc5fe57_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pthx_fbc5fe57 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pthx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pthx_fbc5fe57_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pthx_fbc5fe57 *_wp_args,\n    wp_args_compound_pthx_fbc5fe57 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pthx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pthx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pthx_fbc5fe57_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pthx_fbc5fe57 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pthx_fbc5fe57_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pthx_fbc5fe57_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pthx_fbc5fe57 *_wp_args,\n    wp_args_compound_pthx_fbc5fe57 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pthx_fbc5fe57_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 424, "kernel_name": "compound_spte", "python": "@wp.kernel\ndef compound_spte(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_spte_015f3958 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_spte_015f3958_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_spte_015f3958 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_spte(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_spte_015f3958_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_spte_015f3958 *_wp_args,\n    wp_args_compound_spte_015f3958 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_spte(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_spte(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_spte_015f3958_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_spte_015f3958 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_spte_015f3958_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_spte_015f3958_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_spte_015f3958 *_wp_args,\n    wp_args_compound_spte_015f3958 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_spte_015f3958_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 425, "kernel_name": "elementwise_amlb", "python": "@wp.kernel\ndef elementwise_amlb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_amlb_c5205931 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_amlb_c5205931_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_amlb_c5205931 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_amlb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_amlb_c5205931_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_amlb_c5205931 *_wp_args,\n    wp_args_elementwise_amlb_c5205931 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_amlb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_amlb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_amlb_c5205931_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_amlb_c5205931 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_amlb_c5205931_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_amlb_c5205931_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_amlb_c5205931 *_wp_args,\n    wp_args_elementwise_amlb_c5205931 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_amlb_c5205931_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 426, "kernel_name": "compound_pppj", "python": "@wp.kernel\ndef compound_pppj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pppj_00957dcc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pppj_00957dcc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pppj_00957dcc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pppj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pppj_00957dcc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pppj_00957dcc *_wp_args,\n    wp_args_compound_pppj_00957dcc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pppj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pppj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pppj_00957dcc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pppj_00957dcc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pppj_00957dcc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pppj_00957dcc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pppj_00957dcc *_wp_args,\n    wp_args_compound_pppj_00957dcc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pppj_00957dcc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 427, "kernel_name": "nested_rnub", "python": "@wp.kernel\ndef nested_rnub(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.42:\n        if val > 0.86:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_rnub_638f5671 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_rnub_638f5671_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_rnub_638f5671 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.42;\n    const wp::float32 var_5 = -0.42;\n    bool var_6;\n    const wp::float32 var_7 = 0.86;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_rnub(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.42:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.86:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_rnub_638f5671_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_rnub_638f5671 *_wp_args,\n    wp_args_nested_rnub_638f5671 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.42;\n    const wp::float32 var_5 = -0.42;\n    bool var_6;\n    const wp::float32 var_7 = 0.86;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_rnub(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.42:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.86:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.86:                                                                <L 8>\n    }\n    // adj: if val > -0.42:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_rnub(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_rnub_638f5671_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_rnub_638f5671 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_rnub_638f5671_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_rnub_638f5671_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_rnub_638f5671 *_wp_args,\n    wp_args_nested_rnub_638f5671 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_rnub_638f5671_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 428, "kernel_name": "vec_lpfb", "python": "@wp.kernel\ndef vec_lpfb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_lpfb_67bc9e71 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_lpfb_67bc9e71_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lpfb_67bc9e71 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_lpfb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_lpfb_67bc9e71_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_lpfb_67bc9e71 *_wp_args,\n    wp_args_vec_lpfb_67bc9e71 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_lpfb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_lpfb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_lpfb_67bc9e71_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lpfb_67bc9e71 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lpfb_67bc9e71_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_lpfb_67bc9e71_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_lpfb_67bc9e71 *_wp_args,\n    wp_args_vec_lpfb_67bc9e71 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_lpfb_67bc9e71_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 429, "kernel_name": "vec_knne", "python": "@wp.kernel\ndef vec_knne(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_knne_be42f7cf {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_knne_be42f7cf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_knne_be42f7cf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_knne(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_knne_be42f7cf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_knne_be42f7cf *_wp_args,\n    wp_args_vec_knne_be42f7cf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_knne(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_knne(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_knne_be42f7cf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_knne_be42f7cf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_knne_be42f7cf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_knne_be42f7cf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_knne_be42f7cf *_wp_args,\n    wp_args_vec_knne_be42f7cf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_knne_be42f7cf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 430, "kernel_name": "nested_nmwh", "python": "@wp.kernel\ndef nested_nmwh(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.17:\n        if val > 1.25:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nmwh_358215a4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nmwh_358215a4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nmwh_358215a4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    bool var_5;\n    const wp::float32 var_6 = 1.25;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_nmwh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.17:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.25:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_nmwh_358215a4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nmwh_358215a4 *_wp_args,\n    wp_args_nested_nmwh_358215a4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.17;\n    bool var_5;\n    const wp::float32 var_6 = 1.25;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_nmwh(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.17:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.25:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.25:                                                                <L 8>\n    }\n    // adj: if val > 0.17:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nmwh(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nmwh_358215a4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nmwh_358215a4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nmwh_358215a4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nmwh_358215a4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nmwh_358215a4 *_wp_args,\n    wp_args_nested_nmwh_358215a4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nmwh_358215a4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 431, "kernel_name": "vec_ksqp", "python": "@wp.kernel\ndef vec_ksqp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_ksqp_dbbd9a51 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_ksqp_dbbd9a51_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_ksqp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_ksqp_dbbd9a51_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_args,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_ksqp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_ksqp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_ksqp_dbbd9a51_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ksqp_dbbd9a51_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_ksqp_dbbd9a51_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_args,\n    wp_args_vec_ksqp_dbbd9a51 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_ksqp_dbbd9a51_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 432, "kernel_name": "scalar_arr_ceqq", "python": "@wp.kernel\ndef scalar_arr_ceqq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_ceqq_36d0f3bf {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ceqq_36d0f3bf_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ceqq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_ceqq_36d0f3bf_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_args,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ceqq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ceqq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ceqq_36d0f3bf_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ceqq_36d0f3bf_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ceqq_36d0f3bf_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_args,\n    wp_args_scalar_arr_ceqq_36d0f3bf *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ceqq_36d0f3bf_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 433, "kernel_name": "unary_djyw", "python": "@wp.kernel\ndef unary_djyw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_djyw_2a780756 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_djyw_2a780756_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_djyw_2a780756 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_djyw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_djyw_2a780756_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_djyw_2a780756 *_wp_args,\n    wp_args_unary_djyw_2a780756 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_djyw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_djyw(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_djyw_2a780756_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_djyw_2a780756 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_djyw_2a780756_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_djyw_2a780756_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_djyw_2a780756 *_wp_args,\n    wp_args_unary_djyw_2a780756 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_djyw_2a780756_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 434, "kernel_name": "loop_hkxr", "python": "@wp.kernel\ndef loop_hkxr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hkxr_0c1d5450 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hkxr_0c1d5450_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hkxr_0c1d5450 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hkxr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hkxr_0c1d5450_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hkxr_0c1d5450 *_wp_args,\n    wp_args_loop_hkxr_0c1d5450 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hkxr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hkxr(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hkxr_0c1d5450_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hkxr_0c1d5450 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hkxr_0c1d5450_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hkxr_0c1d5450_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hkxr_0c1d5450 *_wp_args,\n    wp_args_loop_hkxr_0c1d5450 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hkxr_0c1d5450_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 435, "kernel_name": "scalar_arr_tktw", "python": "@wp.kernel\ndef scalar_arr_tktw(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_tktw_dfc6b902 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_tktw_dfc6b902_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_tktw(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_tktw_dfc6b902_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_args,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_tktw(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_tktw(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_tktw_dfc6b902_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tktw_dfc6b902_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_tktw_dfc6b902_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_args,\n    wp_args_scalar_arr_tktw_dfc6b902 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tktw_dfc6b902_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 436, "kernel_name": "loop_hylq", "python": "@wp.kernel\ndef loop_hylq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hylq_f4f3f661 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hylq_f4f3f661_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hylq_f4f3f661 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hylq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hylq_f4f3f661_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hylq_f4f3f661 *_wp_args,\n    wp_args_loop_hylq_f4f3f661 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hylq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hylq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hylq_f4f3f661_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hylq_f4f3f661 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hylq_f4f3f661_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hylq_f4f3f661_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hylq_f4f3f661 *_wp_args,\n    wp_args_loop_hylq_f4f3f661 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hylq_f4f3f661_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 437, "kernel_name": "branch_fgrf", "python": "@wp.kernel\ndef branch_fgrf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.95:\n        b[tid] = val * 0.9\n    else:\n        b[tid] = val - 1.3", "cpp": "struct wp_args_branch_fgrf_57198e2e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fgrf_57198e2e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fgrf_57198e2e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.95;\n    const wp::float32 var_5 = -0.95;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.3;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fgrf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.95:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.3                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fgrf_57198e2e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fgrf_57198e2e *_wp_args,\n    wp_args_branch_fgrf_57198e2e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.95;\n    const wp::float32 var_5 = -0.95;\n    bool var_6;\n    const wp::float32 var_7 = 0.9;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.3;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fgrf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.95:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 0.9                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 1.3                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 1.3                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 0.9                                                            <L 8>\n    }\n    // adj: if val > -0.95:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fgrf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fgrf_57198e2e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fgrf_57198e2e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fgrf_57198e2e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fgrf_57198e2e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fgrf_57198e2e *_wp_args,\n    wp_args_branch_fgrf_57198e2e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fgrf_57198e2e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 438, "kernel_name": "vec_vgef", "python": "@wp.kernel\ndef vec_vgef(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_vgef_f1c43e3e {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_vgef_f1c43e3e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_vgef_f1c43e3e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_vgef(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_vgef_f1c43e3e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_vgef_f1c43e3e *_wp_args,\n    wp_args_vec_vgef_f1c43e3e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_vgef(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_vgef(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_vgef_f1c43e3e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_vgef_f1c43e3e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_vgef_f1c43e3e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_vgef_f1c43e3e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_vgef_f1c43e3e *_wp_args,\n    wp_args_vec_vgef_f1c43e3e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_vgef_f1c43e3e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 439, "kernel_name": "compound_ovsg", "python": "@wp.kernel\ndef compound_ovsg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ovsg_a6498702 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ovsg_a6498702_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ovsg_a6498702 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ovsg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ovsg_a6498702_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ovsg_a6498702 *_wp_args,\n    wp_args_compound_ovsg_a6498702 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ovsg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ovsg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ovsg_a6498702_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ovsg_a6498702 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ovsg_a6498702_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ovsg_a6498702_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ovsg_a6498702 *_wp_args,\n    wp_args_compound_ovsg_a6498702 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ovsg_a6498702_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 440, "kernel_name": "branch_fqvb", "python": "@wp.kernel\ndef branch_fqvb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.96:\n        b[tid] = val * 1.2\n    else:\n        b[tid] = val + 2.4", "cpp": "struct wp_args_branch_fqvb_8e0224da {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fqvb_8e0224da_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqvb_8e0224da *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 1.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.4;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fqvb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.2                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.4                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fqvb_8e0224da_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fqvb_8e0224da *_wp_args,\n    wp_args_branch_fqvb_8e0224da *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 1.2;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.4;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fqvb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 1.2                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.4                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.4                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 1.2                                                            <L 8>\n    }\n    // adj: if val > -0.96:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fqvb(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fqvb_8e0224da_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqvb_8e0224da *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqvb_8e0224da_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fqvb_8e0224da_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fqvb_8e0224da *_wp_args,\n    wp_args_branch_fqvb_8e0224da *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fqvb_8e0224da_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 441, "kernel_name": "elementwise_atdw", "python": "@wp.kernel\ndef elementwise_atdw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_atdw_2c647a80 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_atdw_2c647a80_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_atdw_2c647a80 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_atdw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_atdw_2c647a80_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_atdw_2c647a80 *_wp_args,\n    wp_args_elementwise_atdw_2c647a80 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_atdw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_atdw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_atdw_2c647a80_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_atdw_2c647a80 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_atdw_2c647a80_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_atdw_2c647a80_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_atdw_2c647a80 *_wp_args,\n    wp_args_elementwise_atdw_2c647a80 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_atdw_2c647a80_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 442, "kernel_name": "compound_ocbh", "python": "@wp.kernel\ndef compound_ocbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_ocbh_5daa9612 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_ocbh_5daa9612_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ocbh_5daa9612 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_ocbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_ocbh_5daa9612_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_ocbh_5daa9612 *_wp_args,\n    wp_args_compound_ocbh_5daa9612 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_ocbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_ocbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_ocbh_5daa9612_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ocbh_5daa9612 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ocbh_5daa9612_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_ocbh_5daa9612_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_ocbh_5daa9612 *_wp_args,\n    wp_args_compound_ocbh_5daa9612 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_ocbh_5daa9612_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 443, "kernel_name": "compound_zlcx", "python": "@wp.kernel\ndef compound_zlcx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_zlcx_68caf1f2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_zlcx_68caf1f2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_zlcx_68caf1f2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_zlcx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_zlcx_68caf1f2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_zlcx_68caf1f2 *_wp_args,\n    wp_args_compound_zlcx_68caf1f2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_zlcx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_zlcx(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_zlcx_68caf1f2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_zlcx_68caf1f2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_zlcx_68caf1f2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_zlcx_68caf1f2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_zlcx_68caf1f2 *_wp_args,\n    wp_args_compound_zlcx_68caf1f2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_zlcx_68caf1f2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 444, "kernel_name": "reduce_zvgr", "python": "@wp.kernel\ndef reduce_zvgr(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_zvgr_9cc1f2b6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_zvgr_9cc1f2b6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_zvgr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_zvgr_9cc1f2b6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_args,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_zvgr(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_zvgr(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_zvgr_9cc1f2b6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zvgr_9cc1f2b6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_zvgr_9cc1f2b6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_args,\n    wp_args_reduce_zvgr_9cc1f2b6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_zvgr_9cc1f2b6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 445, "kernel_name": "vec_kppl", "python": "@wp.kernel\ndef vec_kppl(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kppl_d4dcf7b7 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kppl_d4dcf7b7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kppl(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kppl_d4dcf7b7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_args,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kppl(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kppl(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kppl_d4dcf7b7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kppl_d4dcf7b7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kppl_d4dcf7b7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_args,\n    wp_args_vec_kppl_d4dcf7b7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kppl_d4dcf7b7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 446, "kernel_name": "multi_mdgk", "python": "@wp.kernel\ndef multi_mdgk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mdgk_e2f10192 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mdgk_e2f10192_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mdgk_e2f10192 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mdgk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mdgk_e2f10192_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mdgk_e2f10192 *_wp_args,\n    wp_args_multi_mdgk_e2f10192 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mdgk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mdgk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mdgk_e2f10192_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mdgk_e2f10192 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mdgk_e2f10192_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mdgk_e2f10192_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mdgk_e2f10192 *_wp_args,\n    wp_args_multi_mdgk_e2f10192 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mdgk_e2f10192_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 447, "kernel_name": "compound_xddl", "python": "@wp.kernel\ndef compound_xddl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_xddl_af4d8695 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_xddl_af4d8695_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xddl_af4d8695 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_xddl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_xddl_af4d8695_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xddl_af4d8695 *_wp_args,\n    wp_args_compound_xddl_af4d8695 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_xddl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_xddl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_xddl_af4d8695_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xddl_af4d8695 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xddl_af4d8695_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_xddl_af4d8695_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xddl_af4d8695 *_wp_args,\n    wp_args_compound_xddl_af4d8695 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xddl_af4d8695_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 448, "kernel_name": "vec_qgqn", "python": "@wp.kernel\ndef vec_qgqn(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_qgqn_565a5d2d {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_qgqn_565a5d2d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qgqn_565a5d2d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_qgqn(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_qgqn_565a5d2d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_qgqn_565a5d2d *_wp_args,\n    wp_args_vec_qgqn_565a5d2d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_qgqn(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_qgqn(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_qgqn_565a5d2d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qgqn_565a5d2d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qgqn_565a5d2d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_qgqn_565a5d2d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_qgqn_565a5d2d *_wp_args,\n    wp_args_vec_qgqn_565a5d2d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_qgqn_565a5d2d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 449, "kernel_name": "branch_ufrd", "python": "@wp.kernel\ndef branch_ufrd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.03:\n        b[tid] = val - 1.7\n    else:\n        b[tid] = val * 1.2", "cpp": "struct wp_args_branch_ufrd_91e5228c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_ufrd_91e5228c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_ufrd_91e5228c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.03;\n    const wp::float32 var_5 = -0.03;\n    bool var_6;\n    const wp::float32 var_7 = 1.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.2;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_ufrd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.03:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.2                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_ufrd_91e5228c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_ufrd_91e5228c *_wp_args,\n    wp_args_branch_ufrd_91e5228c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.03;\n    const wp::float32 var_5 = -0.03;\n    bool var_6;\n    const wp::float32 var_7 = 1.7;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.2;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_ufrd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.03:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.7                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.2                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 1.2                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.7                                                            <L 8>\n    }\n    // adj: if val > -0.03:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_ufrd(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_ufrd_91e5228c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_ufrd_91e5228c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_ufrd_91e5228c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_ufrd_91e5228c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_ufrd_91e5228c *_wp_args,\n    wp_args_branch_ufrd_91e5228c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_ufrd_91e5228c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 450, "kernel_name": "vec_kvds", "python": "@wp.kernel\ndef vec_kvds(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kvds_20307a52 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kvds_20307a52_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kvds_20307a52 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kvds(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kvds_20307a52_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kvds_20307a52 *_wp_args,\n    wp_args_vec_kvds_20307a52 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kvds(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kvds(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kvds_20307a52_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kvds_20307a52 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kvds_20307a52_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kvds_20307a52_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kvds_20307a52 *_wp_args,\n    wp_args_vec_kvds_20307a52 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kvds_20307a52_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 451, "kernel_name": "branch_wsdr", "python": "@wp.kernel\ndef branch_wsdr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.91:\n        b[tid] = val - 1.4\n    else:\n        b[tid] = val + 0.5", "cpp": "struct wp_args_branch_wsdr_2d9e1ce0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_wsdr_2d9e1ce0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.91;\n    const wp::float32 var_5 = -0.91;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.5;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_wsdr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.91:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_wsdr_2d9e1ce0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_args,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.91;\n    const wp::float32 var_5 = -0.91;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.5;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_wsdr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.91:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.5                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 0.5                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.4                                                            <L 8>\n    }\n    // adj: if val > -0.91:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_wsdr(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_wsdr_2d9e1ce0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_wsdr_2d9e1ce0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_wsdr_2d9e1ce0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_args,\n    wp_args_branch_wsdr_2d9e1ce0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_wsdr_2d9e1ce0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 452, "kernel_name": "nested_ncqv", "python": "@wp.kernel\ndef nested_ncqv(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.06:\n        if val > 1.4:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ncqv_2a0517b2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ncqv_2a0517b2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ncqv_2a0517b2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_ncqv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.06:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.4:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_ncqv_2a0517b2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ncqv_2a0517b2 *_wp_args,\n    wp_args_nested_ncqv_2a0517b2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_ncqv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.06:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.4:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.4:                                                                 <L 8>\n    }\n    // adj: if val > 0.06:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ncqv(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ncqv_2a0517b2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ncqv_2a0517b2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ncqv_2a0517b2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ncqv_2a0517b2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ncqv_2a0517b2 *_wp_args,\n    wp_args_nested_ncqv_2a0517b2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ncqv_2a0517b2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 453, "kernel_name": "branch_glix", "python": "@wp.kernel\ndef branch_glix(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.4:\n        b[tid] = val + 2.9\n    else:\n        b[tid] = val + 2.9", "cpp": "struct wp_args_branch_glix_7a5e5940 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_glix_7a5e5940_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_glix_7a5e5940 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_glix(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.4:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 2.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_glix_7a5e5940_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_glix_7a5e5940 *_wp_args,\n    wp_args_branch_glix_7a5e5940 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.4;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_glix(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.4:                                                                          <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 2.9                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 2.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.9                                                            <L 8>\n    }\n    // adj: if val > 0.4:                                                                     <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_glix(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_glix_7a5e5940_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_glix_7a5e5940 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_glix_7a5e5940_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_glix_7a5e5940_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_glix_7a5e5940 *_wp_args,\n    wp_args_branch_glix_7a5e5940 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_glix_7a5e5940_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 454, "kernel_name": "vec_kjow", "python": "@wp.kernel\ndef vec_kjow(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kjow_2ffc4e6c {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kjow_2ffc4e6c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjow_2ffc4e6c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kjow(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kjow_2ffc4e6c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kjow_2ffc4e6c *_wp_args,\n    wp_args_vec_kjow_2ffc4e6c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kjow(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kjow(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kjow_2ffc4e6c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjow_2ffc4e6c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjow_2ffc4e6c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kjow_2ffc4e6c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kjow_2ffc4e6c *_wp_args,\n    wp_args_vec_kjow_2ffc4e6c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kjow_2ffc4e6c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 455, "kernel_name": "vec_kiys", "python": "@wp.kernel\ndef vec_kiys(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_kiys_fabe3a09 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_kiys_fabe3a09_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kiys_fabe3a09 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_kiys(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_kiys_fabe3a09_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kiys_fabe3a09 *_wp_args,\n    wp_args_vec_kiys_fabe3a09 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_kiys(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kiys(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kiys_fabe3a09_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kiys_fabe3a09 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kiys_fabe3a09_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kiys_fabe3a09_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kiys_fabe3a09 *_wp_args,\n    wp_args_vec_kiys_fabe3a09 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kiys_fabe3a09_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 456, "kernel_name": "scalar_arr_clnz", "python": "@wp.kernel\ndef scalar_arr_clnz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_clnz_aedc97bc {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_clnz_aedc97bc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_clnz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_clnz_aedc97bc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_args,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_clnz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_clnz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_clnz_aedc97bc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_clnz_aedc97bc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_clnz_aedc97bc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_args,\n    wp_args_scalar_arr_clnz_aedc97bc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_clnz_aedc97bc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 457, "kernel_name": "nested_snqg", "python": "@wp.kernel\ndef nested_snqg(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.1:\n        if val > 0.82:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_snqg_412e4b81 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_snqg_412e4b81_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snqg_412e4b81 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    const wp::float32 var_5 = -0.1;\n    bool var_6;\n    const wp::float32 var_7 = 0.82;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_snqg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.1:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.82:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_snqg_412e4b81_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snqg_412e4b81 *_wp_args,\n    wp_args_nested_snqg_412e4b81 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.1;\n    const wp::float32 var_5 = -0.1;\n    bool var_6;\n    const wp::float32 var_7 = 0.82;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_snqg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.1:                                                                         <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.82:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.82:                                                                <L 8>\n    }\n    // adj: if val > -0.1:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_snqg(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_snqg_412e4b81_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snqg_412e4b81 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snqg_412e4b81_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_snqg_412e4b81_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snqg_412e4b81 *_wp_args,\n    wp_args_nested_snqg_412e4b81 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snqg_412e4b81_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 458, "kernel_name": "loop_vqyg", "python": "@wp.kernel\ndef loop_vqyg(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_vqyg_52237f5f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_vqyg_52237f5f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_vqyg_52237f5f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_vqyg(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_vqyg_52237f5f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_vqyg_52237f5f *_wp_args,\n    wp_args_loop_vqyg_52237f5f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_vqyg(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_vqyg(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_vqyg_52237f5f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_vqyg_52237f5f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_vqyg_52237f5f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_vqyg_52237f5f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_vqyg_52237f5f *_wp_args,\n    wp_args_loop_vqyg_52237f5f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_vqyg_52237f5f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 459, "kernel_name": "compound_qsol", "python": "@wp.kernel\ndef compound_qsol(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_qsol_1f6fd6bc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_qsol_1f6fd6bc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qsol_1f6fd6bc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_qsol(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_qsol_1f6fd6bc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_qsol_1f6fd6bc *_wp_args,\n    wp_args_compound_qsol_1f6fd6bc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_qsol(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_qsol(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_qsol_1f6fd6bc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qsol_1f6fd6bc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qsol_1f6fd6bc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_qsol_1f6fd6bc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_qsol_1f6fd6bc *_wp_args,\n    wp_args_compound_qsol_1f6fd6bc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_qsol_1f6fd6bc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 460, "kernel_name": "scalar_arr_xylz", "python": "@wp.kernel\ndef scalar_arr_xylz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_xylz_e1c41158 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_xylz_e1c41158_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_xylz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_xylz_e1c41158_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_args,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_xylz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::sub(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_xylz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_xylz_e1c41158_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_xylz_e1c41158_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_xylz_e1c41158_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_args,\n    wp_args_scalar_arr_xylz_e1c41158 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_xylz_e1c41158_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 461, "kernel_name": "branch_qfeu", "python": "@wp.kernel\ndef branch_qfeu(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.96:\n        b[tid] = val * 2.5\n    else:\n        b[tid] = val * 1.0", "cpp": "struct wp_args_branch_qfeu_486e8f70 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_qfeu_486e8f70_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qfeu_486e8f70 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 2.5;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.0;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_qfeu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 2.5                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_qfeu_486e8f70_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_qfeu_486e8f70 *_wp_args,\n    wp_args_branch_qfeu_486e8f70 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.96;\n    const wp::float32 var_5 = -0.96;\n    bool var_6;\n    const wp::float32 var_7 = 2.5;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 1.0;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_qfeu(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.96:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val * 2.5                                                                 <L 8>\n        var_8 = wp::mul(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val * 1.0                                                                 <L 10>\n        var_10 = wp::mul(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val * 1.0                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val * 2.5                                                            <L 8>\n    }\n    // adj: if val > -0.96:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_qfeu(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_qfeu_486e8f70_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qfeu_486e8f70 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qfeu_486e8f70_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_qfeu_486e8f70_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_qfeu_486e8f70 *_wp_args,\n    wp_args_branch_qfeu_486e8f70 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_qfeu_486e8f70_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 462, "kernel_name": "elementwise_ayyi", "python": "@wp.kernel\ndef elementwise_ayyi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_ayyi_68058edb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ayyi_68058edb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ayyi_68058edb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ayyi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ayyi_68058edb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ayyi_68058edb *_wp_args,\n    wp_args_elementwise_ayyi_68058edb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ayyi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ayyi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ayyi_68058edb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ayyi_68058edb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ayyi_68058edb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ayyi_68058edb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ayyi_68058edb *_wp_args,\n    wp_args_elementwise_ayyi_68058edb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ayyi_68058edb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 463, "kernel_name": "compound_phfc", "python": "@wp.kernel\ndef compound_phfc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_phfc_bb325d14 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_phfc_bb325d14_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_phfc_bb325d14 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_phfc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_phfc_bb325d14_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_phfc_bb325d14 *_wp_args,\n    wp_args_compound_phfc_bb325d14 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_phfc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_phfc(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_phfc_bb325d14_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_phfc_bb325d14 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_phfc_bb325d14_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_phfc_bb325d14_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_phfc_bb325d14 *_wp_args,\n    wp_args_compound_phfc_bb325d14 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_phfc_bb325d14_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 464, "kernel_name": "nested_ouve", "python": "@wp.kernel\ndef nested_ouve(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.08:\n        if val > 0.54:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ouve_f347e990 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ouve_f347e990_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ouve_f347e990 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    const wp::float32 var_5 = -0.08;\n    bool var_6;\n    const wp::float32 var_7 = 0.54;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ouve(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.08:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.54:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ouve_f347e990_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ouve_f347e990 *_wp_args,\n    wp_args_nested_ouve_f347e990 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    const wp::float32 var_5 = -0.08;\n    bool var_6;\n    const wp::float32 var_7 = 0.54;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ouve(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.08:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 0.54:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.54:                                                                <L 8>\n    }\n    // adj: if val > -0.08:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ouve(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ouve_f347e990_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ouve_f347e990 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ouve_f347e990_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ouve_f347e990_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ouve_f347e990 *_wp_args,\n    wp_args_nested_ouve_f347e990 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ouve_f347e990_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 465, "kernel_name": "loop_huav", "python": "@wp.kernel\ndef loop_huav(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_huav_a8122fec {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_huav_a8122fec_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_huav_a8122fec *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_huav(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_huav_a8122fec_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_huav_a8122fec *_wp_args,\n    wp_args_loop_huav_a8122fec *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_huav(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_huav(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_huav_a8122fec_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_huav_a8122fec *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_huav_a8122fec_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_huav_a8122fec_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_huav_a8122fec *_wp_args,\n    wp_args_loop_huav_a8122fec *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_huav_a8122fec_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 466, "kernel_name": "elementwise_acna", "python": "@wp.kernel\ndef elementwise_acna(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_acna_bff99d59 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_acna_bff99d59_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_acna_bff99d59 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_acna(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_acna_bff99d59_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_acna_bff99d59 *_wp_args,\n    wp_args_elementwise_acna_bff99d59 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_acna(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_acna(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_acna_bff99d59_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_acna_bff99d59 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_acna_bff99d59_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_acna_bff99d59_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_acna_bff99d59 *_wp_args,\n    wp_args_elementwise_acna_bff99d59 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_acna_bff99d59_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 467, "kernel_name": "unary_dftb", "python": "@wp.kernel\ndef unary_dftb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dftb_05190e2f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dftb_05190e2f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dftb_05190e2f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dftb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dftb_05190e2f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dftb_05190e2f *_wp_args,\n    wp_args_unary_dftb_05190e2f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dftb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dftb(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dftb_05190e2f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dftb_05190e2f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dftb_05190e2f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dftb_05190e2f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dftb_05190e2f *_wp_args,\n    wp_args_unary_dftb_05190e2f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dftb_05190e2f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 468, "kernel_name": "multi_tspe", "python": "@wp.kernel\ndef multi_tspe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_tspe_74f1628b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_tspe_74f1628b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_tspe_74f1628b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_tspe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_tspe_74f1628b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_tspe_74f1628b *_wp_args,\n    wp_args_multi_tspe_74f1628b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_tspe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_tspe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_tspe_74f1628b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_tspe_74f1628b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_tspe_74f1628b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_tspe_74f1628b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_tspe_74f1628b *_wp_args,\n    wp_args_multi_tspe_74f1628b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_tspe_74f1628b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 469, "kernel_name": "nested_toaj", "python": "@wp.kernel\ndef nested_toaj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.04:\n        if val > 1.37:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_toaj_8c3760f5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_toaj_8c3760f5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_toaj_8c3760f5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.04;\n    const wp::float32 var_5 = -0.04;\n    bool var_6;\n    const wp::float32 var_7 = 1.37;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_toaj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.04:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.37:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_toaj_8c3760f5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_toaj_8c3760f5 *_wp_args,\n    wp_args_nested_toaj_8c3760f5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.04;\n    const wp::float32 var_5 = -0.04;\n    bool var_6;\n    const wp::float32 var_7 = 1.37;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_toaj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.04:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.37:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.37:                                                                <L 8>\n    }\n    // adj: if val > -0.04:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_toaj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_toaj_8c3760f5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_toaj_8c3760f5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_toaj_8c3760f5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_toaj_8c3760f5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_toaj_8c3760f5 *_wp_args,\n    wp_args_nested_toaj_8c3760f5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_toaj_8c3760f5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 470, "kernel_name": "loop_gqnb", "python": "@wp.kernel\ndef loop_gqnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_gqnb_497956f6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_gqnb_497956f6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqnb_497956f6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_gqnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_gqnb_497956f6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_gqnb_497956f6 *_wp_args,\n    wp_args_loop_gqnb_497956f6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_gqnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_gqnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_gqnb_497956f6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqnb_497956f6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqnb_497956f6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_gqnb_497956f6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_gqnb_497956f6 *_wp_args,\n    wp_args_loop_gqnb_497956f6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_gqnb_497956f6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 471, "kernel_name": "loop_hdmh", "python": "@wp.kernel\ndef loop_hdmh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hdmh_47c10a33 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hdmh_47c10a33_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hdmh_47c10a33 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hdmh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hdmh_47c10a33_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hdmh_47c10a33 *_wp_args,\n    wp_args_loop_hdmh_47c10a33 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hdmh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hdmh(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hdmh_47c10a33_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hdmh_47c10a33 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hdmh_47c10a33_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hdmh_47c10a33_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hdmh_47c10a33 *_wp_args,\n    wp_args_loop_hdmh_47c10a33 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hdmh_47c10a33_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 472, "kernel_name": "scalar_arr_cuvz", "python": "@wp.kernel\ndef scalar_arr_cuvz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_cuvz_212e0d87 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_cuvz_212e0d87_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_cuvz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_cuvz_212e0d87_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_args,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_cuvz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_cuvz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_cuvz_212e0d87_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cuvz_212e0d87_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_cuvz_212e0d87_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_args,\n    wp_args_scalar_arr_cuvz_212e0d87 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_cuvz_212e0d87_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 473, "kernel_name": "compound_rjwr", "python": "@wp.kernel\ndef compound_rjwr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_rjwr_12049fc0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_rjwr_12049fc0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rjwr_12049fc0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_rjwr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_rjwr_12049fc0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rjwr_12049fc0 *_wp_args,\n    wp_args_compound_rjwr_12049fc0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_rjwr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_rjwr(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_rjwr_12049fc0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rjwr_12049fc0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rjwr_12049fc0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_rjwr_12049fc0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rjwr_12049fc0 *_wp_args,\n    wp_args_compound_rjwr_12049fc0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rjwr_12049fc0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 474, "kernel_name": "reduce_xrlw", "python": "@wp.kernel\ndef reduce_xrlw(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_xrlw_8ce3cafb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_xrlw_8ce3cafb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_xrlw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_xrlw_8ce3cafb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_args,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_xrlw(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_xrlw(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_xrlw_8ce3cafb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xrlw_8ce3cafb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_xrlw_8ce3cafb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_args,\n    wp_args_reduce_xrlw_8ce3cafb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_xrlw_8ce3cafb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 475, "kernel_name": "nested_ndmp", "python": "@wp.kernel\ndef nested_ndmp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.36:\n        if val > 1.44:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ndmp_52f948b2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ndmp_52f948b2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ndmp_52f948b2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    const wp::float32 var_5 = -0.36;\n    bool var_6;\n    const wp::float32 var_7 = 1.44;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ndmp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.36:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.44:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ndmp_52f948b2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ndmp_52f948b2 *_wp_args,\n    wp_args_nested_ndmp_52f948b2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.36;\n    const wp::float32 var_5 = -0.36;\n    bool var_6;\n    const wp::float32 var_7 = 1.44;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ndmp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.36:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.44:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.44:                                                                <L 8>\n    }\n    // adj: if val > -0.36:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ndmp(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ndmp_52f948b2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ndmp_52f948b2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ndmp_52f948b2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ndmp_52f948b2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ndmp_52f948b2 *_wp_args,\n    wp_args_nested_ndmp_52f948b2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ndmp_52f948b2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 476, "kernel_name": "reduce_invp", "python": "@wp.kernel\ndef reduce_invp(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_invp_6d0c9055 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_invp_6d0c9055_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_invp_6d0c9055 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_invp(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_invp_6d0c9055_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_invp_6d0c9055 *_wp_args,\n    wp_args_reduce_invp_6d0c9055 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_invp(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_invp(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_invp_6d0c9055_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_invp_6d0c9055 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_invp_6d0c9055_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_invp_6d0c9055_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_invp_6d0c9055 *_wp_args,\n    wp_args_reduce_invp_6d0c9055 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_invp_6d0c9055_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 477, "kernel_name": "vec_zlny", "python": "@wp.kernel\ndef vec_zlny(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_zlny_a6adc621 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_zlny_a6adc621_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zlny_a6adc621 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_zlny(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_zlny_a6adc621_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zlny_a6adc621 *_wp_args,\n    wp_args_vec_zlny_a6adc621 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_zlny(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_zlny(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_zlny_a6adc621_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zlny_a6adc621 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zlny_a6adc621_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_zlny_a6adc621_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zlny_a6adc621 *_wp_args,\n    wp_args_vec_zlny_a6adc621 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zlny_a6adc621_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 478, "kernel_name": "multi_xygq", "python": "@wp.kernel\ndef multi_xygq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_xygq_42a43028 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_xygq_42a43028_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xygq_42a43028 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_xygq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_xygq_42a43028_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_xygq_42a43028 *_wp_args,\n    wp_args_multi_xygq_42a43028 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_xygq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_xygq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_xygq_42a43028_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xygq_42a43028 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xygq_42a43028_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_xygq_42a43028_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_xygq_42a43028 *_wp_args,\n    wp_args_multi_xygq_42a43028 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_xygq_42a43028_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 479, "kernel_name": "nested_nlyd", "python": "@wp.kernel\ndef nested_nlyd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.06:\n        if val > 1.36:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nlyd_ced26ce4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nlyd_ced26ce4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nlyd_ced26ce4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 1.36;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_nlyd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.36:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_nlyd_ced26ce4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nlyd_ced26ce4 *_wp_args,\n    wp_args_nested_nlyd_ced26ce4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.06;\n    const wp::float32 var_5 = -0.06;\n    bool var_6;\n    const wp::float32 var_7 = 1.36;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_nlyd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.06:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.36:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.36:                                                                <L 8>\n    }\n    // adj: if val > -0.06:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nlyd(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nlyd_ced26ce4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nlyd_ced26ce4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nlyd_ced26ce4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nlyd_ced26ce4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nlyd_ced26ce4 *_wp_args,\n    wp_args_nested_nlyd_ced26ce4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nlyd_ced26ce4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 480, "kernel_name": "elementwise_bnmi", "python": "@wp.kernel\ndef elementwise_bnmi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_bnmi_0a884ff6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bnmi_0a884ff6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bnmi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bnmi_0a884ff6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_args,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bnmi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bnmi(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bnmi_0a884ff6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bnmi_0a884ff6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bnmi_0a884ff6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_args,\n    wp_args_elementwise_bnmi_0a884ff6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bnmi_0a884ff6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 481, "kernel_name": "vec_krbp", "python": "@wp.kernel\ndef vec_krbp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_krbp_62223943 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_krbp_62223943_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_krbp_62223943 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_krbp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_krbp_62223943_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_krbp_62223943 *_wp_args,\n    wp_args_vec_krbp_62223943 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_krbp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_krbp(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_krbp_62223943_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_krbp_62223943 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_krbp_62223943_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_krbp_62223943_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_krbp_62223943 *_wp_args,\n    wp_args_vec_krbp_62223943 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_krbp_62223943_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 482, "kernel_name": "scalar_arr_ceee", "python": "@wp.kernel\ndef scalar_arr_ceee(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_ceee_ae5b7b8f {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ceee_ae5b7b8f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ceee(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_ceee_ae5b7b8f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_args,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ceee(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ceee(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ceee_ae5b7b8f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ceee_ae5b7b8f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ceee_ae5b7b8f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_args,\n    wp_args_scalar_arr_ceee_ae5b7b8f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ceee_ae5b7b8f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 483, "kernel_name": "elementwise_brsm", "python": "@wp.kernel\ndef elementwise_brsm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_brsm_7fe42262 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_brsm_7fe42262_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_brsm_7fe42262 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_brsm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_brsm_7fe42262_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_brsm_7fe42262 *_wp_args,\n    wp_args_elementwise_brsm_7fe42262 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_brsm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_brsm(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_brsm_7fe42262_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_brsm_7fe42262 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_brsm_7fe42262_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_brsm_7fe42262_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_brsm_7fe42262 *_wp_args,\n    wp_args_elementwise_brsm_7fe42262 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_brsm_7fe42262_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 484, "kernel_name": "nested_ownt", "python": "@wp.kernel\ndef nested_ownt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.13:\n        if val > 0.53:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ownt_12b04946 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ownt_12b04946_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ownt_12b04946 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    bool var_5;\n    const wp::float32 var_6 = 0.53;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_ownt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.13:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.53:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_ownt_12b04946_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ownt_12b04946 *_wp_args,\n    wp_args_nested_ownt_12b04946 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.13;\n    bool var_5;\n    const wp::float32 var_6 = 0.53;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_ownt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.13:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.53:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.53:                                                                <L 8>\n    }\n    // adj: if val > 0.13:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ownt(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ownt_12b04946_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ownt_12b04946 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ownt_12b04946_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ownt_12b04946_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ownt_12b04946 *_wp_args,\n    wp_args_nested_ownt_12b04946 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ownt_12b04946_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 485, "kernel_name": "elementwise_yads", "python": "@wp.kernel\ndef elementwise_yads(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_yads_46a9c5e4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_yads_46a9c5e4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_yads(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_yads_46a9c5e4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_args,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_yads(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_yads(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_yads_46a9c5e4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yads_46a9c5e4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_yads_46a9c5e4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_args,\n    wp_args_elementwise_yads_46a9c5e4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yads_46a9c5e4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 486, "kernel_name": "elementwise_ahxp", "python": "@wp.kernel\ndef elementwise_ahxp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_ahxp_336a0edc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ahxp_336a0edc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ahxp_336a0edc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ahxp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ahxp_336a0edc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ahxp_336a0edc *_wp_args,\n    wp_args_elementwise_ahxp_336a0edc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ahxp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ahxp(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ahxp_336a0edc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ahxp_336a0edc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ahxp_336a0edc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ahxp_336a0edc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ahxp_336a0edc *_wp_args,\n    wp_args_elementwise_ahxp_336a0edc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ahxp_336a0edc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 487, "kernel_name": "nested_zkmv", "python": "@wp.kernel\ndef nested_zkmv(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.25:\n        if val > 1.14:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_zkmv_96879ff1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_zkmv_96879ff1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zkmv_96879ff1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    bool var_5;\n    const wp::float32 var_6 = 1.14;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_zkmv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.25:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.14:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_zkmv_96879ff1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zkmv_96879ff1 *_wp_args,\n    wp_args_nested_zkmv_96879ff1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    bool var_5;\n    const wp::float32 var_6 = 1.14;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_zkmv(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.25:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.14:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.14:                                                                <L 8>\n    }\n    // adj: if val > 0.25:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_zkmv(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_zkmv_96879ff1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zkmv_96879ff1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zkmv_96879ff1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_zkmv_96879ff1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zkmv_96879ff1 *_wp_args,\n    wp_args_nested_zkmv_96879ff1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zkmv_96879ff1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 488, "kernel_name": "multi_wvcz", "python": "@wp.kernel\ndef multi_wvcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_wvcz_d6ca7c8c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_wvcz_d6ca7c8c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_wvcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_wvcz_d6ca7c8c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_args,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_wvcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_wvcz(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_wvcz_d6ca7c8c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wvcz_d6ca7c8c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_wvcz_d6ca7c8c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_args,\n    wp_args_multi_wvcz_d6ca7c8c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wvcz_d6ca7c8c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 489, "kernel_name": "elementwise_albq", "python": "@wp.kernel\ndef elementwise_albq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_albq_ef6ac141 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_albq_ef6ac141_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_albq_ef6ac141 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_albq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_albq_ef6ac141_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_albq_ef6ac141 *_wp_args,\n    wp_args_elementwise_albq_ef6ac141 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_albq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_albq(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_albq_ef6ac141_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_albq_ef6ac141 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_albq_ef6ac141_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_albq_ef6ac141_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_albq_ef6ac141 *_wp_args,\n    wp_args_elementwise_albq_ef6ac141 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_albq_ef6ac141_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 490, "kernel_name": "scalar_arr_ruch", "python": "@wp.kernel\ndef scalar_arr_ruch(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha - x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_ruch_39b5d043 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_ruch_39b5d043_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_ruch(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_ruch_39b5d043_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_args,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_ruch(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha - x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sub(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_sub(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha - x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_ruch(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_ruch_39b5d043_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ruch_39b5d043_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_ruch_39b5d043_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_args,\n    wp_args_scalar_arr_ruch_39b5d043 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_ruch_39b5d043_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 491, "kernel_name": "elementwise_ammb", "python": "@wp.kernel\ndef elementwise_ammb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_ammb_05ade78c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_ammb_05ade78c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ammb_05ade78c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_ammb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_ammb_05ade78c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_ammb_05ade78c *_wp_args,\n    wp_args_elementwise_ammb_05ade78c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_ammb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_ammb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_ammb_05ade78c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ammb_05ade78c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ammb_05ade78c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_ammb_05ade78c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_ammb_05ade78c *_wp_args,\n    wp_args_elementwise_ammb_05ade78c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_ammb_05ade78c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 492, "kernel_name": "compound_pjwa", "python": "@wp.kernel\ndef compound_pjwa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pjwa_5121f6e2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pjwa_5121f6e2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pjwa_5121f6e2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pjwa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pjwa_5121f6e2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pjwa_5121f6e2 *_wp_args,\n    wp_args_compound_pjwa_5121f6e2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pjwa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pjwa(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pjwa_5121f6e2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pjwa_5121f6e2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pjwa_5121f6e2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pjwa_5121f6e2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pjwa_5121f6e2 *_wp_args,\n    wp_args_compound_pjwa_5121f6e2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pjwa_5121f6e2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 493, "kernel_name": "compound_wtze", "python": "@wp.kernel\ndef compound_wtze(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_wtze_a022370a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_wtze_a022370a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wtze_a022370a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_wtze(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_wtze_a022370a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wtze_a022370a *_wp_args,\n    wp_args_compound_wtze_a022370a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_wtze(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_wtze(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_wtze_a022370a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wtze_a022370a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wtze_a022370a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_wtze_a022370a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wtze_a022370a *_wp_args,\n    wp_args_compound_wtze_a022370a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wtze_a022370a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 494, "kernel_name": "unary_eoyn", "python": "@wp.kernel\ndef unary_eoyn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_eoyn_e3ff50de {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_eoyn_e3ff50de_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eoyn_e3ff50de *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_eoyn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_eoyn_e3ff50de_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_eoyn_e3ff50de *_wp_args,\n    wp_args_unary_eoyn_e3ff50de *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_eoyn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_eoyn(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_eoyn_e3ff50de_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eoyn_e3ff50de *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eoyn_e3ff50de_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_eoyn_e3ff50de_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_eoyn_e3ff50de *_wp_args,\n    wp_args_unary_eoyn_e3ff50de *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_eoyn_e3ff50de_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 495, "kernel_name": "elementwise_azde", "python": "@wp.kernel\ndef elementwise_azde(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_azde_bb5c25e8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_azde_bb5c25e8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_azde(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_azde_bb5c25e8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_args,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_azde(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_azde(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_azde_bb5c25e8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azde_bb5c25e8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_azde_bb5c25e8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_args,\n    wp_args_elementwise_azde_bb5c25e8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_azde_bb5c25e8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 496, "kernel_name": "scalar_arr_bfvq", "python": "@wp.kernel\ndef scalar_arr_bfvq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_bfvq_24508f1e {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bfvq_24508f1e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bfvq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bfvq_24508f1e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_args,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bfvq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bfvq(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bfvq_24508f1e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bfvq_24508f1e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bfvq_24508f1e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_args,\n    wp_args_scalar_arr_bfvq_24508f1e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bfvq_24508f1e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 497, "kernel_name": "multi_ymix", "python": "@wp.kernel\ndef multi_ymix(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_ymix_470df4f1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_ymix_470df4f1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ymix_470df4f1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_ymix(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_ymix_470df4f1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ymix_470df4f1 *_wp_args,\n    wp_args_multi_ymix_470df4f1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_ymix(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_ymix(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_ymix_470df4f1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ymix_470df4f1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ymix_470df4f1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_ymix_470df4f1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ymix_470df4f1 *_wp_args,\n    wp_args_multi_ymix_470df4f1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ymix_470df4f1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 498, "kernel_name": "multi_lsib", "python": "@wp.kernel\ndef multi_lsib(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_lsib_7452ad27 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lsib_7452ad27_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lsib_7452ad27 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lsib(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lsib_7452ad27_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lsib_7452ad27 *_wp_args,\n    wp_args_multi_lsib_7452ad27 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lsib(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lsib(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lsib_7452ad27_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lsib_7452ad27 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lsib_7452ad27_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lsib_7452ad27_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lsib_7452ad27 *_wp_args,\n    wp_args_multi_lsib_7452ad27 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lsib_7452ad27_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 499, "kernel_name": "vec_kgjz", "python": "@wp.kernel\ndef vec_kgjz(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kgjz_9481c9ff {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kgjz_9481c9ff_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kgjz_9481c9ff *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kgjz(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kgjz_9481c9ff_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kgjz_9481c9ff *_wp_args,\n    wp_args_vec_kgjz_9481c9ff *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kgjz(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kgjz(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kgjz_9481c9ff_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kgjz_9481c9ff *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kgjz_9481c9ff_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kgjz_9481c9ff_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kgjz_9481c9ff *_wp_args,\n    wp_args_vec_kgjz_9481c9ff *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kgjz_9481c9ff_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
