{"id": 0, "kernel_name": "branch_guln", "python": "@wp.kernel\ndef branch_guln(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.68:\n        b[tid] = val * 1.5\n    else:\n        b[tid] = val - 1.1", "cpp": "struct wp_args_branch_guln_1101229a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_guln_1101229a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_guln_1101229a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.68;\n    bool var_5;\n    const wp::float32 var_6 = 1.5;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.1;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_guln(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.68:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.5                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.1                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_guln_1101229a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_guln_1101229a *_wp_args,\n    wp_args_branch_guln_1101229a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.68;\n    bool var_5;\n    const wp::float32 var_6 = 1.5;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.1;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_guln(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.68:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.5                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.1                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_sub(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val - 1.1                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 1.5                                                            <L 8>\n    }\n    // adj: if val > 0.68:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_guln(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_guln_1101229a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_guln_1101229a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_guln_1101229a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_guln_1101229a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_guln_1101229a *_wp_args,\n    wp_args_branch_guln_1101229a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_guln_1101229a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 1, "kernel_name": "compound_oqto", "python": "@wp.kernel\ndef compound_oqto(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_oqto_7d233bf2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_oqto_7d233bf2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_oqto_7d233bf2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_oqto(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_oqto_7d233bf2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_oqto_7d233bf2 *_wp_args,\n    wp_args_compound_oqto_7d233bf2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_oqto(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_oqto(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_oqto_7d233bf2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_oqto_7d233bf2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_oqto_7d233bf2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_oqto_7d233bf2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_oqto_7d233bf2 *_wp_args,\n    wp_args_compound_oqto_7d233bf2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_oqto_7d233bf2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 2, "kernel_name": "loop_qgwa", "python": "@wp.kernel\ndef loop_qgwa(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_qgwa_cf6a7c46 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_qgwa_cf6a7c46_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_qgwa(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_qgwa_cf6a7c46_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_args,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_qgwa(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_qgwa(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_qgwa_cf6a7c46_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qgwa_cf6a7c46_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_qgwa_cf6a7c46_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_args,\n    wp_args_loop_qgwa_cf6a7c46 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_qgwa_cf6a7c46_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 3, "kernel_name": "unary_ethj", "python": "@wp.kernel\ndef unary_ethj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_ethj_02ee72c0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_ethj_02ee72c0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ethj_02ee72c0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_ethj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_ethj_02ee72c0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ethj_02ee72c0 *_wp_args,\n    wp_args_unary_ethj_02ee72c0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_ethj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_ethj(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_ethj_02ee72c0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ethj_02ee72c0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ethj_02ee72c0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_ethj_02ee72c0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ethj_02ee72c0 *_wp_args,\n    wp_args_unary_ethj_02ee72c0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ethj_02ee72c0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 4, "kernel_name": "reduce_ihpd", "python": "@wp.kernel\ndef reduce_ihpd(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ihpd_73dc2b39 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ihpd_73dc2b39_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ihpd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ihpd_73dc2b39_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_args,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ihpd(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ihpd(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ihpd_73dc2b39_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ihpd_73dc2b39_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ihpd_73dc2b39_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_args,\n    wp_args_reduce_ihpd_73dc2b39 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ihpd_73dc2b39_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 5, "kernel_name": "branch_fbli", "python": "@wp.kernel\ndef branch_fbli(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.63:\n        b[tid] = val + 2.3\n    else:\n        b[tid] = val + 0.7", "cpp": "struct wp_args_branch_fbli_83852e28 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fbli_83852e28_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fbli_83852e28 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.63;\n    const wp::float32 var_5 = -0.63;\n    bool var_6;\n    const wp::float32 var_7 = 2.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_fbli(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.63:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 2.3                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_fbli_83852e28_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fbli_83852e28 *_wp_args,\n    wp_args_branch_fbli_83852e28 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.63;\n    const wp::float32 var_5 = -0.63;\n    bool var_6;\n    const wp::float32 var_7 = 2.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_fbli(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.63:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 2.3                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 0.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 2.3                                                            <L 8>\n    }\n    // adj: if val > -0.63:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fbli(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fbli_83852e28_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fbli_83852e28 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fbli_83852e28_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fbli_83852e28_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fbli_83852e28 *_wp_args,\n    wp_args_branch_fbli_83852e28 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fbli_83852e28_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 6, "kernel_name": "unary_etqd", "python": "@wp.kernel\ndef unary_etqd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_etqd_41300d07 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_etqd_41300d07_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_etqd_41300d07 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_etqd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_etqd_41300d07_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_etqd_41300d07 *_wp_args,\n    wp_args_unary_etqd_41300d07 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_etqd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_etqd(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_etqd_41300d07_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_etqd_41300d07 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_etqd_41300d07_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_etqd_41300d07_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_etqd_41300d07 *_wp_args,\n    wp_args_unary_etqd_41300d07 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_etqd_41300d07_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 7, "kernel_name": "unary_dpuq", "python": "@wp.kernel\ndef unary_dpuq(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sin(a[tid])", "cpp": "struct wp_args_unary_dpuq_879c30e9 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dpuq_879c30e9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dpuq_879c30e9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dpuq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dpuq_879c30e9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dpuq_879c30e9 *_wp_args,\n    wp_args_unary_dpuq_879c30e9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dpuq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sin(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sin(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sin(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sin(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dpuq(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dpuq_879c30e9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dpuq_879c30e9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dpuq_879c30e9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dpuq_879c30e9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dpuq_879c30e9 *_wp_args,\n    wp_args_unary_dpuq_879c30e9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dpuq_879c30e9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 8, "kernel_name": "elementwise_aeht", "python": "@wp.kernel\ndef elementwise_aeht(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_aeht_d3024ce2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_aeht_d3024ce2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_aeht(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_aeht_d3024ce2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_args,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_aeht(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_aeht(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_aeht_d3024ce2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aeht_d3024ce2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_aeht_d3024ce2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_args,\n    wp_args_elementwise_aeht_d3024ce2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_aeht_d3024ce2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 9, "kernel_name": "nested_zign", "python": "@wp.kernel\ndef nested_zign(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.14:\n        if val > 1.25:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_zign_15de7fe0 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_zign_15de7fe0_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zign_15de7fe0 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    const wp::float32 var_5 = -0.14;\n    bool var_6;\n    const wp::float32 var_7 = 1.25;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_zign(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.14:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.25:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_zign_15de7fe0_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zign_15de7fe0 *_wp_args,\n    wp_args_nested_zign_15de7fe0 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.14;\n    const wp::float32 var_5 = -0.14;\n    bool var_6;\n    const wp::float32 var_7 = 1.25;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_zign(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.14:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.25:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.25:                                                                <L 8>\n    }\n    // adj: if val > -0.14:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_zign(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_zign_15de7fe0_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zign_15de7fe0 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zign_15de7fe0_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_zign_15de7fe0_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zign_15de7fe0 *_wp_args,\n    wp_args_nested_zign_15de7fe0 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zign_15de7fe0_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 10, "kernel_name": "loop_yazq", "python": "@wp.kernel\ndef loop_yazq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total * a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_yazq_b7068004 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_yazq_b7068004_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yazq_b7068004 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_yazq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_yazq_b7068004_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_yazq_b7068004 *_wp_args,\n    wp_args_loop_yazq_b7068004 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_yazq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total * a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::mul(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_mul(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total * a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_yazq(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_yazq_b7068004_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yazq_b7068004 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yazq_b7068004_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_yazq_b7068004_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_yazq_b7068004 *_wp_args,\n    wp_args_loop_yazq_b7068004 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_yazq_b7068004_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 11, "kernel_name": "branch_rreb", "python": "@wp.kernel\ndef branch_rreb(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.02:\n        b[tid] = val + 1.4\n    else:\n        b[tid] = val + 0.7", "cpp": "struct wp_args_branch_rreb_39e3491f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_rreb_39e3491f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_rreb_39e3491f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_rreb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.4                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_rreb_39e3491f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_rreb_39e3491f *_wp_args,\n    wp_args_branch_rreb_39e3491f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.02;\n    const wp::float32 var_5 = -0.02;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 0.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_rreb(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.02:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val + 1.4                                                                 <L 8>\n        var_8 = wp::add(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 0.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 0.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_add(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val + 1.4                                                            <L 8>\n    }\n    // adj: if val > -0.02:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_rreb(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_rreb_39e3491f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_rreb_39e3491f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_rreb_39e3491f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_rreb_39e3491f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_rreb_39e3491f *_wp_args,\n    wp_args_branch_rreb_39e3491f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_rreb_39e3491f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 12, "kernel_name": "scalar_arr_bvjp", "python": "@wp.kernel\ndef scalar_arr_bvjp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_bvjp_328187e7 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bvjp_328187e7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bvjp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bvjp_328187e7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_args,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bvjp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bvjp(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bvjp_328187e7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bvjp_328187e7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bvjp_328187e7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_args,\n    wp_args_scalar_arr_bvjp_328187e7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bvjp_328187e7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 13, "kernel_name": "loop_guom", "python": "@wp.kernel\ndef loop_guom(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_guom_f148e8ec {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_guom_f148e8ec_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_guom_f148e8ec *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_guom(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_guom_f148e8ec_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_guom_f148e8ec *_wp_args,\n    wp_args_loop_guom_f148e8ec *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_guom(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_guom(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_guom_f148e8ec_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_guom_f148e8ec *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_guom_f148e8ec_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_guom_f148e8ec_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_guom_f148e8ec *_wp_args,\n    wp_args_loop_guom_f148e8ec *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_guom_f148e8ec_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 14, "kernel_name": "unary_ejhn", "python": "@wp.kernel\ndef unary_ejhn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_ejhn_682067e6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_ejhn_682067e6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ejhn_682067e6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_ejhn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_ejhn_682067e6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_ejhn_682067e6 *_wp_args,\n    wp_args_unary_ejhn_682067e6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_ejhn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_ejhn(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_ejhn_682067e6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ejhn_682067e6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ejhn_682067e6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_ejhn_682067e6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_ejhn_682067e6 *_wp_args,\n    wp_args_unary_ejhn_682067e6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_ejhn_682067e6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 15, "kernel_name": "reduce_jvlc", "python": "@wp.kernel\ndef reduce_jvlc(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jvlc_b98eda3d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jvlc_b98eda3d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvlc_b98eda3d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jvlc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jvlc_b98eda3d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jvlc_b98eda3d *_wp_args,\n    wp_args_reduce_jvlc_b98eda3d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jvlc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jvlc(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jvlc_b98eda3d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvlc_b98eda3d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvlc_b98eda3d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jvlc_b98eda3d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jvlc_b98eda3d *_wp_args,\n    wp_args_reduce_jvlc_b98eda3d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jvlc_b98eda3d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 16, "kernel_name": "compound_vqdg", "python": "@wp.kernel\ndef compound_vqdg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_vqdg_f25ec596 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_vqdg_f25ec596_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_vqdg_f25ec596 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_vqdg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_vqdg_f25ec596_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_vqdg_f25ec596 *_wp_args,\n    wp_args_compound_vqdg_f25ec596 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_vqdg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_vqdg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_vqdg_f25ec596_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_vqdg_f25ec596 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_vqdg_f25ec596_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_vqdg_f25ec596_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_vqdg_f25ec596 *_wp_args,\n    wp_args_compound_vqdg_f25ec596 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_vqdg_f25ec596_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 17, "kernel_name": "compound_rxgl", "python": "@wp.kernel\ndef compound_rxgl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_rxgl_82c433d4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_rxgl_82c433d4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rxgl_82c433d4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_rxgl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_rxgl_82c433d4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rxgl_82c433d4 *_wp_args,\n    wp_args_compound_rxgl_82c433d4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_rxgl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_rxgl(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_rxgl_82c433d4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rxgl_82c433d4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rxgl_82c433d4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_rxgl_82c433d4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rxgl_82c433d4 *_wp_args,\n    wp_args_compound_rxgl_82c433d4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rxgl_82c433d4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 18, "kernel_name": "scalar_arr_denx", "python": "@wp.kernel\ndef scalar_arr_denx(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_denx_2f24538a {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_denx_2f24538a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_denx_2f24538a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_denx(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_denx_2f24538a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_denx_2f24538a *_wp_args,\n    wp_args_scalar_arr_denx_2f24538a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_denx(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_denx(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_denx_2f24538a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_denx_2f24538a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_denx_2f24538a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_denx_2f24538a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_denx_2f24538a *_wp_args,\n    wp_args_scalar_arr_denx_2f24538a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_denx_2f24538a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 19, "kernel_name": "branch_falj", "python": "@wp.kernel\ndef branch_falj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.33:\n        b[tid] = val * 1.8\n    else:\n        b[tid] = val * 0.6", "cpp": "struct wp_args_branch_falj_02000051 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_falj_02000051_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_falj_02000051 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.33;\n    bool var_5;\n    const wp::float32 var_6 = 1.8;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.6;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_falj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.33:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.8                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_falj_02000051_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_falj_02000051 *_wp_args,\n    wp_args_branch_falj_02000051 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.33;\n    bool var_5;\n    const wp::float32 var_6 = 1.8;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 0.6;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_falj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.33:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 1.8                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.6                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 0.6                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 1.8                                                            <L 8>\n    }\n    // adj: if val > 0.33:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_falj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_falj_02000051_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_falj_02000051 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_falj_02000051_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_falj_02000051_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_falj_02000051 *_wp_args,\n    wp_args_branch_falj_02000051 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_falj_02000051_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 20, "kernel_name": "multi_wpor", "python": "@wp.kernel\ndef multi_wpor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_wpor_827b0ee7 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_wpor_827b0ee7_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wpor_827b0ee7 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_wpor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_wpor_827b0ee7_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_wpor_827b0ee7 *_wp_args,\n    wp_args_multi_wpor_827b0ee7 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_wpor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_wpor(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_wpor_827b0ee7_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wpor_827b0ee7 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wpor_827b0ee7_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_wpor_827b0ee7_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_wpor_827b0ee7 *_wp_args,\n    wp_args_multi_wpor_827b0ee7 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_wpor_827b0ee7_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 21, "kernel_name": "compound_pziv", "python": "@wp.kernel\ndef compound_pziv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pziv_c01d46ed {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pziv_c01d46ed_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pziv_c01d46ed *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pziv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pziv_c01d46ed_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pziv_c01d46ed *_wp_args,\n    wp_args_compound_pziv_c01d46ed *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pziv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pziv(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pziv_c01d46ed_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pziv_c01d46ed *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pziv_c01d46ed_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pziv_c01d46ed_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pziv_c01d46ed *_wp_args,\n    wp_args_compound_pziv_c01d46ed *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pziv_c01d46ed_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 22, "kernel_name": "nested_ozjr", "python": "@wp.kernel\ndef nested_ozjr(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.48:\n        if val > 1.05:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ozjr_1781fe52 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ozjr_1781fe52_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ozjr_1781fe52 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.48;\n    const wp::float32 var_5 = -0.48;\n    bool var_6;\n    const wp::float32 var_7 = 1.05;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ozjr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.48:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.05:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ozjr_1781fe52_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ozjr_1781fe52 *_wp_args,\n    wp_args_nested_ozjr_1781fe52 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.48;\n    const wp::float32 var_5 = -0.48;\n    bool var_6;\n    const wp::float32 var_7 = 1.05;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ozjr(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.48:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.05:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.05:                                                                <L 8>\n    }\n    // adj: if val > -0.48:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ozjr(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ozjr_1781fe52_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ozjr_1781fe52 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ozjr_1781fe52_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ozjr_1781fe52_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ozjr_1781fe52 *_wp_args,\n    wp_args_nested_ozjr_1781fe52 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ozjr_1781fe52_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 23, "kernel_name": "multi_smvw", "python": "@wp.kernel\ndef multi_smvw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sin(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_smvw_e85e8f0c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_smvw_e85e8f0c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_smvw_e85e8f0c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_smvw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_smvw_e85e8f0c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_smvw_e85e8f0c *_wp_args,\n    wp_args_multi_smvw_e85e8f0c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_smvw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sin(temp1)                                                                  <L 7>\n    var_6 = wp::sin(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sin(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.sin(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_smvw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_smvw_e85e8f0c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_smvw_e85e8f0c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_smvw_e85e8f0c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_smvw_e85e8f0c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_smvw_e85e8f0c *_wp_args,\n    wp_args_multi_smvw_e85e8f0c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_smvw_e85e8f0c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 24, "kernel_name": "multi_mlbh", "python": "@wp.kernel\ndef multi_mlbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mlbh_fce735a6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mlbh_fce735a6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mlbh_fce735a6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mlbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mlbh_fce735a6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mlbh_fce735a6 *_wp_args,\n    wp_args_multi_mlbh_fce735a6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mlbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mlbh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mlbh_fce735a6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mlbh_fce735a6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mlbh_fce735a6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mlbh_fce735a6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mlbh_fce735a6 *_wp_args,\n    wp_args_multi_mlbh_fce735a6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mlbh_fce735a6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 25, "kernel_name": "reduce_jlbj", "python": "@wp.kernel\ndef reduce_jlbj(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jlbj_e9dd488f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jlbj_e9dd488f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jlbj_e9dd488f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jlbj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jlbj_e9dd488f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jlbj_e9dd488f *_wp_args,\n    wp_args_reduce_jlbj_e9dd488f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jlbj(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jlbj(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jlbj_e9dd488f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jlbj_e9dd488f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jlbj_e9dd488f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jlbj_e9dd488f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jlbj_e9dd488f *_wp_args,\n    wp_args_reduce_jlbj_e9dd488f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jlbj_e9dd488f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 26, "kernel_name": "compound_tenw", "python": "@wp.kernel\ndef compound_tenw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_tenw_75fb89d3 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_tenw_75fb89d3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_tenw_75fb89d3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_tenw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_tenw_75fb89d3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_tenw_75fb89d3 *_wp_args,\n    wp_args_compound_tenw_75fb89d3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_tenw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_tenw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_tenw_75fb89d3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_tenw_75fb89d3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_tenw_75fb89d3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_tenw_75fb89d3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_tenw_75fb89d3 *_wp_args,\n    wp_args_compound_tenw_75fb89d3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_tenw_75fb89d3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 27, "kernel_name": "unary_dhnk", "python": "@wp.kernel\ndef unary_dhnk(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_dhnk_c42a8703 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_dhnk_c42a8703_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dhnk_c42a8703 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_dhnk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_dhnk_c42a8703_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_dhnk_c42a8703 *_wp_args,\n    wp_args_unary_dhnk_c42a8703 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_dhnk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_dhnk(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_dhnk_c42a8703_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dhnk_c42a8703 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dhnk_c42a8703_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_dhnk_c42a8703_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_dhnk_c42a8703 *_wp_args,\n    wp_args_unary_dhnk_c42a8703 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_dhnk_c42a8703_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 28, "kernel_name": "scalar_arr_xjbz", "python": "@wp.kernel\ndef scalar_arr_xjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_xjbz_bdf83c42 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_xjbz_bdf83c42_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_xjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_xjbz_bdf83c42_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_args,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_xjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_xjbz(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_xjbz_bdf83c42_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_xjbz_bdf83c42_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_xjbz_bdf83c42_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_args,\n    wp_args_scalar_arr_xjbz_bdf83c42 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_xjbz_bdf83c42_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 29, "kernel_name": "unary_emlf", "python": "@wp.kernel\ndef unary_emlf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.abs(a[tid])", "cpp": "struct wp_args_unary_emlf_14d9bb7f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_emlf_14d9bb7f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_emlf_14d9bb7f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_emlf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_emlf_14d9bb7f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_emlf_14d9bb7f *_wp_args,\n    wp_args_unary_emlf_14d9bb7f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_emlf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.abs(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::abs(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_abs(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.abs(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_emlf(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_emlf_14d9bb7f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_emlf_14d9bb7f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_emlf_14d9bb7f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_emlf_14d9bb7f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_emlf_14d9bb7f *_wp_args,\n    wp_args_unary_emlf_14d9bb7f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_emlf_14d9bb7f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 30, "kernel_name": "loop_hwnv", "python": "@wp.kernel\ndef loop_hwnv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hwnv_b45861d6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hwnv_b45861d6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hwnv_b45861d6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hwnv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hwnv_b45861d6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hwnv_b45861d6 *_wp_args,\n    wp_args_loop_hwnv_b45861d6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hwnv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hwnv(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hwnv_b45861d6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hwnv_b45861d6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hwnv_b45861d6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hwnv_b45861d6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hwnv_b45861d6 *_wp_args,\n    wp_args_loop_hwnv_b45861d6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hwnv_b45861d6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 31, "kernel_name": "vec_sblg", "python": "@wp.kernel\ndef vec_sblg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_sblg_13d66ec9 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_sblg_13d66ec9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_sblg_13d66ec9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_sblg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_sblg_13d66ec9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_sblg_13d66ec9 *_wp_args,\n    wp_args_vec_sblg_13d66ec9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_sblg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_sblg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_sblg_13d66ec9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_sblg_13d66ec9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_sblg_13d66ec9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_sblg_13d66ec9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_sblg_13d66ec9 *_wp_args,\n    wp_args_vec_sblg_13d66ec9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_sblg_13d66ec9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 32, "kernel_name": "branch_fkni", "python": "@wp.kernel\ndef branch_fkni(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.61:\n        b[tid] = val + 2.9\n    else:\n        b[tid] = val + 1.8", "cpp": "struct wp_args_branch_fkni_9552a6f6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fkni_9552a6f6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fkni_9552a6f6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.61;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fkni(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.61:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.8                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fkni_9552a6f6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fkni_9552a6f6 *_wp_args,\n    wp_args_branch_fkni_9552a6f6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.61;\n    bool var_5;\n    const wp::float32 var_6 = 2.9;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fkni(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.61:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 2.9                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.8                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 1.8                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 2.9                                                            <L 8>\n    }\n    // adj: if val > 0.61:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fkni(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fkni_9552a6f6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fkni_9552a6f6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fkni_9552a6f6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fkni_9552a6f6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fkni_9552a6f6 *_wp_args,\n    wp_args_branch_fkni_9552a6f6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fkni_9552a6f6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 33, "kernel_name": "nested_osyq", "python": "@wp.kernel\ndef nested_osyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.08:\n        if val > 1.04:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_osyq_46f3096e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_osyq_46f3096e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_osyq_46f3096e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    bool var_5;\n    const wp::float32 var_6 = 1.04;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_osyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.08:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.04:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_osyq_46f3096e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_osyq_46f3096e *_wp_args,\n    wp_args_nested_osyq_46f3096e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    bool var_5;\n    const wp::float32 var_6 = 1.04;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_osyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.08:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.04:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.04:                                                                <L 8>\n    }\n    // adj: if val > 0.08:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_osyq(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_osyq_46f3096e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_osyq_46f3096e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_osyq_46f3096e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_osyq_46f3096e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_osyq_46f3096e *_wp_args,\n    wp_args_nested_osyq_46f3096e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_osyq_46f3096e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 34, "kernel_name": "multi_vtal", "python": "@wp.kernel\ndef multi_vtal(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_vtal_9a0012b1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_vtal_9a0012b1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_vtal_9a0012b1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_vtal(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_vtal_9a0012b1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_vtal_9a0012b1 *_wp_args,\n    wp_args_multi_vtal_9a0012b1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_vtal(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_vtal(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_vtal_9a0012b1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_vtal_9a0012b1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_vtal_9a0012b1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_vtal_9a0012b1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_vtal_9a0012b1 *_wp_args,\n    wp_args_multi_vtal_9a0012b1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_vtal_9a0012b1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 35, "kernel_name": "scalar_arr_catv", "python": "@wp.kernel\ndef scalar_arr_catv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] - y[tid]", "cpp": "struct wp_args_scalar_arr_catv_170558f9 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_catv_170558f9_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_catv_170558f9 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_catv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_catv_170558f9_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_catv_170558f9 *_wp_args,\n    wp_args_scalar_arr_catv_170558f9 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_catv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] - y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::add(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::sub(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_sub(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] - y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_catv(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_catv_170558f9_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_catv_170558f9 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_catv_170558f9_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_catv_170558f9_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_catv_170558f9 *_wp_args,\n    wp_args_scalar_arr_catv_170558f9 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_catv_170558f9_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 36, "kernel_name": "elementwise_qdfy", "python": "@wp.kernel\ndef elementwise_qdfy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_qdfy_d076604d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_qdfy_d076604d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_qdfy_d076604d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_qdfy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_qdfy_d076604d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_qdfy_d076604d *_wp_args,\n    wp_args_elementwise_qdfy_d076604d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_qdfy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_qdfy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_qdfy_d076604d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_qdfy_d076604d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_qdfy_d076604d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_qdfy_d076604d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_qdfy_d076604d *_wp_args,\n    wp_args_elementwise_qdfy_d076604d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_qdfy_d076604d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 37, "kernel_name": "unary_rwfo", "python": "@wp.kernel\ndef unary_rwfo(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_rwfo_5fae60c5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_rwfo_5fae60c5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_rwfo_5fae60c5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_rwfo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_rwfo_5fae60c5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_rwfo_5fae60c5 *_wp_args,\n    wp_args_unary_rwfo_5fae60c5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_rwfo(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_rwfo(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_rwfo_5fae60c5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_rwfo_5fae60c5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_rwfo_5fae60c5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_rwfo_5fae60c5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_rwfo_5fae60c5 *_wp_args,\n    wp_args_unary_rwfo_5fae60c5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_rwfo_5fae60c5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 38, "kernel_name": "compound_usup", "python": "@wp.kernel\ndef compound_usup(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_usup_7a00265d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_usup_7a00265d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_usup_7a00265d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_usup(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_usup_7a00265d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_usup_7a00265d *_wp_args,\n    wp_args_compound_usup_7a00265d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_usup(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_usup(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_usup_7a00265d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_usup_7a00265d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_usup_7a00265d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_usup_7a00265d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_usup_7a00265d *_wp_args,\n    wp_args_compound_usup_7a00265d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_usup_7a00265d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 39, "kernel_name": "scalar_arr_dtbh", "python": "@wp.kernel\ndef scalar_arr_dtbh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_dtbh_cb08565e {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_dtbh_cb08565e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_dtbh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_dtbh_cb08565e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_args,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_dtbh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_dtbh(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_dtbh_cb08565e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dtbh_cb08565e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_dtbh_cb08565e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_args,\n    wp_args_scalar_arr_dtbh_cb08565e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dtbh_cb08565e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 40, "kernel_name": "elementwise_yyqk", "python": "@wp.kernel\ndef elementwise_yyqk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] + b[tid]", "cpp": "struct wp_args_elementwise_yyqk_eee378dc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_yyqk_eee378dc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yyqk_eee378dc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_yyqk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_yyqk_eee378dc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_yyqk_eee378dc *_wp_args,\n    wp_args_elementwise_yyqk_eee378dc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_yyqk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] + b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] + b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_yyqk(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_yyqk_eee378dc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yyqk_eee378dc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yyqk_eee378dc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_yyqk_eee378dc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_yyqk_eee378dc *_wp_args,\n    wp_args_elementwise_yyqk_eee378dc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_yyqk_eee378dc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 41, "kernel_name": "nested_snhk", "python": "@wp.kernel\ndef nested_snhk(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.08:\n        if val > 0.7:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_snhk_7d397037 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_snhk_7d397037_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snhk_7d397037 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    bool var_5;\n    const wp::float32 var_6 = 0.7;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_snhk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.08:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.7:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_snhk_7d397037_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_snhk_7d397037 *_wp_args,\n    wp_args_nested_snhk_7d397037 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.08;\n    bool var_5;\n    const wp::float32 var_6 = 0.7;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_snhk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.08:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 0.7:                                                                      <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 0.7:                                                                 <L 8>\n    }\n    // adj: if val > 0.08:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_snhk(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_snhk_7d397037_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snhk_7d397037 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snhk_7d397037_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_snhk_7d397037_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_snhk_7d397037 *_wp_args,\n    wp_args_nested_snhk_7d397037 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_snhk_7d397037_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 42, "kernel_name": "branch_fynd", "python": "@wp.kernel\ndef branch_fynd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.48:\n        b[tid] = val - 1.4\n    else:\n        b[tid] = val + 1.0", "cpp": "struct wp_args_branch_fynd_b627f1e4 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_fynd_b627f1e4_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fynd_b627f1e4 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.48;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.0;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_fynd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.48:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.0                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_fynd_b627f1e4_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_fynd_b627f1e4 *_wp_args,\n    wp_args_branch_fynd_b627f1e4 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.48;\n    bool var_5;\n    const wp::float32 var_6 = 1.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.0;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_fynd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.48:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val + 1.0                                                                 <L 10>\n        var_9 = wp::add(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_add(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val + 1.0                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_sub(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val - 1.4                                                            <L 8>\n    }\n    // adj: if val > 0.48:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_fynd(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_fynd_b627f1e4_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fynd_b627f1e4 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fynd_b627f1e4_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_fynd_b627f1e4_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_fynd_b627f1e4 *_wp_args,\n    wp_args_branch_fynd_b627f1e4 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_fynd_b627f1e4_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 43, "kernel_name": "reduce_jzac", "python": "@wp.kernel\ndef reduce_jzac(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_jzac_f00ddb57 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_jzac_f00ddb57_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jzac_f00ddb57 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_jzac(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_jzac_f00ddb57_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_jzac_f00ddb57 *_wp_args,\n    wp_args_reduce_jzac_f00ddb57 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_jzac(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_jzac(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_jzac_f00ddb57_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jzac_f00ddb57 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jzac_f00ddb57_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_jzac_f00ddb57_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_jzac_f00ddb57 *_wp_args,\n    wp_args_reduce_jzac_f00ddb57 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_jzac_f00ddb57_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 44, "kernel_name": "branch_gvri", "python": "@wp.kernel\ndef branch_gvri(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.07:\n        b[tid] = val + 1.2\n    else:\n        b[tid] = val * 2.3", "cpp": "struct wp_args_branch_gvri_8b9c55e8 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gvri_8b9c55e8_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gvri_8b9c55e8 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.07;\n    bool var_5;\n    const wp::float32 var_6 = 1.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.3;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_gvri(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.07:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 1.2                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.3                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_gvri_8b9c55e8_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gvri_8b9c55e8 *_wp_args,\n    wp_args_branch_gvri_8b9c55e8 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.07;\n    bool var_5;\n    const wp::float32 var_6 = 1.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.3;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_gvri(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.07:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val + 1.2                                                                 <L 8>\n        var_7 = wp::add(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.3                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 2.3                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_add(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val + 1.2                                                            <L 8>\n    }\n    // adj: if val > 0.07:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gvri(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gvri_8b9c55e8_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gvri_8b9c55e8 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gvri_8b9c55e8_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gvri_8b9c55e8_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gvri_8b9c55e8 *_wp_args,\n    wp_args_branch_gvri_8b9c55e8 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gvri_8b9c55e8_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 45, "kernel_name": "branch_futl", "python": "@wp.kernel\ndef branch_futl(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.86:\n        b[tid] = val * 2.4\n    else:\n        b[tid] = val * 2.9", "cpp": "struct wp_args_branch_futl_23ac9348 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_futl_23ac9348_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_futl_23ac9348 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.86;\n    bool var_5;\n    const wp::float32 var_6 = 2.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.9;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_futl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.86:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.4                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.9                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_futl_23ac9348_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_futl_23ac9348 *_wp_args,\n    wp_args_branch_futl_23ac9348 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.86;\n    bool var_5;\n    const wp::float32 var_6 = 2.4;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 2.9;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_futl(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.86:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.4                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 2.9                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 2.9                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 2.4                                                            <L 8>\n    }\n    // adj: if val > 0.86:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_futl(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_futl_23ac9348_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_futl_23ac9348 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_futl_23ac9348_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_futl_23ac9348_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_futl_23ac9348 *_wp_args,\n    wp_args_branch_futl_23ac9348 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_futl_23ac9348_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 46, "kernel_name": "elementwise_axyg", "python": "@wp.kernel\ndef elementwise_axyg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_axyg_02bc5e98 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_axyg_02bc5e98_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_axyg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_axyg_02bc5e98_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_args,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_axyg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_axyg(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_axyg_02bc5e98_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_axyg_02bc5e98_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_axyg_02bc5e98_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_args,\n    wp_args_elementwise_axyg_02bc5e98 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_axyg_02bc5e98_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 47, "kernel_name": "nested_zxfj", "python": "@wp.kernel\ndef nested_zxfj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.32:\n        if val > 1.19:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_zxfj_6df21de6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_zxfj_6df21de6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zxfj_6df21de6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.32;\n    bool var_5;\n    const wp::float32 var_6 = 1.19;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_zxfj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.32:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.19:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_zxfj_6df21de6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_zxfj_6df21de6 *_wp_args,\n    wp_args_nested_zxfj_6df21de6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.32;\n    bool var_5;\n    const wp::float32 var_6 = 1.19;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_zxfj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.32:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.19:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.19:                                                                <L 8>\n    }\n    // adj: if val > 0.32:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_zxfj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_zxfj_6df21de6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zxfj_6df21de6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zxfj_6df21de6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_zxfj_6df21de6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_zxfj_6df21de6 *_wp_args,\n    wp_args_nested_zxfj_6df21de6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_zxfj_6df21de6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 48, "kernel_name": "reduce_ypvq", "python": "@wp.kernel\ndef reduce_ypvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_ypvq_e1239d16 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_ypvq_e1239d16_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ypvq_e1239d16 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_ypvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_ypvq_e1239d16_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_ypvq_e1239d16 *_wp_args,\n    wp_args_reduce_ypvq_e1239d16 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_ypvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_ypvq(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_ypvq_e1239d16_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ypvq_e1239d16 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ypvq_e1239d16_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_ypvq_e1239d16_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_ypvq_e1239d16 *_wp_args,\n    wp_args_reduce_ypvq_e1239d16 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_ypvq_e1239d16_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 49, "kernel_name": "elementwise_bked", "python": "@wp.kernel\ndef elementwise_bked(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bked_d379b794 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bked_d379b794_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bked_d379b794 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bked(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bked_d379b794_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bked_d379b794 *_wp_args,\n    wp_args_elementwise_bked_d379b794 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bked(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bked(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bked_d379b794_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bked_d379b794 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bked_d379b794_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bked_d379b794_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bked_d379b794 *_wp_args,\n    wp_args_elementwise_bked_d379b794 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bked_d379b794_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 50, "kernel_name": "scalar_arr_tcwo", "python": "@wp.kernel\ndef scalar_arr_tcwo(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha + x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_tcwo_07e2352a {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_tcwo_07e2352a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_tcwo(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    wp::array_store(var_out, var_0, var_6);\n}\n\n\n\nvoid scalar_arr_tcwo_07e2352a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_args,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_tcwo(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha + x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_2 = wp::address(var_y, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    var_6 = wp::add(var_alpha, var_3);\n    // wp::array_store(var_out, var_0, var_6);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n    wp::adj_add(var_alpha, var_3, adj_alpha, adj_3, adj_6);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha + x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_tcwo(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_tcwo_07e2352a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tcwo_07e2352a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_tcwo_07e2352a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_args,\n    wp_args_scalar_arr_tcwo_07e2352a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_tcwo_07e2352a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 51, "kernel_name": "unary_esze", "python": "@wp.kernel\ndef unary_esze(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_esze_81fda92a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_esze_81fda92a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_esze_81fda92a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_esze(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_esze_81fda92a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_esze_81fda92a *_wp_args,\n    wp_args_unary_esze_81fda92a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_esze(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_esze(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_esze_81fda92a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_esze_81fda92a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_esze_81fda92a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_esze_81fda92a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_esze_81fda92a *_wp_args,\n    wp_args_unary_esze_81fda92a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_esze_81fda92a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 52, "kernel_name": "vec_kdqv", "python": "@wp.kernel\ndef vec_kdqv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kdqv_7cfa7c4c {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kdqv_7cfa7c4c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kdqv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kdqv_7cfa7c4c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_args,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kdqv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kdqv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kdqv_7cfa7c4c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdqv_7cfa7c4c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kdqv_7cfa7c4c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_args,\n    wp_args_vec_kdqv_7cfa7c4c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kdqv_7cfa7c4c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 53, "kernel_name": "unary_uqws", "python": "@wp.kernel\ndef unary_uqws(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_uqws_cca33424 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_uqws_cca33424_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_uqws_cca33424 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_uqws(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_uqws_cca33424_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_uqws_cca33424 *_wp_args,\n    wp_args_unary_uqws_cca33424 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_uqws(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_uqws(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_uqws_cca33424_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_uqws_cca33424 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_uqws_cca33424_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_uqws_cca33424_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_uqws_cca33424 *_wp_args,\n    wp_args_unary_uqws_cca33424 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_uqws_cca33424_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 54, "kernel_name": "unary_tmrp", "python": "@wp.kernel\ndef unary_tmrp(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_tmrp_e7f19fa1 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_tmrp_e7f19fa1_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_tmrp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_tmrp_e7f19fa1_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_args,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_tmrp(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_tmrp(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_tmrp_e7f19fa1_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_tmrp_e7f19fa1_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_tmrp_e7f19fa1_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_args,\n    wp_args_unary_tmrp_e7f19fa1 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_tmrp_e7f19fa1_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 55, "kernel_name": "reduce_idnt", "python": "@wp.kernel\ndef reduce_idnt(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_idnt_5d7d11d5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_idnt_5d7d11d5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_idnt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_idnt_5d7d11d5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_args,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_idnt(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_idnt(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_idnt_5d7d11d5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_idnt_5d7d11d5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_idnt_5d7d11d5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_args,\n    wp_args_reduce_idnt_5d7d11d5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_idnt_5d7d11d5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 56, "kernel_name": "multi_mcoe", "python": "@wp.kernel\ndef multi_mcoe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mcoe_ed6689bc {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mcoe_ed6689bc_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mcoe_ed6689bc *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mcoe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mcoe_ed6689bc_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mcoe_ed6689bc *_wp_args,\n    wp_args_multi_mcoe_ed6689bc *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mcoe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mcoe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mcoe_ed6689bc_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mcoe_ed6689bc *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mcoe_ed6689bc_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mcoe_ed6689bc_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mcoe_ed6689bc *_wp_args,\n    wp_args_multi_mcoe_ed6689bc *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mcoe_ed6689bc_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 57, "kernel_name": "multi_msjb", "python": "@wp.kernel\ndef multi_msjb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_msjb_0e33425c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_msjb_0e33425c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_msjb_0e33425c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_msjb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_msjb_0e33425c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_msjb_0e33425c *_wp_args,\n    wp_args_multi_msjb_0e33425c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_msjb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_msjb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_msjb_0e33425c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_msjb_0e33425c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_msjb_0e33425c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_msjb_0e33425c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_msjb_0e33425c *_wp_args,\n    wp_args_multi_msjb_0e33425c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_msjb_0e33425c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 58, "kernel_name": "nested_ohqt", "python": "@wp.kernel\ndef nested_ohqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.25:\n        if val > 1.41:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ohqt_bc019e6c {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ohqt_bc019e6c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohqt_bc019e6c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 1.41;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ohqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.41:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ohqt_bc019e6c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ohqt_bc019e6c *_wp_args,\n    wp_args_nested_ohqt_bc019e6c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.25;\n    const wp::float32 var_5 = -0.25;\n    bool var_6;\n    const wp::float32 var_7 = 1.41;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ohqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.25:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.41:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.41:                                                                <L 8>\n    }\n    // adj: if val > -0.25:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ohqt(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ohqt_bc019e6c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohqt_bc019e6c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohqt_bc019e6c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ohqt_bc019e6c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ohqt_bc019e6c *_wp_args,\n    wp_args_nested_ohqt_bc019e6c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ohqt_bc019e6c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 59, "kernel_name": "loop_htnb", "python": "@wp.kernel\ndef loop_htnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_htnb_0186d0af {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_htnb_0186d0af_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_htnb_0186d0af *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_htnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_htnb_0186d0af_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_htnb_0186d0af *_wp_args,\n    wp_args_loop_htnb_0186d0af *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_htnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_htnb(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_htnb_0186d0af_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_htnb_0186d0af *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_htnb_0186d0af_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_htnb_0186d0af_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_htnb_0186d0af *_wp_args,\n    wp_args_loop_htnb_0186d0af *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_htnb_0186d0af_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 60, "kernel_name": "branch_flzc", "python": "@wp.kernel\ndef branch_flzc(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.43:\n        b[tid] = val * 2.2\n    else:\n        b[tid] = val - 1.4", "cpp": "struct wp_args_branch_flzc_4b1056eb {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_flzc_4b1056eb_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_flzc_4b1056eb *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.43;\n    bool var_5;\n    const wp::float32 var_6 = 2.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.4;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_flzc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.43:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.2                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.4                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_flzc_4b1056eb_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_flzc_4b1056eb *_wp_args,\n    wp_args_branch_flzc_4b1056eb *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.43;\n    bool var_5;\n    const wp::float32 var_6 = 2.2;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.4;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_flzc(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.43:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val * 2.2                                                                 <L 8>\n        var_7 = wp::mul(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val - 1.4                                                                 <L 10>\n        var_9 = wp::sub(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_sub(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val - 1.4                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val * 2.2                                                            <L 8>\n    }\n    // adj: if val > 0.43:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_flzc(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_flzc_4b1056eb_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_flzc_4b1056eb *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_flzc_4b1056eb_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_flzc_4b1056eb_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_flzc_4b1056eb *_wp_args,\n    wp_args_branch_flzc_4b1056eb *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_flzc_4b1056eb_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 61, "kernel_name": "vec_kocj", "python": "@wp.kernel\ndef vec_kocj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kocj_bcf54a55 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kocj_bcf54a55_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kocj_bcf54a55 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kocj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kocj_bcf54a55_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kocj_bcf54a55 *_wp_args,\n    wp_args_vec_kocj_bcf54a55 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kocj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kocj(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kocj_bcf54a55_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kocj_bcf54a55 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kocj_bcf54a55_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kocj_bcf54a55_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kocj_bcf54a55 *_wp_args,\n    wp_args_vec_kocj_bcf54a55 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kocj_bcf54a55_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 62, "kernel_name": "multi_uuma", "python": "@wp.kernel\ndef multi_uuma(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_uuma_08522558 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_uuma_08522558_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_uuma_08522558 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_uuma(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_uuma_08522558_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_uuma_08522558 *_wp_args,\n    wp_args_multi_uuma_08522558 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_uuma(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_uuma(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_uuma_08522558_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_uuma_08522558 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_uuma_08522558_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_uuma_08522558_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_uuma_08522558 *_wp_args,\n    wp_args_multi_uuma_08522558 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_uuma_08522558_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 63, "kernel_name": "compound_rcmb", "python": "@wp.kernel\ndef compound_rcmb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_rcmb_378fc4e2 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_rcmb_378fc4e2_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rcmb_378fc4e2 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_rcmb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_rcmb_378fc4e2_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_rcmb_378fc4e2 *_wp_args,\n    wp_args_compound_rcmb_378fc4e2 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_rcmb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_rcmb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_rcmb_378fc4e2_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rcmb_378fc4e2 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rcmb_378fc4e2_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_rcmb_378fc4e2_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_rcmb_378fc4e2 *_wp_args,\n    wp_args_compound_rcmb_378fc4e2 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_rcmb_378fc4e2_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 64, "kernel_name": "vec_zdjy", "python": "@wp.kernel\ndef vec_zdjy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_zdjy_494ab97c {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_zdjy_494ab97c_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zdjy_494ab97c *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_zdjy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_zdjy_494ab97c_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_zdjy_494ab97c *_wp_args,\n    wp_args_vec_zdjy_494ab97c *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_zdjy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_zdjy(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_zdjy_494ab97c_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zdjy_494ab97c *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zdjy_494ab97c_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_zdjy_494ab97c_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_zdjy_494ab97c *_wp_args,\n    wp_args_vec_zdjy_494ab97c *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_zdjy_494ab97c_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 65, "kernel_name": "loop_hinm", "python": "@wp.kernel\ndef loop_hinm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total - a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hinm_e281dc2f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hinm_e281dc2f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hinm_e281dc2f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hinm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hinm_e281dc2f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hinm_e281dc2f *_wp_args,\n    wp_args_loop_hinm_e281dc2f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hinm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total - a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::sub(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_sub(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total - a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hinm(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hinm_e281dc2f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hinm_e281dc2f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hinm_e281dc2f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hinm_e281dc2f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hinm_e281dc2f *_wp_args,\n    wp_args_loop_hinm_e281dc2f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hinm_e281dc2f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 66, "kernel_name": "elementwise_agpe", "python": "@wp.kernel\ndef elementwise_agpe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] * b[tid]", "cpp": "struct wp_args_elementwise_agpe_b3901ac6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_agpe_b3901ac6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_agpe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_agpe_b3901ac6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_args,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_agpe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] * b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] * b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_agpe(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_agpe_b3901ac6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agpe_b3901ac6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_agpe_b3901ac6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_args,\n    wp_args_elementwise_agpe_b3901ac6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_agpe_b3901ac6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 67, "kernel_name": "compound_vfnj", "python": "@wp.kernel\ndef compound_vfnj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_vfnj_0df0bc06 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_vfnj_0df0bc06_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_vfnj_0df0bc06 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_vfnj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_vfnj_0df0bc06_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_vfnj_0df0bc06 *_wp_args,\n    wp_args_compound_vfnj_0df0bc06 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_vfnj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_vfnj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_vfnj_0df0bc06_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_vfnj_0df0bc06 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_vfnj_0df0bc06_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_vfnj_0df0bc06_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_vfnj_0df0bc06 *_wp_args,\n    wp_args_compound_vfnj_0df0bc06 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_vfnj_0df0bc06_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 68, "kernel_name": "vec_kijb", "python": "@wp.kernel\ndef vec_kijb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_kijb_2f304734 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_kijb_2f304734_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kijb_2f304734 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_kijb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_kijb_2f304734_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_kijb_2f304734 *_wp_args,\n    wp_args_vec_kijb_2f304734 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_kijb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_kijb(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_kijb_2f304734_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kijb_2f304734 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kijb_2f304734_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_kijb_2f304734_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_kijb_2f304734 *_wp_args,\n    wp_args_vec_kijb_2f304734 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_kijb_2f304734_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 69, "kernel_name": "compound_pqge", "python": "@wp.kernel\ndef compound_pqge(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pqge_9b2e4514 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pqge_9b2e4514_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pqge_9b2e4514 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pqge(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pqge_9b2e4514_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pqge_9b2e4514 *_wp_args,\n    wp_args_compound_pqge_9b2e4514 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pqge(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pqge(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pqge_9b2e4514_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pqge_9b2e4514 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pqge_9b2e4514_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pqge_9b2e4514_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pqge_9b2e4514 *_wp_args,\n    wp_args_compound_pqge_9b2e4514 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pqge_9b2e4514_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 70, "kernel_name": "reduce_iddh", "python": "@wp.kernel\ndef reduce_iddh(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iddh_e6fa2025 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iddh_e6fa2025_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iddh_e6fa2025 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iddh(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iddh_e6fa2025_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iddh_e6fa2025 *_wp_args,\n    wp_args_reduce_iddh_e6fa2025 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iddh(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iddh(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iddh_e6fa2025_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iddh_e6fa2025 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iddh_e6fa2025_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iddh_e6fa2025_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iddh_e6fa2025 *_wp_args,\n    wp_args_reduce_iddh_e6fa2025 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iddh_e6fa2025_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 71, "kernel_name": "loop_hmnl", "python": "@wp.kernel\ndef loop_hmnl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(n):\n        total = total + a[tid]\n    b[tid] = total", "cpp": "struct wp_args_loop_hmnl_6e9562de {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::int32 n;\n};\n\n\nvoid loop_hmnl_6e9562de_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hmnl_6e9562de *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // forward\n    // def loop_hmnl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        goto start_for_0;\n    end_for_0:;\n    // b[tid] = total                                                                         <L 9>\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid loop_hmnl_6e9562de_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_loop_hmnl_6e9562de *_wp_args,\n    wp_args_loop_hmnl_6e9562de *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::int32 var_n = _wp_args->n;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::int32 adj_n = _wp_adj_args->n;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::float32 var_1 = 0.0;\n    wp::float32 var_2;\n    wp::range_t var_3;\n    wp::int32 var_4;\n    wp::float32* var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::range_t adj_3 = {};\n    wp::int32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    //---------\n    // forward\n    // def loop_hmnl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):             <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // total = float(0.0)                                                                     <L 6>\n    var_2 = wp::float(var_1);\n    // for i in range(n):                                                                     <L 7>\n    var_3 = wp::range(var_n);\n    // b[tid] = total                                                                         <L 9>\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    // adj: b[tid] = total                                                                    <L 9>\n    var_3 = wp::iter_reverse(var_3);\n    start_for_0:;\n        if (iter_cmp(var_3) == 0) goto end_for_0;\n        var_4 = wp::iter_next(var_3);\n    \tadj_5 = {};\n    \tadj_6 = {};\n    \tadj_7 = {};\n        // total = total + a[tid]                                                             <L 8>\n        var_5 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_5);\n        var_6 = wp::add(var_2, var_7);\n        wp::assign(var_2, var_6);\n        wp::adj_assign(var_2, var_6, adj_2, adj_6);\n        wp::adj_add(var_2, var_7, adj_2, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_5);\n        // adj: total = total + a[tid]                                                        <L 8>\n    \tgoto start_for_0;\n    end_for_0:;\n    wp::adj_range(var_n, adj_n, adj_3);\n    // adj: for i in range(n):                                                                <L 7>\n    wp::adj_float(var_1, adj_1, adj_2);\n    // adj: total = float(0.0)                                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def loop_hmnl(a: wp.array(dtype=float), b: wp.array(dtype=float), n: int):        <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void loop_hmnl_6e9562de_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hmnl_6e9562de *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hmnl_6e9562de_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void loop_hmnl_6e9562de_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_loop_hmnl_6e9562de *_wp_args,\n    wp_args_loop_hmnl_6e9562de *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        loop_hmnl_6e9562de_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_loop_kernel"}
{"id": 72, "kernel_name": "branch_txpn", "python": "@wp.kernel\ndef branch_txpn(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.87:\n        b[tid] = val - 2.3\n    else:\n        b[tid] = val * 1.4", "cpp": "struct wp_args_branch_txpn_7ac49ed5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_txpn_7ac49ed5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_txpn_7ac49ed5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.87;\n    bool var_5;\n    const wp::float32 var_6 = 2.3;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.4;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def branch_txpn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.87:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 2.3                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.4                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        wp::array_store(var_b, var_0, var_9);\n    }\n}\n\n\n\nvoid branch_txpn_7ac49ed5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_txpn_7ac49ed5 *_wp_args,\n    wp_args_branch_txpn_7ac49ed5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.87;\n    bool var_5;\n    const wp::float32 var_6 = 2.3;\n    wp::float32 var_7;\n    const wp::float32 var_8 = 1.4;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def branch_txpn(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.87:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // b[tid] = val - 2.3                                                                 <L 8>\n        var_7 = wp::sub(var_2, var_6);\n        // wp::array_store(var_b, var_0, var_7);\n    }\n    if (!var_5) {\n        // b[tid] = val * 1.4                                                                 <L 10>\n        var_9 = wp::mul(var_2, var_8);\n        // wp::array_store(var_b, var_0, var_9);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n        wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n        // adj: b[tid] = val * 1.4                                                            <L 10>\n    }\n    if (var_5) {\n        wp::adj_array_store(var_b, var_0, var_7, adj_b, adj_0, adj_7);\n        wp::adj_sub(var_2, var_6, adj_2, adj_6, adj_7);\n        // adj: b[tid] = val - 2.3                                                            <L 8>\n    }\n    // adj: if val > 0.87:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_txpn(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_txpn_7ac49ed5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_txpn_7ac49ed5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_txpn_7ac49ed5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_txpn_7ac49ed5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_txpn_7ac49ed5 *_wp_args,\n    wp_args_branch_txpn_7ac49ed5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_txpn_7ac49ed5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 73, "kernel_name": "scalar_arr_bzlk", "python": "@wp.kernel\ndef scalar_arr_bzlk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_bzlk_69d07192 {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_bzlk_69d07192_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_bzlk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_bzlk_69d07192_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_args,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_bzlk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_bzlk(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_bzlk_69d07192_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bzlk_69d07192_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_bzlk_69d07192_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_args,\n    wp_args_scalar_arr_bzlk_69d07192 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_bzlk_69d07192_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 74, "kernel_name": "multi_ulyo", "python": "@wp.kernel\ndef multi_ulyo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_ulyo_d4568bd6 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_ulyo_d4568bd6_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ulyo_d4568bd6 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_ulyo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_ulyo_d4568bd6_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_ulyo_d4568bd6 *_wp_args,\n    wp_args_multi_ulyo_d4568bd6 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_ulyo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_ulyo(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_ulyo_d4568bd6_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ulyo_d4568bd6 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ulyo_d4568bd6_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_ulyo_d4568bd6_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_ulyo_d4568bd6 *_wp_args,\n    wp_args_multi_ulyo_d4568bd6 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_ulyo_d4568bd6_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 75, "kernel_name": "unary_srtg", "python": "@wp.kernel\ndef unary_srtg(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.sqrt(a[tid])", "cpp": "struct wp_args_unary_srtg_d180e041 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_srtg_d180e041_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_srtg_d180e041 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_srtg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_srtg_d180e041_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_srtg_d180e041 *_wp_args,\n    wp_args_unary_srtg_d180e041 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_srtg(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.sqrt(a[tid])                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::sqrt(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_sqrt(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.sqrt(a[tid])                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_srtg(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_srtg_d180e041_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_srtg_d180e041 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_srtg_d180e041_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_srtg_d180e041_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_srtg_d180e041 *_wp_args,\n    wp_args_unary_srtg_d180e041 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_srtg_d180e041_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 76, "kernel_name": "reduce_iwcc", "python": "@wp.kernel\ndef reduce_iwcc(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iwcc_97cced2d {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iwcc_97cced2d_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iwcc_97cced2d *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iwcc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iwcc_97cced2d_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iwcc_97cced2d *_wp_args,\n    wp_args_reduce_iwcc_97cced2d *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iwcc(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iwcc(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iwcc_97cced2d_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iwcc_97cced2d *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iwcc_97cced2d_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iwcc_97cced2d_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iwcc_97cced2d *_wp_args,\n    wp_args_reduce_iwcc_97cced2d *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iwcc_97cced2d_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 77, "kernel_name": "compound_xebj", "python": "@wp.kernel\ndef compound_xebj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_xebj_8a7b13ab {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_xebj_8a7b13ab_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xebj_8a7b13ab *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_xebj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_xebj_8a7b13ab_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_xebj_8a7b13ab *_wp_args,\n    wp_args_compound_xebj_8a7b13ab *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_xebj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_xebj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_xebj_8a7b13ab_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xebj_8a7b13ab *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xebj_8a7b13ab_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_xebj_8a7b13ab_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_xebj_8a7b13ab *_wp_args,\n    wp_args_compound_xebj_8a7b13ab *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_xebj_8a7b13ab_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 78, "kernel_name": "multi_lozj", "python": "@wp.kernel\ndef multi_lozj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] + b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_lozj_6bf7c5b5 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_lozj_6bf7c5b5_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_lozj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_lozj_6bf7c5b5_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_args,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_lozj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] + b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::add(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_add(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] + b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_lozj(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_lozj_6bf7c5b5_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lozj_6bf7c5b5_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_lozj_6bf7c5b5_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_args,\n    wp_args_multi_lozj_6bf7c5b5 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_lozj_6bf7c5b5_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 79, "kernel_name": "elementwise_bylw", "python": "@wp.kernel\ndef elementwise_bylw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_bylw_9ddb130e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_bylw_9ddb130e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bylw_9ddb130e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_bylw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_bylw_9ddb130e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_bylw_9ddb130e *_wp_args,\n    wp_args_elementwise_bylw_9ddb130e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_bylw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_bylw(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_bylw_9ddb130e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bylw_9ddb130e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bylw_9ddb130e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_bylw_9ddb130e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_bylw_9ddb130e *_wp_args,\n    wp_args_elementwise_bylw_9ddb130e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_bylw_9ddb130e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 80, "kernel_name": "scalar_arr_dudt", "python": "@wp.kernel\ndef scalar_arr_dudt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] * y[tid]", "cpp": "struct wp_args_scalar_arr_dudt_43c8084f {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_dudt_43c8084f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_dudt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_dudt_43c8084f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_args,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_dudt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] * y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::mul(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_mul(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] * y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_dudt(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_dudt_43c8084f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dudt_43c8084f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_dudt_43c8084f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_args,\n    wp_args_scalar_arr_dudt_43c8084f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_dudt_43c8084f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 81, "kernel_name": "compound_wqqs", "python": "@wp.kernel\ndef compound_wqqs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_wqqs_882ce885 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_wqqs_882ce885_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wqqs_882ce885 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_wqqs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_wqqs_882ce885_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_wqqs_882ce885 *_wp_args,\n    wp_args_compound_wqqs_882ce885 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_wqqs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_wqqs(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_wqqs_882ce885_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wqqs_882ce885 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wqqs_882ce885_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_wqqs_882ce885_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_wqqs_882ce885 *_wp_args,\n    wp_args_compound_wqqs_882ce885 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_wqqs_882ce885_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 82, "kernel_name": "multi_mkca", "python": "@wp.kernel\ndef multi_mkca(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.cos(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_mkca_93a5093b {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mkca_93a5093b_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mkca_93a5093b *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mkca(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mkca_93a5093b_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mkca_93a5093b *_wp_args,\n    wp_args_multi_mkca_93a5093b *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mkca(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.cos(temp1)                                                                  <L 7>\n    var_6 = wp::cos(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_cos(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.cos(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mkca(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mkca_93a5093b_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mkca_93a5093b *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mkca_93a5093b_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mkca_93a5093b_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mkca_93a5093b *_wp_args,\n    wp_args_multi_mkca_93a5093b *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mkca_93a5093b_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 83, "kernel_name": "multi_mgmu", "python": "@wp.kernel\ndef multi_mgmu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 * a[tid]", "cpp": "struct wp_args_multi_mgmu_4797cccd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mgmu_4797cccd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mgmu_4797cccd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mgmu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mgmu_4797cccd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mgmu_4797cccd *_wp_args,\n    wp_args_multi_mgmu_4797cccd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mgmu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 * a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::mul(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_mul(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 * a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mgmu(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mgmu_4797cccd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mgmu_4797cccd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mgmu_4797cccd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mgmu_4797cccd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mgmu_4797cccd *_wp_args,\n    wp_args_multi_mgmu_4797cccd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mgmu_4797cccd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 84, "kernel_name": "compound_pvhh", "python": "@wp.kernel\ndef compound_pvhh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):\n    tid = wp.tid()\n    x = a[tid]\n    y = b[tid]\n    result = (x + y) * scale\n    result = result - wp.floor(result)\n    c[tid] = wp.abs(result)", "cpp": "struct wp_args_compound_pvhh_7d1d8926 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n    wp::float32 scale;\n};\n\n\nvoid compound_pvhh_7d1d8926_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pvhh_7d1d8926 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // forward\n    // def compound_pvhh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    wp::array_store(var_c, var_0, var_11);\n}\n\n\n\nvoid compound_pvhh_7d1d8926_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_compound_pvhh_7d1d8926 *_wp_args,\n    wp_args_compound_pvhh_7d1d8926 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::float32 var_scale = _wp_args->scale;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    wp::float32 adj_scale = _wp_adj_args->scale;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32 var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    wp::float32 var_10;\n    wp::float32 var_11;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    //---------\n    // forward\n    // def compound_pvhh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // x = a[tid]                                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // y = b[tid]                                                                             <L 7>\n    var_4 = wp::address(var_b, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::copy(var_6);\n    // result = (x + y) * scale                                                               <L 8>\n    var_7 = wp::add(var_2, var_5);\n    var_8 = wp::mul(var_7, var_scale);\n    // result = result - wp.floor(result)                                                     <L 9>\n    var_9 = wp::floor(var_8);\n    var_10 = wp::sub(var_8, var_9);\n    // c[tid] = wp.abs(result)                                                                <L 10>\n    var_11 = wp::abs(var_10);\n    // wp::array_store(var_c, var_0, var_11);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_11, adj_c, adj_0, adj_11);\n    wp::adj_abs(var_10, adj_10, adj_11);\n    // adj: c[tid] = wp.abs(result)                                                           <L 10>\n    wp::adj_sub(var_8, var_9, adj_8, adj_9, adj_10);\n    // adj: result = result - wp.floor(result)                                                <L 9>\n    wp::adj_mul(var_7, var_scale, adj_7, adj_scale, adj_8);\n    wp::adj_add(var_2, var_5, adj_2, adj_5, adj_7);\n    // adj: result = (x + y) * scale                                                          <L 8>\n    wp::adj_copy(var_6, adj_4, adj_5);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n    // adj: y = b[tid]                                                                        <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: x = a[tid]                                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def compound_pvhh(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float), scale: float):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void compound_pvhh_7d1d8926_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pvhh_7d1d8926 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pvhh_7d1d8926_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void compound_pvhh_7d1d8926_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_compound_pvhh_7d1d8926 *_wp_args,\n    wp_args_compound_pvhh_7d1d8926 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        compound_pvhh_7d1d8926_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_compound_kernel"}
{"id": 85, "kernel_name": "multi_slyb", "python": "@wp.kernel\ndef multi_slyb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.sqrt(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_slyb_be251a91 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_slyb_be251a91_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_slyb_be251a91 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_slyb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_slyb_be251a91_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_slyb_be251a91 *_wp_args,\n    wp_args_multi_slyb_be251a91 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_slyb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.sqrt(temp1)                                                                 <L 7>\n    var_6 = wp::sqrt(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_sqrt(var_3, var_6, adj_3, adj_6);\n    // adj: temp2 = wp.sqrt(temp1)                                                            <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_slyb(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_slyb_be251a91_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_slyb_be251a91 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_slyb_be251a91_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_slyb_be251a91_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_slyb_be251a91 *_wp_args,\n    wp_args_multi_slyb_be251a91 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_slyb_be251a91_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 86, "kernel_name": "reduce_izds", "python": "@wp.kernel\ndef reduce_izds(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_izds_f6461f73 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_izds_f6461f73_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_izds_f6461f73 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_izds(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_izds_f6461f73_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_izds_f6461f73 *_wp_args,\n    wp_args_reduce_izds_f6461f73 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_izds(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_izds(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_izds_f6461f73_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_izds_f6461f73 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_izds_f6461f73_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_izds_f6461f73_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_izds_f6461f73 *_wp_args,\n    wp_args_reduce_izds_f6461f73 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_izds_f6461f73_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 87, "kernel_name": "multi_mhik", "python": "@wp.kernel\ndef multi_mhik(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] * b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 + a[tid]", "cpp": "struct wp_args_multi_mhik_155fba3f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_mhik_155fba3f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mhik_155fba3f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_mhik(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_mhik_155fba3f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_mhik_155fba3f *_wp_args,\n    wp_args_multi_mhik_155fba3f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_mhik(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] * b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::mul(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 + a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::add(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 + a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] * b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_mhik(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_mhik_155fba3f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mhik_155fba3f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mhik_155fba3f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_mhik_155fba3f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_mhik_155fba3f *_wp_args,\n    wp_args_multi_mhik_155fba3f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_mhik_155fba3f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 88, "kernel_name": "nested_wodw", "python": "@wp.kernel\ndef nested_wodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.07:\n        if val > 1.47:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_wodw_8ba44bbe {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_wodw_8ba44bbe_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_wodw_8ba44bbe *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.07;\n    bool var_5;\n    const wp::float32 var_6 = 1.47;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_wodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.07:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.47:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_wodw_8ba44bbe_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_wodw_8ba44bbe *_wp_args,\n    wp_args_nested_wodw_8ba44bbe *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.07;\n    bool var_5;\n    const wp::float32 var_6 = 1.47;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_wodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.07:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.47:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.47:                                                                <L 8>\n    }\n    // adj: if val > 0.07:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_wodw(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_wodw_8ba44bbe_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_wodw_8ba44bbe *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_wodw_8ba44bbe_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_wodw_8ba44bbe_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_wodw_8ba44bbe *_wp_args,\n    wp_args_nested_wodw_8ba44bbe *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_wodw_8ba44bbe_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 89, "kernel_name": "unary_shlk", "python": "@wp.kernel\ndef unary_shlk(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.cos(a[tid])", "cpp": "struct wp_args_unary_shlk_e08d2d6f {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid unary_shlk_e08d2d6f_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_shlk_e08d2d6f *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // forward\n    // def unary_shlk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid unary_shlk_e08d2d6f_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_unary_shlk_e08d2d6f *_wp_args,\n    wp_args_unary_shlk_e08d2d6f *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    //---------\n    // forward\n    // def unary_shlk(a: wp.array(dtype=float), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.cos(a[tid])                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::cos(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_cos(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.cos(a[tid])                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def unary_shlk(a: wp.array(dtype=float), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void unary_shlk_e08d2d6f_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_shlk_e08d2d6f *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_shlk_e08d2d6f_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void unary_shlk_e08d2d6f_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_unary_shlk_e08d2d6f *_wp_args,\n    wp_args_unary_shlk_e08d2d6f *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        unary_shlk_e08d2d6f_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_unary_kernel"}
{"id": 90, "kernel_name": "nested_ytjx", "python": "@wp.kernel\ndef nested_ytjx(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.39:\n        if val > 1.44:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_ytjx_c6c88b44 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_ytjx_c6c88b44_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ytjx_c6c88b44 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 1.44;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // forward\n    // def nested_ytjx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.44:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        wp::array_store(var_b, var_0, var_14);\n    }\n}\n\n\n\nvoid nested_ytjx_c6c88b44_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_ytjx_c6c88b44 *_wp_args,\n    wp_args_nested_ytjx_c6c88b44 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.39;\n    const wp::float32 var_5 = -0.39;\n    bool var_6;\n    const wp::float32 var_7 = 1.44;\n    bool var_8;\n    const wp::float32 var_9 = 3.0;\n    wp::float32 var_10;\n    const wp::float32 var_11 = 2.0;\n    wp::float32 var_12;\n    const wp::float32 var_13 = 0.5;\n    wp::float32 var_14;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    bool adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    wp::float32 adj_14 = {};\n    //---------\n    // forward\n    // def nested_ytjx(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.39:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // if val > 1.44:                                                                     <L 8>\n        var_8 = (var_2 > var_7);\n        if (var_8) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_10 = wp::mul(var_2, var_9);\n            // wp::array_store(var_b, var_0, var_10);\n        }\n        if (!var_8) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_12 = wp::mul(var_2, var_11);\n            // wp::array_store(var_b, var_0, var_12);\n        }\n    }\n    if (!var_6) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_14 = wp::mul(var_2, var_13);\n        // wp::array_store(var_b, var_0, var_14);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_14, adj_b, adj_0, adj_14);\n        wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_6) {\n        if (!var_8) {\n            wp::adj_array_store(var_b, var_0, var_12, adj_b, adj_0, adj_12);\n            wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_8) {\n            wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n            wp::adj_mul(var_2, var_9, adj_2, adj_9, adj_10);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.44:                                                                <L 8>\n    }\n    // adj: if val > -0.39:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_ytjx(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_ytjx_c6c88b44_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ytjx_c6c88b44 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ytjx_c6c88b44_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_ytjx_c6c88b44_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_ytjx_c6c88b44 *_wp_args,\n    wp_args_nested_ytjx_c6c88b44 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_ytjx_c6c88b44_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 91, "kernel_name": "reduce_iomu", "python": "@wp.kernel\ndef reduce_iomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_add(result, 0, a[tid])", "cpp": "struct wp_args_reduce_iomu_f319a903 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> result;\n};\n\n\nvoid reduce_iomu_f319a903_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iomu_f319a903 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // forward\n    // def reduce_iomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    var_3 = wp::atomic_add(var_result, var_1, var_4);\n}\n\n\n\nvoid reduce_iomu_f319a903_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_reduce_iomu_f319a903 *_wp_args,\n    wp_args_reduce_iomu_f319a903 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_result = _wp_args->result;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_result = _wp_adj_args->result;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    const wp::int32 var_1 = 0;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::int32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    //---------\n    // forward\n    // def reduce_iomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):              <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // wp.atomic_add(result, 0, a[tid])                                                       <L 6>\n    var_2 = wp::address(var_a, var_0);\n    var_4 = wp::load(var_2);\n    // var_3 = wp::atomic_add(var_result, var_1, var_4);\n    //---------\n    // reverse\n    wp::adj_atomic_add(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_2);\n    // adj: wp.atomic_add(result, 0, a[tid])                                                  <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def reduce_iomu(a: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void reduce_iomu_f319a903_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iomu_f319a903 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iomu_f319a903_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void reduce_iomu_f319a903_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_reduce_iomu_f319a903 *_wp_args,\n    wp_args_reduce_iomu_f319a903 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        reduce_iomu_f319a903_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_reduction_kernel"}
{"id": 92, "kernel_name": "branch_gqhf", "python": "@wp.kernel\ndef branch_gqhf(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.83:\n        b[tid] = val - 1.4\n    else:\n        b[tid] = val + 2.7", "cpp": "struct wp_args_branch_gqhf_6a36bb9a {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gqhf_6a36bb9a_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gqhf_6a36bb9a *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.83;\n    const wp::float32 var_5 = -0.83;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.7;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_gqhf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.83:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_gqhf_6a36bb9a_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gqhf_6a36bb9a *_wp_args,\n    wp_args_branch_gqhf_6a36bb9a *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.83;\n    const wp::float32 var_5 = -0.83;\n    bool var_6;\n    const wp::float32 var_7 = 1.4;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.7;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_gqhf(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.83:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.4                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val + 2.7                                                                 <L 10>\n        var_10 = wp::add(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_add(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val + 2.7                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.4                                                            <L 8>\n    }\n    // adj: if val > -0.83:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gqhf(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gqhf_6a36bb9a_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gqhf_6a36bb9a *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gqhf_6a36bb9a_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gqhf_6a36bb9a_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gqhf_6a36bb9a *_wp_args,\n    wp_args_branch_gqhf_6a36bb9a *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gqhf_6a36bb9a_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 93, "kernel_name": "vec_rwdr", "python": "@wp.kernel\ndef vec_rwdr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    b[tid] = wp.length(a[tid])", "cpp": "struct wp_args_vec_rwdr_9a24cfb3 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid vec_rwdr_9a24cfb3_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // forward\n    // def vec_rwdr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    wp::array_store(var_b, var_0, var_2);\n}\n\n\n\nvoid vec_rwdr_9a24cfb3_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_args,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::float32 var_2;\n    wp::vec_t<3, wp::float32> var_3;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::vec_t<3, wp::float32> adj_3 = {};\n    //---------\n    // forward\n    // def vec_rwdr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):                    <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // b[tid] = wp.length(a[tid])                                                             <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::length(var_3);\n    // wp::array_store(var_b, var_0, var_2);\n    //---------\n    // reverse\n    wp::adj_array_store(var_b, var_0, var_2, adj_b, adj_0, adj_2);\n    wp::adj_length(var_3, var_2, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: b[tid] = wp.length(a[tid])                                                        <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_rwdr(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=float)):               <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_rwdr_9a24cfb3_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_rwdr_9a24cfb3_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_rwdr_9a24cfb3_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_args,\n    wp_args_vec_rwdr_9a24cfb3 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_rwdr_9a24cfb3_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
{"id": 94, "kernel_name": "branch_gncd", "python": "@wp.kernel\ndef branch_gncd(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > -0.51:\n        b[tid] = val - 1.3\n    else:\n        b[tid] = val - 2.9", "cpp": "struct wp_args_branch_gncd_c2dfd651 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid branch_gncd_c2dfd651_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gncd_c2dfd651 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.51;\n    const wp::float32 var_5 = -0.51;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.9;\n    wp::float32 var_10;\n    //---------\n    // forward\n    // def branch_gncd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.51:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.3                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.9                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        wp::array_store(var_b, var_0, var_10);\n    }\n}\n\n\n\nvoid branch_gncd_c2dfd651_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_branch_gncd_c2dfd651 *_wp_args,\n    wp_args_branch_gncd_c2dfd651 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.51;\n    const wp::float32 var_5 = -0.51;\n    bool var_6;\n    const wp::float32 var_7 = 1.3;\n    wp::float32 var_8;\n    const wp::float32 var_9 = 2.9;\n    wp::float32 var_10;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    bool adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    //---------\n    // forward\n    // def branch_gncd(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > -0.51:                                                                        <L 7>\n    var_6 = (var_2 > var_5);\n    if (var_6) {\n        // b[tid] = val - 1.3                                                                 <L 8>\n        var_8 = wp::sub(var_2, var_7);\n        // wp::array_store(var_b, var_0, var_8);\n    }\n    if (!var_6) {\n        // b[tid] = val - 2.9                                                                 <L 10>\n        var_10 = wp::sub(var_2, var_9);\n        // wp::array_store(var_b, var_0, var_10);\n    }\n    //---------\n    // reverse\n    if (!var_6) {\n        wp::adj_array_store(var_b, var_0, var_10, adj_b, adj_0, adj_10);\n        wp::adj_sub(var_2, var_9, adj_2, adj_9, adj_10);\n        // adj: b[tid] = val - 2.9                                                            <L 10>\n    }\n    if (var_6) {\n        wp::adj_array_store(var_b, var_0, var_8, adj_b, adj_0, adj_8);\n        wp::adj_sub(var_2, var_7, adj_2, adj_7, adj_8);\n        // adj: b[tid] = val - 1.3                                                            <L 8>\n    }\n    // adj: if val > -0.51:                                                                   <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def branch_gncd(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void branch_gncd_c2dfd651_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gncd_c2dfd651 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gncd_c2dfd651_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void branch_gncd_c2dfd651_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_branch_gncd_c2dfd651 *_wp_args,\n    wp_args_branch_gncd_c2dfd651 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        branch_gncd_c2dfd651_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_branch_kernel"}
{"id": 95, "kernel_name": "elementwise_akpy", "python": "@wp.kernel\ndef elementwise_akpy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = a[tid] - b[tid]", "cpp": "struct wp_args_elementwise_akpy_75aa636e {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid elementwise_akpy_75aa636e_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_akpy_75aa636e *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // forward\n    // def elementwise_akpy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid elementwise_akpy_75aa636e_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_elementwise_akpy_75aa636e *_wp_args,\n    wp_args_elementwise_akpy_75aa636e *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    //---------\n    // forward\n    // def elementwise_akpy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = a[tid] - b[tid]                                                               <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = a[tid] - b[tid]                                                          <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def elementwise_akpy(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void elementwise_akpy_75aa636e_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_akpy_75aa636e *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_akpy_75aa636e_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void elementwise_akpy_75aa636e_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_elementwise_akpy_75aa636e *_wp_args,\n    wp_args_elementwise_akpy_75aa636e *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        elementwise_akpy_75aa636e_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_simple_elementwise"}
{"id": 96, "kernel_name": "nested_nlxj", "python": "@wp.kernel\ndef nested_nlxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = a[tid]\n    if val > 0.38:\n        if val > 1.31:\n            b[tid] = val * 3.0\n        else:\n            b[tid] = val * 2.0\n    else:\n        b[tid] = val * 0.5", "cpp": "struct wp_args_nested_nlxj_fccce678 {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n};\n\n\nvoid nested_nlxj_fccce678_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nlxj_fccce678 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.38;\n    bool var_5;\n    const wp::float32 var_6 = 1.31;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // forward\n    // def nested_nlxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.38:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.31:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        wp::array_store(var_b, var_0, var_13);\n    }\n}\n\n\n\nvoid nested_nlxj_fccce678_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_nested_nlxj_fccce678 *_wp_args,\n    wp_args_nested_nlxj_fccce678 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    const wp::float32 var_4 = 0.38;\n    bool var_5;\n    const wp::float32 var_6 = 1.31;\n    bool var_7;\n    const wp::float32 var_8 = 3.0;\n    wp::float32 var_9;\n    const wp::float32 var_10 = 2.0;\n    wp::float32 var_11;\n    const wp::float32 var_12 = 0.5;\n    wp::float32 var_13;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    bool adj_5 = {};\n    wp::float32 adj_6 = {};\n    bool adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    wp::float32 adj_10 = {};\n    wp::float32 adj_11 = {};\n    wp::float32 adj_12 = {};\n    wp::float32 adj_13 = {};\n    //---------\n    // forward\n    // def nested_nlxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):                   <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // val = a[tid]                                                                           <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val > 0.38:                                                                         <L 7>\n    var_5 = (var_2 > var_4);\n    if (var_5) {\n        // if val > 1.31:                                                                     <L 8>\n        var_7 = (var_2 > var_6);\n        if (var_7) {\n            // b[tid] = val * 3.0                                                             <L 9>\n            var_9 = wp::mul(var_2, var_8);\n            // wp::array_store(var_b, var_0, var_9);\n        }\n        if (!var_7) {\n            // b[tid] = val * 2.0                                                             <L 11>\n            var_11 = wp::mul(var_2, var_10);\n            // wp::array_store(var_b, var_0, var_11);\n        }\n    }\n    if (!var_5) {\n        // b[tid] = val * 0.5                                                                 <L 13>\n        var_13 = wp::mul(var_2, var_12);\n        // wp::array_store(var_b, var_0, var_13);\n    }\n    //---------\n    // reverse\n    if (!var_5) {\n        wp::adj_array_store(var_b, var_0, var_13, adj_b, adj_0, adj_13);\n        wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n        // adj: b[tid] = val * 0.5                                                            <L 13>\n    }\n    if (var_5) {\n        if (!var_7) {\n            wp::adj_array_store(var_b, var_0, var_11, adj_b, adj_0, adj_11);\n            wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n            // adj: b[tid] = val * 2.0                                                        <L 11>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_b, var_0, var_9, adj_b, adj_0, adj_9);\n            wp::adj_mul(var_2, var_8, adj_2, adj_8, adj_9);\n            // adj: b[tid] = val * 3.0                                                        <L 9>\n        }\n        // adj: if val > 1.31:                                                                <L 8>\n    }\n    // adj: if val > 0.38:                                                                    <L 7>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: val = a[tid]                                                                      <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def nested_nlxj(a: wp.array(dtype=float), b: wp.array(dtype=float)):              <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void nested_nlxj_fccce678_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nlxj_fccce678 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nlxj_fccce678_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void nested_nlxj_fccce678_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_nested_nlxj_fccce678 *_wp_args,\n    wp_args_nested_nlxj_fccce678 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        nested_nlxj_fccce678_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_nested_branch_kernel"}
{"id": 97, "kernel_name": "multi_meba", "python": "@wp.kernel\ndef multi_meba(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    temp1 = a[tid] - b[tid]\n    temp2 = wp.abs(temp1)\n    c[tid] = temp2 - a[tid]", "cpp": "struct wp_args_multi_meba_b76652cd {\n    wp::array_t<wp::float32> a;\n    wp::array_t<wp::float32> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid multi_meba_b76652cd_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_meba_b76652cd *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // forward\n    // def multi_meba(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    wp::array_store(var_c, var_0, var_8);\n}\n\n\n\nvoid multi_meba_b76652cd_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_multi_meba_b76652cd *_wp_args,\n    wp_args_multi_meba_b76652cd *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_a = _wp_args->a;\n    wp::array_t<wp::float32> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::float32> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::float32> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32* var_2;\n    wp::float32 var_3;\n    wp::float32 var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    wp::float32* var_7;\n    wp::float32 var_8;\n    wp::float32 var_9;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    wp::float32 adj_7 = {};\n    wp::float32 adj_8 = {};\n    wp::float32 adj_9 = {};\n    //---------\n    // forward\n    // def multi_meba(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // temp1 = a[tid] - b[tid]                                                                <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::sub(var_4, var_5);\n    // temp2 = wp.abs(temp1)                                                                  <L 7>\n    var_6 = wp::abs(var_3);\n    // c[tid] = temp2 - a[tid]                                                                <L 8>\n    var_7 = wp::address(var_a, var_0);\n    var_9 = wp::load(var_7);\n    var_8 = wp::sub(var_6, var_9);\n    // wp::array_store(var_c, var_0, var_8);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_8, adj_c, adj_0, adj_8);\n    wp::adj_sub(var_6, var_9, adj_6, adj_7, adj_8);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_7);\n    // adj: c[tid] = temp2 - a[tid]                                                           <L 8>\n    wp::adj_abs(var_3, adj_3, adj_6);\n    // adj: temp2 = wp.abs(temp1)                                                             <L 7>\n    wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: temp1 = a[tid] - b[tid]                                                           <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def multi_meba(a: wp.array(dtype=float), b: wp.array(dtype=float), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void multi_meba_b76652cd_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_meba_b76652cd *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_meba_b76652cd_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void multi_meba_b76652cd_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_multi_meba_b76652cd *_wp_args,\n    wp_args_multi_meba_b76652cd *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        multi_meba_b76652cd_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_multi_statement_kernel"}
{"id": 98, "kernel_name": "scalar_arr_wcrf", "python": "@wp.kernel\ndef scalar_arr_wcrf(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = alpha * x[tid] + y[tid]", "cpp": "struct wp_args_scalar_arr_wcrf_ec09b1ce {\n    wp::float32 alpha;\n    wp::array_t<wp::float32> x;\n    wp::array_t<wp::float32> y;\n    wp::array_t<wp::float32> out;\n};\n\n\nvoid scalar_arr_wcrf_ec09b1ce_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // forward\n    // def scalar_arr_wcrf(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    wp::array_store(var_out, var_0, var_5);\n}\n\n\n\nvoid scalar_arr_wcrf_ec09b1ce_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_args,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::float32 var_alpha = _wp_args->alpha;\n    wp::array_t<wp::float32> var_x = _wp_args->x;\n    wp::array_t<wp::float32> var_y = _wp_args->y;\n    wp::array_t<wp::float32> var_out = _wp_args->out;\n    wp::float32 adj_alpha = _wp_adj_args->alpha;\n    wp::array_t<wp::float32> adj_x = _wp_adj_args->x;\n    wp::array_t<wp::float32> adj_y = _wp_adj_args->y;\n    wp::array_t<wp::float32> adj_out = _wp_adj_args->out;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    wp::float32* var_4;\n    wp::float32 var_5;\n    wp::float32 var_6;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::float32 adj_4 = {};\n    wp::float32 adj_5 = {};\n    wp::float32 adj_6 = {};\n    //---------\n    // forward\n    // def scalar_arr_wcrf(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // out[tid] = alpha * x[tid] + y[tid]                                                     <L 6>\n    var_1 = wp::address(var_x, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::mul(var_alpha, var_3);\n    var_4 = wp::address(var_y, var_0);\n    var_6 = wp::load(var_4);\n    var_5 = wp::add(var_2, var_6);\n    // wp::array_store(var_out, var_0, var_5);\n    //---------\n    // reverse\n    wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n    wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n    wp::adj_address(var_y, var_0, adj_y, adj_0, adj_4);\n    wp::adj_mul(var_alpha, var_3, adj_alpha, adj_1, adj_2);\n    wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n    // adj: out[tid] = alpha * x[tid] + y[tid]                                                <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def scalar_arr_wcrf(alpha: float, x: wp.array(dtype=float), y: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void scalar_arr_wcrf_ec09b1ce_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wcrf_ec09b1ce_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void scalar_arr_wcrf_ec09b1ce_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_args,\n    wp_args_scalar_arr_wcrf_ec09b1ce *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        scalar_arr_wcrf_ec09b1ce_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_scalar_array_op"}
{"id": 99, "kernel_name": "vec_jqdv", "python": "@wp.kernel\ndef vec_jqdv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):\n    tid = wp.tid()\n    c[tid] = wp.dot(a[tid], b[tid])", "cpp": "struct wp_args_vec_jqdv_26058807 {\n    wp::array_t<wp::vec_t<3, wp::float32>> a;\n    wp::array_t<wp::vec_t<3, wp::float32>> b;\n    wp::array_t<wp::float32> c;\n};\n\n\nvoid vec_jqdv_26058807_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jqdv_26058807 *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // forward\n    // def vec_jqdv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    wp::array_store(var_c, var_0, var_3);\n}\n\n\n\nvoid vec_jqdv_26058807_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_vec_jqdv_26058807 *_wp_args,\n    wp_args_vec_jqdv_26058807 *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a = _wp_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b = _wp_args->b;\n    wp::array_t<wp::float32> var_c = _wp_args->c;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a = _wp_adj_args->a;\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b = _wp_adj_args->b;\n    wp::array_t<wp::float32> adj_c = _wp_adj_args->c;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::vec_t<3, wp::float32>* var_1;\n    wp::vec_t<3, wp::float32>* var_2;\n    wp::float32 var_3;\n    wp::vec_t<3, wp::float32> var_4;\n    wp::vec_t<3, wp::float32> var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::vec_t<3, wp::float32> adj_1 = {};\n    wp::vec_t<3, wp::float32> adj_2 = {};\n    wp::float32 adj_3 = {};\n    wp::vec_t<3, wp::float32> adj_4 = {};\n    wp::vec_t<3, wp::float32> adj_5 = {};\n    //---------\n    // forward\n    // def vec_jqdv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):       <L 4>\n    // tid = wp.tid()                                                                         <L 5>\n    var_0 = builtin_tid1d();\n    // c[tid] = wp.dot(a[tid], b[tid])                                                        <L 6>\n    var_1 = wp::address(var_a, var_0);\n    var_2 = wp::address(var_b, var_0);\n    var_4 = wp::load(var_1);\n    var_5 = wp::load(var_2);\n    var_3 = wp::dot(var_4, var_5);\n    // wp::array_store(var_c, var_0, var_3);\n    //---------\n    // reverse\n    wp::adj_array_store(var_c, var_0, var_3, adj_c, adj_0, adj_3);\n    wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n    wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n    wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n    // adj: c[tid] = wp.dot(a[tid], b[tid])                                                   <L 6>\n    // adj: tid = wp.tid()                                                                    <L 5>\n    // adj: def vec_jqdv(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), c: wp.array(dtype=float)):  <L 4>\n    return;\n}\n\n\n\n\nextern \"C\" {\n\n// Python CPU entry points\nWP_API void vec_jqdv_26058807_cpu_forward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jqdv_26058807 *_wp_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jqdv_26058807_cpu_kernel_forward(dim, task_index, _wp_args);\n    }\n}\n\n} // extern C\n\n\n\nextern \"C\" {\n\nWP_API void vec_jqdv_26058807_cpu_backward(\n    wp::launch_bounds_t dim,\n    wp_args_vec_jqdv_26058807 *_wp_args,\n    wp_args_vec_jqdv_26058807 *_wp_adj_args)\n{\n    wp::tile_shared_storage_t tile_mem;\n#if defined(WP_ENABLE_TILES_IN_STACK_MEMORY)\n    wp::shared_tile_storage = &tile_mem;\n#endif\n\n    for (size_t task_index = 0; task_index < dim.size; ++task_index)\n    {\n        vec_jqdv_26058807_cpu_kernel_backward(dim, task_index, _wp_args, _wp_adj_args);\n    }\n}\n\n} // extern C\n\n", "type": "generate_vector_kernel"}
