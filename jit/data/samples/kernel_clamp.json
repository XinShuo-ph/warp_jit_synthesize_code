{
  "python_source": "@wp.kernel\ndef kernel_clamp(arr: wp.array(dtype=float), min_val: float, max_val: float):\n    tid = wp.tid()\n    val = arr[tid]\n    if val < min_val:\n        arr[tid] = min_val\n    elif val > max_val:\n        arr[tid] = max_val\n",
  "cpp_forward": "void kernel_clamp_e2532dca_cpu_kernel_forward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_kernel_clamp_e2532dca *_wp_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_arr = _wp_args->arr;\n    wp::float32 var_min_val = _wp_args->min_val;\n    wp::float32 var_max_val = _wp_args->max_val;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    bool var_4;\n    bool var_5;\n    //---------\n    // forward\n    // def kernel_clamp(arr: wp.array(dtype=float), min_val: float, max_val: float):          <L 30>\n    // tid = wp.tid()                                                                         <L 31>\n    var_0 = builtin_tid1d();\n    // val = arr[tid]                                                                         <L 32>\n    var_1 = wp::address(var_arr, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val < min_val:                                                                      <L 33>\n    var_4 = (var_2 < var_min_val);\n    if (var_4) {\n        // arr[tid] = min_val                                                                 <L 34>\n        wp::array_store(var_arr, var_0, var_min_val);\n    }\n    if (!var_4) {\n        // elif val > max_val:                                                                <L 35>\n        var_5 = (var_2 > var_max_val);\n        if (var_5) {\n            // arr[tid] = max_val                                                             <L 36>\n            wp::array_store(var_arr, var_0, var_max_val);\n        }\n    }\n}",
  "cpp_backward": "void kernel_clamp_e2532dca_cpu_kernel_backward(\n    wp::launch_bounds_t dim,\n    size_t task_index,\n    wp_args_kernel_clamp_e2532dca *_wp_args,\n    wp_args_kernel_clamp_e2532dca *_wp_adj_args)\n{\n    //---------\n    // argument vars\n    wp::array_t<wp::float32> var_arr = _wp_args->arr;\n    wp::float32 var_min_val = _wp_args->min_val;\n    wp::float32 var_max_val = _wp_args->max_val;\n    wp::array_t<wp::float32> adj_arr = _wp_adj_args->arr;\n    wp::float32 adj_min_val = _wp_adj_args->min_val;\n    wp::float32 adj_max_val = _wp_adj_args->max_val;\n    //---------\n    // primal vars\n    wp::int32 var_0;\n    wp::float32* var_1;\n    wp::float32 var_2;\n    wp::float32 var_3;\n    bool var_4;\n    bool var_5;\n    //---------\n    // dual vars\n    wp::int32 adj_0 = {};\n    wp::float32 adj_1 = {};\n    wp::float32 adj_2 = {};\n    wp::float32 adj_3 = {};\n    bool adj_4 = {};\n    bool adj_5 = {};\n    //---------\n    // forward\n    // def kernel_clamp(arr: wp.array(dtype=float), min_val: float, max_val: float):          <L 30>\n    // tid = wp.tid()                                                                         <L 31>\n    var_0 = builtin_tid1d();\n    // val = arr[tid]                                                                         <L 32>\n    var_1 = wp::address(var_arr, var_0);\n    var_3 = wp::load(var_1);\n    var_2 = wp::copy(var_3);\n    // if val < min_val:                                                                      <L 33>\n    var_4 = (var_2 < var_min_val);\n    if (var_4) {\n        // arr[tid] = min_val                                                                 <L 34>\n        // wp::array_store(var_arr, var_0, var_min_val);\n    }\n    if (!var_4) {\n        // elif val > max_val:                                                                <L 35>\n        var_5 = (var_2 > var_max_val);\n        if (var_5) {\n            // arr[tid] = max_val                                                             <L 36>\n            // wp::array_store(var_arr, var_0, var_max_val);\n        }\n    }\n    //---------\n    // reverse\n    if (!var_4) {\n        if (var_5) {\n            wp::adj_array_store(var_arr, var_0, var_max_val, adj_arr, adj_0, adj_max_val);\n            // adj: arr[tid] = max_val                                                        <L 36>\n        }\n        // adj: elif val > max_val:                                                           <L 35>\n    }\n    if (var_4) {\n        wp::adj_array_store(var_arr, var_0, var_min_val, adj_arr, adj_0, adj_min_val);\n        // adj: arr[tid] = min_val                                                            <L 34>\n    }\n    // adj: if val < min_val:                                                                 <L 33>\n    wp::adj_copy(var_3, adj_1, adj_2);\n    wp::adj_address(var_arr, var_0, adj_arr, adj_0, adj_1);\n    // adj: val = arr[tid]                                                                    <L 32>\n    // adj: tid = wp.tid()                                                                    <L 31>\n    // adj: def kernel_clamp(arr: wp.array(dtype=float), min_val: float, max_val: float):     <L 30>\n    return;\n}",
  "metadata": {
    "kernel_name": "kernel_clamp",
    "mangled_name": "kernel_clamp_e2532dca",
    "device": "cpu",
    "arg_names": [
      "arr",
      "min_val",
      "max_val"
    ],
    "arg_types": {
      "arr": "array<class 'warp._src.types.float32'>",
      "min_val": "<class 'float'>",
      "max_val": "<class 'float'>"
    },
    "has_backward": true
  }
}