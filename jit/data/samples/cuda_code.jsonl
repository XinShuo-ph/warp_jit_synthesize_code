{"id":"vec_qahftr_5217623655","device":"cuda","category":"vector","description":"Vector op dot on wp.vec4","arg_types":{"a":"wp.array(dtype=wp.vec4)","b":"wp.array(dtype=wp.vec4)","out":"wp.array(dtype=float)"},"metadata":{"vec_type":"wp.vec4","operation":"dot","seed":42},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_qahftr_e0a9cc7c_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32>* var_2;\n        wp::float32 var_3;\n        wp::vec_t<4, wp::float32> var_4;\n        wp::vec_t<4, wp::float32> var_5;\n        //---------\n        // forward\n        // def vec_qahftr(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.dot(a[tid], b[tid])                                                      <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::dot(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_qahftr_e0a9cc7c_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32>* var_2;\n        wp::float32 var_3;\n        wp::vec_t<4, wp::float32> var_4;\n        wp::vec_t<4, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<4, wp::float32> adj_1 = {};\n        wp::vec_t<4, wp::float32> adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::vec_t<4, wp::float32> adj_4 = {};\n        wp::vec_t<4, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def vec_qahftr(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.dot(a[tid], b[tid])                                                      <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::dot(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_dot(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.dot(a[tid], b[tid])                                                 <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_qahftr(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_qahftr","mangled_name":"vec_qahftr_e0a9cc7c","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec4f'>","b":"array<class 'warp._src.types.vec4f'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_qahftr(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.dot(a[tid], b[tid])\n"}
{"id":"scalar_bsdmru_e4083d0361","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=6.03, offset=1.09)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"-","scale":6.03,"offset":1.09,"seed":43},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_bsdmru_452d600c_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_bsdmru(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_bsdmru_452d600c_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_bsdmru(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_sub(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] - scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_bsdmru(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_bsdmru","mangled_name":"scalar_bsdmru_452d600c","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_bsdmru(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] - scale) + offset\n"}
{"id":"combined_kowefa_9d4f77d5bc","device":"cuda","category":"combined","description":"Combined pattern (loop+cond+wp.sin)","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"iterations":4,"threshold":0.27,"function":"wp.sin","seed":44},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void combined_kowefa_5ca34340_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.27;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.27;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.27;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.27;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        //---------\n        // forward\n        // def combined_kowefa(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(4):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::sin(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::sin(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::sin(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::sin(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // out[tid] = acc                                                                         <L 12>\n        wp::array_store(var_out, var_0, var_66);\n    }\n}\n\n\n\nextern \"C\" __global__ void combined_kowefa_5ca34340_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.27;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.27;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.27;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.27;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        bool adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        bool adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        bool adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        //---------\n        // forward\n        // def combined_kowefa(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(4):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::sin(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::sin(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::sin(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.27:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::sin(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // out[tid] = acc                                                                         <L 12>\n        // wp::array_store(var_out, var_0, var_66);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_66, adj_out, adj_0, adj_66);\n        // adj: out[tid] = acc                                                                    <L 12>\n        wp::adj_where(var_57, var_62, var_64, adj_57, adj_62, adj_64, adj_66);\n        if (!var_57) {\n            wp::adj_add(var_62, var_65, adj_62, adj_63, adj_64);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_63);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_57, var_61, var_50, adj_57, adj_61, adj_50, adj_62);\n        if (var_57) {\n            wp::adj_add(var_50, var_59, adj_50, adj_59, adj_61);\n            wp::adj_sin(var_60, adj_58, adj_59);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_58);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_55, var_53, adj_52, adj_53, adj_54);\n        wp::adj_float(var_51, adj_51, adj_53);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        // adj: if a[tid] * float(i) > 0.27:                                                      <L 8>\n        wp::adj_where(var_41, var_46, var_48, adj_41, adj_46, adj_48, adj_50);\n        if (!var_41) {\n            wp::adj_add(var_46, var_49, adj_46, adj_47, adj_48);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_47);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_41, var_45, var_34, adj_41, adj_45, adj_34, adj_46);\n        if (var_41) {\n            wp::adj_add(var_34, var_43, adj_34, adj_43, adj_45);\n            wp::adj_sin(var_44, adj_42, adj_43);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_42);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_39, var_37, adj_36, adj_37, adj_38);\n        wp::adj_float(var_35, adj_35, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        // adj: if a[tid] * float(i) > 0.27:                                                      <L 8>\n        wp::adj_where(var_25, var_30, var_32, adj_25, adj_30, adj_32, adj_34);\n        if (!var_25) {\n            wp::adj_add(var_30, var_33, adj_30, adj_31, adj_32);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_31);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_25, var_29, var_18, adj_25, adj_29, adj_18, adj_30);\n        if (var_25) {\n            wp::adj_add(var_18, var_27, adj_18, adj_27, adj_29);\n            wp::adj_sin(var_28, adj_26, adj_27);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_26);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_23, var_21, adj_20, adj_21, adj_22);\n        wp::adj_float(var_19, adj_19, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        // adj: if a[tid] * float(i) > 0.27:                                                      <L 8>\n        wp::adj_where(var_9, var_14, var_16, adj_9, adj_14, adj_16, adj_18);\n        if (!var_9) {\n            wp::adj_add(var_14, var_17, adj_14, adj_15, adj_16);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_15);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_9, var_13, var_2, adj_9, adj_13, adj_2, adj_14);\n        if (var_9) {\n            wp::adj_add(var_2, var_11, adj_2, adj_11, adj_13);\n            wp::adj_sin(var_12, adj_10, adj_11);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_10);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_float(var_3, adj_3, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: if a[tid] * float(i) > 0.27:                                                      <L 8>\n        // adj: for i in range(4):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: acc = float(0.0)                                                                  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def combined_kowefa(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"combined_kowefa","mangled_name":"combined_kowefa_5ca34340","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef combined_kowefa(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    acc = float(0.0)\n    for i in range(4):\n        if a[tid] * float(i) > 0.27:\n            acc = acc + wp.sin(b[tid])\n        else:\n            acc = acc + b[tid]\n    out[tid] = acc\n"}
{"id":"mat_hmciba_8a7f7c43af","device":"cuda","category":"matrix","description":"Matrix-vector multiply (wp.mat33 * wp.vec3)","arg_types":{"m":"wp.array(dtype=wp.mat33)","v":"wp.array(dtype=wp.vec3)","out":"wp.array(dtype=wp.vec3)"},"metadata":{"mat_type":"wp.mat33","operation":"mat_vec","seed":45},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_hmciba_6254a873_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_hmciba(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_hmciba_6254a873_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<3, 3, wp::float32> adj_1 = {};\n        wp::vec_t<3, wp::float32> adj_2 = {};\n        wp::vec_t<3, wp::float32> adj_3 = {};\n        wp::mat_t<3, 3, wp::float32> adj_4 = {};\n        wp::vec_t<3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_hmciba(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_v, var_0, adj_v, adj_0, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = m[tid] * v[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_hmciba(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_hmciba","mangled_name":"mat_hmciba_6254a873","device":"cuda","arg_names":["m","v","out"],"arg_types":{"m":"array<class 'warp._src.types.mat33f'>","v":"array<class 'warp._src.types.vec3f'>","out":"array<class 'warp._src.types.vec3f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_hmciba(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):\n    tid = wp.tid()\n    out[tid] = m[tid] * v[tid]\n"}
{"id":"math_xkpwfn_a786482a5e","device":"cuda","category":"math","description":"Math chain: cos, neg, exp, log, abs, sin","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["cos","neg","exp","log","abs","sin"],"seed":46},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_xkpwfn_df97a392_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::float32 var_7 = 1.0;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        //---------\n        // forward\n        // def math_xkpwfn(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.sin(wp.abs(wp.log(wp.abs(wp.exp(-wp.cos(a[tid]))) + 1.0)))               <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::neg(var_2);\n        var_5 = wp::exp(var_4);\n        var_6 = wp::abs(var_5);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::log(var_8);\n        var_10 = wp::abs(var_9);\n        var_11 = wp::sin(var_10);\n        wp::array_store(var_out, var_0, var_11);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_xkpwfn_df97a392_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::float32 var_7 = 1.0;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        //---------\n        // forward\n        // def math_xkpwfn(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.sin(wp.abs(wp.log(wp.abs(wp.exp(-wp.cos(a[tid]))) + 1.0)))               <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::neg(var_2);\n        var_5 = wp::exp(var_4);\n        var_6 = wp::abs(var_5);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::log(var_8);\n        var_10 = wp::abs(var_9);\n        var_11 = wp::sin(var_10);\n        // wp::array_store(var_out, var_0, var_11);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n        wp::adj_sin(var_10, adj_10, adj_11);\n        wp::adj_abs(var_9, adj_9, adj_10);\n        wp::adj_log(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_abs(var_5, adj_5, adj_6);\n        wp::adj_exp(var_4, var_5, adj_4, adj_5);\n        wp::adj_neg(var_2, adj_2, adj_4);\n        wp::adj_cos(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.sin(wp.abs(wp.log(wp.abs(wp.exp(-wp.cos(a[tid]))) + 1.0)))          <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_xkpwfn(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_xkpwfn","mangled_name":"math_xkpwfn_df97a392","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_xkpwfn(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.sin(wp.abs(wp.log(wp.abs(wp.exp(-wp.cos(a[tid]))) + 1.0)))\n"}
{"id":"arith_jllink_e9271c8276","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 2 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":2,"seed":47},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_jllink_2d6ec616_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        //---------\n        // forward\n        // def arith_jllink(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.max(a[tid], b[tid])                                                         <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::max(var_4, var_5);\n        // var_1 = -var_0                                                                         <L 7>\n        var_6 = wp::neg(var_3);\n        // out[tid] = var_1                                                                       <L 8>\n        wp::array_store(var_out, var_0, var_6);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_jllink_2d6ec616_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        //---------\n        // forward\n        // def arith_jllink(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.max(a[tid], b[tid])                                                         <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::max(var_4, var_5);\n        // var_1 = -var_0                                                                         <L 7>\n        var_6 = wp::neg(var_3);\n        // out[tid] = var_1                                                                       <L 8>\n        // wp::array_store(var_out, var_0, var_6);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_6, adj_out, adj_0, adj_6);\n        // adj: out[tid] = var_1                                                                  <L 8>\n        wp::adj_neg(var_3, adj_3, adj_6);\n        // adj: var_1 = -var_0                                                                    <L 7>\n        wp::adj_max(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = wp.max(a[tid], b[tid])                                                    <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_jllink(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_jllink","mangled_name":"arith_jllink_2d6ec616","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_jllink(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = wp.max(a[tid], b[tid])\n    var_1 = -var_0\n    out[tid] = var_1\n"}
{"id":"arith_odshyf_7903c83b39","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 8 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":8,"seed":48},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_odshyf_8628ef92_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32* var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        //---------\n        // forward\n        // def arith_odshyf(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.log(wp.abs(a[tid]) + 1.0)                                                   <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::abs(var_3);\n        var_5 = wp::add(var_2, var_4);\n        var_6 = wp::log(var_5);\n        // var_1 = var_0 + b[tid]                                                                 <L 7>\n        var_7 = wp::address(var_b, var_0);\n        var_9 = wp::load(var_7);\n        var_8 = wp::add(var_6, var_9);\n        // var_2 = wp.abs(var_1)                                                                  <L 8>\n        var_10 = wp::abs(var_8);\n        // var_3 = wp.cos(var_2)                                                                  <L 9>\n        var_11 = wp::cos(var_10);\n        // var_4 = wp.min(var_3, b[tid])                                                          <L 10>\n        var_12 = wp::address(var_b, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::min(var_11, var_14);\n        // var_5 = wp.abs(var_4)                                                                  <L 11>\n        var_15 = wp::abs(var_13);\n        // var_6 = wp.sin(var_5)                                                                  <L 12>\n        var_16 = wp::sin(var_15);\n        // var_7 = wp.sin(var_6)                                                                  <L 13>\n        var_17 = wp::sin(var_16);\n        // out[tid] = var_7                                                                       <L 14>\n        wp::array_store(var_out, var_0, var_17);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_odshyf_8628ef92_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32* var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        //---------\n        // forward\n        // def arith_odshyf(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.log(wp.abs(a[tid]) + 1.0)                                                   <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::abs(var_3);\n        var_5 = wp::add(var_2, var_4);\n        var_6 = wp::log(var_5);\n        // var_1 = var_0 + b[tid]                                                                 <L 7>\n        var_7 = wp::address(var_b, var_0);\n        var_9 = wp::load(var_7);\n        var_8 = wp::add(var_6, var_9);\n        // var_2 = wp.abs(var_1)                                                                  <L 8>\n        var_10 = wp::abs(var_8);\n        // var_3 = wp.cos(var_2)                                                                  <L 9>\n        var_11 = wp::cos(var_10);\n        // var_4 = wp.min(var_3, b[tid])                                                          <L 10>\n        var_12 = wp::address(var_b, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::min(var_11, var_14);\n        // var_5 = wp.abs(var_4)                                                                  <L 11>\n        var_15 = wp::abs(var_13);\n        // var_6 = wp.sin(var_5)                                                                  <L 12>\n        var_16 = wp::sin(var_15);\n        // var_7 = wp.sin(var_6)                                                                  <L 13>\n        var_17 = wp::sin(var_16);\n        // out[tid] = var_7                                                                       <L 14>\n        // wp::array_store(var_out, var_0, var_17);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_17, adj_out, adj_0, adj_17);\n        // adj: out[tid] = var_7                                                                  <L 14>\n        wp::adj_sin(var_16, adj_16, adj_17);\n        // adj: var_7 = wp.sin(var_6)                                                             <L 13>\n        wp::adj_sin(var_15, adj_15, adj_16);\n        // adj: var_6 = wp.sin(var_5)                                                             <L 12>\n        wp::adj_abs(var_13, adj_13, adj_15);\n        // adj: var_5 = wp.abs(var_4)                                                             <L 11>\n        wp::adj_min(var_11, var_14, adj_11, adj_12, adj_13);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_12);\n        // adj: var_4 = wp.min(var_3, b[tid])                                                     <L 10>\n        wp::adj_cos(var_10, adj_10, adj_11);\n        // adj: var_3 = wp.cos(var_2)                                                             <L 9>\n        wp::adj_abs(var_8, adj_8, adj_10);\n        // adj: var_2 = wp.abs(var_1)                                                             <L 8>\n        wp::adj_add(var_6, var_9, adj_6, adj_7, adj_8);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_7);\n        // adj: var_1 = var_0 + b[tid]                                                            <L 7>\n        wp::adj_log(var_5, adj_5, adj_6);\n        wp::adj_add(var_2, var_4, adj_2, adj_4, adj_5);\n        wp::adj_abs(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = wp.log(wp.abs(a[tid]) + 1.0)                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_odshyf(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_odshyf","mangled_name":"arith_odshyf_8628ef92","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_odshyf(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = wp.log(wp.abs(a[tid]) + 1.0)\n    var_1 = var_0 + b[tid]\n    var_2 = wp.abs(var_1)\n    var_3 = wp.cos(var_2)\n    var_4 = wp.min(var_3, b[tid])\n    var_5 = wp.abs(var_4)\n    var_6 = wp.sin(var_5)\n    var_7 = wp.sin(var_6)\n    out[tid] = var_7\n"}
{"id":"mat_bkctnb_1d8c2febbd","device":"cuda","category":"matrix","description":"Matrix transpose (wp.mat22)","arg_types":{"m":"wp.array(dtype=wp.mat22)","out":"wp.array(dtype=wp.mat22)"},"metadata":{"mat_type":"wp.mat22","operation":"transpose","seed":49},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_bkctnb_3c928a61_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::mat_t<2, 2, wp::float32> var_2;\n        wp::mat_t<2, 2, wp::float32> var_3;\n        //---------\n        // forward\n        // def mat_bkctnb(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.transpose(m[tid])                                                        <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::transpose(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_bkctnb_3c928a61_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::mat_t<2, 2, wp::float32> var_2;\n        wp::mat_t<2, 2, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<2, 2, wp::float32> adj_1 = {};\n        wp::mat_t<2, 2, wp::float32> adj_2 = {};\n        wp::mat_t<2, 2, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def mat_bkctnb(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.transpose(m[tid])                                                        <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::transpose(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_transpose(var_3, adj_1, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = wp.transpose(m[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_bkctnb(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_bkctnb","mangled_name":"mat_bkctnb_3c928a61","device":"cuda","arg_names":["m","out"],"arg_types":{"m":"array<class 'warp._src.types.mat22f'>","out":"array<class 'warp._src.types.mat22f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_bkctnb(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):\n    tid = wp.tid()\n    out[tid] = wp.transpose(m[tid])\n"}
{"id":"math_mgqgmz_e4fb368c76","device":"cuda","category":"math","description":"Math chain: cos, sqrt","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["cos","sqrt"],"seed":50},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_mgqgmz_c29a6353_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        //---------\n        // forward\n        // def math_mgqgmz(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.sqrt(wp.abs(wp.cos(a[tid])))                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::sqrt(var_4);\n        wp::array_store(var_out, var_0, var_5);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_mgqgmz_c29a6353_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        //---------\n        // forward\n        // def math_mgqgmz(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.sqrt(wp.abs(wp.cos(a[tid])))                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::sqrt(var_4);\n        // wp::array_store(var_out, var_0, var_5);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n        wp::adj_sqrt(var_4, var_5, adj_4, adj_5);\n        wp::adj_abs(var_2, adj_2, adj_4);\n        wp::adj_cos(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.sqrt(wp.abs(wp.cos(a[tid])))                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_mgqgmz(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_mgqgmz","mangled_name":"math_mgqgmz_c29a6353","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_mgqgmz(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.sqrt(wp.abs(wp.cos(a[tid])))\n"}
{"id":"ctrl_gnevgo_dea05ad72f","device":"cuda","category":"control_flow","description":"Loop sum (12 iterations)","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"pattern":"loop_sum","seed":51},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_gnevgo_78663fd3_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        const wp::int32 var_47 = 11;\n        wp::float32* var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        //---------\n        // forward\n        // def ctrl_gnevgo(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(12):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        var_48 = wp::address(var_a, var_0);\n        var_50 = wp::load(var_48);\n        var_49 = wp::add(var_45, var_50);\n        // out[tid] = total                                                                       <L 9>\n        wp::array_store(var_out, var_0, var_49);\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_gnevgo_78663fd3_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        const wp::int32 var_47 = 11;\n        wp::float32* var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::int32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::int32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::int32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::int32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::int32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        //---------\n        // forward\n        // def ctrl_gnevgo(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(12):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        var_48 = wp::address(var_a, var_0);\n        var_50 = wp::load(var_48);\n        var_49 = wp::add(var_45, var_50);\n        // out[tid] = total                                                                       <L 9>\n        // wp::array_store(var_out, var_0, var_49);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_49, adj_out, adj_0, adj_49);\n        // adj: out[tid] = total                                                                  <L 9>\n        wp::adj_add(var_45, var_50, adj_45, adj_48, adj_49);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_48);\n        wp::adj_add(var_41, var_46, adj_41, adj_44, adj_45);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_44);\n        wp::adj_add(var_37, var_42, adj_37, adj_40, adj_41);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_40);\n        wp::adj_add(var_33, var_38, adj_33, adj_36, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        wp::adj_add(var_29, var_34, adj_29, adj_32, adj_33);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_32);\n        wp::adj_add(var_25, var_30, adj_25, adj_28, adj_29);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_28);\n        wp::adj_add(var_21, var_26, adj_21, adj_24, adj_25);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_24);\n        wp::adj_add(var_17, var_22, adj_17, adj_20, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        wp::adj_add(var_13, var_18, adj_13, adj_16, adj_17);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_16);\n        wp::adj_add(var_9, var_14, adj_9, adj_12, adj_13);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_12);\n        wp::adj_add(var_5, var_10, adj_5, adj_8, adj_9);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_8);\n        wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: total = total + a[tid]                                                            <L 8>\n        // adj: for i in range(12):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_gnevgo(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_gnevgo","mangled_name":"ctrl_gnevgo_78663fd3","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_gnevgo(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(12):\n        total = total + a[tid]\n    out[tid] = total\n"}
{"id":"math_zbsmyk_7b4da8c6c2","device":"cuda","category":"math","description":"Math chain: abs, sin, log","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["abs","sin","log"],"seed":52},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_zbsmyk_e9f7c837_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        const wp::float32 var_6 = 1.0;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // forward\n        // def math_zbsmyk(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.log(wp.abs(wp.sin(wp.abs(a[tid]))) + 1.0)                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::abs(var_3);\n        var_4 = wp::sin(var_2);\n        var_5 = wp::abs(var_4);\n        var_7 = wp::add(var_5, var_6);\n        var_8 = wp::log(var_7);\n        wp::array_store(var_out, var_0, var_8);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_zbsmyk_e9f7c837_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        const wp::float32 var_6 = 1.0;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        //---------\n        // forward\n        // def math_zbsmyk(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.log(wp.abs(wp.sin(wp.abs(a[tid]))) + 1.0)                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::abs(var_3);\n        var_4 = wp::sin(var_2);\n        var_5 = wp::abs(var_4);\n        var_7 = wp::add(var_5, var_6);\n        var_8 = wp::log(var_7);\n        // wp::array_store(var_out, var_0, var_8);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n        wp::adj_log(var_7, adj_7, adj_8);\n        wp::adj_add(var_5, var_6, adj_5, adj_6, adj_7);\n        wp::adj_abs(var_4, adj_4, adj_5);\n        wp::adj_sin(var_2, adj_2, adj_4);\n        wp::adj_abs(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.log(wp.abs(wp.sin(wp.abs(a[tid]))) + 1.0)                           <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_zbsmyk(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_zbsmyk","mangled_name":"math_zbsmyk_e9f7c837","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_zbsmyk(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.log(wp.abs(wp.sin(wp.abs(a[tid]))) + 1.0)\n"}
{"id":"atom_qxlsyn_878291b474","device":"cuda","category":"atomic","description":"Atomic max reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"max","seed":53},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_qxlsyn_05920868_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_qxlsyn(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_max(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_qxlsyn_05920868_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_qxlsyn(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_max(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_max(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_max(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_qxlsyn(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_qxlsyn","mangled_name":"atom_qxlsyn_05920868","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_qxlsyn(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_max(result, 0, values[tid])\n"}
{"id":"multicond_xdomyj_754d25a163","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: -0.53, 2.57)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":-0.53,"threshold2":2.57,"seed":54},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_xdomyj_0163bca0_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.53;\n        const wp::float32 var_5 = -0.53;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 2.57;\n        bool var_10;\n        const wp::float32 var_11 = 1.0;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 2.0;\n        wp::float32 var_14;\n        //---------\n        // forward\n        // def multicond_xdomyj(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -0.53:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < 2.57:                                                                   <L 9>\n            var_10 = (var_2 < var_9);\n            if (var_10) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_12 = wp::mul(var_2, var_11);\n                wp::array_store(var_out, var_0, var_12);\n            }\n            if (!var_10) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_14 = wp::mul(var_2, var_13);\n                wp::array_store(var_out, var_0, var_14);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_xdomyj_0163bca0_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.53;\n        const wp::float32 var_5 = -0.53;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 2.57;\n        bool var_10;\n        const wp::float32 var_11 = 1.0;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 2.0;\n        wp::float32 var_14;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        bool adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        bool adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        //---------\n        // forward\n        // def multicond_xdomyj(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -0.53:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            // wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < 2.57:                                                                   <L 9>\n            var_10 = (var_2 < var_9);\n            if (var_10) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_12 = wp::mul(var_2, var_11);\n                // wp::array_store(var_out, var_0, var_12);\n            }\n            if (!var_10) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_14 = wp::mul(var_2, var_13);\n                // wp::array_store(var_out, var_0, var_14);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_6) {\n            if (!var_10) {\n                wp::adj_array_store(var_out, var_0, var_14, adj_out, adj_0, adj_14);\n                wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_10) {\n                wp::adj_array_store(var_out, var_0, var_12, adj_out, adj_0, adj_12);\n                wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 2.57:                                                              <L 9>\n        }\n        if (var_6) {\n            wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n            wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < -0.53:                                                                   <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_xdomyj(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_xdomyj","mangled_name":"multicond_xdomyj_0163bca0","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_xdomyj(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < -0.53:\n        out[tid] = val * 0.5\n    elif val < 2.57:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"nested_cydtvt_c1eab9b954","device":"cuda","category":"nested_loop","description":"Nested loops (5x3)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":5,"inner_iterations":3,"seed":55},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_cydtvt_d62095f4_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        //---------\n        // forward\n        // def nested_cydtvt(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_142);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_cydtvt_d62095f4_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::int32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::int32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::int32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::int32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::int32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::int32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::int32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::int32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::int32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::float32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::int32 adj_91 = {};\n        wp::int32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::int32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::int32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::int32 adj_119 = {};\n        wp::int32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::int32 adj_128 = {};\n        wp::int32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::int32 adj_137 = {};\n        wp::int32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        //---------\n        // forward\n        // def nested_cydtvt(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_142);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_142, adj_out, adj_0, adj_142);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_133, var_140, adj_133, adj_140, adj_142);\n        wp::adj_mul(var_141, var_139, adj_135, adj_139, adj_140);\n        wp::adj_float(var_138, adj_138, adj_139);\n        wp::adj_add(var_136, var_137, adj_136, adj_137, adj_138);\n        wp::adj_mul(var_115, var_134, adj_115, adj_134, adj_136);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_135);\n        wp::adj_add(var_124, var_131, adj_124, adj_131, adj_133);\n        wp::adj_mul(var_132, var_130, adj_126, adj_130, adj_131);\n        wp::adj_float(var_129, adj_129, adj_130);\n        wp::adj_add(var_127, var_128, adj_127, adj_128, adj_129);\n        wp::adj_mul(var_115, var_125, adj_115, adj_125, adj_127);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_126);\n        wp::adj_add(var_114, var_122, adj_114, adj_122, adj_124);\n        wp::adj_mul(var_123, var_121, adj_117, adj_121, adj_122);\n        wp::adj_float(var_120, adj_120, adj_121);\n        wp::adj_add(var_118, var_119, adj_118, adj_119, adj_120);\n        wp::adj_mul(var_115, var_116, adj_115, adj_116, adj_118);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_117);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_105, var_112, adj_105, adj_112, adj_114);\n        wp::adj_mul(var_113, var_111, adj_107, adj_111, adj_112);\n        wp::adj_float(var_110, adj_110, adj_111);\n        wp::adj_add(var_108, var_109, adj_108, adj_109, adj_110);\n        wp::adj_mul(var_87, var_106, adj_87, adj_106, adj_108);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_107);\n        wp::adj_add(var_96, var_103, adj_96, adj_103, adj_105);\n        wp::adj_mul(var_104, var_102, adj_98, adj_102, adj_103);\n        wp::adj_float(var_101, adj_101, adj_102);\n        wp::adj_add(var_99, var_100, adj_99, adj_100, adj_101);\n        wp::adj_mul(var_87, var_97, adj_87, adj_97, adj_99);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_98);\n        wp::adj_add(var_86, var_94, adj_86, adj_94, adj_96);\n        wp::adj_mul(var_95, var_93, adj_89, adj_93, adj_94);\n        wp::adj_float(var_92, adj_92, adj_93);\n        wp::adj_add(var_90, var_91, adj_90, adj_91, adj_92);\n        wp::adj_mul(var_87, var_88, adj_87, adj_88, adj_90);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_89);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_77, var_84, adj_77, adj_84, adj_86);\n        wp::adj_mul(var_85, var_83, adj_79, adj_83, adj_84);\n        wp::adj_float(var_82, adj_82, adj_83);\n        wp::adj_add(var_80, var_81, adj_80, adj_81, adj_82);\n        wp::adj_mul(var_59, var_78, adj_59, adj_78, adj_80);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_79);\n        wp::adj_add(var_68, var_75, adj_68, adj_75, adj_77);\n        wp::adj_mul(var_76, var_74, adj_70, adj_74, adj_75);\n        wp::adj_float(var_73, adj_73, adj_74);\n        wp::adj_add(var_71, var_72, adj_71, adj_72, adj_73);\n        wp::adj_mul(var_59, var_69, adj_59, adj_69, adj_71);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_70);\n        wp::adj_add(var_58, var_66, adj_58, adj_66, adj_68);\n        wp::adj_mul(var_67, var_65, adj_61, adj_65, adj_66);\n        wp::adj_float(var_64, adj_64, adj_65);\n        wp::adj_add(var_62, var_63, adj_62, adj_63, adj_64);\n        wp::adj_mul(var_59, var_60, adj_59, adj_60, adj_62);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_61);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_49, var_56, adj_49, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_31, var_50, adj_31, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        wp::adj_add(var_40, var_47, adj_40, adj_47, adj_49);\n        wp::adj_mul(var_48, var_46, adj_42, adj_46, adj_47);\n        wp::adj_float(var_45, adj_45, adj_46);\n        wp::adj_add(var_43, var_44, adj_43, adj_44, adj_45);\n        wp::adj_mul(var_31, var_41, adj_31, adj_41, adj_43);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_42);\n        wp::adj_add(var_30, var_38, adj_30, adj_38, adj_40);\n        wp::adj_mul(var_39, var_37, adj_33, adj_37, adj_38);\n        wp::adj_float(var_36, adj_36, adj_37);\n        wp::adj_add(var_34, var_35, adj_34, adj_35, adj_36);\n        wp::adj_mul(var_31, var_32, adj_31, adj_32, adj_34);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_33);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        // adj: for i in range(5):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_cydtvt(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_cydtvt","mangled_name":"nested_cydtvt_d62095f4","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_cydtvt(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(5):\n        for j in range(3):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"atom_zomntz_ed55110848","device":"cuda","category":"atomic","description":"Atomic min reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"min","seed":56},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_zomntz_ca2361f9_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_zomntz(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_min(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_zomntz_ca2361f9_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_zomntz(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_min(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_min(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_min(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_zomntz(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_zomntz","mangled_name":"atom_zomntz_ca2361f9","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_zomntz(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_min(result, 0, values[tid])\n"}
{"id":"ctrl_bpanzh_e03510cb49","device":"cuda","category":"control_flow","description":"Loop sum (14 iterations)","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"pattern":"loop_sum","seed":57},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_bpanzh_211fc00b_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        const wp::int32 var_47 = 11;\n        wp::float32* var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 12;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        const wp::int32 var_55 = 13;\n        wp::float32* var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        //---------\n        // forward\n        // def ctrl_bpanzh(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(14):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        var_48 = wp::address(var_a, var_0);\n        var_50 = wp::load(var_48);\n        var_49 = wp::add(var_45, var_50);\n        var_52 = wp::address(var_a, var_0);\n        var_54 = wp::load(var_52);\n        var_53 = wp::add(var_49, var_54);\n        var_56 = wp::address(var_a, var_0);\n        var_58 = wp::load(var_56);\n        var_57 = wp::add(var_53, var_58);\n        // out[tid] = total                                                                       <L 9>\n        wp::array_store(var_out, var_0, var_57);\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_bpanzh_211fc00b_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        const wp::int32 var_47 = 11;\n        wp::float32* var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 12;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        const wp::int32 var_55 = 13;\n        wp::float32* var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::int32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::int32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::int32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::int32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::int32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::int32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        //---------\n        // forward\n        // def ctrl_bpanzh(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(14):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        var_48 = wp::address(var_a, var_0);\n        var_50 = wp::load(var_48);\n        var_49 = wp::add(var_45, var_50);\n        var_52 = wp::address(var_a, var_0);\n        var_54 = wp::load(var_52);\n        var_53 = wp::add(var_49, var_54);\n        var_56 = wp::address(var_a, var_0);\n        var_58 = wp::load(var_56);\n        var_57 = wp::add(var_53, var_58);\n        // out[tid] = total                                                                       <L 9>\n        // wp::array_store(var_out, var_0, var_57);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_57, adj_out, adj_0, adj_57);\n        // adj: out[tid] = total                                                                  <L 9>\n        wp::adj_add(var_53, var_58, adj_53, adj_56, adj_57);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_56);\n        wp::adj_add(var_49, var_54, adj_49, adj_52, adj_53);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        wp::adj_add(var_45, var_50, adj_45, adj_48, adj_49);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_48);\n        wp::adj_add(var_41, var_46, adj_41, adj_44, adj_45);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_44);\n        wp::adj_add(var_37, var_42, adj_37, adj_40, adj_41);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_40);\n        wp::adj_add(var_33, var_38, adj_33, adj_36, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        wp::adj_add(var_29, var_34, adj_29, adj_32, adj_33);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_32);\n        wp::adj_add(var_25, var_30, adj_25, adj_28, adj_29);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_28);\n        wp::adj_add(var_21, var_26, adj_21, adj_24, adj_25);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_24);\n        wp::adj_add(var_17, var_22, adj_17, adj_20, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        wp::adj_add(var_13, var_18, adj_13, adj_16, adj_17);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_16);\n        wp::adj_add(var_9, var_14, adj_9, adj_12, adj_13);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_12);\n        wp::adj_add(var_5, var_10, adj_5, adj_8, adj_9);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_8);\n        wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: total = total + a[tid]                                                            <L 8>\n        // adj: for i in range(14):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_bpanzh(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_bpanzh","mangled_name":"ctrl_bpanzh_211fc00b","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_bpanzh(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(14):\n        total = total + a[tid]\n    out[tid] = total\n"}
{"id":"nested_pfqybl_926462664d","device":"cuda","category":"nested_loop","description":"Nested loops (5x5)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":5,"inner_iterations":5,"seed":58},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_pfqybl_d34190e3_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 1;\n        const wp::int32 var_50 = 0;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 1;\n        wp::float32* var_60;\n        wp::int32 var_61;\n        const wp::int32 var_62 = 1;\n        wp::int32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        const wp::int32 var_68 = 2;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 3;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 4;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        const wp::int32 var_96 = 0;\n        wp::float32* var_97;\n        wp::int32 var_98;\n        const wp::int32 var_99 = 1;\n        wp::int32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 1;\n        wp::float32* var_106;\n        wp::int32 var_107;\n        const wp::int32 var_108 = 1;\n        wp::int32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        const wp::int32 var_114 = 2;\n        wp::float32* var_115;\n        wp::int32 var_116;\n        const wp::int32 var_117 = 1;\n        wp::int32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        const wp::int32 var_123 = 3;\n        wp::float32* var_124;\n        wp::int32 var_125;\n        const wp::int32 var_126 = 1;\n        wp::int32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        const wp::int32 var_132 = 4;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        const wp::int32 var_141 = 3;\n        const wp::int32 var_142 = 0;\n        wp::float32* var_143;\n        wp::int32 var_144;\n        const wp::int32 var_145 = 1;\n        wp::int32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        const wp::int32 var_151 = 1;\n        wp::float32* var_152;\n        wp::int32 var_153;\n        const wp::int32 var_154 = 1;\n        wp::int32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        const wp::int32 var_160 = 2;\n        wp::float32* var_161;\n        wp::int32 var_162;\n        const wp::int32 var_163 = 1;\n        wp::int32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        const wp::int32 var_169 = 3;\n        wp::float32* var_170;\n        wp::int32 var_171;\n        const wp::int32 var_172 = 1;\n        wp::int32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        wp::float32 var_177;\n        const wp::int32 var_178 = 4;\n        wp::float32* var_179;\n        wp::int32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::int32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        wp::float32 var_186;\n        const wp::int32 var_187 = 4;\n        const wp::int32 var_188 = 0;\n        wp::float32* var_189;\n        wp::int32 var_190;\n        const wp::int32 var_191 = 1;\n        wp::int32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        const wp::int32 var_197 = 1;\n        wp::float32* var_198;\n        wp::int32 var_199;\n        const wp::int32 var_200 = 1;\n        wp::int32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        wp::float32 var_204;\n        wp::float32 var_205;\n        const wp::int32 var_206 = 2;\n        wp::float32* var_207;\n        wp::int32 var_208;\n        const wp::int32 var_209 = 1;\n        wp::int32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        wp::float32 var_213;\n        wp::float32 var_214;\n        const wp::int32 var_215 = 3;\n        wp::float32* var_216;\n        wp::int32 var_217;\n        const wp::int32 var_218 = 1;\n        wp::int32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        wp::float32 var_222;\n        wp::float32 var_223;\n        const wp::int32 var_224 = 4;\n        wp::float32* var_225;\n        wp::int32 var_226;\n        const wp::int32 var_227 = 1;\n        wp::int32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        wp::float32 var_232;\n        //---------\n        // forward\n        // def nested_pfqybl(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_49, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_48, var_56);\n        var_60 = wp::address(var_data, var_0);\n        var_61 = wp::mul(var_49, var_59);\n        var_63 = wp::add(var_61, var_62);\n        var_64 = wp::float(var_63);\n        var_66 = wp::load(var_60);\n        var_65 = wp::mul(var_66, var_64);\n        var_67 = wp::add(var_58, var_65);\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_49, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_67, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_49, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_49, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_97 = wp::address(var_data, var_0);\n        var_98 = wp::mul(var_95, var_96);\n        var_100 = wp::add(var_98, var_99);\n        var_101 = wp::float(var_100);\n        var_103 = wp::load(var_97);\n        var_102 = wp::mul(var_103, var_101);\n        var_104 = wp::add(var_94, var_102);\n        var_106 = wp::address(var_data, var_0);\n        var_107 = wp::mul(var_95, var_105);\n        var_109 = wp::add(var_107, var_108);\n        var_110 = wp::float(var_109);\n        var_112 = wp::load(var_106);\n        var_111 = wp::mul(var_112, var_110);\n        var_113 = wp::add(var_104, var_111);\n        var_115 = wp::address(var_data, var_0);\n        var_116 = wp::mul(var_95, var_114);\n        var_118 = wp::add(var_116, var_117);\n        var_119 = wp::float(var_118);\n        var_121 = wp::load(var_115);\n        var_120 = wp::mul(var_121, var_119);\n        var_122 = wp::add(var_113, var_120);\n        var_124 = wp::address(var_data, var_0);\n        var_125 = wp::mul(var_95, var_123);\n        var_127 = wp::add(var_125, var_126);\n        var_128 = wp::float(var_127);\n        var_130 = wp::load(var_124);\n        var_129 = wp::mul(var_130, var_128);\n        var_131 = wp::add(var_122, var_129);\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_95, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_131, var_138);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_143 = wp::address(var_data, var_0);\n        var_144 = wp::mul(var_141, var_142);\n        var_146 = wp::add(var_144, var_145);\n        var_147 = wp::float(var_146);\n        var_149 = wp::load(var_143);\n        var_148 = wp::mul(var_149, var_147);\n        var_150 = wp::add(var_140, var_148);\n        var_152 = wp::address(var_data, var_0);\n        var_153 = wp::mul(var_141, var_151);\n        var_155 = wp::add(var_153, var_154);\n        var_156 = wp::float(var_155);\n        var_158 = wp::load(var_152);\n        var_157 = wp::mul(var_158, var_156);\n        var_159 = wp::add(var_150, var_157);\n        var_161 = wp::address(var_data, var_0);\n        var_162 = wp::mul(var_141, var_160);\n        var_164 = wp::add(var_162, var_163);\n        var_165 = wp::float(var_164);\n        var_167 = wp::load(var_161);\n        var_166 = wp::mul(var_167, var_165);\n        var_168 = wp::add(var_159, var_166);\n        var_170 = wp::address(var_data, var_0);\n        var_171 = wp::mul(var_141, var_169);\n        var_173 = wp::add(var_171, var_172);\n        var_174 = wp::float(var_173);\n        var_176 = wp::load(var_170);\n        var_175 = wp::mul(var_176, var_174);\n        var_177 = wp::add(var_168, var_175);\n        var_179 = wp::address(var_data, var_0);\n        var_180 = wp::mul(var_141, var_178);\n        var_182 = wp::add(var_180, var_181);\n        var_183 = wp::float(var_182);\n        var_185 = wp::load(var_179);\n        var_184 = wp::mul(var_185, var_183);\n        var_186 = wp::add(var_177, var_184);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_189 = wp::address(var_data, var_0);\n        var_190 = wp::mul(var_187, var_188);\n        var_192 = wp::add(var_190, var_191);\n        var_193 = wp::float(var_192);\n        var_195 = wp::load(var_189);\n        var_194 = wp::mul(var_195, var_193);\n        var_196 = wp::add(var_186, var_194);\n        var_198 = wp::address(var_data, var_0);\n        var_199 = wp::mul(var_187, var_197);\n        var_201 = wp::add(var_199, var_200);\n        var_202 = wp::float(var_201);\n        var_204 = wp::load(var_198);\n        var_203 = wp::mul(var_204, var_202);\n        var_205 = wp::add(var_196, var_203);\n        var_207 = wp::address(var_data, var_0);\n        var_208 = wp::mul(var_187, var_206);\n        var_210 = wp::add(var_208, var_209);\n        var_211 = wp::float(var_210);\n        var_213 = wp::load(var_207);\n        var_212 = wp::mul(var_213, var_211);\n        var_214 = wp::add(var_205, var_212);\n        var_216 = wp::address(var_data, var_0);\n        var_217 = wp::mul(var_187, var_215);\n        var_219 = wp::add(var_217, var_218);\n        var_220 = wp::float(var_219);\n        var_222 = wp::load(var_216);\n        var_221 = wp::mul(var_222, var_220);\n        var_223 = wp::add(var_214, var_221);\n        var_225 = wp::address(var_data, var_0);\n        var_226 = wp::mul(var_187, var_224);\n        var_228 = wp::add(var_226, var_227);\n        var_229 = wp::float(var_228);\n        var_231 = wp::load(var_225);\n        var_230 = wp::mul(var_231, var_229);\n        var_232 = wp::add(var_223, var_230);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_232);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_pfqybl_d34190e3_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 1;\n        const wp::int32 var_50 = 0;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 1;\n        wp::float32* var_60;\n        wp::int32 var_61;\n        const wp::int32 var_62 = 1;\n        wp::int32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        const wp::int32 var_68 = 2;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 3;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 4;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        const wp::int32 var_96 = 0;\n        wp::float32* var_97;\n        wp::int32 var_98;\n        const wp::int32 var_99 = 1;\n        wp::int32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 1;\n        wp::float32* var_106;\n        wp::int32 var_107;\n        const wp::int32 var_108 = 1;\n        wp::int32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        const wp::int32 var_114 = 2;\n        wp::float32* var_115;\n        wp::int32 var_116;\n        const wp::int32 var_117 = 1;\n        wp::int32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        const wp::int32 var_123 = 3;\n        wp::float32* var_124;\n        wp::int32 var_125;\n        const wp::int32 var_126 = 1;\n        wp::int32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        const wp::int32 var_132 = 4;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        const wp::int32 var_141 = 3;\n        const wp::int32 var_142 = 0;\n        wp::float32* var_143;\n        wp::int32 var_144;\n        const wp::int32 var_145 = 1;\n        wp::int32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        const wp::int32 var_151 = 1;\n        wp::float32* var_152;\n        wp::int32 var_153;\n        const wp::int32 var_154 = 1;\n        wp::int32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        const wp::int32 var_160 = 2;\n        wp::float32* var_161;\n        wp::int32 var_162;\n        const wp::int32 var_163 = 1;\n        wp::int32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        const wp::int32 var_169 = 3;\n        wp::float32* var_170;\n        wp::int32 var_171;\n        const wp::int32 var_172 = 1;\n        wp::int32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        wp::float32 var_177;\n        const wp::int32 var_178 = 4;\n        wp::float32* var_179;\n        wp::int32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::int32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        wp::float32 var_186;\n        const wp::int32 var_187 = 4;\n        const wp::int32 var_188 = 0;\n        wp::float32* var_189;\n        wp::int32 var_190;\n        const wp::int32 var_191 = 1;\n        wp::int32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        const wp::int32 var_197 = 1;\n        wp::float32* var_198;\n        wp::int32 var_199;\n        const wp::int32 var_200 = 1;\n        wp::int32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        wp::float32 var_204;\n        wp::float32 var_205;\n        const wp::int32 var_206 = 2;\n        wp::float32* var_207;\n        wp::int32 var_208;\n        const wp::int32 var_209 = 1;\n        wp::int32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        wp::float32 var_213;\n        wp::float32 var_214;\n        const wp::int32 var_215 = 3;\n        wp::float32* var_216;\n        wp::int32 var_217;\n        const wp::int32 var_218 = 1;\n        wp::int32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        wp::float32 var_222;\n        wp::float32 var_223;\n        const wp::int32 var_224 = 4;\n        wp::float32* var_225;\n        wp::int32 var_226;\n        const wp::int32 var_227 = 1;\n        wp::int32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        wp::float32 var_232;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::int32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::int32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::int32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::int32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::int32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::int32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::int32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::int32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::int32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::int32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::int32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::int32 adj_95 = {};\n        wp::int32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::int32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::int32 adj_105 = {};\n        wp::float32 adj_106 = {};\n        wp::int32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::int32 adj_114 = {};\n        wp::float32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::int32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::int32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::int32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::int32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::int32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::float32 adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::int32 adj_141 = {};\n        wp::int32 adj_142 = {};\n        wp::float32 adj_143 = {};\n        wp::int32 adj_144 = {};\n        wp::int32 adj_145 = {};\n        wp::int32 adj_146 = {};\n        wp::float32 adj_147 = {};\n        wp::float32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::float32 adj_150 = {};\n        wp::int32 adj_151 = {};\n        wp::float32 adj_152 = {};\n        wp::int32 adj_153 = {};\n        wp::int32 adj_154 = {};\n        wp::int32 adj_155 = {};\n        wp::float32 adj_156 = {};\n        wp::float32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::float32 adj_159 = {};\n        wp::int32 adj_160 = {};\n        wp::float32 adj_161 = {};\n        wp::int32 adj_162 = {};\n        wp::int32 adj_163 = {};\n        wp::int32 adj_164 = {};\n        wp::float32 adj_165 = {};\n        wp::float32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::float32 adj_168 = {};\n        wp::int32 adj_169 = {};\n        wp::float32 adj_170 = {};\n        wp::int32 adj_171 = {};\n        wp::int32 adj_172 = {};\n        wp::int32 adj_173 = {};\n        wp::float32 adj_174 = {};\n        wp::float32 adj_175 = {};\n        wp::float32 adj_176 = {};\n        wp::float32 adj_177 = {};\n        wp::int32 adj_178 = {};\n        wp::float32 adj_179 = {};\n        wp::int32 adj_180 = {};\n        wp::int32 adj_181 = {};\n        wp::int32 adj_182 = {};\n        wp::float32 adj_183 = {};\n        wp::float32 adj_184 = {};\n        wp::float32 adj_185 = {};\n        wp::float32 adj_186 = {};\n        wp::int32 adj_187 = {};\n        wp::int32 adj_188 = {};\n        wp::float32 adj_189 = {};\n        wp::int32 adj_190 = {};\n        wp::int32 adj_191 = {};\n        wp::int32 adj_192 = {};\n        wp::float32 adj_193 = {};\n        wp::float32 adj_194 = {};\n        wp::float32 adj_195 = {};\n        wp::float32 adj_196 = {};\n        wp::int32 adj_197 = {};\n        wp::float32 adj_198 = {};\n        wp::int32 adj_199 = {};\n        wp::int32 adj_200 = {};\n        wp::int32 adj_201 = {};\n        wp::float32 adj_202 = {};\n        wp::float32 adj_203 = {};\n        wp::float32 adj_204 = {};\n        wp::float32 adj_205 = {};\n        wp::int32 adj_206 = {};\n        wp::float32 adj_207 = {};\n        wp::int32 adj_208 = {};\n        wp::int32 adj_209 = {};\n        wp::int32 adj_210 = {};\n        wp::float32 adj_211 = {};\n        wp::float32 adj_212 = {};\n        wp::float32 adj_213 = {};\n        wp::float32 adj_214 = {};\n        wp::int32 adj_215 = {};\n        wp::float32 adj_216 = {};\n        wp::int32 adj_217 = {};\n        wp::int32 adj_218 = {};\n        wp::int32 adj_219 = {};\n        wp::float32 adj_220 = {};\n        wp::float32 adj_221 = {};\n        wp::float32 adj_222 = {};\n        wp::float32 adj_223 = {};\n        wp::int32 adj_224 = {};\n        wp::float32 adj_225 = {};\n        wp::int32 adj_226 = {};\n        wp::int32 adj_227 = {};\n        wp::int32 adj_228 = {};\n        wp::float32 adj_229 = {};\n        wp::float32 adj_230 = {};\n        wp::float32 adj_231 = {};\n        wp::float32 adj_232 = {};\n        //---------\n        // forward\n        // def nested_pfqybl(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_49, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_48, var_56);\n        var_60 = wp::address(var_data, var_0);\n        var_61 = wp::mul(var_49, var_59);\n        var_63 = wp::add(var_61, var_62);\n        var_64 = wp::float(var_63);\n        var_66 = wp::load(var_60);\n        var_65 = wp::mul(var_66, var_64);\n        var_67 = wp::add(var_58, var_65);\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_49, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_67, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_49, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_49, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_97 = wp::address(var_data, var_0);\n        var_98 = wp::mul(var_95, var_96);\n        var_100 = wp::add(var_98, var_99);\n        var_101 = wp::float(var_100);\n        var_103 = wp::load(var_97);\n        var_102 = wp::mul(var_103, var_101);\n        var_104 = wp::add(var_94, var_102);\n        var_106 = wp::address(var_data, var_0);\n        var_107 = wp::mul(var_95, var_105);\n        var_109 = wp::add(var_107, var_108);\n        var_110 = wp::float(var_109);\n        var_112 = wp::load(var_106);\n        var_111 = wp::mul(var_112, var_110);\n        var_113 = wp::add(var_104, var_111);\n        var_115 = wp::address(var_data, var_0);\n        var_116 = wp::mul(var_95, var_114);\n        var_118 = wp::add(var_116, var_117);\n        var_119 = wp::float(var_118);\n        var_121 = wp::load(var_115);\n        var_120 = wp::mul(var_121, var_119);\n        var_122 = wp::add(var_113, var_120);\n        var_124 = wp::address(var_data, var_0);\n        var_125 = wp::mul(var_95, var_123);\n        var_127 = wp::add(var_125, var_126);\n        var_128 = wp::float(var_127);\n        var_130 = wp::load(var_124);\n        var_129 = wp::mul(var_130, var_128);\n        var_131 = wp::add(var_122, var_129);\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_95, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_131, var_138);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_143 = wp::address(var_data, var_0);\n        var_144 = wp::mul(var_141, var_142);\n        var_146 = wp::add(var_144, var_145);\n        var_147 = wp::float(var_146);\n        var_149 = wp::load(var_143);\n        var_148 = wp::mul(var_149, var_147);\n        var_150 = wp::add(var_140, var_148);\n        var_152 = wp::address(var_data, var_0);\n        var_153 = wp::mul(var_141, var_151);\n        var_155 = wp::add(var_153, var_154);\n        var_156 = wp::float(var_155);\n        var_158 = wp::load(var_152);\n        var_157 = wp::mul(var_158, var_156);\n        var_159 = wp::add(var_150, var_157);\n        var_161 = wp::address(var_data, var_0);\n        var_162 = wp::mul(var_141, var_160);\n        var_164 = wp::add(var_162, var_163);\n        var_165 = wp::float(var_164);\n        var_167 = wp::load(var_161);\n        var_166 = wp::mul(var_167, var_165);\n        var_168 = wp::add(var_159, var_166);\n        var_170 = wp::address(var_data, var_0);\n        var_171 = wp::mul(var_141, var_169);\n        var_173 = wp::add(var_171, var_172);\n        var_174 = wp::float(var_173);\n        var_176 = wp::load(var_170);\n        var_175 = wp::mul(var_176, var_174);\n        var_177 = wp::add(var_168, var_175);\n        var_179 = wp::address(var_data, var_0);\n        var_180 = wp::mul(var_141, var_178);\n        var_182 = wp::add(var_180, var_181);\n        var_183 = wp::float(var_182);\n        var_185 = wp::load(var_179);\n        var_184 = wp::mul(var_185, var_183);\n        var_186 = wp::add(var_177, var_184);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_189 = wp::address(var_data, var_0);\n        var_190 = wp::mul(var_187, var_188);\n        var_192 = wp::add(var_190, var_191);\n        var_193 = wp::float(var_192);\n        var_195 = wp::load(var_189);\n        var_194 = wp::mul(var_195, var_193);\n        var_196 = wp::add(var_186, var_194);\n        var_198 = wp::address(var_data, var_0);\n        var_199 = wp::mul(var_187, var_197);\n        var_201 = wp::add(var_199, var_200);\n        var_202 = wp::float(var_201);\n        var_204 = wp::load(var_198);\n        var_203 = wp::mul(var_204, var_202);\n        var_205 = wp::add(var_196, var_203);\n        var_207 = wp::address(var_data, var_0);\n        var_208 = wp::mul(var_187, var_206);\n        var_210 = wp::add(var_208, var_209);\n        var_211 = wp::float(var_210);\n        var_213 = wp::load(var_207);\n        var_212 = wp::mul(var_213, var_211);\n        var_214 = wp::add(var_205, var_212);\n        var_216 = wp::address(var_data, var_0);\n        var_217 = wp::mul(var_187, var_215);\n        var_219 = wp::add(var_217, var_218);\n        var_220 = wp::float(var_219);\n        var_222 = wp::load(var_216);\n        var_221 = wp::mul(var_222, var_220);\n        var_223 = wp::add(var_214, var_221);\n        var_225 = wp::address(var_data, var_0);\n        var_226 = wp::mul(var_187, var_224);\n        var_228 = wp::add(var_226, var_227);\n        var_229 = wp::float(var_228);\n        var_231 = wp::load(var_225);\n        var_230 = wp::mul(var_231, var_229);\n        var_232 = wp::add(var_223, var_230);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_232);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_232, adj_out, adj_0, adj_232);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_223, var_230, adj_223, adj_230, adj_232);\n        wp::adj_mul(var_231, var_229, adj_225, adj_229, adj_230);\n        wp::adj_float(var_228, adj_228, adj_229);\n        wp::adj_add(var_226, var_227, adj_226, adj_227, adj_228);\n        wp::adj_mul(var_187, var_224, adj_187, adj_224, adj_226);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_225);\n        wp::adj_add(var_214, var_221, adj_214, adj_221, adj_223);\n        wp::adj_mul(var_222, var_220, adj_216, adj_220, adj_221);\n        wp::adj_float(var_219, adj_219, adj_220);\n        wp::adj_add(var_217, var_218, adj_217, adj_218, adj_219);\n        wp::adj_mul(var_187, var_215, adj_187, adj_215, adj_217);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_216);\n        wp::adj_add(var_205, var_212, adj_205, adj_212, adj_214);\n        wp::adj_mul(var_213, var_211, adj_207, adj_211, adj_212);\n        wp::adj_float(var_210, adj_210, adj_211);\n        wp::adj_add(var_208, var_209, adj_208, adj_209, adj_210);\n        wp::adj_mul(var_187, var_206, adj_187, adj_206, adj_208);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_207);\n        wp::adj_add(var_196, var_203, adj_196, adj_203, adj_205);\n        wp::adj_mul(var_204, var_202, adj_198, adj_202, adj_203);\n        wp::adj_float(var_201, adj_201, adj_202);\n        wp::adj_add(var_199, var_200, adj_199, adj_200, adj_201);\n        wp::adj_mul(var_187, var_197, adj_187, adj_197, adj_199);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_198);\n        wp::adj_add(var_186, var_194, adj_186, adj_194, adj_196);\n        wp::adj_mul(var_195, var_193, adj_189, adj_193, adj_194);\n        wp::adj_float(var_192, adj_192, adj_193);\n        wp::adj_add(var_190, var_191, adj_190, adj_191, adj_192);\n        wp::adj_mul(var_187, var_188, adj_187, adj_188, adj_190);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_189);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_177, var_184, adj_177, adj_184, adj_186);\n        wp::adj_mul(var_185, var_183, adj_179, adj_183, adj_184);\n        wp::adj_float(var_182, adj_182, adj_183);\n        wp::adj_add(var_180, var_181, adj_180, adj_181, adj_182);\n        wp::adj_mul(var_141, var_178, adj_141, adj_178, adj_180);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_179);\n        wp::adj_add(var_168, var_175, adj_168, adj_175, adj_177);\n        wp::adj_mul(var_176, var_174, adj_170, adj_174, adj_175);\n        wp::adj_float(var_173, adj_173, adj_174);\n        wp::adj_add(var_171, var_172, adj_171, adj_172, adj_173);\n        wp::adj_mul(var_141, var_169, adj_141, adj_169, adj_171);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_170);\n        wp::adj_add(var_159, var_166, adj_159, adj_166, adj_168);\n        wp::adj_mul(var_167, var_165, adj_161, adj_165, adj_166);\n        wp::adj_float(var_164, adj_164, adj_165);\n        wp::adj_add(var_162, var_163, adj_162, adj_163, adj_164);\n        wp::adj_mul(var_141, var_160, adj_141, adj_160, adj_162);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_161);\n        wp::adj_add(var_150, var_157, adj_150, adj_157, adj_159);\n        wp::adj_mul(var_158, var_156, adj_152, adj_156, adj_157);\n        wp::adj_float(var_155, adj_155, adj_156);\n        wp::adj_add(var_153, var_154, adj_153, adj_154, adj_155);\n        wp::adj_mul(var_141, var_151, adj_141, adj_151, adj_153);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_152);\n        wp::adj_add(var_140, var_148, adj_140, adj_148, adj_150);\n        wp::adj_mul(var_149, var_147, adj_143, adj_147, adj_148);\n        wp::adj_float(var_146, adj_146, adj_147);\n        wp::adj_add(var_144, var_145, adj_144, adj_145, adj_146);\n        wp::adj_mul(var_141, var_142, adj_141, adj_142, adj_144);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_143);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_131, var_138, adj_131, adj_138, adj_140);\n        wp::adj_mul(var_139, var_137, adj_133, adj_137, adj_138);\n        wp::adj_float(var_136, adj_136, adj_137);\n        wp::adj_add(var_134, var_135, adj_134, adj_135, adj_136);\n        wp::adj_mul(var_95, var_132, adj_95, adj_132, adj_134);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_133);\n        wp::adj_add(var_122, var_129, adj_122, adj_129, adj_131);\n        wp::adj_mul(var_130, var_128, adj_124, adj_128, adj_129);\n        wp::adj_float(var_127, adj_127, adj_128);\n        wp::adj_add(var_125, var_126, adj_125, adj_126, adj_127);\n        wp::adj_mul(var_95, var_123, adj_95, adj_123, adj_125);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_124);\n        wp::adj_add(var_113, var_120, adj_113, adj_120, adj_122);\n        wp::adj_mul(var_121, var_119, adj_115, adj_119, adj_120);\n        wp::adj_float(var_118, adj_118, adj_119);\n        wp::adj_add(var_116, var_117, adj_116, adj_117, adj_118);\n        wp::adj_mul(var_95, var_114, adj_95, adj_114, adj_116);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_115);\n        wp::adj_add(var_104, var_111, adj_104, adj_111, adj_113);\n        wp::adj_mul(var_112, var_110, adj_106, adj_110, adj_111);\n        wp::adj_float(var_109, adj_109, adj_110);\n        wp::adj_add(var_107, var_108, adj_107, adj_108, adj_109);\n        wp::adj_mul(var_95, var_105, adj_95, adj_105, adj_107);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_106);\n        wp::adj_add(var_94, var_102, adj_94, adj_102, adj_104);\n        wp::adj_mul(var_103, var_101, adj_97, adj_101, adj_102);\n        wp::adj_float(var_100, adj_100, adj_101);\n        wp::adj_add(var_98, var_99, adj_98, adj_99, adj_100);\n        wp::adj_mul(var_95, var_96, adj_95, adj_96, adj_98);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_97);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_85, var_92, adj_85, adj_92, adj_94);\n        wp::adj_mul(var_93, var_91, adj_87, adj_91, adj_92);\n        wp::adj_float(var_90, adj_90, adj_91);\n        wp::adj_add(var_88, var_89, adj_88, adj_89, adj_90);\n        wp::adj_mul(var_49, var_86, adj_49, adj_86, adj_88);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_87);\n        wp::adj_add(var_76, var_83, adj_76, adj_83, adj_85);\n        wp::adj_mul(var_84, var_82, adj_78, adj_82, adj_83);\n        wp::adj_float(var_81, adj_81, adj_82);\n        wp::adj_add(var_79, var_80, adj_79, adj_80, adj_81);\n        wp::adj_mul(var_49, var_77, adj_49, adj_77, adj_79);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_78);\n        wp::adj_add(var_67, var_74, adj_67, adj_74, adj_76);\n        wp::adj_mul(var_75, var_73, adj_69, adj_73, adj_74);\n        wp::adj_float(var_72, adj_72, adj_73);\n        wp::adj_add(var_70, var_71, adj_70, adj_71, adj_72);\n        wp::adj_mul(var_49, var_68, adj_49, adj_68, adj_70);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_69);\n        wp::adj_add(var_58, var_65, adj_58, adj_65, adj_67);\n        wp::adj_mul(var_66, var_64, adj_60, adj_64, adj_65);\n        wp::adj_float(var_63, adj_63, adj_64);\n        wp::adj_add(var_61, var_62, adj_61, adj_62, adj_63);\n        wp::adj_mul(var_49, var_59, adj_49, adj_59, adj_61);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_60);\n        wp::adj_add(var_48, var_56, adj_48, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_49, var_50, adj_49, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_39, var_46, adj_39, adj_46, adj_48);\n        wp::adj_mul(var_47, var_45, adj_41, adj_45, adj_46);\n        wp::adj_float(var_44, adj_44, adj_45);\n        wp::adj_add(var_42, var_43, adj_42, adj_43, adj_44);\n        wp::adj_mul(var_3, var_40, adj_3, adj_40, adj_42);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_41);\n        wp::adj_add(var_30, var_37, adj_30, adj_37, adj_39);\n        wp::adj_mul(var_38, var_36, adj_32, adj_36, adj_37);\n        wp::adj_float(var_35, adj_35, adj_36);\n        wp::adj_add(var_33, var_34, adj_33, adj_34, adj_35);\n        wp::adj_mul(var_3, var_31, adj_3, adj_31, adj_33);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_32);\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        // adj: for i in range(5):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_pfqybl(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_pfqybl","mangled_name":"nested_pfqybl_d34190e3","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_pfqybl(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(5):\n        for j in range(5):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"math_fyyaws_a564608226","device":"cuda","category":"math","description":"Math chain: neg, sin, exp, cos, sqrt, abs","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["neg","sin","exp","cos","sqrt","abs"],"seed":59},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_fyyaws_4750e826_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        //---------\n        // forward\n        // def math_fyyaws(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.sin(-a[tid]))))))                    <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::neg(var_3);\n        var_4 = wp::sin(var_2);\n        var_5 = wp::exp(var_4);\n        var_6 = wp::cos(var_5);\n        var_7 = wp::abs(var_6);\n        var_8 = wp::sqrt(var_7);\n        var_9 = wp::abs(var_8);\n        wp::array_store(var_out, var_0, var_9);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_fyyaws_4750e826_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        //---------\n        // forward\n        // def math_fyyaws(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.sin(-a[tid]))))))                    <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::neg(var_3);\n        var_4 = wp::sin(var_2);\n        var_5 = wp::exp(var_4);\n        var_6 = wp::cos(var_5);\n        var_7 = wp::abs(var_6);\n        var_8 = wp::sqrt(var_7);\n        var_9 = wp::abs(var_8);\n        // wp::array_store(var_out, var_0, var_9);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_9, adj_out, adj_0, adj_9);\n        wp::adj_abs(var_8, adj_8, adj_9);\n        wp::adj_sqrt(var_7, var_8, adj_7, adj_8);\n        wp::adj_abs(var_6, adj_6, adj_7);\n        wp::adj_cos(var_5, adj_5, adj_6);\n        wp::adj_exp(var_4, var_5, adj_4, adj_5);\n        wp::adj_sin(var_2, adj_2, adj_4);\n        wp::adj_neg(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.sin(-a[tid]))))))               <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_fyyaws(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_fyyaws","mangled_name":"math_fyyaws_4750e826","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_fyyaws(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.sin(-a[tid]))))))\n"}
{"id":"mat_ipgvmi_55e96b4b31","device":"cuda","category":"matrix","description":"Matrix-vector multiply (wp.mat22 * wp.vec2)","arg_types":{"m":"wp.array(dtype=wp.mat22)","v":"wp.array(dtype=wp.vec2)","out":"wp.array(dtype=wp.vec2)"},"metadata":{"mat_type":"wp.mat22","operation":"mat_vec","seed":60},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_ipgvmi_b943c895_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32>* var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        wp::mat_t<2, 2, wp::float32> var_4;\n        wp::vec_t<2, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_ipgvmi(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_ipgvmi_b943c895_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32>* var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        wp::mat_t<2, 2, wp::float32> var_4;\n        wp::vec_t<2, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<2, 2, wp::float32> adj_1 = {};\n        wp::vec_t<2, wp::float32> adj_2 = {};\n        wp::vec_t<2, wp::float32> adj_3 = {};\n        wp::mat_t<2, 2, wp::float32> adj_4 = {};\n        wp::vec_t<2, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_ipgvmi(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_v, var_0, adj_v, adj_0, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = m[tid] * v[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_ipgvmi(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_ipgvmi","mangled_name":"mat_ipgvmi_b943c895","device":"cuda","arg_names":["m","v","out"],"arg_types":{"m":"array<class 'warp._src.types.mat22f'>","v":"array<class 'warp._src.types.vec2f'>","out":"array<class 'warp._src.types.vec2f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_ipgvmi(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):\n    tid = wp.tid()\n    out[tid] = m[tid] * v[tid]\n"}
{"id":"mat_moviis_57753ec224","device":"cuda","category":"matrix","description":"Matrix-matrix multiply (wp.mat33)","arg_types":{"a":"wp.array(dtype=wp.mat33)","b":"wp.array(dtype=wp.mat33)","out":"wp.array(dtype=wp.mat33)"},"metadata":{"mat_type":"wp.mat33","operation":"mat_mat","seed":61},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_moviis_f1650342_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::mat_t<3, 3, wp::float32>* var_2;\n        wp::mat_t<3, 3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::mat_t<3, 3, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_moviis(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_moviis_f1650342_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::mat_t<3, 3, wp::float32>* var_2;\n        wp::mat_t<3, 3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::mat_t<3, 3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<3, 3, wp::float32> adj_1 = {};\n        wp::mat_t<3, 3, wp::float32> adj_2 = {};\n        wp::mat_t<3, 3, wp::float32> adj_3 = {};\n        wp::mat_t<3, 3, wp::float32> adj_4 = {};\n        wp::mat_t<3, 3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_moviis(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = a[tid] * b[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_moviis(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_moviis","mangled_name":"mat_moviis_f1650342","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.mat33f'>","b":"array<class 'warp._src.types.mat33f'>","out":"array<class 'warp._src.types.mat33f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_moviis(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):\n    tid = wp.tid()\n    out[tid] = a[tid] * b[tid]\n"}
{"id":"scalar_yezgmx_2a17a575ff","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=1.79, offset=-3.13)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"-","scale":1.79,"offset":-3.13,"seed":62},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_yezgmx_bf500e2e_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_yezgmx(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_yezgmx_bf500e2e_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_yezgmx(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_sub(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] - scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_yezgmx(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_yezgmx","mangled_name":"scalar_yezgmx_bf500e2e","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_yezgmx(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] - scale) + offset\n"}
{"id":"arith_lhxmct_5bedce8fe2","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 3 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":3,"seed":63},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_lhxmct_772a7859_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        //---------\n        // forward\n        // def arith_lhxmct(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = a[tid] * b[tid]                                                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // var_1 = wp.exp(var_0)                                                                  <L 7>\n        var_6 = wp::exp(var_3);\n        // var_2 = wp.exp(var_1)                                                                  <L 8>\n        var_7 = wp::exp(var_6);\n        // out[tid] = var_2                                                                       <L 9>\n        wp::array_store(var_out, var_0, var_7);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_lhxmct_772a7859_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        //---------\n        // forward\n        // def arith_lhxmct(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = a[tid] * b[tid]                                                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // var_1 = wp.exp(var_0)                                                                  <L 7>\n        var_6 = wp::exp(var_3);\n        // var_2 = wp.exp(var_1)                                                                  <L 8>\n        var_7 = wp::exp(var_6);\n        // out[tid] = var_2                                                                       <L 9>\n        // wp::array_store(var_out, var_0, var_7);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_7, adj_out, adj_0, adj_7);\n        // adj: out[tid] = var_2                                                                  <L 9>\n        wp::adj_exp(var_6, var_7, adj_6, adj_7);\n        // adj: var_2 = wp.exp(var_1)                                                             <L 8>\n        wp::adj_exp(var_3, var_6, adj_3, adj_6);\n        // adj: var_1 = wp.exp(var_0)                                                             <L 7>\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = a[tid] * b[tid]                                                           <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_lhxmct(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_lhxmct","mangled_name":"arith_lhxmct_772a7859","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_lhxmct(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = a[tid] * b[tid]\n    var_1 = wp.exp(var_0)\n    var_2 = wp.exp(var_1)\n    out[tid] = var_2\n"}
{"id":"scalar_mqkxaz_ab8a82f91a","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=9.14, offset=1.33)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"*","scale":9.14,"offset":1.33,"seed":64},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_mqkxaz_c5cfe68b_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_mqkxaz(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_mqkxaz_c5cfe68b_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_mqkxaz(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_mul(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] * scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_mqkxaz(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_mqkxaz","mangled_name":"scalar_mqkxaz_c5cfe68b","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_mqkxaz(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] * scale) + offset\n"}
{"id":"ctrl_khvlno_d6e3794879","device":"cuda","category":"control_flow","description":"Step function","arg_types":{"a":"wp.array(dtype=float)","threshold":"float","out":"wp.array(dtype=float)"},"metadata":{"pattern":"step","seed":65},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_khvlno_ec12a169_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::float32 var_threshold,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        bool var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        const wp::float32 var_5 = 0.0;\n        //---------\n        // forward\n        // def ctrl_khvlno(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // if a[tid] > threshold:                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = (var_3 > var_threshold);\n        if (var_2) {\n            // out[tid] = 1.0                                                                     <L 7>\n            wp::array_store(var_out, var_0, var_4);\n        }\n        if (!var_2) {\n            // out[tid] = 0.0                                                                     <L 9>\n            wp::array_store(var_out, var_0, var_5);\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_khvlno_ec12a169_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::float32 var_threshold,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::float32 adj_threshold,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        bool var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        const wp::float32 var_5 = 0.0;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        bool adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        //---------\n        // forward\n        // def ctrl_khvlno(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // if a[tid] > threshold:                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = (var_3 > var_threshold);\n        if (var_2) {\n            // out[tid] = 1.0                                                                     <L 7>\n            // wp::array_store(var_out, var_0, var_4);\n        }\n        if (!var_2) {\n            // out[tid] = 0.0                                                                     <L 9>\n            // wp::array_store(var_out, var_0, var_5);\n        }\n        //---------\n        // reverse\n        if (!var_2) {\n            wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n            // adj: out[tid] = 0.0                                                                <L 9>\n        }\n        if (var_2) {\n            wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n            // adj: out[tid] = 1.0                                                                <L 7>\n        }\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: if a[tid] > threshold:                                                            <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_khvlno(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_khvlno","mangled_name":"ctrl_khvlno_ec12a169","device":"cuda","arg_names":["a","threshold","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","threshold":"<class 'float'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_khvlno(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):\n    tid = wp.tid()\n    if a[tid] > threshold:\n        out[tid] = 1.0\n    else:\n        out[tid] = 0.0\n"}
{"id":"nested_blglgw_52a7e49586","device":"cuda","category":"nested_loop","description":"Nested loops (7x3)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":7,"inner_iterations":3,"seed":66},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_blglgw_19da3276_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        const wp::int32 var_143 = 5;\n        const wp::int32 var_144 = 0;\n        wp::float32* var_145;\n        wp::int32 var_146;\n        const wp::int32 var_147 = 1;\n        wp::int32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::float32* var_154;\n        wp::int32 var_155;\n        const wp::int32 var_156 = 1;\n        wp::int32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        const wp::int32 var_162 = 2;\n        wp::float32* var_163;\n        wp::int32 var_164;\n        const wp::int32 var_165 = 1;\n        wp::int32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32 var_169;\n        wp::float32 var_170;\n        const wp::int32 var_171 = 6;\n        const wp::int32 var_172 = 0;\n        wp::float32* var_173;\n        wp::int32 var_174;\n        const wp::int32 var_175 = 1;\n        wp::int32 var_176;\n        wp::float32 var_177;\n        wp::float32 var_178;\n        wp::float32 var_179;\n        wp::float32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::float32* var_182;\n        wp::int32 var_183;\n        const wp::int32 var_184 = 1;\n        wp::int32 var_185;\n        wp::float32 var_186;\n        wp::float32 var_187;\n        wp::float32 var_188;\n        wp::float32 var_189;\n        const wp::int32 var_190 = 2;\n        wp::float32* var_191;\n        wp::int32 var_192;\n        const wp::int32 var_193 = 1;\n        wp::int32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        wp::float32 var_197;\n        wp::float32 var_198;\n        //---------\n        // forward\n        // def nested_blglgw(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_145 = wp::address(var_data, var_0);\n        var_146 = wp::mul(var_143, var_144);\n        var_148 = wp::add(var_146, var_147);\n        var_149 = wp::float(var_148);\n        var_151 = wp::load(var_145);\n        var_150 = wp::mul(var_151, var_149);\n        var_152 = wp::add(var_142, var_150);\n        var_154 = wp::address(var_data, var_0);\n        var_155 = wp::mul(var_143, var_153);\n        var_157 = wp::add(var_155, var_156);\n        var_158 = wp::float(var_157);\n        var_160 = wp::load(var_154);\n        var_159 = wp::mul(var_160, var_158);\n        var_161 = wp::add(var_152, var_159);\n        var_163 = wp::address(var_data, var_0);\n        var_164 = wp::mul(var_143, var_162);\n        var_166 = wp::add(var_164, var_165);\n        var_167 = wp::float(var_166);\n        var_169 = wp::load(var_163);\n        var_168 = wp::mul(var_169, var_167);\n        var_170 = wp::add(var_161, var_168);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_173 = wp::address(var_data, var_0);\n        var_174 = wp::mul(var_171, var_172);\n        var_176 = wp::add(var_174, var_175);\n        var_177 = wp::float(var_176);\n        var_179 = wp::load(var_173);\n        var_178 = wp::mul(var_179, var_177);\n        var_180 = wp::add(var_170, var_178);\n        var_182 = wp::address(var_data, var_0);\n        var_183 = wp::mul(var_171, var_181);\n        var_185 = wp::add(var_183, var_184);\n        var_186 = wp::float(var_185);\n        var_188 = wp::load(var_182);\n        var_187 = wp::mul(var_188, var_186);\n        var_189 = wp::add(var_180, var_187);\n        var_191 = wp::address(var_data, var_0);\n        var_192 = wp::mul(var_171, var_190);\n        var_194 = wp::add(var_192, var_193);\n        var_195 = wp::float(var_194);\n        var_197 = wp::load(var_191);\n        var_196 = wp::mul(var_197, var_195);\n        var_198 = wp::add(var_189, var_196);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_198);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_blglgw_19da3276_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        const wp::int32 var_143 = 5;\n        const wp::int32 var_144 = 0;\n        wp::float32* var_145;\n        wp::int32 var_146;\n        const wp::int32 var_147 = 1;\n        wp::int32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::float32* var_154;\n        wp::int32 var_155;\n        const wp::int32 var_156 = 1;\n        wp::int32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        const wp::int32 var_162 = 2;\n        wp::float32* var_163;\n        wp::int32 var_164;\n        const wp::int32 var_165 = 1;\n        wp::int32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32 var_169;\n        wp::float32 var_170;\n        const wp::int32 var_171 = 6;\n        const wp::int32 var_172 = 0;\n        wp::float32* var_173;\n        wp::int32 var_174;\n        const wp::int32 var_175 = 1;\n        wp::int32 var_176;\n        wp::float32 var_177;\n        wp::float32 var_178;\n        wp::float32 var_179;\n        wp::float32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::float32* var_182;\n        wp::int32 var_183;\n        const wp::int32 var_184 = 1;\n        wp::int32 var_185;\n        wp::float32 var_186;\n        wp::float32 var_187;\n        wp::float32 var_188;\n        wp::float32 var_189;\n        const wp::int32 var_190 = 2;\n        wp::float32* var_191;\n        wp::int32 var_192;\n        const wp::int32 var_193 = 1;\n        wp::int32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        wp::float32 var_197;\n        wp::float32 var_198;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::int32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::int32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::int32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::int32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::int32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::int32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::int32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::int32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::int32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::float32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::int32 adj_91 = {};\n        wp::int32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::int32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::int32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::int32 adj_119 = {};\n        wp::int32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::int32 adj_128 = {};\n        wp::int32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::int32 adj_137 = {};\n        wp::int32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::int32 adj_143 = {};\n        wp::int32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        wp::int32 adj_146 = {};\n        wp::int32 adj_147 = {};\n        wp::int32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::float32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::float32 adj_152 = {};\n        wp::int32 adj_153 = {};\n        wp::float32 adj_154 = {};\n        wp::int32 adj_155 = {};\n        wp::int32 adj_156 = {};\n        wp::int32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::float32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::float32 adj_161 = {};\n        wp::int32 adj_162 = {};\n        wp::float32 adj_163 = {};\n        wp::int32 adj_164 = {};\n        wp::int32 adj_165 = {};\n        wp::int32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::float32 adj_168 = {};\n        wp::float32 adj_169 = {};\n        wp::float32 adj_170 = {};\n        wp::int32 adj_171 = {};\n        wp::int32 adj_172 = {};\n        wp::float32 adj_173 = {};\n        wp::int32 adj_174 = {};\n        wp::int32 adj_175 = {};\n        wp::int32 adj_176 = {};\n        wp::float32 adj_177 = {};\n        wp::float32 adj_178 = {};\n        wp::float32 adj_179 = {};\n        wp::float32 adj_180 = {};\n        wp::int32 adj_181 = {};\n        wp::float32 adj_182 = {};\n        wp::int32 adj_183 = {};\n        wp::int32 adj_184 = {};\n        wp::int32 adj_185 = {};\n        wp::float32 adj_186 = {};\n        wp::float32 adj_187 = {};\n        wp::float32 adj_188 = {};\n        wp::float32 adj_189 = {};\n        wp::int32 adj_190 = {};\n        wp::float32 adj_191 = {};\n        wp::int32 adj_192 = {};\n        wp::int32 adj_193 = {};\n        wp::int32 adj_194 = {};\n        wp::float32 adj_195 = {};\n        wp::float32 adj_196 = {};\n        wp::float32 adj_197 = {};\n        wp::float32 adj_198 = {};\n        //---------\n        // forward\n        // def nested_blglgw(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_145 = wp::address(var_data, var_0);\n        var_146 = wp::mul(var_143, var_144);\n        var_148 = wp::add(var_146, var_147);\n        var_149 = wp::float(var_148);\n        var_151 = wp::load(var_145);\n        var_150 = wp::mul(var_151, var_149);\n        var_152 = wp::add(var_142, var_150);\n        var_154 = wp::address(var_data, var_0);\n        var_155 = wp::mul(var_143, var_153);\n        var_157 = wp::add(var_155, var_156);\n        var_158 = wp::float(var_157);\n        var_160 = wp::load(var_154);\n        var_159 = wp::mul(var_160, var_158);\n        var_161 = wp::add(var_152, var_159);\n        var_163 = wp::address(var_data, var_0);\n        var_164 = wp::mul(var_143, var_162);\n        var_166 = wp::add(var_164, var_165);\n        var_167 = wp::float(var_166);\n        var_169 = wp::load(var_163);\n        var_168 = wp::mul(var_169, var_167);\n        var_170 = wp::add(var_161, var_168);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_173 = wp::address(var_data, var_0);\n        var_174 = wp::mul(var_171, var_172);\n        var_176 = wp::add(var_174, var_175);\n        var_177 = wp::float(var_176);\n        var_179 = wp::load(var_173);\n        var_178 = wp::mul(var_179, var_177);\n        var_180 = wp::add(var_170, var_178);\n        var_182 = wp::address(var_data, var_0);\n        var_183 = wp::mul(var_171, var_181);\n        var_185 = wp::add(var_183, var_184);\n        var_186 = wp::float(var_185);\n        var_188 = wp::load(var_182);\n        var_187 = wp::mul(var_188, var_186);\n        var_189 = wp::add(var_180, var_187);\n        var_191 = wp::address(var_data, var_0);\n        var_192 = wp::mul(var_171, var_190);\n        var_194 = wp::add(var_192, var_193);\n        var_195 = wp::float(var_194);\n        var_197 = wp::load(var_191);\n        var_196 = wp::mul(var_197, var_195);\n        var_198 = wp::add(var_189, var_196);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_198);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_198, adj_out, adj_0, adj_198);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_189, var_196, adj_189, adj_196, adj_198);\n        wp::adj_mul(var_197, var_195, adj_191, adj_195, adj_196);\n        wp::adj_float(var_194, adj_194, adj_195);\n        wp::adj_add(var_192, var_193, adj_192, adj_193, adj_194);\n        wp::adj_mul(var_171, var_190, adj_171, adj_190, adj_192);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_191);\n        wp::adj_add(var_180, var_187, adj_180, adj_187, adj_189);\n        wp::adj_mul(var_188, var_186, adj_182, adj_186, adj_187);\n        wp::adj_float(var_185, adj_185, adj_186);\n        wp::adj_add(var_183, var_184, adj_183, adj_184, adj_185);\n        wp::adj_mul(var_171, var_181, adj_171, adj_181, adj_183);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_182);\n        wp::adj_add(var_170, var_178, adj_170, adj_178, adj_180);\n        wp::adj_mul(var_179, var_177, adj_173, adj_177, adj_178);\n        wp::adj_float(var_176, adj_176, adj_177);\n        wp::adj_add(var_174, var_175, adj_174, adj_175, adj_176);\n        wp::adj_mul(var_171, var_172, adj_171, adj_172, adj_174);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_173);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_161, var_168, adj_161, adj_168, adj_170);\n        wp::adj_mul(var_169, var_167, adj_163, adj_167, adj_168);\n        wp::adj_float(var_166, adj_166, adj_167);\n        wp::adj_add(var_164, var_165, adj_164, adj_165, adj_166);\n        wp::adj_mul(var_143, var_162, adj_143, adj_162, adj_164);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_163);\n        wp::adj_add(var_152, var_159, adj_152, adj_159, adj_161);\n        wp::adj_mul(var_160, var_158, adj_154, adj_158, adj_159);\n        wp::adj_float(var_157, adj_157, adj_158);\n        wp::adj_add(var_155, var_156, adj_155, adj_156, adj_157);\n        wp::adj_mul(var_143, var_153, adj_143, adj_153, adj_155);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_154);\n        wp::adj_add(var_142, var_150, adj_142, adj_150, adj_152);\n        wp::adj_mul(var_151, var_149, adj_145, adj_149, adj_150);\n        wp::adj_float(var_148, adj_148, adj_149);\n        wp::adj_add(var_146, var_147, adj_146, adj_147, adj_148);\n        wp::adj_mul(var_143, var_144, adj_143, adj_144, adj_146);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_145);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_133, var_140, adj_133, adj_140, adj_142);\n        wp::adj_mul(var_141, var_139, adj_135, adj_139, adj_140);\n        wp::adj_float(var_138, adj_138, adj_139);\n        wp::adj_add(var_136, var_137, adj_136, adj_137, adj_138);\n        wp::adj_mul(var_115, var_134, adj_115, adj_134, adj_136);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_135);\n        wp::adj_add(var_124, var_131, adj_124, adj_131, adj_133);\n        wp::adj_mul(var_132, var_130, adj_126, adj_130, adj_131);\n        wp::adj_float(var_129, adj_129, adj_130);\n        wp::adj_add(var_127, var_128, adj_127, adj_128, adj_129);\n        wp::adj_mul(var_115, var_125, adj_115, adj_125, adj_127);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_126);\n        wp::adj_add(var_114, var_122, adj_114, adj_122, adj_124);\n        wp::adj_mul(var_123, var_121, adj_117, adj_121, adj_122);\n        wp::adj_float(var_120, adj_120, adj_121);\n        wp::adj_add(var_118, var_119, adj_118, adj_119, adj_120);\n        wp::adj_mul(var_115, var_116, adj_115, adj_116, adj_118);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_117);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_105, var_112, adj_105, adj_112, adj_114);\n        wp::adj_mul(var_113, var_111, adj_107, adj_111, adj_112);\n        wp::adj_float(var_110, adj_110, adj_111);\n        wp::adj_add(var_108, var_109, adj_108, adj_109, adj_110);\n        wp::adj_mul(var_87, var_106, adj_87, adj_106, adj_108);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_107);\n        wp::adj_add(var_96, var_103, adj_96, adj_103, adj_105);\n        wp::adj_mul(var_104, var_102, adj_98, adj_102, adj_103);\n        wp::adj_float(var_101, adj_101, adj_102);\n        wp::adj_add(var_99, var_100, adj_99, adj_100, adj_101);\n        wp::adj_mul(var_87, var_97, adj_87, adj_97, adj_99);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_98);\n        wp::adj_add(var_86, var_94, adj_86, adj_94, adj_96);\n        wp::adj_mul(var_95, var_93, adj_89, adj_93, adj_94);\n        wp::adj_float(var_92, adj_92, adj_93);\n        wp::adj_add(var_90, var_91, adj_90, adj_91, adj_92);\n        wp::adj_mul(var_87, var_88, adj_87, adj_88, adj_90);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_89);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_77, var_84, adj_77, adj_84, adj_86);\n        wp::adj_mul(var_85, var_83, adj_79, adj_83, adj_84);\n        wp::adj_float(var_82, adj_82, adj_83);\n        wp::adj_add(var_80, var_81, adj_80, adj_81, adj_82);\n        wp::adj_mul(var_59, var_78, adj_59, adj_78, adj_80);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_79);\n        wp::adj_add(var_68, var_75, adj_68, adj_75, adj_77);\n        wp::adj_mul(var_76, var_74, adj_70, adj_74, adj_75);\n        wp::adj_float(var_73, adj_73, adj_74);\n        wp::adj_add(var_71, var_72, adj_71, adj_72, adj_73);\n        wp::adj_mul(var_59, var_69, adj_59, adj_69, adj_71);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_70);\n        wp::adj_add(var_58, var_66, adj_58, adj_66, adj_68);\n        wp::adj_mul(var_67, var_65, adj_61, adj_65, adj_66);\n        wp::adj_float(var_64, adj_64, adj_65);\n        wp::adj_add(var_62, var_63, adj_62, adj_63, adj_64);\n        wp::adj_mul(var_59, var_60, adj_59, adj_60, adj_62);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_61);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_49, var_56, adj_49, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_31, var_50, adj_31, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        wp::adj_add(var_40, var_47, adj_40, adj_47, adj_49);\n        wp::adj_mul(var_48, var_46, adj_42, adj_46, adj_47);\n        wp::adj_float(var_45, adj_45, adj_46);\n        wp::adj_add(var_43, var_44, adj_43, adj_44, adj_45);\n        wp::adj_mul(var_31, var_41, adj_31, adj_41, adj_43);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_42);\n        wp::adj_add(var_30, var_38, adj_30, adj_38, adj_40);\n        wp::adj_mul(var_39, var_37, adj_33, adj_37, adj_38);\n        wp::adj_float(var_36, adj_36, adj_37);\n        wp::adj_add(var_34, var_35, adj_34, adj_35, adj_36);\n        wp::adj_mul(var_31, var_32, adj_31, adj_32, adj_34);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_33);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        // adj: for i in range(7):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_blglgw(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_blglgw","mangled_name":"nested_blglgw_19da3276","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_blglgw(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(7):\n        for j in range(3):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"multicond_btzkyl_9baa5e9dc7","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: 1.22, 5.86)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":1.22,"threshold2":5.86,"seed":67},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_btzkyl_43ce44b7_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.22;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 5.86;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // forward\n        // def multicond_btzkyl(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 1.22:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 5.86:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                wp::array_store(var_out, var_0, var_13);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_btzkyl_43ce44b7_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.22;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 5.86;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        bool adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        //---------\n        // forward\n        // def multicond_btzkyl(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 1.22:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            // wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 5.86:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                // wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                // wp::array_store(var_out, var_0, var_13);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_5) {\n            if (!var_9) {\n                wp::adj_array_store(var_out, var_0, var_13, adj_out, adj_0, adj_13);\n                wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_9) {\n                wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n                wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 5.86:                                                              <L 9>\n        }\n        if (var_5) {\n            wp::adj_array_store(var_out, var_0, var_7, adj_out, adj_0, adj_7);\n            wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < 1.22:                                                                    <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_btzkyl(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_btzkyl","mangled_name":"multicond_btzkyl_43ce44b7","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_btzkyl(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < 1.22:\n        out[tid] = val * 0.5\n    elif val < 5.86:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"ctrl_tytxcp_5b5b43d7a2","device":"cuda","category":"control_flow","description":"Loop sum (11 iterations)","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"pattern":"loop_sum","seed":68},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_tytxcp_6cced44f_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        //---------\n        // forward\n        // def ctrl_tytxcp(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(11):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        // out[tid] = total                                                                       <L 9>\n        wp::array_store(var_out, var_0, var_45);\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_tytxcp_6cced44f_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::float32* var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        const wp::int32 var_11 = 2;\n        wp::float32* var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 3;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 4;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        const wp::int32 var_23 = 5;\n        wp::float32* var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 6;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 7;\n        wp::float32* var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 8;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 9;\n        wp::float32* var_40;\n        wp::float32 var_41;\n        wp::float32 var_42;\n        const wp::int32 var_43 = 10;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::int32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::int32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::int32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::int32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        //---------\n        // forward\n        // def ctrl_tytxcp(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(11):                                                                    <L 7>\n        // total = total + a[tid]                                                                 <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::add(var_2, var_6);\n        var_8 = wp::address(var_a, var_0);\n        var_10 = wp::load(var_8);\n        var_9 = wp::add(var_5, var_10);\n        var_12 = wp::address(var_a, var_0);\n        var_14 = wp::load(var_12);\n        var_13 = wp::add(var_9, var_14);\n        var_16 = wp::address(var_a, var_0);\n        var_18 = wp::load(var_16);\n        var_17 = wp::add(var_13, var_18);\n        var_20 = wp::address(var_a, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_17, var_22);\n        var_24 = wp::address(var_a, var_0);\n        var_26 = wp::load(var_24);\n        var_25 = wp::add(var_21, var_26);\n        var_28 = wp::address(var_a, var_0);\n        var_30 = wp::load(var_28);\n        var_29 = wp::add(var_25, var_30);\n        var_32 = wp::address(var_a, var_0);\n        var_34 = wp::load(var_32);\n        var_33 = wp::add(var_29, var_34);\n        var_36 = wp::address(var_a, var_0);\n        var_38 = wp::load(var_36);\n        var_37 = wp::add(var_33, var_38);\n        var_40 = wp::address(var_a, var_0);\n        var_42 = wp::load(var_40);\n        var_41 = wp::add(var_37, var_42);\n        var_44 = wp::address(var_a, var_0);\n        var_46 = wp::load(var_44);\n        var_45 = wp::add(var_41, var_46);\n        // out[tid] = total                                                                       <L 9>\n        // wp::array_store(var_out, var_0, var_45);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_45, adj_out, adj_0, adj_45);\n        // adj: out[tid] = total                                                                  <L 9>\n        wp::adj_add(var_41, var_46, adj_41, adj_44, adj_45);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_44);\n        wp::adj_add(var_37, var_42, adj_37, adj_40, adj_41);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_40);\n        wp::adj_add(var_33, var_38, adj_33, adj_36, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        wp::adj_add(var_29, var_34, adj_29, adj_32, adj_33);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_32);\n        wp::adj_add(var_25, var_30, adj_25, adj_28, adj_29);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_28);\n        wp::adj_add(var_21, var_26, adj_21, adj_24, adj_25);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_24);\n        wp::adj_add(var_17, var_22, adj_17, adj_20, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        wp::adj_add(var_13, var_18, adj_13, adj_16, adj_17);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_16);\n        wp::adj_add(var_9, var_14, adj_9, adj_12, adj_13);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_12);\n        wp::adj_add(var_5, var_10, adj_5, adj_8, adj_9);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_8);\n        wp::adj_add(var_2, var_6, adj_2, adj_4, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: total = total + a[tid]                                                            <L 8>\n        // adj: for i in range(11):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_tytxcp(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_tytxcp","mangled_name":"ctrl_tytxcp_6cced44f","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_tytxcp(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(11):\n        total = total + a[tid]\n    out[tid] = total\n"}
{"id":"math_rcepix_0ea8ddc167","device":"cuda","category":"math","description":"Math chain: sin, log, exp, cos, sqrt, abs","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["sin","log","exp","cos","sqrt","abs"],"seed":69},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_rcepix_2b18afc9_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        const wp::float32 var_5 = 1.0;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        //---------\n        // forward\n        // def math_rcepix(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))))))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_6 = wp::add(var_4, var_5);\n        var_7 = wp::log(var_6);\n        var_8 = wp::exp(var_7);\n        var_9 = wp::cos(var_8);\n        var_10 = wp::abs(var_9);\n        var_11 = wp::sqrt(var_10);\n        var_12 = wp::abs(var_11);\n        wp::array_store(var_out, var_0, var_12);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_rcepix_2b18afc9_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        const wp::float32 var_5 = 1.0;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        //---------\n        // forward\n        // def math_rcepix(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))))))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_6 = wp::add(var_4, var_5);\n        var_7 = wp::log(var_6);\n        var_8 = wp::exp(var_7);\n        var_9 = wp::cos(var_8);\n        var_10 = wp::abs(var_9);\n        var_11 = wp::sqrt(var_10);\n        var_12 = wp::abs(var_11);\n        // wp::array_store(var_out, var_0, var_12);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_12, adj_out, adj_0, adj_12);\n        wp::adj_abs(var_11, adj_11, adj_12);\n        wp::adj_sqrt(var_10, var_11, adj_10, adj_11);\n        wp::adj_abs(var_9, adj_9, adj_10);\n        wp::adj_cos(var_8, adj_8, adj_9);\n        wp::adj_exp(var_7, var_8, adj_7, adj_8);\n        wp::adj_log(var_6, adj_6, adj_7);\n        wp::adj_add(var_4, var_5, adj_4, adj_5, adj_6);\n        wp::adj_abs(var_2, adj_2, adj_4);\n        wp::adj_sin(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))))))  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_rcepix(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_rcepix","mangled_name":"math_rcepix_2b18afc9","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_rcepix(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.abs(wp.sqrt(wp.abs(wp.cos(wp.exp(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))))))\n"}
{"id":"combined_xhldze_cc187bf401","device":"cuda","category":"combined","description":"Combined pattern (loop+cond+wp.abs)","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"iterations":6,"threshold":0.86,"function":"wp.abs","seed":70},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void combined_xhldze_819e4d09_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.86;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.86;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.86;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.86;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 0.86;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 0.86;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        //---------\n        // forward\n        // def combined_xhldze(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(6):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::abs(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::abs(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::abs(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::abs(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::abs(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::abs(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // out[tid] = acc                                                                         <L 12>\n        wp::array_store(var_out, var_0, var_98);\n    }\n}\n\n\n\nextern \"C\" __global__ void combined_xhldze_819e4d09_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.86;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.86;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.86;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.86;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 0.86;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 0.86;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        bool adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        bool adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        bool adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::int32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::float32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        bool adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::float32 adj_80 = {};\n        wp::float32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::int32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::float32 adj_88 = {};\n        bool adj_89 = {};\n        wp::float32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        //---------\n        // forward\n        // def combined_xhldze(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(6):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::abs(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::abs(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::abs(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::abs(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::abs(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 0.86:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.abs(b[tid])                                                         <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::abs(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // out[tid] = acc                                                                         <L 12>\n        // wp::array_store(var_out, var_0, var_98);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_98, adj_out, adj_0, adj_98);\n        // adj: out[tid] = acc                                                                    <L 12>\n        wp::adj_where(var_89, var_94, var_96, adj_89, adj_94, adj_96, adj_98);\n        if (!var_89) {\n            wp::adj_add(var_94, var_97, adj_94, adj_95, adj_96);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_95);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_89, var_93, var_82, adj_89, adj_93, adj_82, adj_94);\n        if (var_89) {\n            wp::adj_add(var_82, var_91, adj_82, adj_91, adj_93);\n            wp::adj_abs(var_92, adj_90, adj_91);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_90);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_87, var_85, adj_84, adj_85, adj_86);\n        wp::adj_float(var_83, adj_83, adj_85);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_84);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        wp::adj_where(var_73, var_78, var_80, adj_73, adj_78, adj_80, adj_82);\n        if (!var_73) {\n            wp::adj_add(var_78, var_81, adj_78, adj_79, adj_80);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_79);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_73, var_77, var_66, adj_73, adj_77, adj_66, adj_78);\n        if (var_73) {\n            wp::adj_add(var_66, var_75, adj_66, adj_75, adj_77);\n            wp::adj_abs(var_76, adj_74, adj_75);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_74);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_71, var_69, adj_68, adj_69, adj_70);\n        wp::adj_float(var_67, adj_67, adj_69);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_68);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        wp::adj_where(var_57, var_62, var_64, adj_57, adj_62, adj_64, adj_66);\n        if (!var_57) {\n            wp::adj_add(var_62, var_65, adj_62, adj_63, adj_64);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_63);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_57, var_61, var_50, adj_57, adj_61, adj_50, adj_62);\n        if (var_57) {\n            wp::adj_add(var_50, var_59, adj_50, adj_59, adj_61);\n            wp::adj_abs(var_60, adj_58, adj_59);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_58);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_55, var_53, adj_52, adj_53, adj_54);\n        wp::adj_float(var_51, adj_51, adj_53);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        wp::adj_where(var_41, var_46, var_48, adj_41, adj_46, adj_48, adj_50);\n        if (!var_41) {\n            wp::adj_add(var_46, var_49, adj_46, adj_47, adj_48);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_47);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_41, var_45, var_34, adj_41, adj_45, adj_34, adj_46);\n        if (var_41) {\n            wp::adj_add(var_34, var_43, adj_34, adj_43, adj_45);\n            wp::adj_abs(var_44, adj_42, adj_43);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_42);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_39, var_37, adj_36, adj_37, adj_38);\n        wp::adj_float(var_35, adj_35, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        wp::adj_where(var_25, var_30, var_32, adj_25, adj_30, adj_32, adj_34);\n        if (!var_25) {\n            wp::adj_add(var_30, var_33, adj_30, adj_31, adj_32);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_31);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_25, var_29, var_18, adj_25, adj_29, adj_18, adj_30);\n        if (var_25) {\n            wp::adj_add(var_18, var_27, adj_18, adj_27, adj_29);\n            wp::adj_abs(var_28, adj_26, adj_27);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_26);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_23, var_21, adj_20, adj_21, adj_22);\n        wp::adj_float(var_19, adj_19, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        wp::adj_where(var_9, var_14, var_16, adj_9, adj_14, adj_16, adj_18);\n        if (!var_9) {\n            wp::adj_add(var_14, var_17, adj_14, adj_15, adj_16);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_15);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_9, var_13, var_2, adj_9, adj_13, adj_2, adj_14);\n        if (var_9) {\n            wp::adj_add(var_2, var_11, adj_2, adj_11, adj_13);\n            wp::adj_abs(var_12, adj_10, adj_11);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_10);\n            // adj: acc = acc + wp.abs(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_float(var_3, adj_3, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: if a[tid] * float(i) > 0.86:                                                      <L 8>\n        // adj: for i in range(6):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: acc = float(0.0)                                                                  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def combined_xhldze(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"combined_xhldze","mangled_name":"combined_xhldze_819e4d09","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef combined_xhldze(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    acc = float(0.0)\n    for i in range(6):\n        if a[tid] * float(i) > 0.86:\n            acc = acc + wp.abs(b[tid])\n        else:\n            acc = acc + b[tid]\n    out[tid] = acc\n"}
{"id":"nested_iqazvz_54df6eb448","device":"cuda","category":"nested_loop","description":"Nested loops (5x3)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":5,"inner_iterations":3,"seed":71},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_iqazvz_6f34c9db_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        //---------\n        // forward\n        // def nested_iqazvz(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_142);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_iqazvz_6f34c9db_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::int32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::int32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::int32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::int32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::int32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::int32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::int32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::int32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::int32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::float32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::int32 adj_91 = {};\n        wp::int32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::int32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::int32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::int32 adj_119 = {};\n        wp::int32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::int32 adj_128 = {};\n        wp::int32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::int32 adj_137 = {};\n        wp::int32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        //---------\n        // forward\n        // def nested_iqazvz(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(5):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_142);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_142, adj_out, adj_0, adj_142);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_133, var_140, adj_133, adj_140, adj_142);\n        wp::adj_mul(var_141, var_139, adj_135, adj_139, adj_140);\n        wp::adj_float(var_138, adj_138, adj_139);\n        wp::adj_add(var_136, var_137, adj_136, adj_137, adj_138);\n        wp::adj_mul(var_115, var_134, adj_115, adj_134, adj_136);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_135);\n        wp::adj_add(var_124, var_131, adj_124, adj_131, adj_133);\n        wp::adj_mul(var_132, var_130, adj_126, adj_130, adj_131);\n        wp::adj_float(var_129, adj_129, adj_130);\n        wp::adj_add(var_127, var_128, adj_127, adj_128, adj_129);\n        wp::adj_mul(var_115, var_125, adj_115, adj_125, adj_127);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_126);\n        wp::adj_add(var_114, var_122, adj_114, adj_122, adj_124);\n        wp::adj_mul(var_123, var_121, adj_117, adj_121, adj_122);\n        wp::adj_float(var_120, adj_120, adj_121);\n        wp::adj_add(var_118, var_119, adj_118, adj_119, adj_120);\n        wp::adj_mul(var_115, var_116, adj_115, adj_116, adj_118);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_117);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_105, var_112, adj_105, adj_112, adj_114);\n        wp::adj_mul(var_113, var_111, adj_107, adj_111, adj_112);\n        wp::adj_float(var_110, adj_110, adj_111);\n        wp::adj_add(var_108, var_109, adj_108, adj_109, adj_110);\n        wp::adj_mul(var_87, var_106, adj_87, adj_106, adj_108);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_107);\n        wp::adj_add(var_96, var_103, adj_96, adj_103, adj_105);\n        wp::adj_mul(var_104, var_102, adj_98, adj_102, adj_103);\n        wp::adj_float(var_101, adj_101, adj_102);\n        wp::adj_add(var_99, var_100, adj_99, adj_100, adj_101);\n        wp::adj_mul(var_87, var_97, adj_87, adj_97, adj_99);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_98);\n        wp::adj_add(var_86, var_94, adj_86, adj_94, adj_96);\n        wp::adj_mul(var_95, var_93, adj_89, adj_93, adj_94);\n        wp::adj_float(var_92, adj_92, adj_93);\n        wp::adj_add(var_90, var_91, adj_90, adj_91, adj_92);\n        wp::adj_mul(var_87, var_88, adj_87, adj_88, adj_90);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_89);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_77, var_84, adj_77, adj_84, adj_86);\n        wp::adj_mul(var_85, var_83, adj_79, adj_83, adj_84);\n        wp::adj_float(var_82, adj_82, adj_83);\n        wp::adj_add(var_80, var_81, adj_80, adj_81, adj_82);\n        wp::adj_mul(var_59, var_78, adj_59, adj_78, adj_80);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_79);\n        wp::adj_add(var_68, var_75, adj_68, adj_75, adj_77);\n        wp::adj_mul(var_76, var_74, adj_70, adj_74, adj_75);\n        wp::adj_float(var_73, adj_73, adj_74);\n        wp::adj_add(var_71, var_72, adj_71, adj_72, adj_73);\n        wp::adj_mul(var_59, var_69, adj_59, adj_69, adj_71);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_70);\n        wp::adj_add(var_58, var_66, adj_58, adj_66, adj_68);\n        wp::adj_mul(var_67, var_65, adj_61, adj_65, adj_66);\n        wp::adj_float(var_64, adj_64, adj_65);\n        wp::adj_add(var_62, var_63, adj_62, adj_63, adj_64);\n        wp::adj_mul(var_59, var_60, adj_59, adj_60, adj_62);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_61);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_49, var_56, adj_49, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_31, var_50, adj_31, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        wp::adj_add(var_40, var_47, adj_40, adj_47, adj_49);\n        wp::adj_mul(var_48, var_46, adj_42, adj_46, adj_47);\n        wp::adj_float(var_45, adj_45, adj_46);\n        wp::adj_add(var_43, var_44, adj_43, adj_44, adj_45);\n        wp::adj_mul(var_31, var_41, adj_31, adj_41, adj_43);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_42);\n        wp::adj_add(var_30, var_38, adj_30, adj_38, adj_40);\n        wp::adj_mul(var_39, var_37, adj_33, adj_37, adj_38);\n        wp::adj_float(var_36, adj_36, adj_37);\n        wp::adj_add(var_34, var_35, adj_34, adj_35, adj_36);\n        wp::adj_mul(var_31, var_32, adj_31, adj_32, adj_34);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_33);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        // adj: for i in range(5):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_iqazvz(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_iqazvz","mangled_name":"nested_iqazvz_6f34c9db","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_iqazvz(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(5):\n        for j in range(3):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"vec_bpzioj_15fcedbcf2","device":"cuda","category":"vector","description":"Vector op normalize on wp.vec4","arg_types":{"a":"wp.array(dtype=wp.vec4)","b":"wp.array(dtype=wp.vec4)","out":"wp.array(dtype=wp.vec4)"},"metadata":{"vec_type":"wp.vec4","operation":"normalize","seed":72},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_bpzioj_f4ed324d_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32> var_2;\n        wp::vec_t<4, wp::float32> var_3;\n        //---------\n        // forward\n        // def vec_bpzioj(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_bpzioj_f4ed324d_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32> var_2;\n        wp::vec_t<4, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<4, wp::float32> adj_1 = {};\n        wp::vec_t<4, wp::float32> adj_2 = {};\n        wp::vec_t<4, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def vec_bpzioj(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_normalize(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.normalize(a[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_bpzioj(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_bpzioj","mangled_name":"vec_bpzioj_f4ed324d","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec4f'>","b":"array<class 'warp._src.types.vec4f'>","out":"array<class 'warp._src.types.vec4f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_bpzioj(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):\n    tid = wp.tid()\n    out[tid] = wp.normalize(a[tid])\n"}
{"id":"scalar_hnolpm_40571f7399","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=5.06, offset=-0.49)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"*","scale":5.06,"offset":-0.49,"seed":73},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_hnolpm_dfe066ea_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_hnolpm(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_hnolpm_dfe066ea_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_hnolpm(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_mul(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] * scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_hnolpm(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_hnolpm","mangled_name":"scalar_hnolpm_dfe066ea","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_hnolpm(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] * scale) + offset\n"}
{"id":"arith_wncdiw_5883ef1f27","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 5 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":5,"seed":74},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_wncdiw_9e95cd19_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32* var_7;\n        const wp::float32 var_8 = 0.0001;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32* var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        //---------\n        // forward\n        // def arith_wncdiw(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.sin(a[tid])                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        // var_1 = wp.min(var_0, b[tid])                                                          <L 7>\n        var_4 = wp::address(var_b, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::min(var_2, var_6);\n        // var_2 = var_1 / (b[tid] + 0.0001)                                                      <L 8>\n        var_7 = wp::address(var_b, var_0);\n        var_10 = wp::load(var_7);\n        var_9 = wp::add(var_10, var_8);\n        var_11 = wp::div(var_5, var_9);\n        // var_3 = wp.sqrt(wp.abs(var_2))                                                         <L 9>\n        var_12 = wp::abs(var_11);\n        var_13 = wp::sqrt(var_12);\n        // var_4 = var_3 + b[tid]                                                                 <L 10>\n        var_14 = wp::address(var_b, var_0);\n        var_16 = wp::load(var_14);\n        var_15 = wp::add(var_13, var_16);\n        // out[tid] = var_4                                                                       <L 11>\n        wp::array_store(var_out, var_0, var_15);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_wncdiw_9e95cd19_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32* var_7;\n        const wp::float32 var_8 = 0.0001;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32* var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        //---------\n        // forward\n        // def arith_wncdiw(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.sin(a[tid])                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        // var_1 = wp.min(var_0, b[tid])                                                          <L 7>\n        var_4 = wp::address(var_b, var_0);\n        var_6 = wp::load(var_4);\n        var_5 = wp::min(var_2, var_6);\n        // var_2 = var_1 / (b[tid] + 0.0001)                                                      <L 8>\n        var_7 = wp::address(var_b, var_0);\n        var_10 = wp::load(var_7);\n        var_9 = wp::add(var_10, var_8);\n        var_11 = wp::div(var_5, var_9);\n        // var_3 = wp.sqrt(wp.abs(var_2))                                                         <L 9>\n        var_12 = wp::abs(var_11);\n        var_13 = wp::sqrt(var_12);\n        // var_4 = var_3 + b[tid]                                                                 <L 10>\n        var_14 = wp::address(var_b, var_0);\n        var_16 = wp::load(var_14);\n        var_15 = wp::add(var_13, var_16);\n        // out[tid] = var_4                                                                       <L 11>\n        // wp::array_store(var_out, var_0, var_15);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_15, adj_out, adj_0, adj_15);\n        // adj: out[tid] = var_4                                                                  <L 11>\n        wp::adj_add(var_13, var_16, adj_13, adj_14, adj_15);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_14);\n        // adj: var_4 = var_3 + b[tid]                                                            <L 10>\n        wp::adj_sqrt(var_12, var_13, adj_12, adj_13);\n        wp::adj_abs(var_11, adj_11, adj_12);\n        // adj: var_3 = wp.sqrt(wp.abs(var_2))                                                    <L 9>\n        wp::adj_div(var_5, var_9, var_11, adj_5, adj_9, adj_11);\n        wp::adj_add(var_10, var_8, adj_7, adj_8, adj_9);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_7);\n        // adj: var_2 = var_1 / (b[tid] + 0.0001)                                                 <L 8>\n        wp::adj_min(var_2, var_6, adj_2, adj_4, adj_5);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n        // adj: var_1 = wp.min(var_0, b[tid])                                                     <L 7>\n        wp::adj_sin(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = wp.sin(a[tid])                                                            <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_wncdiw(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_wncdiw","mangled_name":"arith_wncdiw_9e95cd19","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_wncdiw(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = wp.sin(a[tid])\n    var_1 = wp.min(var_0, b[tid])\n    var_2 = var_1 / (b[tid] + 0.0001)\n    var_3 = wp.sqrt(wp.abs(var_2))\n    var_4 = var_3 + b[tid]\n    out[tid] = var_4\n"}
{"id":"combined_llbtrr_de9e6e5634","device":"cuda","category":"combined","description":"Combined pattern (loop+cond+wp.sqrt)","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"iterations":10,"threshold":1.64,"function":"wp.sqrt","seed":75},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void combined_llbtrr_bf2b8c47_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.64;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 1.64;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 1.64;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 1.64;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 1.64;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 1.64;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        const wp::int32 var_99 = 6;\n        wp::float32* var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::float32 var_104 = 1.64;\n        bool var_105;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32* var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 7;\n        wp::float32* var_116;\n        wp::float32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        const wp::float32 var_120 = 1.64;\n        bool var_121;\n        wp::float32* var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        wp::float32* var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 8;\n        wp::float32* var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32 var_135;\n        const wp::float32 var_136 = 1.64;\n        bool var_137;\n        wp::float32* var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32* var_143;\n        wp::float32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        const wp::int32 var_147 = 9;\n        wp::float32* var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        const wp::float32 var_152 = 1.64;\n        bool var_153;\n        wp::float32* var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        wp::float32* var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        wp::float32 var_162;\n        //---------\n        // forward\n        // def combined_llbtrr(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(10):                                                                    <L 7>\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::sqrt(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::sqrt(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::sqrt(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::sqrt(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::sqrt(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::sqrt(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_100 = wp::address(var_a, var_0);\n        var_101 = wp::float(var_99);\n        var_103 = wp::load(var_100);\n        var_102 = wp::mul(var_103, var_101);\n        var_105 = (var_102 > var_104);\n        if (var_105) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_106 = wp::address(var_b, var_0);\n            var_108 = wp::load(var_106);\n            var_107 = wp::sqrt(var_108);\n            var_109 = wp::add(var_98, var_107);\n        }\n        var_110 = wp::where(var_105, var_109, var_98);\n        if (!var_105) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_111 = wp::address(var_b, var_0);\n            var_113 = wp::load(var_111);\n            var_112 = wp::add(var_110, var_113);\n        }\n        var_114 = wp::where(var_105, var_110, var_112);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_116 = wp::address(var_a, var_0);\n        var_117 = wp::float(var_115);\n        var_119 = wp::load(var_116);\n        var_118 = wp::mul(var_119, var_117);\n        var_121 = (var_118 > var_120);\n        if (var_121) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_122 = wp::address(var_b, var_0);\n            var_124 = wp::load(var_122);\n            var_123 = wp::sqrt(var_124);\n            var_125 = wp::add(var_114, var_123);\n        }\n        var_126 = wp::where(var_121, var_125, var_114);\n        if (!var_121) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_127 = wp::address(var_b, var_0);\n            var_129 = wp::load(var_127);\n            var_128 = wp::add(var_126, var_129);\n        }\n        var_130 = wp::where(var_121, var_126, var_128);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_132 = wp::address(var_a, var_0);\n        var_133 = wp::float(var_131);\n        var_135 = wp::load(var_132);\n        var_134 = wp::mul(var_135, var_133);\n        var_137 = (var_134 > var_136);\n        if (var_137) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_138 = wp::address(var_b, var_0);\n            var_140 = wp::load(var_138);\n            var_139 = wp::sqrt(var_140);\n            var_141 = wp::add(var_130, var_139);\n        }\n        var_142 = wp::where(var_137, var_141, var_130);\n        if (!var_137) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_143 = wp::address(var_b, var_0);\n            var_145 = wp::load(var_143);\n            var_144 = wp::add(var_142, var_145);\n        }\n        var_146 = wp::where(var_137, var_142, var_144);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_148 = wp::address(var_a, var_0);\n        var_149 = wp::float(var_147);\n        var_151 = wp::load(var_148);\n        var_150 = wp::mul(var_151, var_149);\n        var_153 = (var_150 > var_152);\n        if (var_153) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_154 = wp::address(var_b, var_0);\n            var_156 = wp::load(var_154);\n            var_155 = wp::sqrt(var_156);\n            var_157 = wp::add(var_146, var_155);\n        }\n        var_158 = wp::where(var_153, var_157, var_146);\n        if (!var_153) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_159 = wp::address(var_b, var_0);\n            var_161 = wp::load(var_159);\n            var_160 = wp::add(var_158, var_161);\n        }\n        var_162 = wp::where(var_153, var_158, var_160);\n        // out[tid] = acc                                                                         <L 12>\n        wp::array_store(var_out, var_0, var_162);\n    }\n}\n\n\n\nextern \"C\" __global__ void combined_llbtrr_bf2b8c47_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.64;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 1.64;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 1.64;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 1.64;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 1.64;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 1.64;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        const wp::int32 var_99 = 6;\n        wp::float32* var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::float32 var_104 = 1.64;\n        bool var_105;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32* var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 7;\n        wp::float32* var_116;\n        wp::float32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        const wp::float32 var_120 = 1.64;\n        bool var_121;\n        wp::float32* var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        wp::float32* var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 8;\n        wp::float32* var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32 var_135;\n        const wp::float32 var_136 = 1.64;\n        bool var_137;\n        wp::float32* var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32* var_143;\n        wp::float32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        const wp::int32 var_147 = 9;\n        wp::float32* var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        const wp::float32 var_152 = 1.64;\n        bool var_153;\n        wp::float32* var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        wp::float32* var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        wp::float32 var_162;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        bool adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        bool adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        bool adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::int32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::float32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        bool adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::float32 adj_80 = {};\n        wp::float32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::int32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::float32 adj_88 = {};\n        bool adj_89 = {};\n        wp::float32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::float32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        bool adj_105 = {};\n        wp::float32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::float32 adj_108 = {};\n        wp::float32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::float32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::float32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        bool adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::float32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::float32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::int32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::float32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::float32 adj_136 = {};\n        bool adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::float32 adj_143 = {};\n        wp::float32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        wp::float32 adj_146 = {};\n        wp::int32 adj_147 = {};\n        wp::float32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::float32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::float32 adj_152 = {};\n        bool adj_153 = {};\n        wp::float32 adj_154 = {};\n        wp::float32 adj_155 = {};\n        wp::float32 adj_156 = {};\n        wp::float32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::float32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::float32 adj_161 = {};\n        wp::float32 adj_162 = {};\n        //---------\n        // forward\n        // def combined_llbtrr(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(10):                                                                    <L 7>\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::sqrt(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::sqrt(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::sqrt(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::sqrt(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::sqrt(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::sqrt(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_100 = wp::address(var_a, var_0);\n        var_101 = wp::float(var_99);\n        var_103 = wp::load(var_100);\n        var_102 = wp::mul(var_103, var_101);\n        var_105 = (var_102 > var_104);\n        if (var_105) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_106 = wp::address(var_b, var_0);\n            var_108 = wp::load(var_106);\n            var_107 = wp::sqrt(var_108);\n            var_109 = wp::add(var_98, var_107);\n        }\n        var_110 = wp::where(var_105, var_109, var_98);\n        if (!var_105) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_111 = wp::address(var_b, var_0);\n            var_113 = wp::load(var_111);\n            var_112 = wp::add(var_110, var_113);\n        }\n        var_114 = wp::where(var_105, var_110, var_112);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_116 = wp::address(var_a, var_0);\n        var_117 = wp::float(var_115);\n        var_119 = wp::load(var_116);\n        var_118 = wp::mul(var_119, var_117);\n        var_121 = (var_118 > var_120);\n        if (var_121) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_122 = wp::address(var_b, var_0);\n            var_124 = wp::load(var_122);\n            var_123 = wp::sqrt(var_124);\n            var_125 = wp::add(var_114, var_123);\n        }\n        var_126 = wp::where(var_121, var_125, var_114);\n        if (!var_121) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_127 = wp::address(var_b, var_0);\n            var_129 = wp::load(var_127);\n            var_128 = wp::add(var_126, var_129);\n        }\n        var_130 = wp::where(var_121, var_126, var_128);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_132 = wp::address(var_a, var_0);\n        var_133 = wp::float(var_131);\n        var_135 = wp::load(var_132);\n        var_134 = wp::mul(var_135, var_133);\n        var_137 = (var_134 > var_136);\n        if (var_137) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_138 = wp::address(var_b, var_0);\n            var_140 = wp::load(var_138);\n            var_139 = wp::sqrt(var_140);\n            var_141 = wp::add(var_130, var_139);\n        }\n        var_142 = wp::where(var_137, var_141, var_130);\n        if (!var_137) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_143 = wp::address(var_b, var_0);\n            var_145 = wp::load(var_143);\n            var_144 = wp::add(var_142, var_145);\n        }\n        var_146 = wp::where(var_137, var_142, var_144);\n        // if a[tid] * float(i) > 1.64:                                                           <L 8>\n        var_148 = wp::address(var_a, var_0);\n        var_149 = wp::float(var_147);\n        var_151 = wp::load(var_148);\n        var_150 = wp::mul(var_151, var_149);\n        var_153 = (var_150 > var_152);\n        if (var_153) {\n            // acc = acc + wp.sqrt(b[tid])                                                        <L 9>\n            var_154 = wp::address(var_b, var_0);\n            var_156 = wp::load(var_154);\n            var_155 = wp::sqrt(var_156);\n            var_157 = wp::add(var_146, var_155);\n        }\n        var_158 = wp::where(var_153, var_157, var_146);\n        if (!var_153) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_159 = wp::address(var_b, var_0);\n            var_161 = wp::load(var_159);\n            var_160 = wp::add(var_158, var_161);\n        }\n        var_162 = wp::where(var_153, var_158, var_160);\n        // out[tid] = acc                                                                         <L 12>\n        // wp::array_store(var_out, var_0, var_162);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_162, adj_out, adj_0, adj_162);\n        // adj: out[tid] = acc                                                                    <L 12>\n        wp::adj_where(var_153, var_158, var_160, adj_153, adj_158, adj_160, adj_162);\n        if (!var_153) {\n            wp::adj_add(var_158, var_161, adj_158, adj_159, adj_160);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_159);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_153, var_157, var_146, adj_153, adj_157, adj_146, adj_158);\n        if (var_153) {\n            wp::adj_add(var_146, var_155, adj_146, adj_155, adj_157);\n            wp::adj_sqrt(var_156, var_155, adj_154, adj_155);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_154);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_151, var_149, adj_148, adj_149, adj_150);\n        wp::adj_float(var_147, adj_147, adj_149);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_148);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_137, var_142, var_144, adj_137, adj_142, adj_144, adj_146);\n        if (!var_137) {\n            wp::adj_add(var_142, var_145, adj_142, adj_143, adj_144);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_143);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_137, var_141, var_130, adj_137, adj_141, adj_130, adj_142);\n        if (var_137) {\n            wp::adj_add(var_130, var_139, adj_130, adj_139, adj_141);\n            wp::adj_sqrt(var_140, var_139, adj_138, adj_139);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_138);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_135, var_133, adj_132, adj_133, adj_134);\n        wp::adj_float(var_131, adj_131, adj_133);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_132);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_121, var_126, var_128, adj_121, adj_126, adj_128, adj_130);\n        if (!var_121) {\n            wp::adj_add(var_126, var_129, adj_126, adj_127, adj_128);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_127);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_121, var_125, var_114, adj_121, adj_125, adj_114, adj_126);\n        if (var_121) {\n            wp::adj_add(var_114, var_123, adj_114, adj_123, adj_125);\n            wp::adj_sqrt(var_124, var_123, adj_122, adj_123);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_122);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_119, var_117, adj_116, adj_117, adj_118);\n        wp::adj_float(var_115, adj_115, adj_117);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_116);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_105, var_110, var_112, adj_105, adj_110, adj_112, adj_114);\n        if (!var_105) {\n            wp::adj_add(var_110, var_113, adj_110, adj_111, adj_112);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_111);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_105, var_109, var_98, adj_105, adj_109, adj_98, adj_110);\n        if (var_105) {\n            wp::adj_add(var_98, var_107, adj_98, adj_107, adj_109);\n            wp::adj_sqrt(var_108, var_107, adj_106, adj_107);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_106);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_103, var_101, adj_100, adj_101, adj_102);\n        wp::adj_float(var_99, adj_99, adj_101);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_100);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_89, var_94, var_96, adj_89, adj_94, adj_96, adj_98);\n        if (!var_89) {\n            wp::adj_add(var_94, var_97, adj_94, adj_95, adj_96);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_95);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_89, var_93, var_82, adj_89, adj_93, adj_82, adj_94);\n        if (var_89) {\n            wp::adj_add(var_82, var_91, adj_82, adj_91, adj_93);\n            wp::adj_sqrt(var_92, var_91, adj_90, adj_91);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_90);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_87, var_85, adj_84, adj_85, adj_86);\n        wp::adj_float(var_83, adj_83, adj_85);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_84);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_73, var_78, var_80, adj_73, adj_78, adj_80, adj_82);\n        if (!var_73) {\n            wp::adj_add(var_78, var_81, adj_78, adj_79, adj_80);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_79);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_73, var_77, var_66, adj_73, adj_77, adj_66, adj_78);\n        if (var_73) {\n            wp::adj_add(var_66, var_75, adj_66, adj_75, adj_77);\n            wp::adj_sqrt(var_76, var_75, adj_74, adj_75);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_74);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_71, var_69, adj_68, adj_69, adj_70);\n        wp::adj_float(var_67, adj_67, adj_69);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_68);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_57, var_62, var_64, adj_57, adj_62, adj_64, adj_66);\n        if (!var_57) {\n            wp::adj_add(var_62, var_65, adj_62, adj_63, adj_64);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_63);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_57, var_61, var_50, adj_57, adj_61, adj_50, adj_62);\n        if (var_57) {\n            wp::adj_add(var_50, var_59, adj_50, adj_59, adj_61);\n            wp::adj_sqrt(var_60, var_59, adj_58, adj_59);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_58);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_55, var_53, adj_52, adj_53, adj_54);\n        wp::adj_float(var_51, adj_51, adj_53);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_41, var_46, var_48, adj_41, adj_46, adj_48, adj_50);\n        if (!var_41) {\n            wp::adj_add(var_46, var_49, adj_46, adj_47, adj_48);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_47);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_41, var_45, var_34, adj_41, adj_45, adj_34, adj_46);\n        if (var_41) {\n            wp::adj_add(var_34, var_43, adj_34, adj_43, adj_45);\n            wp::adj_sqrt(var_44, var_43, adj_42, adj_43);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_42);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_39, var_37, adj_36, adj_37, adj_38);\n        wp::adj_float(var_35, adj_35, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_25, var_30, var_32, adj_25, adj_30, adj_32, adj_34);\n        if (!var_25) {\n            wp::adj_add(var_30, var_33, adj_30, adj_31, adj_32);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_31);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_25, var_29, var_18, adj_25, adj_29, adj_18, adj_30);\n        if (var_25) {\n            wp::adj_add(var_18, var_27, adj_18, adj_27, adj_29);\n            wp::adj_sqrt(var_28, var_27, adj_26, adj_27);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_26);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_23, var_21, adj_20, adj_21, adj_22);\n        wp::adj_float(var_19, adj_19, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        wp::adj_where(var_9, var_14, var_16, adj_9, adj_14, adj_16, adj_18);\n        if (!var_9) {\n            wp::adj_add(var_14, var_17, adj_14, adj_15, adj_16);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_15);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_9, var_13, var_2, adj_9, adj_13, adj_2, adj_14);\n        if (var_9) {\n            wp::adj_add(var_2, var_11, adj_2, adj_11, adj_13);\n            wp::adj_sqrt(var_12, var_11, adj_10, adj_11);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_10);\n            // adj: acc = acc + wp.sqrt(b[tid])                                                   <L 9>\n        }\n        wp::adj_mul(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_float(var_3, adj_3, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: if a[tid] * float(i) > 1.64:                                                      <L 8>\n        // adj: for i in range(10):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: acc = float(0.0)                                                                  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def combined_llbtrr(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"combined_llbtrr","mangled_name":"combined_llbtrr_bf2b8c47","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef combined_llbtrr(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    acc = float(0.0)\n    for i in range(10):\n        if a[tid] * float(i) > 1.64:\n            acc = acc + wp.sqrt(b[tid])\n        else:\n            acc = acc + b[tid]\n    out[tid] = acc\n"}
{"id":"vec_jyfhkg_056f2d2921","device":"cuda","category":"vector","description":"Vector op cross on wp.vec3","arg_types":{"a":"wp.array(dtype=wp.vec3)","b":"wp.array(dtype=wp.vec3)","out":"wp.array(dtype=wp.vec3)"},"metadata":{"vec_type":"wp.vec3","operation":"cross","seed":76},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_jyfhkg_4bee2b71_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::vec_t<3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // forward\n        // def vec_jyfhkg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cross(a[tid], b[tid])                                                    <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::cross(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_jyfhkg_4bee2b71_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::vec_t<3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<3, wp::float32> adj_1 = {};\n        wp::vec_t<3, wp::float32> adj_2 = {};\n        wp::vec_t<3, wp::float32> adj_3 = {};\n        wp::vec_t<3, wp::float32> adj_4 = {};\n        wp::vec_t<3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def vec_jyfhkg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cross(a[tid], b[tid])                                                    <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::cross(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_cross(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.cross(a[tid], b[tid])                                               <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_jyfhkg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_jyfhkg","mangled_name":"vec_jyfhkg_4bee2b71","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec3f'>","b":"array<class 'warp._src.types.vec3f'>","out":"array<class 'warp._src.types.vec3f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_jyfhkg(a: wp.array(dtype=wp.vec3), b: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):\n    tid = wp.tid()\n    out[tid] = wp.cross(a[tid], b[tid])\n"}
{"id":"multicond_uigvcm_4c89061578","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: 0.58, 3.83)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":0.58,"threshold2":3.83,"seed":77},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_uigvcm_713e25f6_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.58;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 3.83;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // forward\n        // def multicond_uigvcm(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 0.58:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 3.83:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                wp::array_store(var_out, var_0, var_13);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_uigvcm_713e25f6_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.58;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 3.83;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        bool adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        //---------\n        // forward\n        // def multicond_uigvcm(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 0.58:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            // wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 3.83:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                // wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                // wp::array_store(var_out, var_0, var_13);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_5) {\n            if (!var_9) {\n                wp::adj_array_store(var_out, var_0, var_13, adj_out, adj_0, adj_13);\n                wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_9) {\n                wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n                wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 3.83:                                                              <L 9>\n        }\n        if (var_5) {\n            wp::adj_array_store(var_out, var_0, var_7, adj_out, adj_0, adj_7);\n            wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < 0.58:                                                                    <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_uigvcm(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_uigvcm","mangled_name":"multicond_uigvcm_713e25f6","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_uigvcm(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < 0.58:\n        out[tid] = val * 0.5\n    elif val < 3.83:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"mat_vcysgl_120e9534a9","device":"cuda","category":"matrix","description":"Matrix transpose (wp.mat22)","arg_types":{"m":"wp.array(dtype=wp.mat22)","out":"wp.array(dtype=wp.mat22)"},"metadata":{"mat_type":"wp.mat22","operation":"transpose","seed":78},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_vcysgl_9ffdf7cd_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::mat_t<2, 2, wp::float32> var_2;\n        wp::mat_t<2, 2, wp::float32> var_3;\n        //---------\n        // forward\n        // def mat_vcysgl(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.transpose(m[tid])                                                        <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::transpose(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_vcysgl_9ffdf7cd_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_m,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::mat_t<2, 2, wp::float32> var_2;\n        wp::mat_t<2, 2, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<2, 2, wp::float32> adj_1 = {};\n        wp::mat_t<2, 2, wp::float32> adj_2 = {};\n        wp::mat_t<2, 2, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def mat_vcysgl(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.transpose(m[tid])                                                        <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::transpose(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_transpose(var_3, adj_1, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = wp.transpose(m[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_vcysgl(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_vcysgl","mangled_name":"mat_vcysgl_9ffdf7cd","device":"cuda","arg_names":["m","out"],"arg_types":{"m":"array<class 'warp._src.types.mat22f'>","out":"array<class 'warp._src.types.mat22f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_vcysgl(m: wp.array(dtype=wp.mat22), out: wp.array(dtype=wp.mat22)):\n    tid = wp.tid()\n    out[tid] = wp.transpose(m[tid])\n"}
{"id":"mat_djegse_3281c5b0fa","device":"cuda","category":"matrix","description":"Matrix-vector multiply (wp.mat33 * wp.vec3)","arg_types":{"m":"wp.array(dtype=wp.mat33)","v":"wp.array(dtype=wp.vec3)","out":"wp.array(dtype=wp.vec3)"},"metadata":{"mat_type":"wp.mat33","operation":"mat_vec","seed":79},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_djegse_ebfebec4_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_djegse(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_djegse_ebfebec4_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<3, 3, wp::float32> adj_1 = {};\n        wp::vec_t<3, wp::float32> adj_2 = {};\n        wp::vec_t<3, wp::float32> adj_3 = {};\n        wp::mat_t<3, 3, wp::float32> adj_4 = {};\n        wp::vec_t<3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_djegse(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_v, var_0, adj_v, adj_0, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = m[tid] * v[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_djegse(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_djegse","mangled_name":"mat_djegse_ebfebec4","device":"cuda","arg_names":["m","v","out"],"arg_types":{"m":"array<class 'warp._src.types.mat33f'>","v":"array<class 'warp._src.types.vec3f'>","out":"array<class 'warp._src.types.vec3f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_djegse(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):\n    tid = wp.tid()\n    out[tid] = m[tid] * v[tid]\n"}
{"id":"ctrl_hosyjn_1cb9468010","device":"cuda","category":"control_flow","description":"Step function","arg_types":{"a":"wp.array(dtype=float)","threshold":"float","out":"wp.array(dtype=float)"},"metadata":{"pattern":"step","seed":80},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_hosyjn_647b5958_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::float32 var_threshold,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        bool var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        const wp::float32 var_5 = 0.0;\n        //---------\n        // forward\n        // def ctrl_hosyjn(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // if a[tid] > threshold:                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = (var_3 > var_threshold);\n        if (var_2) {\n            // out[tid] = 1.0                                                                     <L 7>\n            wp::array_store(var_out, var_0, var_4);\n        }\n        if (!var_2) {\n            // out[tid] = 0.0                                                                     <L 9>\n            wp::array_store(var_out, var_0, var_5);\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_hosyjn_647b5958_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::float32 var_threshold,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::float32 adj_threshold,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        bool var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 1.0;\n        const wp::float32 var_5 = 0.0;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        bool adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        //---------\n        // forward\n        // def ctrl_hosyjn(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // if a[tid] > threshold:                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = (var_3 > var_threshold);\n        if (var_2) {\n            // out[tid] = 1.0                                                                     <L 7>\n            // wp::array_store(var_out, var_0, var_4);\n        }\n        if (!var_2) {\n            // out[tid] = 0.0                                                                     <L 9>\n            // wp::array_store(var_out, var_0, var_5);\n        }\n        //---------\n        // reverse\n        if (!var_2) {\n            wp::adj_array_store(var_out, var_0, var_5, adj_out, adj_0, adj_5);\n            // adj: out[tid] = 0.0                                                                <L 9>\n        }\n        if (var_2) {\n            wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n            // adj: out[tid] = 1.0                                                                <L 7>\n        }\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: if a[tid] > threshold:                                                            <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_hosyjn(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_hosyjn","mangled_name":"ctrl_hosyjn_647b5958","device":"cuda","arg_names":["a","threshold","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","threshold":"<class 'float'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_hosyjn(a: wp.array(dtype=float), threshold: float, out: wp.array(dtype=float)):\n    tid = wp.tid()\n    if a[tid] > threshold:\n        out[tid] = 1.0\n    else:\n        out[tid] = 0.0\n"}
{"id":"arith_nlojve_371b37e4fd","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 9 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":9,"seed":81},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_nlojve_4aeb3cee_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 1.0;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        wp::float32* var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        //---------\n        // forward\n        // def arith_nlojve(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.min(a[tid], b[tid])                                                         <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::min(var_4, var_5);\n        // var_1 = wp.sqrt(wp.abs(var_0))                                                         <L 7>\n        var_6 = wp::abs(var_3);\n        var_7 = wp::sqrt(var_6);\n        // var_2 = wp.sqrt(wp.abs(var_1))                                                         <L 8>\n        var_8 = wp::abs(var_7);\n        var_9 = wp::sqrt(var_8);\n        // var_3 = wp.exp(var_2)                                                                  <L 9>\n        var_10 = wp::exp(var_9);\n        // var_4 = -var_3                                                                         <L 10>\n        var_11 = wp::neg(var_10);\n        // var_5 = wp.log(wp.abs(var_4) + 1.0)                                                    <L 11>\n        var_12 = wp::abs(var_11);\n        var_14 = wp::add(var_12, var_13);\n        var_15 = wp::log(var_14);\n        // var_6 = wp.cos(var_5)                                                                  <L 12>\n        var_16 = wp::cos(var_15);\n        // var_7 = var_6 - b[tid]                                                                 <L 13>\n        var_17 = wp::address(var_b, var_0);\n        var_19 = wp::load(var_17);\n        var_18 = wp::sub(var_16, var_19);\n        // var_8 = wp.max(var_7, b[tid])                                                          <L 14>\n        var_20 = wp::address(var_b, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::max(var_18, var_22);\n        // out[tid] = var_8                                                                       <L 15>\n        wp::array_store(var_out, var_0, var_21);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_nlojve_4aeb3cee_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 1.0;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        wp::float32* var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        //---------\n        // forward\n        // def arith_nlojve(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.min(a[tid], b[tid])                                                         <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::min(var_4, var_5);\n        // var_1 = wp.sqrt(wp.abs(var_0))                                                         <L 7>\n        var_6 = wp::abs(var_3);\n        var_7 = wp::sqrt(var_6);\n        // var_2 = wp.sqrt(wp.abs(var_1))                                                         <L 8>\n        var_8 = wp::abs(var_7);\n        var_9 = wp::sqrt(var_8);\n        // var_3 = wp.exp(var_2)                                                                  <L 9>\n        var_10 = wp::exp(var_9);\n        // var_4 = -var_3                                                                         <L 10>\n        var_11 = wp::neg(var_10);\n        // var_5 = wp.log(wp.abs(var_4) + 1.0)                                                    <L 11>\n        var_12 = wp::abs(var_11);\n        var_14 = wp::add(var_12, var_13);\n        var_15 = wp::log(var_14);\n        // var_6 = wp.cos(var_5)                                                                  <L 12>\n        var_16 = wp::cos(var_15);\n        // var_7 = var_6 - b[tid]                                                                 <L 13>\n        var_17 = wp::address(var_b, var_0);\n        var_19 = wp::load(var_17);\n        var_18 = wp::sub(var_16, var_19);\n        // var_8 = wp.max(var_7, b[tid])                                                          <L 14>\n        var_20 = wp::address(var_b, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::max(var_18, var_22);\n        // out[tid] = var_8                                                                       <L 15>\n        // wp::array_store(var_out, var_0, var_21);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_21, adj_out, adj_0, adj_21);\n        // adj: out[tid] = var_8                                                                  <L 15>\n        wp::adj_max(var_18, var_22, adj_18, adj_20, adj_21);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_20);\n        // adj: var_8 = wp.max(var_7, b[tid])                                                     <L 14>\n        wp::adj_sub(var_16, var_19, adj_16, adj_17, adj_18);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_17);\n        // adj: var_7 = var_6 - b[tid]                                                            <L 13>\n        wp::adj_cos(var_15, adj_15, adj_16);\n        // adj: var_6 = wp.cos(var_5)                                                             <L 12>\n        wp::adj_log(var_14, adj_14, adj_15);\n        wp::adj_add(var_12, var_13, adj_12, adj_13, adj_14);\n        wp::adj_abs(var_11, adj_11, adj_12);\n        // adj: var_5 = wp.log(wp.abs(var_4) + 1.0)                                               <L 11>\n        wp::adj_neg(var_10, adj_10, adj_11);\n        // adj: var_4 = -var_3                                                                    <L 10>\n        wp::adj_exp(var_9, var_10, adj_9, adj_10);\n        // adj: var_3 = wp.exp(var_2)                                                             <L 9>\n        wp::adj_sqrt(var_8, var_9, adj_8, adj_9);\n        wp::adj_abs(var_7, adj_7, adj_8);\n        // adj: var_2 = wp.sqrt(wp.abs(var_1))                                                    <L 8>\n        wp::adj_sqrt(var_6, var_7, adj_6, adj_7);\n        wp::adj_abs(var_3, adj_3, adj_6);\n        // adj: var_1 = wp.sqrt(wp.abs(var_0))                                                    <L 7>\n        wp::adj_min(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = wp.min(a[tid], b[tid])                                                    <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_nlojve(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_nlojve","mangled_name":"arith_nlojve_4aeb3cee","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_nlojve(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = wp.min(a[tid], b[tid])\n    var_1 = wp.sqrt(wp.abs(var_0))\n    var_2 = wp.sqrt(wp.abs(var_1))\n    var_3 = wp.exp(var_2)\n    var_4 = -var_3\n    var_5 = wp.log(wp.abs(var_4) + 1.0)\n    var_6 = wp.cos(var_5)\n    var_7 = var_6 - b[tid]\n    var_8 = wp.max(var_7, b[tid])\n    out[tid] = var_8\n"}
{"id":"mat_dmnzvu_91e579b7f0","device":"cuda","category":"matrix","description":"Matrix-matrix multiply (wp.mat44)","arg_types":{"a":"wp.array(dtype=wp.mat44)","b":"wp.array(dtype=wp.mat44)","out":"wp.array(dtype=wp.mat44)"},"metadata":{"mat_type":"wp.mat44","operation":"mat_mat","seed":82},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_dmnzvu_cd65463d_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<4, 4, wp::float32>* var_1;\n        wp::mat_t<4, 4, wp::float32>* var_2;\n        wp::mat_t<4, 4, wp::float32> var_3;\n        wp::mat_t<4, 4, wp::float32> var_4;\n        wp::mat_t<4, 4, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_dmnzvu(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_dmnzvu_cd65463d_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<4, 4, wp::float32>* var_1;\n        wp::mat_t<4, 4, wp::float32>* var_2;\n        wp::mat_t<4, 4, wp::float32> var_3;\n        wp::mat_t<4, 4, wp::float32> var_4;\n        wp::mat_t<4, 4, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<4, 4, wp::float32> adj_1 = {};\n        wp::mat_t<4, 4, wp::float32> adj_2 = {};\n        wp::mat_t<4, 4, wp::float32> adj_3 = {};\n        wp::mat_t<4, 4, wp::float32> adj_4 = {};\n        wp::mat_t<4, 4, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_dmnzvu(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = a[tid] * b[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_dmnzvu(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_dmnzvu","mangled_name":"mat_dmnzvu_cd65463d","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.mat44f'>","b":"array<class 'warp._src.types.mat44f'>","out":"array<class 'warp._src.types.mat44f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_dmnzvu(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):\n    tid = wp.tid()\n    out[tid] = a[tid] * b[tid]\n"}
{"id":"mat_mwcjbq_694b389ca1","device":"cuda","category":"matrix","description":"Matrix-vector multiply (wp.mat22 * wp.vec2)","arg_types":{"m":"wp.array(dtype=wp.mat22)","v":"wp.array(dtype=wp.vec2)","out":"wp.array(dtype=wp.vec2)"},"metadata":{"mat_type":"wp.mat22","operation":"mat_vec","seed":83},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_mwcjbq_7c21647a_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32>* var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        wp::mat_t<2, 2, wp::float32> var_4;\n        wp::vec_t<2, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_mwcjbq(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_mwcjbq_7c21647a_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<2, 2, wp::float32>> adj_m,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_v,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<2, 2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32>* var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        wp::mat_t<2, 2, wp::float32> var_4;\n        wp::vec_t<2, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<2, 2, wp::float32> adj_1 = {};\n        wp::vec_t<2, wp::float32> adj_2 = {};\n        wp::vec_t<2, wp::float32> adj_3 = {};\n        wp::mat_t<2, 2, wp::float32> adj_4 = {};\n        wp::vec_t<2, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_mwcjbq(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_v, var_0, adj_v, adj_0, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = m[tid] * v[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_mwcjbq(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_mwcjbq","mangled_name":"mat_mwcjbq_7c21647a","device":"cuda","arg_names":["m","v","out"],"arg_types":{"m":"array<class 'warp._src.types.mat22f'>","v":"array<class 'warp._src.types.vec2f'>","out":"array<class 'warp._src.types.vec2f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_mwcjbq(m: wp.array(dtype=wp.mat22), v: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):\n    tid = wp.tid()\n    out[tid] = m[tid] * v[tid]\n"}
{"id":"math_txaazi_b4705ec643","device":"cuda","category":"math","description":"Math chain: sin, log, cos","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["sin","log","cos"],"seed":84},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_txaazi_b1ac5e67_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        const wp::float32 var_5 = 1.0;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // forward\n        // def math_txaazi(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cos(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_6 = wp::add(var_4, var_5);\n        var_7 = wp::log(var_6);\n        var_8 = wp::cos(var_7);\n        wp::array_store(var_out, var_0, var_8);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_txaazi_b1ac5e67_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        const wp::float32 var_5 = 1.0;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        //---------\n        // forward\n        // def math_txaazi(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cos(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))                                <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_6 = wp::add(var_4, var_5);\n        var_7 = wp::log(var_6);\n        var_8 = wp::cos(var_7);\n        // wp::array_store(var_out, var_0, var_8);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n        wp::adj_cos(var_7, adj_7, adj_8);\n        wp::adj_log(var_6, adj_6, adj_7);\n        wp::adj_add(var_4, var_5, adj_4, adj_5, adj_6);\n        wp::adj_abs(var_2, adj_2, adj_4);\n        wp::adj_sin(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.cos(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))                           <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_txaazi(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_txaazi","mangled_name":"math_txaazi_b1ac5e67","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_txaazi(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.cos(wp.log(wp.abs(wp.sin(a[tid])) + 1.0))\n"}
{"id":"atom_fpcxel_c567526760","device":"cuda","category":"atomic","description":"Atomic min reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"min","seed":85},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_fpcxel_309353e7_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_fpcxel(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_min(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_fpcxel_309353e7_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_fpcxel(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_min(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_min(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_min(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_fpcxel(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_fpcxel","mangled_name":"atom_fpcxel_309353e7","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_fpcxel(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_min(result, 0, values[tid])\n"}
{"id":"scalar_uaviab_1a2d20af0a","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=7.43, offset=-1.96)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"*","scale":7.43,"offset":-1.96,"seed":86},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_uaviab_da338fd0_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_uaviab(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_uaviab_da338fd0_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_uaviab(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_mul(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] * scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_uaviab(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_uaviab","mangled_name":"scalar_uaviab_da338fd0","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_uaviab(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] * scale) + offset\n"}
{"id":"nested_devohi_0010996ac7","device":"cuda","category":"nested_loop","description":"Nested loops (7x8)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":7,"inner_iterations":8,"seed":87},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_devohi_8a16bc0b_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 5;\n        wp::float32* var_50;\n        wp::int32 var_51;\n        const wp::int32 var_52 = 1;\n        wp::int32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        const wp::int32 var_58 = 6;\n        wp::float32* var_59;\n        wp::int32 var_60;\n        const wp::int32 var_61 = 1;\n        wp::int32 var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 7;\n        wp::float32* var_68;\n        wp::int32 var_69;\n        const wp::int32 var_70 = 1;\n        wp::int32 var_71;\n        wp::float32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        const wp::int32 var_76 = 1;\n        const wp::int32 var_77 = 0;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 1;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        wp::float32* var_96;\n        wp::int32 var_97;\n        const wp::int32 var_98 = 1;\n        wp::int32 var_99;\n        wp::float32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::int32 var_104 = 3;\n        wp::float32* var_105;\n        wp::int32 var_106;\n        const wp::int32 var_107 = 1;\n        wp::int32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        const wp::int32 var_113 = 4;\n        wp::float32* var_114;\n        wp::int32 var_115;\n        const wp::int32 var_116 = 1;\n        wp::int32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 5;\n        wp::float32* var_123;\n        wp::int32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::int32 var_126;\n        wp::float32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 6;\n        wp::float32* var_132;\n        wp::int32 var_133;\n        const wp::int32 var_134 = 1;\n        wp::int32 var_135;\n        wp::float32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        const wp::int32 var_140 = 7;\n        wp::float32* var_141;\n        wp::int32 var_142;\n        const wp::int32 var_143 = 1;\n        wp::int32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        const wp::int32 var_149 = 2;\n        const wp::int32 var_150 = 0;\n        wp::float32* var_151;\n        wp::int32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::int32 var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        const wp::int32 var_159 = 1;\n        wp::float32* var_160;\n        wp::int32 var_161;\n        const wp::int32 var_162 = 1;\n        wp::int32 var_163;\n        wp::float32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        const wp::int32 var_168 = 2;\n        wp::float32* var_169;\n        wp::int32 var_170;\n        const wp::int32 var_171 = 1;\n        wp::int32 var_172;\n        wp::float32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        const wp::int32 var_177 = 3;\n        wp::float32* var_178;\n        wp::int32 var_179;\n        const wp::int32 var_180 = 1;\n        wp::int32 var_181;\n        wp::float32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        const wp::int32 var_186 = 4;\n        wp::float32* var_187;\n        wp::int32 var_188;\n        const wp::int32 var_189 = 1;\n        wp::int32 var_190;\n        wp::float32 var_191;\n        wp::float32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        const wp::int32 var_195 = 5;\n        wp::float32* var_196;\n        wp::int32 var_197;\n        const wp::int32 var_198 = 1;\n        wp::int32 var_199;\n        wp::float32 var_200;\n        wp::float32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        const wp::int32 var_204 = 6;\n        wp::float32* var_205;\n        wp::int32 var_206;\n        const wp::int32 var_207 = 1;\n        wp::int32 var_208;\n        wp::float32 var_209;\n        wp::float32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        const wp::int32 var_213 = 7;\n        wp::float32* var_214;\n        wp::int32 var_215;\n        const wp::int32 var_216 = 1;\n        wp::int32 var_217;\n        wp::float32 var_218;\n        wp::float32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        const wp::int32 var_222 = 3;\n        const wp::int32 var_223 = 0;\n        wp::float32* var_224;\n        wp::int32 var_225;\n        const wp::int32 var_226 = 1;\n        wp::int32 var_227;\n        wp::float32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        const wp::int32 var_232 = 1;\n        wp::float32* var_233;\n        wp::int32 var_234;\n        const wp::int32 var_235 = 1;\n        wp::int32 var_236;\n        wp::float32 var_237;\n        wp::float32 var_238;\n        wp::float32 var_239;\n        wp::float32 var_240;\n        const wp::int32 var_241 = 2;\n        wp::float32* var_242;\n        wp::int32 var_243;\n        const wp::int32 var_244 = 1;\n        wp::int32 var_245;\n        wp::float32 var_246;\n        wp::float32 var_247;\n        wp::float32 var_248;\n        wp::float32 var_249;\n        const wp::int32 var_250 = 3;\n        wp::float32* var_251;\n        wp::int32 var_252;\n        const wp::int32 var_253 = 1;\n        wp::int32 var_254;\n        wp::float32 var_255;\n        wp::float32 var_256;\n        wp::float32 var_257;\n        wp::float32 var_258;\n        const wp::int32 var_259 = 4;\n        wp::float32* var_260;\n        wp::int32 var_261;\n        const wp::int32 var_262 = 1;\n        wp::int32 var_263;\n        wp::float32 var_264;\n        wp::float32 var_265;\n        wp::float32 var_266;\n        wp::float32 var_267;\n        const wp::int32 var_268 = 5;\n        wp::float32* var_269;\n        wp::int32 var_270;\n        const wp::int32 var_271 = 1;\n        wp::int32 var_272;\n        wp::float32 var_273;\n        wp::float32 var_274;\n        wp::float32 var_275;\n        wp::float32 var_276;\n        const wp::int32 var_277 = 6;\n        wp::float32* var_278;\n        wp::int32 var_279;\n        const wp::int32 var_280 = 1;\n        wp::int32 var_281;\n        wp::float32 var_282;\n        wp::float32 var_283;\n        wp::float32 var_284;\n        wp::float32 var_285;\n        const wp::int32 var_286 = 7;\n        wp::float32* var_287;\n        wp::int32 var_288;\n        const wp::int32 var_289 = 1;\n        wp::int32 var_290;\n        wp::float32 var_291;\n        wp::float32 var_292;\n        wp::float32 var_293;\n        wp::float32 var_294;\n        const wp::int32 var_295 = 4;\n        const wp::int32 var_296 = 0;\n        wp::float32* var_297;\n        wp::int32 var_298;\n        const wp::int32 var_299 = 1;\n        wp::int32 var_300;\n        wp::float32 var_301;\n        wp::float32 var_302;\n        wp::float32 var_303;\n        wp::float32 var_304;\n        const wp::int32 var_305 = 1;\n        wp::float32* var_306;\n        wp::int32 var_307;\n        const wp::int32 var_308 = 1;\n        wp::int32 var_309;\n        wp::float32 var_310;\n        wp::float32 var_311;\n        wp::float32 var_312;\n        wp::float32 var_313;\n        const wp::int32 var_314 = 2;\n        wp::float32* var_315;\n        wp::int32 var_316;\n        const wp::int32 var_317 = 1;\n        wp::int32 var_318;\n        wp::float32 var_319;\n        wp::float32 var_320;\n        wp::float32 var_321;\n        wp::float32 var_322;\n        const wp::int32 var_323 = 3;\n        wp::float32* var_324;\n        wp::int32 var_325;\n        const wp::int32 var_326 = 1;\n        wp::int32 var_327;\n        wp::float32 var_328;\n        wp::float32 var_329;\n        wp::float32 var_330;\n        wp::float32 var_331;\n        const wp::int32 var_332 = 4;\n        wp::float32* var_333;\n        wp::int32 var_334;\n        const wp::int32 var_335 = 1;\n        wp::int32 var_336;\n        wp::float32 var_337;\n        wp::float32 var_338;\n        wp::float32 var_339;\n        wp::float32 var_340;\n        const wp::int32 var_341 = 5;\n        wp::float32* var_342;\n        wp::int32 var_343;\n        const wp::int32 var_344 = 1;\n        wp::int32 var_345;\n        wp::float32 var_346;\n        wp::float32 var_347;\n        wp::float32 var_348;\n        wp::float32 var_349;\n        const wp::int32 var_350 = 6;\n        wp::float32* var_351;\n        wp::int32 var_352;\n        const wp::int32 var_353 = 1;\n        wp::int32 var_354;\n        wp::float32 var_355;\n        wp::float32 var_356;\n        wp::float32 var_357;\n        wp::float32 var_358;\n        const wp::int32 var_359 = 7;\n        wp::float32* var_360;\n        wp::int32 var_361;\n        const wp::int32 var_362 = 1;\n        wp::int32 var_363;\n        wp::float32 var_364;\n        wp::float32 var_365;\n        wp::float32 var_366;\n        wp::float32 var_367;\n        const wp::int32 var_368 = 5;\n        const wp::int32 var_369 = 0;\n        wp::float32* var_370;\n        wp::int32 var_371;\n        const wp::int32 var_372 = 1;\n        wp::int32 var_373;\n        wp::float32 var_374;\n        wp::float32 var_375;\n        wp::float32 var_376;\n        wp::float32 var_377;\n        const wp::int32 var_378 = 1;\n        wp::float32* var_379;\n        wp::int32 var_380;\n        const wp::int32 var_381 = 1;\n        wp::int32 var_382;\n        wp::float32 var_383;\n        wp::float32 var_384;\n        wp::float32 var_385;\n        wp::float32 var_386;\n        const wp::int32 var_387 = 2;\n        wp::float32* var_388;\n        wp::int32 var_389;\n        const wp::int32 var_390 = 1;\n        wp::int32 var_391;\n        wp::float32 var_392;\n        wp::float32 var_393;\n        wp::float32 var_394;\n        wp::float32 var_395;\n        const wp::int32 var_396 = 3;\n        wp::float32* var_397;\n        wp::int32 var_398;\n        const wp::int32 var_399 = 1;\n        wp::int32 var_400;\n        wp::float32 var_401;\n        wp::float32 var_402;\n        wp::float32 var_403;\n        wp::float32 var_404;\n        const wp::int32 var_405 = 4;\n        wp::float32* var_406;\n        wp::int32 var_407;\n        const wp::int32 var_408 = 1;\n        wp::int32 var_409;\n        wp::float32 var_410;\n        wp::float32 var_411;\n        wp::float32 var_412;\n        wp::float32 var_413;\n        const wp::int32 var_414 = 5;\n        wp::float32* var_415;\n        wp::int32 var_416;\n        const wp::int32 var_417 = 1;\n        wp::int32 var_418;\n        wp::float32 var_419;\n        wp::float32 var_420;\n        wp::float32 var_421;\n        wp::float32 var_422;\n        const wp::int32 var_423 = 6;\n        wp::float32* var_424;\n        wp::int32 var_425;\n        const wp::int32 var_426 = 1;\n        wp::int32 var_427;\n        wp::float32 var_428;\n        wp::float32 var_429;\n        wp::float32 var_430;\n        wp::float32 var_431;\n        const wp::int32 var_432 = 7;\n        wp::float32* var_433;\n        wp::int32 var_434;\n        const wp::int32 var_435 = 1;\n        wp::int32 var_436;\n        wp::float32 var_437;\n        wp::float32 var_438;\n        wp::float32 var_439;\n        wp::float32 var_440;\n        const wp::int32 var_441 = 6;\n        const wp::int32 var_442 = 0;\n        wp::float32* var_443;\n        wp::int32 var_444;\n        const wp::int32 var_445 = 1;\n        wp::int32 var_446;\n        wp::float32 var_447;\n        wp::float32 var_448;\n        wp::float32 var_449;\n        wp::float32 var_450;\n        const wp::int32 var_451 = 1;\n        wp::float32* var_452;\n        wp::int32 var_453;\n        const wp::int32 var_454 = 1;\n        wp::int32 var_455;\n        wp::float32 var_456;\n        wp::float32 var_457;\n        wp::float32 var_458;\n        wp::float32 var_459;\n        const wp::int32 var_460 = 2;\n        wp::float32* var_461;\n        wp::int32 var_462;\n        const wp::int32 var_463 = 1;\n        wp::int32 var_464;\n        wp::float32 var_465;\n        wp::float32 var_466;\n        wp::float32 var_467;\n        wp::float32 var_468;\n        const wp::int32 var_469 = 3;\n        wp::float32* var_470;\n        wp::int32 var_471;\n        const wp::int32 var_472 = 1;\n        wp::int32 var_473;\n        wp::float32 var_474;\n        wp::float32 var_475;\n        wp::float32 var_476;\n        wp::float32 var_477;\n        const wp::int32 var_478 = 4;\n        wp::float32* var_479;\n        wp::int32 var_480;\n        const wp::int32 var_481 = 1;\n        wp::int32 var_482;\n        wp::float32 var_483;\n        wp::float32 var_484;\n        wp::float32 var_485;\n        wp::float32 var_486;\n        const wp::int32 var_487 = 5;\n        wp::float32* var_488;\n        wp::int32 var_489;\n        const wp::int32 var_490 = 1;\n        wp::int32 var_491;\n        wp::float32 var_492;\n        wp::float32 var_493;\n        wp::float32 var_494;\n        wp::float32 var_495;\n        const wp::int32 var_496 = 6;\n        wp::float32* var_497;\n        wp::int32 var_498;\n        const wp::int32 var_499 = 1;\n        wp::int32 var_500;\n        wp::float32 var_501;\n        wp::float32 var_502;\n        wp::float32 var_503;\n        wp::float32 var_504;\n        const wp::int32 var_505 = 7;\n        wp::float32* var_506;\n        wp::int32 var_507;\n        const wp::int32 var_508 = 1;\n        wp::int32 var_509;\n        wp::float32 var_510;\n        wp::float32 var_511;\n        wp::float32 var_512;\n        wp::float32 var_513;\n        //---------\n        // forward\n        // def nested_devohi(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        var_50 = wp::address(var_data, var_0);\n        var_51 = wp::mul(var_3, var_49);\n        var_53 = wp::add(var_51, var_52);\n        var_54 = wp::float(var_53);\n        var_56 = wp::load(var_50);\n        var_55 = wp::mul(var_56, var_54);\n        var_57 = wp::add(var_48, var_55);\n        var_59 = wp::address(var_data, var_0);\n        var_60 = wp::mul(var_3, var_58);\n        var_62 = wp::add(var_60, var_61);\n        var_63 = wp::float(var_62);\n        var_65 = wp::load(var_59);\n        var_64 = wp::mul(var_65, var_63);\n        var_66 = wp::add(var_57, var_64);\n        var_68 = wp::address(var_data, var_0);\n        var_69 = wp::mul(var_3, var_67);\n        var_71 = wp::add(var_69, var_70);\n        var_72 = wp::float(var_71);\n        var_74 = wp::load(var_68);\n        var_73 = wp::mul(var_74, var_72);\n        var_75 = wp::add(var_66, var_73);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_76, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_75, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_76, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        var_96 = wp::address(var_data, var_0);\n        var_97 = wp::mul(var_76, var_95);\n        var_99 = wp::add(var_97, var_98);\n        var_100 = wp::float(var_99);\n        var_102 = wp::load(var_96);\n        var_101 = wp::mul(var_102, var_100);\n        var_103 = wp::add(var_94, var_101);\n        var_105 = wp::address(var_data, var_0);\n        var_106 = wp::mul(var_76, var_104);\n        var_108 = wp::add(var_106, var_107);\n        var_109 = wp::float(var_108);\n        var_111 = wp::load(var_105);\n        var_110 = wp::mul(var_111, var_109);\n        var_112 = wp::add(var_103, var_110);\n        var_114 = wp::address(var_data, var_0);\n        var_115 = wp::mul(var_76, var_113);\n        var_117 = wp::add(var_115, var_116);\n        var_118 = wp::float(var_117);\n        var_120 = wp::load(var_114);\n        var_119 = wp::mul(var_120, var_118);\n        var_121 = wp::add(var_112, var_119);\n        var_123 = wp::address(var_data, var_0);\n        var_124 = wp::mul(var_76, var_122);\n        var_126 = wp::add(var_124, var_125);\n        var_127 = wp::float(var_126);\n        var_129 = wp::load(var_123);\n        var_128 = wp::mul(var_129, var_127);\n        var_130 = wp::add(var_121, var_128);\n        var_132 = wp::address(var_data, var_0);\n        var_133 = wp::mul(var_76, var_131);\n        var_135 = wp::add(var_133, var_134);\n        var_136 = wp::float(var_135);\n        var_138 = wp::load(var_132);\n        var_137 = wp::mul(var_138, var_136);\n        var_139 = wp::add(var_130, var_137);\n        var_141 = wp::address(var_data, var_0);\n        var_142 = wp::mul(var_76, var_140);\n        var_144 = wp::add(var_142, var_143);\n        var_145 = wp::float(var_144);\n        var_147 = wp::load(var_141);\n        var_146 = wp::mul(var_147, var_145);\n        var_148 = wp::add(var_139, var_146);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_151 = wp::address(var_data, var_0);\n        var_152 = wp::mul(var_149, var_150);\n        var_154 = wp::add(var_152, var_153);\n        var_155 = wp::float(var_154);\n        var_157 = wp::load(var_151);\n        var_156 = wp::mul(var_157, var_155);\n        var_158 = wp::add(var_148, var_156);\n        var_160 = wp::address(var_data, var_0);\n        var_161 = wp::mul(var_149, var_159);\n        var_163 = wp::add(var_161, var_162);\n        var_164 = wp::float(var_163);\n        var_166 = wp::load(var_160);\n        var_165 = wp::mul(var_166, var_164);\n        var_167 = wp::add(var_158, var_165);\n        var_169 = wp::address(var_data, var_0);\n        var_170 = wp::mul(var_149, var_168);\n        var_172 = wp::add(var_170, var_171);\n        var_173 = wp::float(var_172);\n        var_175 = wp::load(var_169);\n        var_174 = wp::mul(var_175, var_173);\n        var_176 = wp::add(var_167, var_174);\n        var_178 = wp::address(var_data, var_0);\n        var_179 = wp::mul(var_149, var_177);\n        var_181 = wp::add(var_179, var_180);\n        var_182 = wp::float(var_181);\n        var_184 = wp::load(var_178);\n        var_183 = wp::mul(var_184, var_182);\n        var_185 = wp::add(var_176, var_183);\n        var_187 = wp::address(var_data, var_0);\n        var_188 = wp::mul(var_149, var_186);\n        var_190 = wp::add(var_188, var_189);\n        var_191 = wp::float(var_190);\n        var_193 = wp::load(var_187);\n        var_192 = wp::mul(var_193, var_191);\n        var_194 = wp::add(var_185, var_192);\n        var_196 = wp::address(var_data, var_0);\n        var_197 = wp::mul(var_149, var_195);\n        var_199 = wp::add(var_197, var_198);\n        var_200 = wp::float(var_199);\n        var_202 = wp::load(var_196);\n        var_201 = wp::mul(var_202, var_200);\n        var_203 = wp::add(var_194, var_201);\n        var_205 = wp::address(var_data, var_0);\n        var_206 = wp::mul(var_149, var_204);\n        var_208 = wp::add(var_206, var_207);\n        var_209 = wp::float(var_208);\n        var_211 = wp::load(var_205);\n        var_210 = wp::mul(var_211, var_209);\n        var_212 = wp::add(var_203, var_210);\n        var_214 = wp::address(var_data, var_0);\n        var_215 = wp::mul(var_149, var_213);\n        var_217 = wp::add(var_215, var_216);\n        var_218 = wp::float(var_217);\n        var_220 = wp::load(var_214);\n        var_219 = wp::mul(var_220, var_218);\n        var_221 = wp::add(var_212, var_219);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_224 = wp::address(var_data, var_0);\n        var_225 = wp::mul(var_222, var_223);\n        var_227 = wp::add(var_225, var_226);\n        var_228 = wp::float(var_227);\n        var_230 = wp::load(var_224);\n        var_229 = wp::mul(var_230, var_228);\n        var_231 = wp::add(var_221, var_229);\n        var_233 = wp::address(var_data, var_0);\n        var_234 = wp::mul(var_222, var_232);\n        var_236 = wp::add(var_234, var_235);\n        var_237 = wp::float(var_236);\n        var_239 = wp::load(var_233);\n        var_238 = wp::mul(var_239, var_237);\n        var_240 = wp::add(var_231, var_238);\n        var_242 = wp::address(var_data, var_0);\n        var_243 = wp::mul(var_222, var_241);\n        var_245 = wp::add(var_243, var_244);\n        var_246 = wp::float(var_245);\n        var_248 = wp::load(var_242);\n        var_247 = wp::mul(var_248, var_246);\n        var_249 = wp::add(var_240, var_247);\n        var_251 = wp::address(var_data, var_0);\n        var_252 = wp::mul(var_222, var_250);\n        var_254 = wp::add(var_252, var_253);\n        var_255 = wp::float(var_254);\n        var_257 = wp::load(var_251);\n        var_256 = wp::mul(var_257, var_255);\n        var_258 = wp::add(var_249, var_256);\n        var_260 = wp::address(var_data, var_0);\n        var_261 = wp::mul(var_222, var_259);\n        var_263 = wp::add(var_261, var_262);\n        var_264 = wp::float(var_263);\n        var_266 = wp::load(var_260);\n        var_265 = wp::mul(var_266, var_264);\n        var_267 = wp::add(var_258, var_265);\n        var_269 = wp::address(var_data, var_0);\n        var_270 = wp::mul(var_222, var_268);\n        var_272 = wp::add(var_270, var_271);\n        var_273 = wp::float(var_272);\n        var_275 = wp::load(var_269);\n        var_274 = wp::mul(var_275, var_273);\n        var_276 = wp::add(var_267, var_274);\n        var_278 = wp::address(var_data, var_0);\n        var_279 = wp::mul(var_222, var_277);\n        var_281 = wp::add(var_279, var_280);\n        var_282 = wp::float(var_281);\n        var_284 = wp::load(var_278);\n        var_283 = wp::mul(var_284, var_282);\n        var_285 = wp::add(var_276, var_283);\n        var_287 = wp::address(var_data, var_0);\n        var_288 = wp::mul(var_222, var_286);\n        var_290 = wp::add(var_288, var_289);\n        var_291 = wp::float(var_290);\n        var_293 = wp::load(var_287);\n        var_292 = wp::mul(var_293, var_291);\n        var_294 = wp::add(var_285, var_292);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_297 = wp::address(var_data, var_0);\n        var_298 = wp::mul(var_295, var_296);\n        var_300 = wp::add(var_298, var_299);\n        var_301 = wp::float(var_300);\n        var_303 = wp::load(var_297);\n        var_302 = wp::mul(var_303, var_301);\n        var_304 = wp::add(var_294, var_302);\n        var_306 = wp::address(var_data, var_0);\n        var_307 = wp::mul(var_295, var_305);\n        var_309 = wp::add(var_307, var_308);\n        var_310 = wp::float(var_309);\n        var_312 = wp::load(var_306);\n        var_311 = wp::mul(var_312, var_310);\n        var_313 = wp::add(var_304, var_311);\n        var_315 = wp::address(var_data, var_0);\n        var_316 = wp::mul(var_295, var_314);\n        var_318 = wp::add(var_316, var_317);\n        var_319 = wp::float(var_318);\n        var_321 = wp::load(var_315);\n        var_320 = wp::mul(var_321, var_319);\n        var_322 = wp::add(var_313, var_320);\n        var_324 = wp::address(var_data, var_0);\n        var_325 = wp::mul(var_295, var_323);\n        var_327 = wp::add(var_325, var_326);\n        var_328 = wp::float(var_327);\n        var_330 = wp::load(var_324);\n        var_329 = wp::mul(var_330, var_328);\n        var_331 = wp::add(var_322, var_329);\n        var_333 = wp::address(var_data, var_0);\n        var_334 = wp::mul(var_295, var_332);\n        var_336 = wp::add(var_334, var_335);\n        var_337 = wp::float(var_336);\n        var_339 = wp::load(var_333);\n        var_338 = wp::mul(var_339, var_337);\n        var_340 = wp::add(var_331, var_338);\n        var_342 = wp::address(var_data, var_0);\n        var_343 = wp::mul(var_295, var_341);\n        var_345 = wp::add(var_343, var_344);\n        var_346 = wp::float(var_345);\n        var_348 = wp::load(var_342);\n        var_347 = wp::mul(var_348, var_346);\n        var_349 = wp::add(var_340, var_347);\n        var_351 = wp::address(var_data, var_0);\n        var_352 = wp::mul(var_295, var_350);\n        var_354 = wp::add(var_352, var_353);\n        var_355 = wp::float(var_354);\n        var_357 = wp::load(var_351);\n        var_356 = wp::mul(var_357, var_355);\n        var_358 = wp::add(var_349, var_356);\n        var_360 = wp::address(var_data, var_0);\n        var_361 = wp::mul(var_295, var_359);\n        var_363 = wp::add(var_361, var_362);\n        var_364 = wp::float(var_363);\n        var_366 = wp::load(var_360);\n        var_365 = wp::mul(var_366, var_364);\n        var_367 = wp::add(var_358, var_365);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_370 = wp::address(var_data, var_0);\n        var_371 = wp::mul(var_368, var_369);\n        var_373 = wp::add(var_371, var_372);\n        var_374 = wp::float(var_373);\n        var_376 = wp::load(var_370);\n        var_375 = wp::mul(var_376, var_374);\n        var_377 = wp::add(var_367, var_375);\n        var_379 = wp::address(var_data, var_0);\n        var_380 = wp::mul(var_368, var_378);\n        var_382 = wp::add(var_380, var_381);\n        var_383 = wp::float(var_382);\n        var_385 = wp::load(var_379);\n        var_384 = wp::mul(var_385, var_383);\n        var_386 = wp::add(var_377, var_384);\n        var_388 = wp::address(var_data, var_0);\n        var_389 = wp::mul(var_368, var_387);\n        var_391 = wp::add(var_389, var_390);\n        var_392 = wp::float(var_391);\n        var_394 = wp::load(var_388);\n        var_393 = wp::mul(var_394, var_392);\n        var_395 = wp::add(var_386, var_393);\n        var_397 = wp::address(var_data, var_0);\n        var_398 = wp::mul(var_368, var_396);\n        var_400 = wp::add(var_398, var_399);\n        var_401 = wp::float(var_400);\n        var_403 = wp::load(var_397);\n        var_402 = wp::mul(var_403, var_401);\n        var_404 = wp::add(var_395, var_402);\n        var_406 = wp::address(var_data, var_0);\n        var_407 = wp::mul(var_368, var_405);\n        var_409 = wp::add(var_407, var_408);\n        var_410 = wp::float(var_409);\n        var_412 = wp::load(var_406);\n        var_411 = wp::mul(var_412, var_410);\n        var_413 = wp::add(var_404, var_411);\n        var_415 = wp::address(var_data, var_0);\n        var_416 = wp::mul(var_368, var_414);\n        var_418 = wp::add(var_416, var_417);\n        var_419 = wp::float(var_418);\n        var_421 = wp::load(var_415);\n        var_420 = wp::mul(var_421, var_419);\n        var_422 = wp::add(var_413, var_420);\n        var_424 = wp::address(var_data, var_0);\n        var_425 = wp::mul(var_368, var_423);\n        var_427 = wp::add(var_425, var_426);\n        var_428 = wp::float(var_427);\n        var_430 = wp::load(var_424);\n        var_429 = wp::mul(var_430, var_428);\n        var_431 = wp::add(var_422, var_429);\n        var_433 = wp::address(var_data, var_0);\n        var_434 = wp::mul(var_368, var_432);\n        var_436 = wp::add(var_434, var_435);\n        var_437 = wp::float(var_436);\n        var_439 = wp::load(var_433);\n        var_438 = wp::mul(var_439, var_437);\n        var_440 = wp::add(var_431, var_438);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_443 = wp::address(var_data, var_0);\n        var_444 = wp::mul(var_441, var_442);\n        var_446 = wp::add(var_444, var_445);\n        var_447 = wp::float(var_446);\n        var_449 = wp::load(var_443);\n        var_448 = wp::mul(var_449, var_447);\n        var_450 = wp::add(var_440, var_448);\n        var_452 = wp::address(var_data, var_0);\n        var_453 = wp::mul(var_441, var_451);\n        var_455 = wp::add(var_453, var_454);\n        var_456 = wp::float(var_455);\n        var_458 = wp::load(var_452);\n        var_457 = wp::mul(var_458, var_456);\n        var_459 = wp::add(var_450, var_457);\n        var_461 = wp::address(var_data, var_0);\n        var_462 = wp::mul(var_441, var_460);\n        var_464 = wp::add(var_462, var_463);\n        var_465 = wp::float(var_464);\n        var_467 = wp::load(var_461);\n        var_466 = wp::mul(var_467, var_465);\n        var_468 = wp::add(var_459, var_466);\n        var_470 = wp::address(var_data, var_0);\n        var_471 = wp::mul(var_441, var_469);\n        var_473 = wp::add(var_471, var_472);\n        var_474 = wp::float(var_473);\n        var_476 = wp::load(var_470);\n        var_475 = wp::mul(var_476, var_474);\n        var_477 = wp::add(var_468, var_475);\n        var_479 = wp::address(var_data, var_0);\n        var_480 = wp::mul(var_441, var_478);\n        var_482 = wp::add(var_480, var_481);\n        var_483 = wp::float(var_482);\n        var_485 = wp::load(var_479);\n        var_484 = wp::mul(var_485, var_483);\n        var_486 = wp::add(var_477, var_484);\n        var_488 = wp::address(var_data, var_0);\n        var_489 = wp::mul(var_441, var_487);\n        var_491 = wp::add(var_489, var_490);\n        var_492 = wp::float(var_491);\n        var_494 = wp::load(var_488);\n        var_493 = wp::mul(var_494, var_492);\n        var_495 = wp::add(var_486, var_493);\n        var_497 = wp::address(var_data, var_0);\n        var_498 = wp::mul(var_441, var_496);\n        var_500 = wp::add(var_498, var_499);\n        var_501 = wp::float(var_500);\n        var_503 = wp::load(var_497);\n        var_502 = wp::mul(var_503, var_501);\n        var_504 = wp::add(var_495, var_502);\n        var_506 = wp::address(var_data, var_0);\n        var_507 = wp::mul(var_441, var_505);\n        var_509 = wp::add(var_507, var_508);\n        var_510 = wp::float(var_509);\n        var_512 = wp::load(var_506);\n        var_511 = wp::mul(var_512, var_510);\n        var_513 = wp::add(var_504, var_511);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_513);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_devohi_8a16bc0b_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 5;\n        wp::float32* var_50;\n        wp::int32 var_51;\n        const wp::int32 var_52 = 1;\n        wp::int32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        const wp::int32 var_58 = 6;\n        wp::float32* var_59;\n        wp::int32 var_60;\n        const wp::int32 var_61 = 1;\n        wp::int32 var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 7;\n        wp::float32* var_68;\n        wp::int32 var_69;\n        const wp::int32 var_70 = 1;\n        wp::int32 var_71;\n        wp::float32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        const wp::int32 var_76 = 1;\n        const wp::int32 var_77 = 0;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 1;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        wp::float32* var_96;\n        wp::int32 var_97;\n        const wp::int32 var_98 = 1;\n        wp::int32 var_99;\n        wp::float32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::int32 var_104 = 3;\n        wp::float32* var_105;\n        wp::int32 var_106;\n        const wp::int32 var_107 = 1;\n        wp::int32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        const wp::int32 var_113 = 4;\n        wp::float32* var_114;\n        wp::int32 var_115;\n        const wp::int32 var_116 = 1;\n        wp::int32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 5;\n        wp::float32* var_123;\n        wp::int32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::int32 var_126;\n        wp::float32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 6;\n        wp::float32* var_132;\n        wp::int32 var_133;\n        const wp::int32 var_134 = 1;\n        wp::int32 var_135;\n        wp::float32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        const wp::int32 var_140 = 7;\n        wp::float32* var_141;\n        wp::int32 var_142;\n        const wp::int32 var_143 = 1;\n        wp::int32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        const wp::int32 var_149 = 2;\n        const wp::int32 var_150 = 0;\n        wp::float32* var_151;\n        wp::int32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::int32 var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        const wp::int32 var_159 = 1;\n        wp::float32* var_160;\n        wp::int32 var_161;\n        const wp::int32 var_162 = 1;\n        wp::int32 var_163;\n        wp::float32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        const wp::int32 var_168 = 2;\n        wp::float32* var_169;\n        wp::int32 var_170;\n        const wp::int32 var_171 = 1;\n        wp::int32 var_172;\n        wp::float32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        const wp::int32 var_177 = 3;\n        wp::float32* var_178;\n        wp::int32 var_179;\n        const wp::int32 var_180 = 1;\n        wp::int32 var_181;\n        wp::float32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        const wp::int32 var_186 = 4;\n        wp::float32* var_187;\n        wp::int32 var_188;\n        const wp::int32 var_189 = 1;\n        wp::int32 var_190;\n        wp::float32 var_191;\n        wp::float32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        const wp::int32 var_195 = 5;\n        wp::float32* var_196;\n        wp::int32 var_197;\n        const wp::int32 var_198 = 1;\n        wp::int32 var_199;\n        wp::float32 var_200;\n        wp::float32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        const wp::int32 var_204 = 6;\n        wp::float32* var_205;\n        wp::int32 var_206;\n        const wp::int32 var_207 = 1;\n        wp::int32 var_208;\n        wp::float32 var_209;\n        wp::float32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        const wp::int32 var_213 = 7;\n        wp::float32* var_214;\n        wp::int32 var_215;\n        const wp::int32 var_216 = 1;\n        wp::int32 var_217;\n        wp::float32 var_218;\n        wp::float32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        const wp::int32 var_222 = 3;\n        const wp::int32 var_223 = 0;\n        wp::float32* var_224;\n        wp::int32 var_225;\n        const wp::int32 var_226 = 1;\n        wp::int32 var_227;\n        wp::float32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        const wp::int32 var_232 = 1;\n        wp::float32* var_233;\n        wp::int32 var_234;\n        const wp::int32 var_235 = 1;\n        wp::int32 var_236;\n        wp::float32 var_237;\n        wp::float32 var_238;\n        wp::float32 var_239;\n        wp::float32 var_240;\n        const wp::int32 var_241 = 2;\n        wp::float32* var_242;\n        wp::int32 var_243;\n        const wp::int32 var_244 = 1;\n        wp::int32 var_245;\n        wp::float32 var_246;\n        wp::float32 var_247;\n        wp::float32 var_248;\n        wp::float32 var_249;\n        const wp::int32 var_250 = 3;\n        wp::float32* var_251;\n        wp::int32 var_252;\n        const wp::int32 var_253 = 1;\n        wp::int32 var_254;\n        wp::float32 var_255;\n        wp::float32 var_256;\n        wp::float32 var_257;\n        wp::float32 var_258;\n        const wp::int32 var_259 = 4;\n        wp::float32* var_260;\n        wp::int32 var_261;\n        const wp::int32 var_262 = 1;\n        wp::int32 var_263;\n        wp::float32 var_264;\n        wp::float32 var_265;\n        wp::float32 var_266;\n        wp::float32 var_267;\n        const wp::int32 var_268 = 5;\n        wp::float32* var_269;\n        wp::int32 var_270;\n        const wp::int32 var_271 = 1;\n        wp::int32 var_272;\n        wp::float32 var_273;\n        wp::float32 var_274;\n        wp::float32 var_275;\n        wp::float32 var_276;\n        const wp::int32 var_277 = 6;\n        wp::float32* var_278;\n        wp::int32 var_279;\n        const wp::int32 var_280 = 1;\n        wp::int32 var_281;\n        wp::float32 var_282;\n        wp::float32 var_283;\n        wp::float32 var_284;\n        wp::float32 var_285;\n        const wp::int32 var_286 = 7;\n        wp::float32* var_287;\n        wp::int32 var_288;\n        const wp::int32 var_289 = 1;\n        wp::int32 var_290;\n        wp::float32 var_291;\n        wp::float32 var_292;\n        wp::float32 var_293;\n        wp::float32 var_294;\n        const wp::int32 var_295 = 4;\n        const wp::int32 var_296 = 0;\n        wp::float32* var_297;\n        wp::int32 var_298;\n        const wp::int32 var_299 = 1;\n        wp::int32 var_300;\n        wp::float32 var_301;\n        wp::float32 var_302;\n        wp::float32 var_303;\n        wp::float32 var_304;\n        const wp::int32 var_305 = 1;\n        wp::float32* var_306;\n        wp::int32 var_307;\n        const wp::int32 var_308 = 1;\n        wp::int32 var_309;\n        wp::float32 var_310;\n        wp::float32 var_311;\n        wp::float32 var_312;\n        wp::float32 var_313;\n        const wp::int32 var_314 = 2;\n        wp::float32* var_315;\n        wp::int32 var_316;\n        const wp::int32 var_317 = 1;\n        wp::int32 var_318;\n        wp::float32 var_319;\n        wp::float32 var_320;\n        wp::float32 var_321;\n        wp::float32 var_322;\n        const wp::int32 var_323 = 3;\n        wp::float32* var_324;\n        wp::int32 var_325;\n        const wp::int32 var_326 = 1;\n        wp::int32 var_327;\n        wp::float32 var_328;\n        wp::float32 var_329;\n        wp::float32 var_330;\n        wp::float32 var_331;\n        const wp::int32 var_332 = 4;\n        wp::float32* var_333;\n        wp::int32 var_334;\n        const wp::int32 var_335 = 1;\n        wp::int32 var_336;\n        wp::float32 var_337;\n        wp::float32 var_338;\n        wp::float32 var_339;\n        wp::float32 var_340;\n        const wp::int32 var_341 = 5;\n        wp::float32* var_342;\n        wp::int32 var_343;\n        const wp::int32 var_344 = 1;\n        wp::int32 var_345;\n        wp::float32 var_346;\n        wp::float32 var_347;\n        wp::float32 var_348;\n        wp::float32 var_349;\n        const wp::int32 var_350 = 6;\n        wp::float32* var_351;\n        wp::int32 var_352;\n        const wp::int32 var_353 = 1;\n        wp::int32 var_354;\n        wp::float32 var_355;\n        wp::float32 var_356;\n        wp::float32 var_357;\n        wp::float32 var_358;\n        const wp::int32 var_359 = 7;\n        wp::float32* var_360;\n        wp::int32 var_361;\n        const wp::int32 var_362 = 1;\n        wp::int32 var_363;\n        wp::float32 var_364;\n        wp::float32 var_365;\n        wp::float32 var_366;\n        wp::float32 var_367;\n        const wp::int32 var_368 = 5;\n        const wp::int32 var_369 = 0;\n        wp::float32* var_370;\n        wp::int32 var_371;\n        const wp::int32 var_372 = 1;\n        wp::int32 var_373;\n        wp::float32 var_374;\n        wp::float32 var_375;\n        wp::float32 var_376;\n        wp::float32 var_377;\n        const wp::int32 var_378 = 1;\n        wp::float32* var_379;\n        wp::int32 var_380;\n        const wp::int32 var_381 = 1;\n        wp::int32 var_382;\n        wp::float32 var_383;\n        wp::float32 var_384;\n        wp::float32 var_385;\n        wp::float32 var_386;\n        const wp::int32 var_387 = 2;\n        wp::float32* var_388;\n        wp::int32 var_389;\n        const wp::int32 var_390 = 1;\n        wp::int32 var_391;\n        wp::float32 var_392;\n        wp::float32 var_393;\n        wp::float32 var_394;\n        wp::float32 var_395;\n        const wp::int32 var_396 = 3;\n        wp::float32* var_397;\n        wp::int32 var_398;\n        const wp::int32 var_399 = 1;\n        wp::int32 var_400;\n        wp::float32 var_401;\n        wp::float32 var_402;\n        wp::float32 var_403;\n        wp::float32 var_404;\n        const wp::int32 var_405 = 4;\n        wp::float32* var_406;\n        wp::int32 var_407;\n        const wp::int32 var_408 = 1;\n        wp::int32 var_409;\n        wp::float32 var_410;\n        wp::float32 var_411;\n        wp::float32 var_412;\n        wp::float32 var_413;\n        const wp::int32 var_414 = 5;\n        wp::float32* var_415;\n        wp::int32 var_416;\n        const wp::int32 var_417 = 1;\n        wp::int32 var_418;\n        wp::float32 var_419;\n        wp::float32 var_420;\n        wp::float32 var_421;\n        wp::float32 var_422;\n        const wp::int32 var_423 = 6;\n        wp::float32* var_424;\n        wp::int32 var_425;\n        const wp::int32 var_426 = 1;\n        wp::int32 var_427;\n        wp::float32 var_428;\n        wp::float32 var_429;\n        wp::float32 var_430;\n        wp::float32 var_431;\n        const wp::int32 var_432 = 7;\n        wp::float32* var_433;\n        wp::int32 var_434;\n        const wp::int32 var_435 = 1;\n        wp::int32 var_436;\n        wp::float32 var_437;\n        wp::float32 var_438;\n        wp::float32 var_439;\n        wp::float32 var_440;\n        const wp::int32 var_441 = 6;\n        const wp::int32 var_442 = 0;\n        wp::float32* var_443;\n        wp::int32 var_444;\n        const wp::int32 var_445 = 1;\n        wp::int32 var_446;\n        wp::float32 var_447;\n        wp::float32 var_448;\n        wp::float32 var_449;\n        wp::float32 var_450;\n        const wp::int32 var_451 = 1;\n        wp::float32* var_452;\n        wp::int32 var_453;\n        const wp::int32 var_454 = 1;\n        wp::int32 var_455;\n        wp::float32 var_456;\n        wp::float32 var_457;\n        wp::float32 var_458;\n        wp::float32 var_459;\n        const wp::int32 var_460 = 2;\n        wp::float32* var_461;\n        wp::int32 var_462;\n        const wp::int32 var_463 = 1;\n        wp::int32 var_464;\n        wp::float32 var_465;\n        wp::float32 var_466;\n        wp::float32 var_467;\n        wp::float32 var_468;\n        const wp::int32 var_469 = 3;\n        wp::float32* var_470;\n        wp::int32 var_471;\n        const wp::int32 var_472 = 1;\n        wp::int32 var_473;\n        wp::float32 var_474;\n        wp::float32 var_475;\n        wp::float32 var_476;\n        wp::float32 var_477;\n        const wp::int32 var_478 = 4;\n        wp::float32* var_479;\n        wp::int32 var_480;\n        const wp::int32 var_481 = 1;\n        wp::int32 var_482;\n        wp::float32 var_483;\n        wp::float32 var_484;\n        wp::float32 var_485;\n        wp::float32 var_486;\n        const wp::int32 var_487 = 5;\n        wp::float32* var_488;\n        wp::int32 var_489;\n        const wp::int32 var_490 = 1;\n        wp::int32 var_491;\n        wp::float32 var_492;\n        wp::float32 var_493;\n        wp::float32 var_494;\n        wp::float32 var_495;\n        const wp::int32 var_496 = 6;\n        wp::float32* var_497;\n        wp::int32 var_498;\n        const wp::int32 var_499 = 1;\n        wp::int32 var_500;\n        wp::float32 var_501;\n        wp::float32 var_502;\n        wp::float32 var_503;\n        wp::float32 var_504;\n        const wp::int32 var_505 = 7;\n        wp::float32* var_506;\n        wp::int32 var_507;\n        const wp::int32 var_508 = 1;\n        wp::int32 var_509;\n        wp::float32 var_510;\n        wp::float32 var_511;\n        wp::float32 var_512;\n        wp::float32 var_513;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::int32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::int32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::int32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::int32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::int32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::int32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::int32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::int32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::int32 adj_76 = {};\n        wp::int32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::int32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::int32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::int32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::int32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::int32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::float32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::int32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::int32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::float32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::int32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::int32 adj_117 = {};\n        wp::float32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::int32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::int32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::int32 adj_126 = {};\n        wp::float32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::int32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::int32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::int32 adj_135 = {};\n        wp::float32 adj_136 = {};\n        wp::float32 adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::int32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::int32 adj_142 = {};\n        wp::int32 adj_143 = {};\n        wp::int32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        wp::float32 adj_146 = {};\n        wp::float32 adj_147 = {};\n        wp::float32 adj_148 = {};\n        wp::int32 adj_149 = {};\n        wp::int32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::int32 adj_152 = {};\n        wp::int32 adj_153 = {};\n        wp::int32 adj_154 = {};\n        wp::float32 adj_155 = {};\n        wp::float32 adj_156 = {};\n        wp::float32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::int32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::int32 adj_161 = {};\n        wp::int32 adj_162 = {};\n        wp::int32 adj_163 = {};\n        wp::float32 adj_164 = {};\n        wp::float32 adj_165 = {};\n        wp::float32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::int32 adj_168 = {};\n        wp::float32 adj_169 = {};\n        wp::int32 adj_170 = {};\n        wp::int32 adj_171 = {};\n        wp::int32 adj_172 = {};\n        wp::float32 adj_173 = {};\n        wp::float32 adj_174 = {};\n        wp::float32 adj_175 = {};\n        wp::float32 adj_176 = {};\n        wp::int32 adj_177 = {};\n        wp::float32 adj_178 = {};\n        wp::int32 adj_179 = {};\n        wp::int32 adj_180 = {};\n        wp::int32 adj_181 = {};\n        wp::float32 adj_182 = {};\n        wp::float32 adj_183 = {};\n        wp::float32 adj_184 = {};\n        wp::float32 adj_185 = {};\n        wp::int32 adj_186 = {};\n        wp::float32 adj_187 = {};\n        wp::int32 adj_188 = {};\n        wp::int32 adj_189 = {};\n        wp::int32 adj_190 = {};\n        wp::float32 adj_191 = {};\n        wp::float32 adj_192 = {};\n        wp::float32 adj_193 = {};\n        wp::float32 adj_194 = {};\n        wp::int32 adj_195 = {};\n        wp::float32 adj_196 = {};\n        wp::int32 adj_197 = {};\n        wp::int32 adj_198 = {};\n        wp::int32 adj_199 = {};\n        wp::float32 adj_200 = {};\n        wp::float32 adj_201 = {};\n        wp::float32 adj_202 = {};\n        wp::float32 adj_203 = {};\n        wp::int32 adj_204 = {};\n        wp::float32 adj_205 = {};\n        wp::int32 adj_206 = {};\n        wp::int32 adj_207 = {};\n        wp::int32 adj_208 = {};\n        wp::float32 adj_209 = {};\n        wp::float32 adj_210 = {};\n        wp::float32 adj_211 = {};\n        wp::float32 adj_212 = {};\n        wp::int32 adj_213 = {};\n        wp::float32 adj_214 = {};\n        wp::int32 adj_215 = {};\n        wp::int32 adj_216 = {};\n        wp::int32 adj_217 = {};\n        wp::float32 adj_218 = {};\n        wp::float32 adj_219 = {};\n        wp::float32 adj_220 = {};\n        wp::float32 adj_221 = {};\n        wp::int32 adj_222 = {};\n        wp::int32 adj_223 = {};\n        wp::float32 adj_224 = {};\n        wp::int32 adj_225 = {};\n        wp::int32 adj_226 = {};\n        wp::int32 adj_227 = {};\n        wp::float32 adj_228 = {};\n        wp::float32 adj_229 = {};\n        wp::float32 adj_230 = {};\n        wp::float32 adj_231 = {};\n        wp::int32 adj_232 = {};\n        wp::float32 adj_233 = {};\n        wp::int32 adj_234 = {};\n        wp::int32 adj_235 = {};\n        wp::int32 adj_236 = {};\n        wp::float32 adj_237 = {};\n        wp::float32 adj_238 = {};\n        wp::float32 adj_239 = {};\n        wp::float32 adj_240 = {};\n        wp::int32 adj_241 = {};\n        wp::float32 adj_242 = {};\n        wp::int32 adj_243 = {};\n        wp::int32 adj_244 = {};\n        wp::int32 adj_245 = {};\n        wp::float32 adj_246 = {};\n        wp::float32 adj_247 = {};\n        wp::float32 adj_248 = {};\n        wp::float32 adj_249 = {};\n        wp::int32 adj_250 = {};\n        wp::float32 adj_251 = {};\n        wp::int32 adj_252 = {};\n        wp::int32 adj_253 = {};\n        wp::int32 adj_254 = {};\n        wp::float32 adj_255 = {};\n        wp::float32 adj_256 = {};\n        wp::float32 adj_257 = {};\n        wp::float32 adj_258 = {};\n        wp::int32 adj_259 = {};\n        wp::float32 adj_260 = {};\n        wp::int32 adj_261 = {};\n        wp::int32 adj_262 = {};\n        wp::int32 adj_263 = {};\n        wp::float32 adj_264 = {};\n        wp::float32 adj_265 = {};\n        wp::float32 adj_266 = {};\n        wp::float32 adj_267 = {};\n        wp::int32 adj_268 = {};\n        wp::float32 adj_269 = {};\n        wp::int32 adj_270 = {};\n        wp::int32 adj_271 = {};\n        wp::int32 adj_272 = {};\n        wp::float32 adj_273 = {};\n        wp::float32 adj_274 = {};\n        wp::float32 adj_275 = {};\n        wp::float32 adj_276 = {};\n        wp::int32 adj_277 = {};\n        wp::float32 adj_278 = {};\n        wp::int32 adj_279 = {};\n        wp::int32 adj_280 = {};\n        wp::int32 adj_281 = {};\n        wp::float32 adj_282 = {};\n        wp::float32 adj_283 = {};\n        wp::float32 adj_284 = {};\n        wp::float32 adj_285 = {};\n        wp::int32 adj_286 = {};\n        wp::float32 adj_287 = {};\n        wp::int32 adj_288 = {};\n        wp::int32 adj_289 = {};\n        wp::int32 adj_290 = {};\n        wp::float32 adj_291 = {};\n        wp::float32 adj_292 = {};\n        wp::float32 adj_293 = {};\n        wp::float32 adj_294 = {};\n        wp::int32 adj_295 = {};\n        wp::int32 adj_296 = {};\n        wp::float32 adj_297 = {};\n        wp::int32 adj_298 = {};\n        wp::int32 adj_299 = {};\n        wp::int32 adj_300 = {};\n        wp::float32 adj_301 = {};\n        wp::float32 adj_302 = {};\n        wp::float32 adj_303 = {};\n        wp::float32 adj_304 = {};\n        wp::int32 adj_305 = {};\n        wp::float32 adj_306 = {};\n        wp::int32 adj_307 = {};\n        wp::int32 adj_308 = {};\n        wp::int32 adj_309 = {};\n        wp::float32 adj_310 = {};\n        wp::float32 adj_311 = {};\n        wp::float32 adj_312 = {};\n        wp::float32 adj_313 = {};\n        wp::int32 adj_314 = {};\n        wp::float32 adj_315 = {};\n        wp::int32 adj_316 = {};\n        wp::int32 adj_317 = {};\n        wp::int32 adj_318 = {};\n        wp::float32 adj_319 = {};\n        wp::float32 adj_320 = {};\n        wp::float32 adj_321 = {};\n        wp::float32 adj_322 = {};\n        wp::int32 adj_323 = {};\n        wp::float32 adj_324 = {};\n        wp::int32 adj_325 = {};\n        wp::int32 adj_326 = {};\n        wp::int32 adj_327 = {};\n        wp::float32 adj_328 = {};\n        wp::float32 adj_329 = {};\n        wp::float32 adj_330 = {};\n        wp::float32 adj_331 = {};\n        wp::int32 adj_332 = {};\n        wp::float32 adj_333 = {};\n        wp::int32 adj_334 = {};\n        wp::int32 adj_335 = {};\n        wp::int32 adj_336 = {};\n        wp::float32 adj_337 = {};\n        wp::float32 adj_338 = {};\n        wp::float32 adj_339 = {};\n        wp::float32 adj_340 = {};\n        wp::int32 adj_341 = {};\n        wp::float32 adj_342 = {};\n        wp::int32 adj_343 = {};\n        wp::int32 adj_344 = {};\n        wp::int32 adj_345 = {};\n        wp::float32 adj_346 = {};\n        wp::float32 adj_347 = {};\n        wp::float32 adj_348 = {};\n        wp::float32 adj_349 = {};\n        wp::int32 adj_350 = {};\n        wp::float32 adj_351 = {};\n        wp::int32 adj_352 = {};\n        wp::int32 adj_353 = {};\n        wp::int32 adj_354 = {};\n        wp::float32 adj_355 = {};\n        wp::float32 adj_356 = {};\n        wp::float32 adj_357 = {};\n        wp::float32 adj_358 = {};\n        wp::int32 adj_359 = {};\n        wp::float32 adj_360 = {};\n        wp::int32 adj_361 = {};\n        wp::int32 adj_362 = {};\n        wp::int32 adj_363 = {};\n        wp::float32 adj_364 = {};\n        wp::float32 adj_365 = {};\n        wp::float32 adj_366 = {};\n        wp::float32 adj_367 = {};\n        wp::int32 adj_368 = {};\n        wp::int32 adj_369 = {};\n        wp::float32 adj_370 = {};\n        wp::int32 adj_371 = {};\n        wp::int32 adj_372 = {};\n        wp::int32 adj_373 = {};\n        wp::float32 adj_374 = {};\n        wp::float32 adj_375 = {};\n        wp::float32 adj_376 = {};\n        wp::float32 adj_377 = {};\n        wp::int32 adj_378 = {};\n        wp::float32 adj_379 = {};\n        wp::int32 adj_380 = {};\n        wp::int32 adj_381 = {};\n        wp::int32 adj_382 = {};\n        wp::float32 adj_383 = {};\n        wp::float32 adj_384 = {};\n        wp::float32 adj_385 = {};\n        wp::float32 adj_386 = {};\n        wp::int32 adj_387 = {};\n        wp::float32 adj_388 = {};\n        wp::int32 adj_389 = {};\n        wp::int32 adj_390 = {};\n        wp::int32 adj_391 = {};\n        wp::float32 adj_392 = {};\n        wp::float32 adj_393 = {};\n        wp::float32 adj_394 = {};\n        wp::float32 adj_395 = {};\n        wp::int32 adj_396 = {};\n        wp::float32 adj_397 = {};\n        wp::int32 adj_398 = {};\n        wp::int32 adj_399 = {};\n        wp::int32 adj_400 = {};\n        wp::float32 adj_401 = {};\n        wp::float32 adj_402 = {};\n        wp::float32 adj_403 = {};\n        wp::float32 adj_404 = {};\n        wp::int32 adj_405 = {};\n        wp::float32 adj_406 = {};\n        wp::int32 adj_407 = {};\n        wp::int32 adj_408 = {};\n        wp::int32 adj_409 = {};\n        wp::float32 adj_410 = {};\n        wp::float32 adj_411 = {};\n        wp::float32 adj_412 = {};\n        wp::float32 adj_413 = {};\n        wp::int32 adj_414 = {};\n        wp::float32 adj_415 = {};\n        wp::int32 adj_416 = {};\n        wp::int32 adj_417 = {};\n        wp::int32 adj_418 = {};\n        wp::float32 adj_419 = {};\n        wp::float32 adj_420 = {};\n        wp::float32 adj_421 = {};\n        wp::float32 adj_422 = {};\n        wp::int32 adj_423 = {};\n        wp::float32 adj_424 = {};\n        wp::int32 adj_425 = {};\n        wp::int32 adj_426 = {};\n        wp::int32 adj_427 = {};\n        wp::float32 adj_428 = {};\n        wp::float32 adj_429 = {};\n        wp::float32 adj_430 = {};\n        wp::float32 adj_431 = {};\n        wp::int32 adj_432 = {};\n        wp::float32 adj_433 = {};\n        wp::int32 adj_434 = {};\n        wp::int32 adj_435 = {};\n        wp::int32 adj_436 = {};\n        wp::float32 adj_437 = {};\n        wp::float32 adj_438 = {};\n        wp::float32 adj_439 = {};\n        wp::float32 adj_440 = {};\n        wp::int32 adj_441 = {};\n        wp::int32 adj_442 = {};\n        wp::float32 adj_443 = {};\n        wp::int32 adj_444 = {};\n        wp::int32 adj_445 = {};\n        wp::int32 adj_446 = {};\n        wp::float32 adj_447 = {};\n        wp::float32 adj_448 = {};\n        wp::float32 adj_449 = {};\n        wp::float32 adj_450 = {};\n        wp::int32 adj_451 = {};\n        wp::float32 adj_452 = {};\n        wp::int32 adj_453 = {};\n        wp::int32 adj_454 = {};\n        wp::int32 adj_455 = {};\n        wp::float32 adj_456 = {};\n        wp::float32 adj_457 = {};\n        wp::float32 adj_458 = {};\n        wp::float32 adj_459 = {};\n        wp::int32 adj_460 = {};\n        wp::float32 adj_461 = {};\n        wp::int32 adj_462 = {};\n        wp::int32 adj_463 = {};\n        wp::int32 adj_464 = {};\n        wp::float32 adj_465 = {};\n        wp::float32 adj_466 = {};\n        wp::float32 adj_467 = {};\n        wp::float32 adj_468 = {};\n        wp::int32 adj_469 = {};\n        wp::float32 adj_470 = {};\n        wp::int32 adj_471 = {};\n        wp::int32 adj_472 = {};\n        wp::int32 adj_473 = {};\n        wp::float32 adj_474 = {};\n        wp::float32 adj_475 = {};\n        wp::float32 adj_476 = {};\n        wp::float32 adj_477 = {};\n        wp::int32 adj_478 = {};\n        wp::float32 adj_479 = {};\n        wp::int32 adj_480 = {};\n        wp::int32 adj_481 = {};\n        wp::int32 adj_482 = {};\n        wp::float32 adj_483 = {};\n        wp::float32 adj_484 = {};\n        wp::float32 adj_485 = {};\n        wp::float32 adj_486 = {};\n        wp::int32 adj_487 = {};\n        wp::float32 adj_488 = {};\n        wp::int32 adj_489 = {};\n        wp::int32 adj_490 = {};\n        wp::int32 adj_491 = {};\n        wp::float32 adj_492 = {};\n        wp::float32 adj_493 = {};\n        wp::float32 adj_494 = {};\n        wp::float32 adj_495 = {};\n        wp::int32 adj_496 = {};\n        wp::float32 adj_497 = {};\n        wp::int32 adj_498 = {};\n        wp::int32 adj_499 = {};\n        wp::int32 adj_500 = {};\n        wp::float32 adj_501 = {};\n        wp::float32 adj_502 = {};\n        wp::float32 adj_503 = {};\n        wp::float32 adj_504 = {};\n        wp::int32 adj_505 = {};\n        wp::float32 adj_506 = {};\n        wp::int32 adj_507 = {};\n        wp::int32 adj_508 = {};\n        wp::int32 adj_509 = {};\n        wp::float32 adj_510 = {};\n        wp::float32 adj_511 = {};\n        wp::float32 adj_512 = {};\n        wp::float32 adj_513 = {};\n        //---------\n        // forward\n        // def nested_devohi(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        var_50 = wp::address(var_data, var_0);\n        var_51 = wp::mul(var_3, var_49);\n        var_53 = wp::add(var_51, var_52);\n        var_54 = wp::float(var_53);\n        var_56 = wp::load(var_50);\n        var_55 = wp::mul(var_56, var_54);\n        var_57 = wp::add(var_48, var_55);\n        var_59 = wp::address(var_data, var_0);\n        var_60 = wp::mul(var_3, var_58);\n        var_62 = wp::add(var_60, var_61);\n        var_63 = wp::float(var_62);\n        var_65 = wp::load(var_59);\n        var_64 = wp::mul(var_65, var_63);\n        var_66 = wp::add(var_57, var_64);\n        var_68 = wp::address(var_data, var_0);\n        var_69 = wp::mul(var_3, var_67);\n        var_71 = wp::add(var_69, var_70);\n        var_72 = wp::float(var_71);\n        var_74 = wp::load(var_68);\n        var_73 = wp::mul(var_74, var_72);\n        var_75 = wp::add(var_66, var_73);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_76, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_75, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_76, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        var_96 = wp::address(var_data, var_0);\n        var_97 = wp::mul(var_76, var_95);\n        var_99 = wp::add(var_97, var_98);\n        var_100 = wp::float(var_99);\n        var_102 = wp::load(var_96);\n        var_101 = wp::mul(var_102, var_100);\n        var_103 = wp::add(var_94, var_101);\n        var_105 = wp::address(var_data, var_0);\n        var_106 = wp::mul(var_76, var_104);\n        var_108 = wp::add(var_106, var_107);\n        var_109 = wp::float(var_108);\n        var_111 = wp::load(var_105);\n        var_110 = wp::mul(var_111, var_109);\n        var_112 = wp::add(var_103, var_110);\n        var_114 = wp::address(var_data, var_0);\n        var_115 = wp::mul(var_76, var_113);\n        var_117 = wp::add(var_115, var_116);\n        var_118 = wp::float(var_117);\n        var_120 = wp::load(var_114);\n        var_119 = wp::mul(var_120, var_118);\n        var_121 = wp::add(var_112, var_119);\n        var_123 = wp::address(var_data, var_0);\n        var_124 = wp::mul(var_76, var_122);\n        var_126 = wp::add(var_124, var_125);\n        var_127 = wp::float(var_126);\n        var_129 = wp::load(var_123);\n        var_128 = wp::mul(var_129, var_127);\n        var_130 = wp::add(var_121, var_128);\n        var_132 = wp::address(var_data, var_0);\n        var_133 = wp::mul(var_76, var_131);\n        var_135 = wp::add(var_133, var_134);\n        var_136 = wp::float(var_135);\n        var_138 = wp::load(var_132);\n        var_137 = wp::mul(var_138, var_136);\n        var_139 = wp::add(var_130, var_137);\n        var_141 = wp::address(var_data, var_0);\n        var_142 = wp::mul(var_76, var_140);\n        var_144 = wp::add(var_142, var_143);\n        var_145 = wp::float(var_144);\n        var_147 = wp::load(var_141);\n        var_146 = wp::mul(var_147, var_145);\n        var_148 = wp::add(var_139, var_146);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_151 = wp::address(var_data, var_0);\n        var_152 = wp::mul(var_149, var_150);\n        var_154 = wp::add(var_152, var_153);\n        var_155 = wp::float(var_154);\n        var_157 = wp::load(var_151);\n        var_156 = wp::mul(var_157, var_155);\n        var_158 = wp::add(var_148, var_156);\n        var_160 = wp::address(var_data, var_0);\n        var_161 = wp::mul(var_149, var_159);\n        var_163 = wp::add(var_161, var_162);\n        var_164 = wp::float(var_163);\n        var_166 = wp::load(var_160);\n        var_165 = wp::mul(var_166, var_164);\n        var_167 = wp::add(var_158, var_165);\n        var_169 = wp::address(var_data, var_0);\n        var_170 = wp::mul(var_149, var_168);\n        var_172 = wp::add(var_170, var_171);\n        var_173 = wp::float(var_172);\n        var_175 = wp::load(var_169);\n        var_174 = wp::mul(var_175, var_173);\n        var_176 = wp::add(var_167, var_174);\n        var_178 = wp::address(var_data, var_0);\n        var_179 = wp::mul(var_149, var_177);\n        var_181 = wp::add(var_179, var_180);\n        var_182 = wp::float(var_181);\n        var_184 = wp::load(var_178);\n        var_183 = wp::mul(var_184, var_182);\n        var_185 = wp::add(var_176, var_183);\n        var_187 = wp::address(var_data, var_0);\n        var_188 = wp::mul(var_149, var_186);\n        var_190 = wp::add(var_188, var_189);\n        var_191 = wp::float(var_190);\n        var_193 = wp::load(var_187);\n        var_192 = wp::mul(var_193, var_191);\n        var_194 = wp::add(var_185, var_192);\n        var_196 = wp::address(var_data, var_0);\n        var_197 = wp::mul(var_149, var_195);\n        var_199 = wp::add(var_197, var_198);\n        var_200 = wp::float(var_199);\n        var_202 = wp::load(var_196);\n        var_201 = wp::mul(var_202, var_200);\n        var_203 = wp::add(var_194, var_201);\n        var_205 = wp::address(var_data, var_0);\n        var_206 = wp::mul(var_149, var_204);\n        var_208 = wp::add(var_206, var_207);\n        var_209 = wp::float(var_208);\n        var_211 = wp::load(var_205);\n        var_210 = wp::mul(var_211, var_209);\n        var_212 = wp::add(var_203, var_210);\n        var_214 = wp::address(var_data, var_0);\n        var_215 = wp::mul(var_149, var_213);\n        var_217 = wp::add(var_215, var_216);\n        var_218 = wp::float(var_217);\n        var_220 = wp::load(var_214);\n        var_219 = wp::mul(var_220, var_218);\n        var_221 = wp::add(var_212, var_219);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_224 = wp::address(var_data, var_0);\n        var_225 = wp::mul(var_222, var_223);\n        var_227 = wp::add(var_225, var_226);\n        var_228 = wp::float(var_227);\n        var_230 = wp::load(var_224);\n        var_229 = wp::mul(var_230, var_228);\n        var_231 = wp::add(var_221, var_229);\n        var_233 = wp::address(var_data, var_0);\n        var_234 = wp::mul(var_222, var_232);\n        var_236 = wp::add(var_234, var_235);\n        var_237 = wp::float(var_236);\n        var_239 = wp::load(var_233);\n        var_238 = wp::mul(var_239, var_237);\n        var_240 = wp::add(var_231, var_238);\n        var_242 = wp::address(var_data, var_0);\n        var_243 = wp::mul(var_222, var_241);\n        var_245 = wp::add(var_243, var_244);\n        var_246 = wp::float(var_245);\n        var_248 = wp::load(var_242);\n        var_247 = wp::mul(var_248, var_246);\n        var_249 = wp::add(var_240, var_247);\n        var_251 = wp::address(var_data, var_0);\n        var_252 = wp::mul(var_222, var_250);\n        var_254 = wp::add(var_252, var_253);\n        var_255 = wp::float(var_254);\n        var_257 = wp::load(var_251);\n        var_256 = wp::mul(var_257, var_255);\n        var_258 = wp::add(var_249, var_256);\n        var_260 = wp::address(var_data, var_0);\n        var_261 = wp::mul(var_222, var_259);\n        var_263 = wp::add(var_261, var_262);\n        var_264 = wp::float(var_263);\n        var_266 = wp::load(var_260);\n        var_265 = wp::mul(var_266, var_264);\n        var_267 = wp::add(var_258, var_265);\n        var_269 = wp::address(var_data, var_0);\n        var_270 = wp::mul(var_222, var_268);\n        var_272 = wp::add(var_270, var_271);\n        var_273 = wp::float(var_272);\n        var_275 = wp::load(var_269);\n        var_274 = wp::mul(var_275, var_273);\n        var_276 = wp::add(var_267, var_274);\n        var_278 = wp::address(var_data, var_0);\n        var_279 = wp::mul(var_222, var_277);\n        var_281 = wp::add(var_279, var_280);\n        var_282 = wp::float(var_281);\n        var_284 = wp::load(var_278);\n        var_283 = wp::mul(var_284, var_282);\n        var_285 = wp::add(var_276, var_283);\n        var_287 = wp::address(var_data, var_0);\n        var_288 = wp::mul(var_222, var_286);\n        var_290 = wp::add(var_288, var_289);\n        var_291 = wp::float(var_290);\n        var_293 = wp::load(var_287);\n        var_292 = wp::mul(var_293, var_291);\n        var_294 = wp::add(var_285, var_292);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_297 = wp::address(var_data, var_0);\n        var_298 = wp::mul(var_295, var_296);\n        var_300 = wp::add(var_298, var_299);\n        var_301 = wp::float(var_300);\n        var_303 = wp::load(var_297);\n        var_302 = wp::mul(var_303, var_301);\n        var_304 = wp::add(var_294, var_302);\n        var_306 = wp::address(var_data, var_0);\n        var_307 = wp::mul(var_295, var_305);\n        var_309 = wp::add(var_307, var_308);\n        var_310 = wp::float(var_309);\n        var_312 = wp::load(var_306);\n        var_311 = wp::mul(var_312, var_310);\n        var_313 = wp::add(var_304, var_311);\n        var_315 = wp::address(var_data, var_0);\n        var_316 = wp::mul(var_295, var_314);\n        var_318 = wp::add(var_316, var_317);\n        var_319 = wp::float(var_318);\n        var_321 = wp::load(var_315);\n        var_320 = wp::mul(var_321, var_319);\n        var_322 = wp::add(var_313, var_320);\n        var_324 = wp::address(var_data, var_0);\n        var_325 = wp::mul(var_295, var_323);\n        var_327 = wp::add(var_325, var_326);\n        var_328 = wp::float(var_327);\n        var_330 = wp::load(var_324);\n        var_329 = wp::mul(var_330, var_328);\n        var_331 = wp::add(var_322, var_329);\n        var_333 = wp::address(var_data, var_0);\n        var_334 = wp::mul(var_295, var_332);\n        var_336 = wp::add(var_334, var_335);\n        var_337 = wp::float(var_336);\n        var_339 = wp::load(var_333);\n        var_338 = wp::mul(var_339, var_337);\n        var_340 = wp::add(var_331, var_338);\n        var_342 = wp::address(var_data, var_0);\n        var_343 = wp::mul(var_295, var_341);\n        var_345 = wp::add(var_343, var_344);\n        var_346 = wp::float(var_345);\n        var_348 = wp::load(var_342);\n        var_347 = wp::mul(var_348, var_346);\n        var_349 = wp::add(var_340, var_347);\n        var_351 = wp::address(var_data, var_0);\n        var_352 = wp::mul(var_295, var_350);\n        var_354 = wp::add(var_352, var_353);\n        var_355 = wp::float(var_354);\n        var_357 = wp::load(var_351);\n        var_356 = wp::mul(var_357, var_355);\n        var_358 = wp::add(var_349, var_356);\n        var_360 = wp::address(var_data, var_0);\n        var_361 = wp::mul(var_295, var_359);\n        var_363 = wp::add(var_361, var_362);\n        var_364 = wp::float(var_363);\n        var_366 = wp::load(var_360);\n        var_365 = wp::mul(var_366, var_364);\n        var_367 = wp::add(var_358, var_365);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_370 = wp::address(var_data, var_0);\n        var_371 = wp::mul(var_368, var_369);\n        var_373 = wp::add(var_371, var_372);\n        var_374 = wp::float(var_373);\n        var_376 = wp::load(var_370);\n        var_375 = wp::mul(var_376, var_374);\n        var_377 = wp::add(var_367, var_375);\n        var_379 = wp::address(var_data, var_0);\n        var_380 = wp::mul(var_368, var_378);\n        var_382 = wp::add(var_380, var_381);\n        var_383 = wp::float(var_382);\n        var_385 = wp::load(var_379);\n        var_384 = wp::mul(var_385, var_383);\n        var_386 = wp::add(var_377, var_384);\n        var_388 = wp::address(var_data, var_0);\n        var_389 = wp::mul(var_368, var_387);\n        var_391 = wp::add(var_389, var_390);\n        var_392 = wp::float(var_391);\n        var_394 = wp::load(var_388);\n        var_393 = wp::mul(var_394, var_392);\n        var_395 = wp::add(var_386, var_393);\n        var_397 = wp::address(var_data, var_0);\n        var_398 = wp::mul(var_368, var_396);\n        var_400 = wp::add(var_398, var_399);\n        var_401 = wp::float(var_400);\n        var_403 = wp::load(var_397);\n        var_402 = wp::mul(var_403, var_401);\n        var_404 = wp::add(var_395, var_402);\n        var_406 = wp::address(var_data, var_0);\n        var_407 = wp::mul(var_368, var_405);\n        var_409 = wp::add(var_407, var_408);\n        var_410 = wp::float(var_409);\n        var_412 = wp::load(var_406);\n        var_411 = wp::mul(var_412, var_410);\n        var_413 = wp::add(var_404, var_411);\n        var_415 = wp::address(var_data, var_0);\n        var_416 = wp::mul(var_368, var_414);\n        var_418 = wp::add(var_416, var_417);\n        var_419 = wp::float(var_418);\n        var_421 = wp::load(var_415);\n        var_420 = wp::mul(var_421, var_419);\n        var_422 = wp::add(var_413, var_420);\n        var_424 = wp::address(var_data, var_0);\n        var_425 = wp::mul(var_368, var_423);\n        var_427 = wp::add(var_425, var_426);\n        var_428 = wp::float(var_427);\n        var_430 = wp::load(var_424);\n        var_429 = wp::mul(var_430, var_428);\n        var_431 = wp::add(var_422, var_429);\n        var_433 = wp::address(var_data, var_0);\n        var_434 = wp::mul(var_368, var_432);\n        var_436 = wp::add(var_434, var_435);\n        var_437 = wp::float(var_436);\n        var_439 = wp::load(var_433);\n        var_438 = wp::mul(var_439, var_437);\n        var_440 = wp::add(var_431, var_438);\n        // for j in range(8):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_443 = wp::address(var_data, var_0);\n        var_444 = wp::mul(var_441, var_442);\n        var_446 = wp::add(var_444, var_445);\n        var_447 = wp::float(var_446);\n        var_449 = wp::load(var_443);\n        var_448 = wp::mul(var_449, var_447);\n        var_450 = wp::add(var_440, var_448);\n        var_452 = wp::address(var_data, var_0);\n        var_453 = wp::mul(var_441, var_451);\n        var_455 = wp::add(var_453, var_454);\n        var_456 = wp::float(var_455);\n        var_458 = wp::load(var_452);\n        var_457 = wp::mul(var_458, var_456);\n        var_459 = wp::add(var_450, var_457);\n        var_461 = wp::address(var_data, var_0);\n        var_462 = wp::mul(var_441, var_460);\n        var_464 = wp::add(var_462, var_463);\n        var_465 = wp::float(var_464);\n        var_467 = wp::load(var_461);\n        var_466 = wp::mul(var_467, var_465);\n        var_468 = wp::add(var_459, var_466);\n        var_470 = wp::address(var_data, var_0);\n        var_471 = wp::mul(var_441, var_469);\n        var_473 = wp::add(var_471, var_472);\n        var_474 = wp::float(var_473);\n        var_476 = wp::load(var_470);\n        var_475 = wp::mul(var_476, var_474);\n        var_477 = wp::add(var_468, var_475);\n        var_479 = wp::address(var_data, var_0);\n        var_480 = wp::mul(var_441, var_478);\n        var_482 = wp::add(var_480, var_481);\n        var_483 = wp::float(var_482);\n        var_485 = wp::load(var_479);\n        var_484 = wp::mul(var_485, var_483);\n        var_486 = wp::add(var_477, var_484);\n        var_488 = wp::address(var_data, var_0);\n        var_489 = wp::mul(var_441, var_487);\n        var_491 = wp::add(var_489, var_490);\n        var_492 = wp::float(var_491);\n        var_494 = wp::load(var_488);\n        var_493 = wp::mul(var_494, var_492);\n        var_495 = wp::add(var_486, var_493);\n        var_497 = wp::address(var_data, var_0);\n        var_498 = wp::mul(var_441, var_496);\n        var_500 = wp::add(var_498, var_499);\n        var_501 = wp::float(var_500);\n        var_503 = wp::load(var_497);\n        var_502 = wp::mul(var_503, var_501);\n        var_504 = wp::add(var_495, var_502);\n        var_506 = wp::address(var_data, var_0);\n        var_507 = wp::mul(var_441, var_505);\n        var_509 = wp::add(var_507, var_508);\n        var_510 = wp::float(var_509);\n        var_512 = wp::load(var_506);\n        var_511 = wp::mul(var_512, var_510);\n        var_513 = wp::add(var_504, var_511);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_513);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_513, adj_out, adj_0, adj_513);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_504, var_511, adj_504, adj_511, adj_513);\n        wp::adj_mul(var_512, var_510, adj_506, adj_510, adj_511);\n        wp::adj_float(var_509, adj_509, adj_510);\n        wp::adj_add(var_507, var_508, adj_507, adj_508, adj_509);\n        wp::adj_mul(var_441, var_505, adj_441, adj_505, adj_507);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_506);\n        wp::adj_add(var_495, var_502, adj_495, adj_502, adj_504);\n        wp::adj_mul(var_503, var_501, adj_497, adj_501, adj_502);\n        wp::adj_float(var_500, adj_500, adj_501);\n        wp::adj_add(var_498, var_499, adj_498, adj_499, adj_500);\n        wp::adj_mul(var_441, var_496, adj_441, adj_496, adj_498);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_497);\n        wp::adj_add(var_486, var_493, adj_486, adj_493, adj_495);\n        wp::adj_mul(var_494, var_492, adj_488, adj_492, adj_493);\n        wp::adj_float(var_491, adj_491, adj_492);\n        wp::adj_add(var_489, var_490, adj_489, adj_490, adj_491);\n        wp::adj_mul(var_441, var_487, adj_441, adj_487, adj_489);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_488);\n        wp::adj_add(var_477, var_484, adj_477, adj_484, adj_486);\n        wp::adj_mul(var_485, var_483, adj_479, adj_483, adj_484);\n        wp::adj_float(var_482, adj_482, adj_483);\n        wp::adj_add(var_480, var_481, adj_480, adj_481, adj_482);\n        wp::adj_mul(var_441, var_478, adj_441, adj_478, adj_480);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_479);\n        wp::adj_add(var_468, var_475, adj_468, adj_475, adj_477);\n        wp::adj_mul(var_476, var_474, adj_470, adj_474, adj_475);\n        wp::adj_float(var_473, adj_473, adj_474);\n        wp::adj_add(var_471, var_472, adj_471, adj_472, adj_473);\n        wp::adj_mul(var_441, var_469, adj_441, adj_469, adj_471);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_470);\n        wp::adj_add(var_459, var_466, adj_459, adj_466, adj_468);\n        wp::adj_mul(var_467, var_465, adj_461, adj_465, adj_466);\n        wp::adj_float(var_464, adj_464, adj_465);\n        wp::adj_add(var_462, var_463, adj_462, adj_463, adj_464);\n        wp::adj_mul(var_441, var_460, adj_441, adj_460, adj_462);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_461);\n        wp::adj_add(var_450, var_457, adj_450, adj_457, adj_459);\n        wp::adj_mul(var_458, var_456, adj_452, adj_456, adj_457);\n        wp::adj_float(var_455, adj_455, adj_456);\n        wp::adj_add(var_453, var_454, adj_453, adj_454, adj_455);\n        wp::adj_mul(var_441, var_451, adj_441, adj_451, adj_453);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_452);\n        wp::adj_add(var_440, var_448, adj_440, adj_448, adj_450);\n        wp::adj_mul(var_449, var_447, adj_443, adj_447, adj_448);\n        wp::adj_float(var_446, adj_446, adj_447);\n        wp::adj_add(var_444, var_445, adj_444, adj_445, adj_446);\n        wp::adj_mul(var_441, var_442, adj_441, adj_442, adj_444);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_443);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_431, var_438, adj_431, adj_438, adj_440);\n        wp::adj_mul(var_439, var_437, adj_433, adj_437, adj_438);\n        wp::adj_float(var_436, adj_436, adj_437);\n        wp::adj_add(var_434, var_435, adj_434, adj_435, adj_436);\n        wp::adj_mul(var_368, var_432, adj_368, adj_432, adj_434);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_433);\n        wp::adj_add(var_422, var_429, adj_422, adj_429, adj_431);\n        wp::adj_mul(var_430, var_428, adj_424, adj_428, adj_429);\n        wp::adj_float(var_427, adj_427, adj_428);\n        wp::adj_add(var_425, var_426, adj_425, adj_426, adj_427);\n        wp::adj_mul(var_368, var_423, adj_368, adj_423, adj_425);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_424);\n        wp::adj_add(var_413, var_420, adj_413, adj_420, adj_422);\n        wp::adj_mul(var_421, var_419, adj_415, adj_419, adj_420);\n        wp::adj_float(var_418, adj_418, adj_419);\n        wp::adj_add(var_416, var_417, adj_416, adj_417, adj_418);\n        wp::adj_mul(var_368, var_414, adj_368, adj_414, adj_416);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_415);\n        wp::adj_add(var_404, var_411, adj_404, adj_411, adj_413);\n        wp::adj_mul(var_412, var_410, adj_406, adj_410, adj_411);\n        wp::adj_float(var_409, adj_409, adj_410);\n        wp::adj_add(var_407, var_408, adj_407, adj_408, adj_409);\n        wp::adj_mul(var_368, var_405, adj_368, adj_405, adj_407);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_406);\n        wp::adj_add(var_395, var_402, adj_395, adj_402, adj_404);\n        wp::adj_mul(var_403, var_401, adj_397, adj_401, adj_402);\n        wp::adj_float(var_400, adj_400, adj_401);\n        wp::adj_add(var_398, var_399, adj_398, adj_399, adj_400);\n        wp::adj_mul(var_368, var_396, adj_368, adj_396, adj_398);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_397);\n        wp::adj_add(var_386, var_393, adj_386, adj_393, adj_395);\n        wp::adj_mul(var_394, var_392, adj_388, adj_392, adj_393);\n        wp::adj_float(var_391, adj_391, adj_392);\n        wp::adj_add(var_389, var_390, adj_389, adj_390, adj_391);\n        wp::adj_mul(var_368, var_387, adj_368, adj_387, adj_389);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_388);\n        wp::adj_add(var_377, var_384, adj_377, adj_384, adj_386);\n        wp::adj_mul(var_385, var_383, adj_379, adj_383, adj_384);\n        wp::adj_float(var_382, adj_382, adj_383);\n        wp::adj_add(var_380, var_381, adj_380, adj_381, adj_382);\n        wp::adj_mul(var_368, var_378, adj_368, adj_378, adj_380);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_379);\n        wp::adj_add(var_367, var_375, adj_367, adj_375, adj_377);\n        wp::adj_mul(var_376, var_374, adj_370, adj_374, adj_375);\n        wp::adj_float(var_373, adj_373, adj_374);\n        wp::adj_add(var_371, var_372, adj_371, adj_372, adj_373);\n        wp::adj_mul(var_368, var_369, adj_368, adj_369, adj_371);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_370);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_358, var_365, adj_358, adj_365, adj_367);\n        wp::adj_mul(var_366, var_364, adj_360, adj_364, adj_365);\n        wp::adj_float(var_363, adj_363, adj_364);\n        wp::adj_add(var_361, var_362, adj_361, adj_362, adj_363);\n        wp::adj_mul(var_295, var_359, adj_295, adj_359, adj_361);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_360);\n        wp::adj_add(var_349, var_356, adj_349, adj_356, adj_358);\n        wp::adj_mul(var_357, var_355, adj_351, adj_355, adj_356);\n        wp::adj_float(var_354, adj_354, adj_355);\n        wp::adj_add(var_352, var_353, adj_352, adj_353, adj_354);\n        wp::adj_mul(var_295, var_350, adj_295, adj_350, adj_352);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_351);\n        wp::adj_add(var_340, var_347, adj_340, adj_347, adj_349);\n        wp::adj_mul(var_348, var_346, adj_342, adj_346, adj_347);\n        wp::adj_float(var_345, adj_345, adj_346);\n        wp::adj_add(var_343, var_344, adj_343, adj_344, adj_345);\n        wp::adj_mul(var_295, var_341, adj_295, adj_341, adj_343);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_342);\n        wp::adj_add(var_331, var_338, adj_331, adj_338, adj_340);\n        wp::adj_mul(var_339, var_337, adj_333, adj_337, adj_338);\n        wp::adj_float(var_336, adj_336, adj_337);\n        wp::adj_add(var_334, var_335, adj_334, adj_335, adj_336);\n        wp::adj_mul(var_295, var_332, adj_295, adj_332, adj_334);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_333);\n        wp::adj_add(var_322, var_329, adj_322, adj_329, adj_331);\n        wp::adj_mul(var_330, var_328, adj_324, adj_328, adj_329);\n        wp::adj_float(var_327, adj_327, adj_328);\n        wp::adj_add(var_325, var_326, adj_325, adj_326, adj_327);\n        wp::adj_mul(var_295, var_323, adj_295, adj_323, adj_325);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_324);\n        wp::adj_add(var_313, var_320, adj_313, adj_320, adj_322);\n        wp::adj_mul(var_321, var_319, adj_315, adj_319, adj_320);\n        wp::adj_float(var_318, adj_318, adj_319);\n        wp::adj_add(var_316, var_317, adj_316, adj_317, adj_318);\n        wp::adj_mul(var_295, var_314, adj_295, adj_314, adj_316);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_315);\n        wp::adj_add(var_304, var_311, adj_304, adj_311, adj_313);\n        wp::adj_mul(var_312, var_310, adj_306, adj_310, adj_311);\n        wp::adj_float(var_309, adj_309, adj_310);\n        wp::adj_add(var_307, var_308, adj_307, adj_308, adj_309);\n        wp::adj_mul(var_295, var_305, adj_295, adj_305, adj_307);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_306);\n        wp::adj_add(var_294, var_302, adj_294, adj_302, adj_304);\n        wp::adj_mul(var_303, var_301, adj_297, adj_301, adj_302);\n        wp::adj_float(var_300, adj_300, adj_301);\n        wp::adj_add(var_298, var_299, adj_298, adj_299, adj_300);\n        wp::adj_mul(var_295, var_296, adj_295, adj_296, adj_298);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_297);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_285, var_292, adj_285, adj_292, adj_294);\n        wp::adj_mul(var_293, var_291, adj_287, adj_291, adj_292);\n        wp::adj_float(var_290, adj_290, adj_291);\n        wp::adj_add(var_288, var_289, adj_288, adj_289, adj_290);\n        wp::adj_mul(var_222, var_286, adj_222, adj_286, adj_288);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_287);\n        wp::adj_add(var_276, var_283, adj_276, adj_283, adj_285);\n        wp::adj_mul(var_284, var_282, adj_278, adj_282, adj_283);\n        wp::adj_float(var_281, adj_281, adj_282);\n        wp::adj_add(var_279, var_280, adj_279, adj_280, adj_281);\n        wp::adj_mul(var_222, var_277, adj_222, adj_277, adj_279);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_278);\n        wp::adj_add(var_267, var_274, adj_267, adj_274, adj_276);\n        wp::adj_mul(var_275, var_273, adj_269, adj_273, adj_274);\n        wp::adj_float(var_272, adj_272, adj_273);\n        wp::adj_add(var_270, var_271, adj_270, adj_271, adj_272);\n        wp::adj_mul(var_222, var_268, adj_222, adj_268, adj_270);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_269);\n        wp::adj_add(var_258, var_265, adj_258, adj_265, adj_267);\n        wp::adj_mul(var_266, var_264, adj_260, adj_264, adj_265);\n        wp::adj_float(var_263, adj_263, adj_264);\n        wp::adj_add(var_261, var_262, adj_261, adj_262, adj_263);\n        wp::adj_mul(var_222, var_259, adj_222, adj_259, adj_261);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_260);\n        wp::adj_add(var_249, var_256, adj_249, adj_256, adj_258);\n        wp::adj_mul(var_257, var_255, adj_251, adj_255, adj_256);\n        wp::adj_float(var_254, adj_254, adj_255);\n        wp::adj_add(var_252, var_253, adj_252, adj_253, adj_254);\n        wp::adj_mul(var_222, var_250, adj_222, adj_250, adj_252);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_251);\n        wp::adj_add(var_240, var_247, adj_240, adj_247, adj_249);\n        wp::adj_mul(var_248, var_246, adj_242, adj_246, adj_247);\n        wp::adj_float(var_245, adj_245, adj_246);\n        wp::adj_add(var_243, var_244, adj_243, adj_244, adj_245);\n        wp::adj_mul(var_222, var_241, adj_222, adj_241, adj_243);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_242);\n        wp::adj_add(var_231, var_238, adj_231, adj_238, adj_240);\n        wp::adj_mul(var_239, var_237, adj_233, adj_237, adj_238);\n        wp::adj_float(var_236, adj_236, adj_237);\n        wp::adj_add(var_234, var_235, adj_234, adj_235, adj_236);\n        wp::adj_mul(var_222, var_232, adj_222, adj_232, adj_234);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_233);\n        wp::adj_add(var_221, var_229, adj_221, adj_229, adj_231);\n        wp::adj_mul(var_230, var_228, adj_224, adj_228, adj_229);\n        wp::adj_float(var_227, adj_227, adj_228);\n        wp::adj_add(var_225, var_226, adj_225, adj_226, adj_227);\n        wp::adj_mul(var_222, var_223, adj_222, adj_223, adj_225);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_224);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_212, var_219, adj_212, adj_219, adj_221);\n        wp::adj_mul(var_220, var_218, adj_214, adj_218, adj_219);\n        wp::adj_float(var_217, adj_217, adj_218);\n        wp::adj_add(var_215, var_216, adj_215, adj_216, adj_217);\n        wp::adj_mul(var_149, var_213, adj_149, adj_213, adj_215);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_214);\n        wp::adj_add(var_203, var_210, adj_203, adj_210, adj_212);\n        wp::adj_mul(var_211, var_209, adj_205, adj_209, adj_210);\n        wp::adj_float(var_208, adj_208, adj_209);\n        wp::adj_add(var_206, var_207, adj_206, adj_207, adj_208);\n        wp::adj_mul(var_149, var_204, adj_149, adj_204, adj_206);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_205);\n        wp::adj_add(var_194, var_201, adj_194, adj_201, adj_203);\n        wp::adj_mul(var_202, var_200, adj_196, adj_200, adj_201);\n        wp::adj_float(var_199, adj_199, adj_200);\n        wp::adj_add(var_197, var_198, adj_197, adj_198, adj_199);\n        wp::adj_mul(var_149, var_195, adj_149, adj_195, adj_197);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_196);\n        wp::adj_add(var_185, var_192, adj_185, adj_192, adj_194);\n        wp::adj_mul(var_193, var_191, adj_187, adj_191, adj_192);\n        wp::adj_float(var_190, adj_190, adj_191);\n        wp::adj_add(var_188, var_189, adj_188, adj_189, adj_190);\n        wp::adj_mul(var_149, var_186, adj_149, adj_186, adj_188);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_187);\n        wp::adj_add(var_176, var_183, adj_176, adj_183, adj_185);\n        wp::adj_mul(var_184, var_182, adj_178, adj_182, adj_183);\n        wp::adj_float(var_181, adj_181, adj_182);\n        wp::adj_add(var_179, var_180, adj_179, adj_180, adj_181);\n        wp::adj_mul(var_149, var_177, adj_149, adj_177, adj_179);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_178);\n        wp::adj_add(var_167, var_174, adj_167, adj_174, adj_176);\n        wp::adj_mul(var_175, var_173, adj_169, adj_173, adj_174);\n        wp::adj_float(var_172, adj_172, adj_173);\n        wp::adj_add(var_170, var_171, adj_170, adj_171, adj_172);\n        wp::adj_mul(var_149, var_168, adj_149, adj_168, adj_170);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_169);\n        wp::adj_add(var_158, var_165, adj_158, adj_165, adj_167);\n        wp::adj_mul(var_166, var_164, adj_160, adj_164, adj_165);\n        wp::adj_float(var_163, adj_163, adj_164);\n        wp::adj_add(var_161, var_162, adj_161, adj_162, adj_163);\n        wp::adj_mul(var_149, var_159, adj_149, adj_159, adj_161);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_160);\n        wp::adj_add(var_148, var_156, adj_148, adj_156, adj_158);\n        wp::adj_mul(var_157, var_155, adj_151, adj_155, adj_156);\n        wp::adj_float(var_154, adj_154, adj_155);\n        wp::adj_add(var_152, var_153, adj_152, adj_153, adj_154);\n        wp::adj_mul(var_149, var_150, adj_149, adj_150, adj_152);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_151);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_139, var_146, adj_139, adj_146, adj_148);\n        wp::adj_mul(var_147, var_145, adj_141, adj_145, adj_146);\n        wp::adj_float(var_144, adj_144, adj_145);\n        wp::adj_add(var_142, var_143, adj_142, adj_143, adj_144);\n        wp::adj_mul(var_76, var_140, adj_76, adj_140, adj_142);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_141);\n        wp::adj_add(var_130, var_137, adj_130, adj_137, adj_139);\n        wp::adj_mul(var_138, var_136, adj_132, adj_136, adj_137);\n        wp::adj_float(var_135, adj_135, adj_136);\n        wp::adj_add(var_133, var_134, adj_133, adj_134, adj_135);\n        wp::adj_mul(var_76, var_131, adj_76, adj_131, adj_133);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_132);\n        wp::adj_add(var_121, var_128, adj_121, adj_128, adj_130);\n        wp::adj_mul(var_129, var_127, adj_123, adj_127, adj_128);\n        wp::adj_float(var_126, adj_126, adj_127);\n        wp::adj_add(var_124, var_125, adj_124, adj_125, adj_126);\n        wp::adj_mul(var_76, var_122, adj_76, adj_122, adj_124);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_123);\n        wp::adj_add(var_112, var_119, adj_112, adj_119, adj_121);\n        wp::adj_mul(var_120, var_118, adj_114, adj_118, adj_119);\n        wp::adj_float(var_117, adj_117, adj_118);\n        wp::adj_add(var_115, var_116, adj_115, adj_116, adj_117);\n        wp::adj_mul(var_76, var_113, adj_76, adj_113, adj_115);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_114);\n        wp::adj_add(var_103, var_110, adj_103, adj_110, adj_112);\n        wp::adj_mul(var_111, var_109, adj_105, adj_109, adj_110);\n        wp::adj_float(var_108, adj_108, adj_109);\n        wp::adj_add(var_106, var_107, adj_106, adj_107, adj_108);\n        wp::adj_mul(var_76, var_104, adj_76, adj_104, adj_106);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_105);\n        wp::adj_add(var_94, var_101, adj_94, adj_101, adj_103);\n        wp::adj_mul(var_102, var_100, adj_96, adj_100, adj_101);\n        wp::adj_float(var_99, adj_99, adj_100);\n        wp::adj_add(var_97, var_98, adj_97, adj_98, adj_99);\n        wp::adj_mul(var_76, var_95, adj_76, adj_95, adj_97);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_96);\n        wp::adj_add(var_85, var_92, adj_85, adj_92, adj_94);\n        wp::adj_mul(var_93, var_91, adj_87, adj_91, adj_92);\n        wp::adj_float(var_90, adj_90, adj_91);\n        wp::adj_add(var_88, var_89, adj_88, adj_89, adj_90);\n        wp::adj_mul(var_76, var_86, adj_76, adj_86, adj_88);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_87);\n        wp::adj_add(var_75, var_83, adj_75, adj_83, adj_85);\n        wp::adj_mul(var_84, var_82, adj_78, adj_82, adj_83);\n        wp::adj_float(var_81, adj_81, adj_82);\n        wp::adj_add(var_79, var_80, adj_79, adj_80, adj_81);\n        wp::adj_mul(var_76, var_77, adj_76, adj_77, adj_79);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_78);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        wp::adj_add(var_66, var_73, adj_66, adj_73, adj_75);\n        wp::adj_mul(var_74, var_72, adj_68, adj_72, adj_73);\n        wp::adj_float(var_71, adj_71, adj_72);\n        wp::adj_add(var_69, var_70, adj_69, adj_70, adj_71);\n        wp::adj_mul(var_3, var_67, adj_3, adj_67, adj_69);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_68);\n        wp::adj_add(var_57, var_64, adj_57, adj_64, adj_66);\n        wp::adj_mul(var_65, var_63, adj_59, adj_63, adj_64);\n        wp::adj_float(var_62, adj_62, adj_63);\n        wp::adj_add(var_60, var_61, adj_60, adj_61, adj_62);\n        wp::adj_mul(var_3, var_58, adj_3, adj_58, adj_60);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_59);\n        wp::adj_add(var_48, var_55, adj_48, adj_55, adj_57);\n        wp::adj_mul(var_56, var_54, adj_50, adj_54, adj_55);\n        wp::adj_float(var_53, adj_53, adj_54);\n        wp::adj_add(var_51, var_52, adj_51, adj_52, adj_53);\n        wp::adj_mul(var_3, var_49, adj_3, adj_49, adj_51);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_50);\n        wp::adj_add(var_39, var_46, adj_39, adj_46, adj_48);\n        wp::adj_mul(var_47, var_45, adj_41, adj_45, adj_46);\n        wp::adj_float(var_44, adj_44, adj_45);\n        wp::adj_add(var_42, var_43, adj_42, adj_43, adj_44);\n        wp::adj_mul(var_3, var_40, adj_3, adj_40, adj_42);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_41);\n        wp::adj_add(var_30, var_37, adj_30, adj_37, adj_39);\n        wp::adj_mul(var_38, var_36, adj_32, adj_36, adj_37);\n        wp::adj_float(var_35, adj_35, adj_36);\n        wp::adj_add(var_33, var_34, adj_33, adj_34, adj_35);\n        wp::adj_mul(var_3, var_31, adj_3, adj_31, adj_33);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_32);\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(8):                                                                <L 8>\n        // adj: for i in range(7):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_devohi(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_devohi","mangled_name":"nested_devohi_8a16bc0b","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_devohi(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(7):\n        for j in range(8):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"atom_kexqns_6cb18f2dbd","device":"cuda","category":"atomic","description":"Atomic min reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"min","seed":88},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_kexqns_f38427ba_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_kexqns(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_min(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_kexqns_f38427ba_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_kexqns(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_min(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_min(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_min(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_kexqns(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_kexqns","mangled_name":"atom_kexqns_f38427ba","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_kexqns(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_min(result, 0, values[tid])\n"}
{"id":"multicond_cpzdwd_01848057bb","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: -0.84, 3.69)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":-0.84,"threshold2":3.69,"seed":89},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_cpzdwd_b4d142c3_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.84;\n        const wp::float32 var_5 = -0.84;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 3.69;\n        bool var_10;\n        const wp::float32 var_11 = 1.0;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 2.0;\n        wp::float32 var_14;\n        //---------\n        // forward\n        // def multicond_cpzdwd(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -0.84:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < 3.69:                                                                   <L 9>\n            var_10 = (var_2 < var_9);\n            if (var_10) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_12 = wp::mul(var_2, var_11);\n                wp::array_store(var_out, var_0, var_12);\n            }\n            if (!var_10) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_14 = wp::mul(var_2, var_13);\n                wp::array_store(var_out, var_0, var_14);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_cpzdwd_b4d142c3_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 0.84;\n        const wp::float32 var_5 = -0.84;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 3.69;\n        bool var_10;\n        const wp::float32 var_11 = 1.0;\n        wp::float32 var_12;\n        const wp::float32 var_13 = 2.0;\n        wp::float32 var_14;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        bool adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        bool adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        //---------\n        // forward\n        // def multicond_cpzdwd(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -0.84:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            // wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < 3.69:                                                                   <L 9>\n            var_10 = (var_2 < var_9);\n            if (var_10) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_12 = wp::mul(var_2, var_11);\n                // wp::array_store(var_out, var_0, var_12);\n            }\n            if (!var_10) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_14 = wp::mul(var_2, var_13);\n                // wp::array_store(var_out, var_0, var_14);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_6) {\n            if (!var_10) {\n                wp::adj_array_store(var_out, var_0, var_14, adj_out, adj_0, adj_14);\n                wp::adj_mul(var_2, var_13, adj_2, adj_13, adj_14);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_10) {\n                wp::adj_array_store(var_out, var_0, var_12, adj_out, adj_0, adj_12);\n                wp::adj_mul(var_2, var_11, adj_2, adj_11, adj_12);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 3.69:                                                              <L 9>\n        }\n        if (var_6) {\n            wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n            wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < -0.84:                                                                   <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_cpzdwd(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_cpzdwd","mangled_name":"multicond_cpzdwd_b4d142c3","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_cpzdwd(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < -0.84:\n        out[tid] = val * 0.5\n    elif val < 3.69:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"math_fcrpqj_2580bd01fd","device":"cuda","category":"math","description":"Math chain: cos, sqrt, exp, sin, abs","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["cos","sqrt","exp","sin","abs"],"seed":90},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_fcrpqj_954a6c57_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // forward\n        // def math_fcrpqj(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sin(wp.exp(wp.sqrt(wp.abs(wp.cos(a[tid]))))))                     <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::sqrt(var_4);\n        var_6 = wp::exp(var_5);\n        var_7 = wp::sin(var_6);\n        var_8 = wp::abs(var_7);\n        wp::array_store(var_out, var_0, var_8);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_fcrpqj_954a6c57_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        //---------\n        // forward\n        // def math_fcrpqj(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.sin(wp.exp(wp.sqrt(wp.abs(wp.cos(a[tid]))))))                     <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::cos(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::sqrt(var_4);\n        var_6 = wp::exp(var_5);\n        var_7 = wp::sin(var_6);\n        var_8 = wp::abs(var_7);\n        // wp::array_store(var_out, var_0, var_8);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n        wp::adj_abs(var_7, adj_7, adj_8);\n        wp::adj_sin(var_6, adj_6, adj_7);\n        wp::adj_exp(var_5, var_6, adj_5, adj_6);\n        wp::adj_sqrt(var_4, var_5, adj_4, adj_5);\n        wp::adj_abs(var_2, adj_2, adj_4);\n        wp::adj_cos(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.abs(wp.sin(wp.exp(wp.sqrt(wp.abs(wp.cos(a[tid]))))))                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_fcrpqj(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_fcrpqj","mangled_name":"math_fcrpqj_954a6c57","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_fcrpqj(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.abs(wp.sin(wp.exp(wp.sqrt(wp.abs(wp.cos(a[tid]))))))\n"}
{"id":"atom_cereyv_7d4fb17685","device":"cuda","category":"atomic","description":"Atomic max reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"max","seed":91},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_cereyv_91a7b475_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_cereyv(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_max(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_cereyv_91a7b475_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_cereyv(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_max(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_max(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_max(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_cereyv(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_cereyv","mangled_name":"atom_cereyv_91a7b475","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_cereyv(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_max(result, 0, values[tid])\n"}
{"id":"nested_koopuz_6a9e161b97","device":"cuda","category":"nested_loop","description":"Nested loops (8x3)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":8,"inner_iterations":3,"seed":92},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_koopuz_dbba1cb6_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        const wp::int32 var_143 = 5;\n        const wp::int32 var_144 = 0;\n        wp::float32* var_145;\n        wp::int32 var_146;\n        const wp::int32 var_147 = 1;\n        wp::int32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::float32* var_154;\n        wp::int32 var_155;\n        const wp::int32 var_156 = 1;\n        wp::int32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        const wp::int32 var_162 = 2;\n        wp::float32* var_163;\n        wp::int32 var_164;\n        const wp::int32 var_165 = 1;\n        wp::int32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32 var_169;\n        wp::float32 var_170;\n        const wp::int32 var_171 = 6;\n        const wp::int32 var_172 = 0;\n        wp::float32* var_173;\n        wp::int32 var_174;\n        const wp::int32 var_175 = 1;\n        wp::int32 var_176;\n        wp::float32 var_177;\n        wp::float32 var_178;\n        wp::float32 var_179;\n        wp::float32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::float32* var_182;\n        wp::int32 var_183;\n        const wp::int32 var_184 = 1;\n        wp::int32 var_185;\n        wp::float32 var_186;\n        wp::float32 var_187;\n        wp::float32 var_188;\n        wp::float32 var_189;\n        const wp::int32 var_190 = 2;\n        wp::float32* var_191;\n        wp::int32 var_192;\n        const wp::int32 var_193 = 1;\n        wp::int32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        wp::float32 var_197;\n        wp::float32 var_198;\n        const wp::int32 var_199 = 7;\n        const wp::int32 var_200 = 0;\n        wp::float32* var_201;\n        wp::int32 var_202;\n        const wp::int32 var_203 = 1;\n        wp::int32 var_204;\n        wp::float32 var_205;\n        wp::float32 var_206;\n        wp::float32 var_207;\n        wp::float32 var_208;\n        const wp::int32 var_209 = 1;\n        wp::float32* var_210;\n        wp::int32 var_211;\n        const wp::int32 var_212 = 1;\n        wp::int32 var_213;\n        wp::float32 var_214;\n        wp::float32 var_215;\n        wp::float32 var_216;\n        wp::float32 var_217;\n        const wp::int32 var_218 = 2;\n        wp::float32* var_219;\n        wp::int32 var_220;\n        const wp::int32 var_221 = 1;\n        wp::int32 var_222;\n        wp::float32 var_223;\n        wp::float32 var_224;\n        wp::float32 var_225;\n        wp::float32 var_226;\n        //---------\n        // forward\n        // def nested_koopuz(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(8):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_145 = wp::address(var_data, var_0);\n        var_146 = wp::mul(var_143, var_144);\n        var_148 = wp::add(var_146, var_147);\n        var_149 = wp::float(var_148);\n        var_151 = wp::load(var_145);\n        var_150 = wp::mul(var_151, var_149);\n        var_152 = wp::add(var_142, var_150);\n        var_154 = wp::address(var_data, var_0);\n        var_155 = wp::mul(var_143, var_153);\n        var_157 = wp::add(var_155, var_156);\n        var_158 = wp::float(var_157);\n        var_160 = wp::load(var_154);\n        var_159 = wp::mul(var_160, var_158);\n        var_161 = wp::add(var_152, var_159);\n        var_163 = wp::address(var_data, var_0);\n        var_164 = wp::mul(var_143, var_162);\n        var_166 = wp::add(var_164, var_165);\n        var_167 = wp::float(var_166);\n        var_169 = wp::load(var_163);\n        var_168 = wp::mul(var_169, var_167);\n        var_170 = wp::add(var_161, var_168);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_173 = wp::address(var_data, var_0);\n        var_174 = wp::mul(var_171, var_172);\n        var_176 = wp::add(var_174, var_175);\n        var_177 = wp::float(var_176);\n        var_179 = wp::load(var_173);\n        var_178 = wp::mul(var_179, var_177);\n        var_180 = wp::add(var_170, var_178);\n        var_182 = wp::address(var_data, var_0);\n        var_183 = wp::mul(var_171, var_181);\n        var_185 = wp::add(var_183, var_184);\n        var_186 = wp::float(var_185);\n        var_188 = wp::load(var_182);\n        var_187 = wp::mul(var_188, var_186);\n        var_189 = wp::add(var_180, var_187);\n        var_191 = wp::address(var_data, var_0);\n        var_192 = wp::mul(var_171, var_190);\n        var_194 = wp::add(var_192, var_193);\n        var_195 = wp::float(var_194);\n        var_197 = wp::load(var_191);\n        var_196 = wp::mul(var_197, var_195);\n        var_198 = wp::add(var_189, var_196);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_201 = wp::address(var_data, var_0);\n        var_202 = wp::mul(var_199, var_200);\n        var_204 = wp::add(var_202, var_203);\n        var_205 = wp::float(var_204);\n        var_207 = wp::load(var_201);\n        var_206 = wp::mul(var_207, var_205);\n        var_208 = wp::add(var_198, var_206);\n        var_210 = wp::address(var_data, var_0);\n        var_211 = wp::mul(var_199, var_209);\n        var_213 = wp::add(var_211, var_212);\n        var_214 = wp::float(var_213);\n        var_216 = wp::load(var_210);\n        var_215 = wp::mul(var_216, var_214);\n        var_217 = wp::add(var_208, var_215);\n        var_219 = wp::address(var_data, var_0);\n        var_220 = wp::mul(var_199, var_218);\n        var_222 = wp::add(var_220, var_221);\n        var_223 = wp::float(var_222);\n        var_225 = wp::load(var_219);\n        var_224 = wp::mul(var_225, var_223);\n        var_226 = wp::add(var_217, var_224);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_226);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_koopuz_dbba1cb6_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        const wp::int32 var_32 = 0;\n        wp::float32* var_33;\n        wp::int32 var_34;\n        const wp::int32 var_35 = 1;\n        wp::int32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        const wp::int32 var_41 = 1;\n        wp::float32* var_42;\n        wp::int32 var_43;\n        const wp::int32 var_44 = 1;\n        wp::int32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        const wp::int32 var_50 = 2;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 2;\n        const wp::int32 var_60 = 0;\n        wp::float32* var_61;\n        wp::int32 var_62;\n        const wp::int32 var_63 = 1;\n        wp::int32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 1;\n        wp::float32* var_70;\n        wp::int32 var_71;\n        const wp::int32 var_72 = 1;\n        wp::int32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        const wp::int32 var_78 = 2;\n        wp::float32* var_79;\n        wp::int32 var_80;\n        const wp::int32 var_81 = 1;\n        wp::int32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        const wp::int32 var_87 = 3;\n        const wp::int32 var_88 = 0;\n        wp::float32* var_89;\n        wp::int32 var_90;\n        const wp::int32 var_91 = 1;\n        wp::int32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32 var_95;\n        wp::float32 var_96;\n        const wp::int32 var_97 = 1;\n        wp::float32* var_98;\n        wp::int32 var_99;\n        const wp::int32 var_100 = 1;\n        wp::int32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        wp::float32 var_105;\n        const wp::int32 var_106 = 2;\n        wp::float32* var_107;\n        wp::int32 var_108;\n        const wp::int32 var_109 = 1;\n        wp::int32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 4;\n        const wp::int32 var_116 = 0;\n        wp::float32* var_117;\n        wp::int32 var_118;\n        const wp::int32 var_119 = 1;\n        wp::int32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::float32* var_126;\n        wp::int32 var_127;\n        const wp::int32 var_128 = 1;\n        wp::int32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        const wp::int32 var_134 = 2;\n        wp::float32* var_135;\n        wp::int32 var_136;\n        const wp::int32 var_137 = 1;\n        wp::int32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        const wp::int32 var_143 = 5;\n        const wp::int32 var_144 = 0;\n        wp::float32* var_145;\n        wp::int32 var_146;\n        const wp::int32 var_147 = 1;\n        wp::int32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::float32* var_154;\n        wp::int32 var_155;\n        const wp::int32 var_156 = 1;\n        wp::int32 var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        wp::float32 var_161;\n        const wp::int32 var_162 = 2;\n        wp::float32* var_163;\n        wp::int32 var_164;\n        const wp::int32 var_165 = 1;\n        wp::int32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32 var_169;\n        wp::float32 var_170;\n        const wp::int32 var_171 = 6;\n        const wp::int32 var_172 = 0;\n        wp::float32* var_173;\n        wp::int32 var_174;\n        const wp::int32 var_175 = 1;\n        wp::int32 var_176;\n        wp::float32 var_177;\n        wp::float32 var_178;\n        wp::float32 var_179;\n        wp::float32 var_180;\n        const wp::int32 var_181 = 1;\n        wp::float32* var_182;\n        wp::int32 var_183;\n        const wp::int32 var_184 = 1;\n        wp::int32 var_185;\n        wp::float32 var_186;\n        wp::float32 var_187;\n        wp::float32 var_188;\n        wp::float32 var_189;\n        const wp::int32 var_190 = 2;\n        wp::float32* var_191;\n        wp::int32 var_192;\n        const wp::int32 var_193 = 1;\n        wp::int32 var_194;\n        wp::float32 var_195;\n        wp::float32 var_196;\n        wp::float32 var_197;\n        wp::float32 var_198;\n        const wp::int32 var_199 = 7;\n        const wp::int32 var_200 = 0;\n        wp::float32* var_201;\n        wp::int32 var_202;\n        const wp::int32 var_203 = 1;\n        wp::int32 var_204;\n        wp::float32 var_205;\n        wp::float32 var_206;\n        wp::float32 var_207;\n        wp::float32 var_208;\n        const wp::int32 var_209 = 1;\n        wp::float32* var_210;\n        wp::int32 var_211;\n        const wp::int32 var_212 = 1;\n        wp::int32 var_213;\n        wp::float32 var_214;\n        wp::float32 var_215;\n        wp::float32 var_216;\n        wp::float32 var_217;\n        const wp::int32 var_218 = 2;\n        wp::float32* var_219;\n        wp::int32 var_220;\n        const wp::int32 var_221 = 1;\n        wp::int32 var_222;\n        wp::float32 var_223;\n        wp::float32 var_224;\n        wp::float32 var_225;\n        wp::float32 var_226;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::int32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::int32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::int32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::int32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::int32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::int32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::int32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::int32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::int32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::float32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::int32 adj_91 = {};\n        wp::int32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::int32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::int32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::int32 adj_119 = {};\n        wp::int32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::int32 adj_128 = {};\n        wp::int32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::int32 adj_137 = {};\n        wp::int32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::int32 adj_143 = {};\n        wp::int32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        wp::int32 adj_146 = {};\n        wp::int32 adj_147 = {};\n        wp::int32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::float32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::float32 adj_152 = {};\n        wp::int32 adj_153 = {};\n        wp::float32 adj_154 = {};\n        wp::int32 adj_155 = {};\n        wp::int32 adj_156 = {};\n        wp::int32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::float32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::float32 adj_161 = {};\n        wp::int32 adj_162 = {};\n        wp::float32 adj_163 = {};\n        wp::int32 adj_164 = {};\n        wp::int32 adj_165 = {};\n        wp::int32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::float32 adj_168 = {};\n        wp::float32 adj_169 = {};\n        wp::float32 adj_170 = {};\n        wp::int32 adj_171 = {};\n        wp::int32 adj_172 = {};\n        wp::float32 adj_173 = {};\n        wp::int32 adj_174 = {};\n        wp::int32 adj_175 = {};\n        wp::int32 adj_176 = {};\n        wp::float32 adj_177 = {};\n        wp::float32 adj_178 = {};\n        wp::float32 adj_179 = {};\n        wp::float32 adj_180 = {};\n        wp::int32 adj_181 = {};\n        wp::float32 adj_182 = {};\n        wp::int32 adj_183 = {};\n        wp::int32 adj_184 = {};\n        wp::int32 adj_185 = {};\n        wp::float32 adj_186 = {};\n        wp::float32 adj_187 = {};\n        wp::float32 adj_188 = {};\n        wp::float32 adj_189 = {};\n        wp::int32 adj_190 = {};\n        wp::float32 adj_191 = {};\n        wp::int32 adj_192 = {};\n        wp::int32 adj_193 = {};\n        wp::int32 adj_194 = {};\n        wp::float32 adj_195 = {};\n        wp::float32 adj_196 = {};\n        wp::float32 adj_197 = {};\n        wp::float32 adj_198 = {};\n        wp::int32 adj_199 = {};\n        wp::int32 adj_200 = {};\n        wp::float32 adj_201 = {};\n        wp::int32 adj_202 = {};\n        wp::int32 adj_203 = {};\n        wp::int32 adj_204 = {};\n        wp::float32 adj_205 = {};\n        wp::float32 adj_206 = {};\n        wp::float32 adj_207 = {};\n        wp::float32 adj_208 = {};\n        wp::int32 adj_209 = {};\n        wp::float32 adj_210 = {};\n        wp::int32 adj_211 = {};\n        wp::int32 adj_212 = {};\n        wp::int32 adj_213 = {};\n        wp::float32 adj_214 = {};\n        wp::float32 adj_215 = {};\n        wp::float32 adj_216 = {};\n        wp::float32 adj_217 = {};\n        wp::int32 adj_218 = {};\n        wp::float32 adj_219 = {};\n        wp::int32 adj_220 = {};\n        wp::int32 adj_221 = {};\n        wp::int32 adj_222 = {};\n        wp::float32 adj_223 = {};\n        wp::float32 adj_224 = {};\n        wp::float32 adj_225 = {};\n        wp::float32 adj_226 = {};\n        //---------\n        // forward\n        // def nested_koopuz(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(8):                                                                     <L 7>\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_33 = wp::address(var_data, var_0);\n        var_34 = wp::mul(var_31, var_32);\n        var_36 = wp::add(var_34, var_35);\n        var_37 = wp::float(var_36);\n        var_39 = wp::load(var_33);\n        var_38 = wp::mul(var_39, var_37);\n        var_40 = wp::add(var_30, var_38);\n        var_42 = wp::address(var_data, var_0);\n        var_43 = wp::mul(var_31, var_41);\n        var_45 = wp::add(var_43, var_44);\n        var_46 = wp::float(var_45);\n        var_48 = wp::load(var_42);\n        var_47 = wp::mul(var_48, var_46);\n        var_49 = wp::add(var_40, var_47);\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_31, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_49, var_56);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_61 = wp::address(var_data, var_0);\n        var_62 = wp::mul(var_59, var_60);\n        var_64 = wp::add(var_62, var_63);\n        var_65 = wp::float(var_64);\n        var_67 = wp::load(var_61);\n        var_66 = wp::mul(var_67, var_65);\n        var_68 = wp::add(var_58, var_66);\n        var_70 = wp::address(var_data, var_0);\n        var_71 = wp::mul(var_59, var_69);\n        var_73 = wp::add(var_71, var_72);\n        var_74 = wp::float(var_73);\n        var_76 = wp::load(var_70);\n        var_75 = wp::mul(var_76, var_74);\n        var_77 = wp::add(var_68, var_75);\n        var_79 = wp::address(var_data, var_0);\n        var_80 = wp::mul(var_59, var_78);\n        var_82 = wp::add(var_80, var_81);\n        var_83 = wp::float(var_82);\n        var_85 = wp::load(var_79);\n        var_84 = wp::mul(var_85, var_83);\n        var_86 = wp::add(var_77, var_84);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_89 = wp::address(var_data, var_0);\n        var_90 = wp::mul(var_87, var_88);\n        var_92 = wp::add(var_90, var_91);\n        var_93 = wp::float(var_92);\n        var_95 = wp::load(var_89);\n        var_94 = wp::mul(var_95, var_93);\n        var_96 = wp::add(var_86, var_94);\n        var_98 = wp::address(var_data, var_0);\n        var_99 = wp::mul(var_87, var_97);\n        var_101 = wp::add(var_99, var_100);\n        var_102 = wp::float(var_101);\n        var_104 = wp::load(var_98);\n        var_103 = wp::mul(var_104, var_102);\n        var_105 = wp::add(var_96, var_103);\n        var_107 = wp::address(var_data, var_0);\n        var_108 = wp::mul(var_87, var_106);\n        var_110 = wp::add(var_108, var_109);\n        var_111 = wp::float(var_110);\n        var_113 = wp::load(var_107);\n        var_112 = wp::mul(var_113, var_111);\n        var_114 = wp::add(var_105, var_112);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_117 = wp::address(var_data, var_0);\n        var_118 = wp::mul(var_115, var_116);\n        var_120 = wp::add(var_118, var_119);\n        var_121 = wp::float(var_120);\n        var_123 = wp::load(var_117);\n        var_122 = wp::mul(var_123, var_121);\n        var_124 = wp::add(var_114, var_122);\n        var_126 = wp::address(var_data, var_0);\n        var_127 = wp::mul(var_115, var_125);\n        var_129 = wp::add(var_127, var_128);\n        var_130 = wp::float(var_129);\n        var_132 = wp::load(var_126);\n        var_131 = wp::mul(var_132, var_130);\n        var_133 = wp::add(var_124, var_131);\n        var_135 = wp::address(var_data, var_0);\n        var_136 = wp::mul(var_115, var_134);\n        var_138 = wp::add(var_136, var_137);\n        var_139 = wp::float(var_138);\n        var_141 = wp::load(var_135);\n        var_140 = wp::mul(var_141, var_139);\n        var_142 = wp::add(var_133, var_140);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_145 = wp::address(var_data, var_0);\n        var_146 = wp::mul(var_143, var_144);\n        var_148 = wp::add(var_146, var_147);\n        var_149 = wp::float(var_148);\n        var_151 = wp::load(var_145);\n        var_150 = wp::mul(var_151, var_149);\n        var_152 = wp::add(var_142, var_150);\n        var_154 = wp::address(var_data, var_0);\n        var_155 = wp::mul(var_143, var_153);\n        var_157 = wp::add(var_155, var_156);\n        var_158 = wp::float(var_157);\n        var_160 = wp::load(var_154);\n        var_159 = wp::mul(var_160, var_158);\n        var_161 = wp::add(var_152, var_159);\n        var_163 = wp::address(var_data, var_0);\n        var_164 = wp::mul(var_143, var_162);\n        var_166 = wp::add(var_164, var_165);\n        var_167 = wp::float(var_166);\n        var_169 = wp::load(var_163);\n        var_168 = wp::mul(var_169, var_167);\n        var_170 = wp::add(var_161, var_168);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_173 = wp::address(var_data, var_0);\n        var_174 = wp::mul(var_171, var_172);\n        var_176 = wp::add(var_174, var_175);\n        var_177 = wp::float(var_176);\n        var_179 = wp::load(var_173);\n        var_178 = wp::mul(var_179, var_177);\n        var_180 = wp::add(var_170, var_178);\n        var_182 = wp::address(var_data, var_0);\n        var_183 = wp::mul(var_171, var_181);\n        var_185 = wp::add(var_183, var_184);\n        var_186 = wp::float(var_185);\n        var_188 = wp::load(var_182);\n        var_187 = wp::mul(var_188, var_186);\n        var_189 = wp::add(var_180, var_187);\n        var_191 = wp::address(var_data, var_0);\n        var_192 = wp::mul(var_171, var_190);\n        var_194 = wp::add(var_192, var_193);\n        var_195 = wp::float(var_194);\n        var_197 = wp::load(var_191);\n        var_196 = wp::mul(var_197, var_195);\n        var_198 = wp::add(var_189, var_196);\n        // for j in range(3):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_201 = wp::address(var_data, var_0);\n        var_202 = wp::mul(var_199, var_200);\n        var_204 = wp::add(var_202, var_203);\n        var_205 = wp::float(var_204);\n        var_207 = wp::load(var_201);\n        var_206 = wp::mul(var_207, var_205);\n        var_208 = wp::add(var_198, var_206);\n        var_210 = wp::address(var_data, var_0);\n        var_211 = wp::mul(var_199, var_209);\n        var_213 = wp::add(var_211, var_212);\n        var_214 = wp::float(var_213);\n        var_216 = wp::load(var_210);\n        var_215 = wp::mul(var_216, var_214);\n        var_217 = wp::add(var_208, var_215);\n        var_219 = wp::address(var_data, var_0);\n        var_220 = wp::mul(var_199, var_218);\n        var_222 = wp::add(var_220, var_221);\n        var_223 = wp::float(var_222);\n        var_225 = wp::load(var_219);\n        var_224 = wp::mul(var_225, var_223);\n        var_226 = wp::add(var_217, var_224);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_226);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_226, adj_out, adj_0, adj_226);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_217, var_224, adj_217, adj_224, adj_226);\n        wp::adj_mul(var_225, var_223, adj_219, adj_223, adj_224);\n        wp::adj_float(var_222, adj_222, adj_223);\n        wp::adj_add(var_220, var_221, adj_220, adj_221, adj_222);\n        wp::adj_mul(var_199, var_218, adj_199, adj_218, adj_220);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_219);\n        wp::adj_add(var_208, var_215, adj_208, adj_215, adj_217);\n        wp::adj_mul(var_216, var_214, adj_210, adj_214, adj_215);\n        wp::adj_float(var_213, adj_213, adj_214);\n        wp::adj_add(var_211, var_212, adj_211, adj_212, adj_213);\n        wp::adj_mul(var_199, var_209, adj_199, adj_209, adj_211);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_210);\n        wp::adj_add(var_198, var_206, adj_198, adj_206, adj_208);\n        wp::adj_mul(var_207, var_205, adj_201, adj_205, adj_206);\n        wp::adj_float(var_204, adj_204, adj_205);\n        wp::adj_add(var_202, var_203, adj_202, adj_203, adj_204);\n        wp::adj_mul(var_199, var_200, adj_199, adj_200, adj_202);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_201);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_189, var_196, adj_189, adj_196, adj_198);\n        wp::adj_mul(var_197, var_195, adj_191, adj_195, adj_196);\n        wp::adj_float(var_194, adj_194, adj_195);\n        wp::adj_add(var_192, var_193, adj_192, adj_193, adj_194);\n        wp::adj_mul(var_171, var_190, adj_171, adj_190, adj_192);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_191);\n        wp::adj_add(var_180, var_187, adj_180, adj_187, adj_189);\n        wp::adj_mul(var_188, var_186, adj_182, adj_186, adj_187);\n        wp::adj_float(var_185, adj_185, adj_186);\n        wp::adj_add(var_183, var_184, adj_183, adj_184, adj_185);\n        wp::adj_mul(var_171, var_181, adj_171, adj_181, adj_183);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_182);\n        wp::adj_add(var_170, var_178, adj_170, adj_178, adj_180);\n        wp::adj_mul(var_179, var_177, adj_173, adj_177, adj_178);\n        wp::adj_float(var_176, adj_176, adj_177);\n        wp::adj_add(var_174, var_175, adj_174, adj_175, adj_176);\n        wp::adj_mul(var_171, var_172, adj_171, adj_172, adj_174);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_173);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_161, var_168, adj_161, adj_168, adj_170);\n        wp::adj_mul(var_169, var_167, adj_163, adj_167, adj_168);\n        wp::adj_float(var_166, adj_166, adj_167);\n        wp::adj_add(var_164, var_165, adj_164, adj_165, adj_166);\n        wp::adj_mul(var_143, var_162, adj_143, adj_162, adj_164);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_163);\n        wp::adj_add(var_152, var_159, adj_152, adj_159, adj_161);\n        wp::adj_mul(var_160, var_158, adj_154, adj_158, adj_159);\n        wp::adj_float(var_157, adj_157, adj_158);\n        wp::adj_add(var_155, var_156, adj_155, adj_156, adj_157);\n        wp::adj_mul(var_143, var_153, adj_143, adj_153, adj_155);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_154);\n        wp::adj_add(var_142, var_150, adj_142, adj_150, adj_152);\n        wp::adj_mul(var_151, var_149, adj_145, adj_149, adj_150);\n        wp::adj_float(var_148, adj_148, adj_149);\n        wp::adj_add(var_146, var_147, adj_146, adj_147, adj_148);\n        wp::adj_mul(var_143, var_144, adj_143, adj_144, adj_146);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_145);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_133, var_140, adj_133, adj_140, adj_142);\n        wp::adj_mul(var_141, var_139, adj_135, adj_139, adj_140);\n        wp::adj_float(var_138, adj_138, adj_139);\n        wp::adj_add(var_136, var_137, adj_136, adj_137, adj_138);\n        wp::adj_mul(var_115, var_134, adj_115, adj_134, adj_136);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_135);\n        wp::adj_add(var_124, var_131, adj_124, adj_131, adj_133);\n        wp::adj_mul(var_132, var_130, adj_126, adj_130, adj_131);\n        wp::adj_float(var_129, adj_129, adj_130);\n        wp::adj_add(var_127, var_128, adj_127, adj_128, adj_129);\n        wp::adj_mul(var_115, var_125, adj_115, adj_125, adj_127);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_126);\n        wp::adj_add(var_114, var_122, adj_114, adj_122, adj_124);\n        wp::adj_mul(var_123, var_121, adj_117, adj_121, adj_122);\n        wp::adj_float(var_120, adj_120, adj_121);\n        wp::adj_add(var_118, var_119, adj_118, adj_119, adj_120);\n        wp::adj_mul(var_115, var_116, adj_115, adj_116, adj_118);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_117);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_105, var_112, adj_105, adj_112, adj_114);\n        wp::adj_mul(var_113, var_111, adj_107, adj_111, adj_112);\n        wp::adj_float(var_110, adj_110, adj_111);\n        wp::adj_add(var_108, var_109, adj_108, adj_109, adj_110);\n        wp::adj_mul(var_87, var_106, adj_87, adj_106, adj_108);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_107);\n        wp::adj_add(var_96, var_103, adj_96, adj_103, adj_105);\n        wp::adj_mul(var_104, var_102, adj_98, adj_102, adj_103);\n        wp::adj_float(var_101, adj_101, adj_102);\n        wp::adj_add(var_99, var_100, adj_99, adj_100, adj_101);\n        wp::adj_mul(var_87, var_97, adj_87, adj_97, adj_99);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_98);\n        wp::adj_add(var_86, var_94, adj_86, adj_94, adj_96);\n        wp::adj_mul(var_95, var_93, adj_89, adj_93, adj_94);\n        wp::adj_float(var_92, adj_92, adj_93);\n        wp::adj_add(var_90, var_91, adj_90, adj_91, adj_92);\n        wp::adj_mul(var_87, var_88, adj_87, adj_88, adj_90);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_89);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_77, var_84, adj_77, adj_84, adj_86);\n        wp::adj_mul(var_85, var_83, adj_79, adj_83, adj_84);\n        wp::adj_float(var_82, adj_82, adj_83);\n        wp::adj_add(var_80, var_81, adj_80, adj_81, adj_82);\n        wp::adj_mul(var_59, var_78, adj_59, adj_78, adj_80);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_79);\n        wp::adj_add(var_68, var_75, adj_68, adj_75, adj_77);\n        wp::adj_mul(var_76, var_74, adj_70, adj_74, adj_75);\n        wp::adj_float(var_73, adj_73, adj_74);\n        wp::adj_add(var_71, var_72, adj_71, adj_72, adj_73);\n        wp::adj_mul(var_59, var_69, adj_59, adj_69, adj_71);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_70);\n        wp::adj_add(var_58, var_66, adj_58, adj_66, adj_68);\n        wp::adj_mul(var_67, var_65, adj_61, adj_65, adj_66);\n        wp::adj_float(var_64, adj_64, adj_65);\n        wp::adj_add(var_62, var_63, adj_62, adj_63, adj_64);\n        wp::adj_mul(var_59, var_60, adj_59, adj_60, adj_62);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_61);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_49, var_56, adj_49, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_31, var_50, adj_31, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        wp::adj_add(var_40, var_47, adj_40, adj_47, adj_49);\n        wp::adj_mul(var_48, var_46, adj_42, adj_46, adj_47);\n        wp::adj_float(var_45, adj_45, adj_46);\n        wp::adj_add(var_43, var_44, adj_43, adj_44, adj_45);\n        wp::adj_mul(var_31, var_41, adj_31, adj_41, adj_43);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_42);\n        wp::adj_add(var_30, var_38, adj_30, adj_38, adj_40);\n        wp::adj_mul(var_39, var_37, adj_33, adj_37, adj_38);\n        wp::adj_float(var_36, adj_36, adj_37);\n        wp::adj_add(var_34, var_35, adj_34, adj_35, adj_36);\n        wp::adj_mul(var_31, var_32, adj_31, adj_32, adj_34);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_33);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(3):                                                                <L 8>\n        // adj: for i in range(8):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_koopuz(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_koopuz","mangled_name":"nested_koopuz_dbba1cb6","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_koopuz(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(8):\n        for j in range(3):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"scalar_xmojcj_19df61539e","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=3.98, offset=2.88)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"+","scale":3.98,"offset":2.88,"seed":93},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_xmojcj_3b0a21f0_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_xmojcj(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] + scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::add(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_xmojcj_3b0a21f0_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_xmojcj(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] + scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::add(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_add(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] + scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_xmojcj(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_xmojcj","mangled_name":"scalar_xmojcj_3b0a21f0","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_xmojcj(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] + scale) + offset\n"}
{"id":"scalar_odhlam_74f7220c37","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=4.34, offset=3.34)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"-","scale":4.34,"offset":3.34,"seed":94},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_odhlam_cb9f90fe_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_odhlam(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_odhlam_cb9f90fe_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_odhlam(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] - scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sub(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_sub(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] - scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_odhlam(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_odhlam","mangled_name":"scalar_odhlam_cb9f90fe","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_odhlam(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] - scale) + offset\n"}
{"id":"combined_tnzoyd_f56005e5ac","device":"cuda","category":"combined","description":"Combined pattern (loop+cond+wp.sin)","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"iterations":10,"threshold":-1.89,"function":"wp.sin","seed":95},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void combined_tnzoyd_757ee361_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.89;\n        const wp::float32 var_9 = -1.89;\n        bool var_10;\n        wp::float32* var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        const wp::int32 var_20 = 1;\n        wp::float32* var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        wp::float32 var_24;\n        const wp::float32 var_25 = 1.89;\n        const wp::float32 var_26 = -1.89;\n        bool var_27;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        wp::float32* var_33;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        wp::float32 var_36;\n        const wp::int32 var_37 = 2;\n        wp::float32* var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        wp::float32 var_41;\n        const wp::float32 var_42 = 1.89;\n        const wp::float32 var_43 = -1.89;\n        bool var_44;\n        wp::float32* var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32* var_50;\n        wp::float32 var_51;\n        wp::float32 var_52;\n        wp::float32 var_53;\n        const wp::int32 var_54 = 3;\n        wp::float32* var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::float32 var_59 = 1.89;\n        const wp::float32 var_60 = -1.89;\n        bool var_61;\n        wp::float32* var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32* var_67;\n        wp::float32 var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        const wp::int32 var_71 = 4;\n        wp::float32* var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        const wp::float32 var_76 = 1.89;\n        const wp::float32 var_77 = -1.89;\n        bool var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::int32 var_88 = 5;\n        wp::float32* var_89;\n        wp::float32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        const wp::float32 var_93 = 1.89;\n        const wp::float32 var_94 = -1.89;\n        bool var_95;\n        wp::float32* var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        wp::float32 var_99;\n        wp::float32 var_100;\n        wp::float32* var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 6;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        const wp::float32 var_110 = 1.89;\n        const wp::float32 var_111 = -1.89;\n        bool var_112;\n        wp::float32* var_113;\n        wp::float32 var_114;\n        wp::float32 var_115;\n        wp::float32 var_116;\n        wp::float32 var_117;\n        wp::float32* var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 7;\n        wp::float32* var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        const wp::float32 var_127 = 1.89;\n        const wp::float32 var_128 = -1.89;\n        bool var_129;\n        wp::float32* var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32* var_135;\n        wp::float32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        const wp::int32 var_139 = 8;\n        wp::float32* var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32 var_143;\n        const wp::float32 var_144 = 1.89;\n        const wp::float32 var_145 = -1.89;\n        bool var_146;\n        wp::float32* var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32* var_152;\n        wp::float32 var_153;\n        wp::float32 var_154;\n        wp::float32 var_155;\n        const wp::int32 var_156 = 9;\n        wp::float32* var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        const wp::float32 var_161 = 1.89;\n        const wp::float32 var_162 = -1.89;\n        bool var_163;\n        wp::float32* var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32* var_169;\n        wp::float32 var_170;\n        wp::float32 var_171;\n        wp::float32 var_172;\n        //---------\n        // forward\n        // def combined_tnzoyd(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(10):                                                                    <L 7>\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_10 = (var_6 > var_9);\n        if (var_10) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_11 = wp::address(var_b, var_0);\n            var_13 = wp::load(var_11);\n            var_12 = wp::sin(var_13);\n            var_14 = wp::add(var_2, var_12);\n        }\n        var_15 = wp::where(var_10, var_14, var_2);\n        if (!var_10) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_16 = wp::address(var_b, var_0);\n            var_18 = wp::load(var_16);\n            var_17 = wp::add(var_15, var_18);\n        }\n        var_19 = wp::where(var_10, var_15, var_17);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_21 = wp::address(var_a, var_0);\n        var_22 = wp::float(var_20);\n        var_24 = wp::load(var_21);\n        var_23 = wp::mul(var_24, var_22);\n        var_27 = (var_23 > var_26);\n        if (var_27) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_28 = wp::address(var_b, var_0);\n            var_30 = wp::load(var_28);\n            var_29 = wp::sin(var_30);\n            var_31 = wp::add(var_19, var_29);\n        }\n        var_32 = wp::where(var_27, var_31, var_19);\n        if (!var_27) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_33 = wp::address(var_b, var_0);\n            var_35 = wp::load(var_33);\n            var_34 = wp::add(var_32, var_35);\n        }\n        var_36 = wp::where(var_27, var_32, var_34);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_38 = wp::address(var_a, var_0);\n        var_39 = wp::float(var_37);\n        var_41 = wp::load(var_38);\n        var_40 = wp::mul(var_41, var_39);\n        var_44 = (var_40 > var_43);\n        if (var_44) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_45 = wp::address(var_b, var_0);\n            var_47 = wp::load(var_45);\n            var_46 = wp::sin(var_47);\n            var_48 = wp::add(var_36, var_46);\n        }\n        var_49 = wp::where(var_44, var_48, var_36);\n        if (!var_44) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_50 = wp::address(var_b, var_0);\n            var_52 = wp::load(var_50);\n            var_51 = wp::add(var_49, var_52);\n        }\n        var_53 = wp::where(var_44, var_49, var_51);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_55 = wp::address(var_a, var_0);\n        var_56 = wp::float(var_54);\n        var_58 = wp::load(var_55);\n        var_57 = wp::mul(var_58, var_56);\n        var_61 = (var_57 > var_60);\n        if (var_61) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_62 = wp::address(var_b, var_0);\n            var_64 = wp::load(var_62);\n            var_63 = wp::sin(var_64);\n            var_65 = wp::add(var_53, var_63);\n        }\n        var_66 = wp::where(var_61, var_65, var_53);\n        if (!var_61) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_67 = wp::address(var_b, var_0);\n            var_69 = wp::load(var_67);\n            var_68 = wp::add(var_66, var_69);\n        }\n        var_70 = wp::where(var_61, var_66, var_68);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_72 = wp::address(var_a, var_0);\n        var_73 = wp::float(var_71);\n        var_75 = wp::load(var_72);\n        var_74 = wp::mul(var_75, var_73);\n        var_78 = (var_74 > var_77);\n        if (var_78) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::sin(var_81);\n            var_82 = wp::add(var_70, var_80);\n        }\n        var_83 = wp::where(var_78, var_82, var_70);\n        if (!var_78) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_84 = wp::address(var_b, var_0);\n            var_86 = wp::load(var_84);\n            var_85 = wp::add(var_83, var_86);\n        }\n        var_87 = wp::where(var_78, var_83, var_85);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_89 = wp::address(var_a, var_0);\n        var_90 = wp::float(var_88);\n        var_92 = wp::load(var_89);\n        var_91 = wp::mul(var_92, var_90);\n        var_95 = (var_91 > var_94);\n        if (var_95) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_96 = wp::address(var_b, var_0);\n            var_98 = wp::load(var_96);\n            var_97 = wp::sin(var_98);\n            var_99 = wp::add(var_87, var_97);\n        }\n        var_100 = wp::where(var_95, var_99, var_87);\n        if (!var_95) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_101 = wp::address(var_b, var_0);\n            var_103 = wp::load(var_101);\n            var_102 = wp::add(var_100, var_103);\n        }\n        var_104 = wp::where(var_95, var_100, var_102);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_106 = wp::address(var_a, var_0);\n        var_107 = wp::float(var_105);\n        var_109 = wp::load(var_106);\n        var_108 = wp::mul(var_109, var_107);\n        var_112 = (var_108 > var_111);\n        if (var_112) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_113 = wp::address(var_b, var_0);\n            var_115 = wp::load(var_113);\n            var_114 = wp::sin(var_115);\n            var_116 = wp::add(var_104, var_114);\n        }\n        var_117 = wp::where(var_112, var_116, var_104);\n        if (!var_112) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_118 = wp::address(var_b, var_0);\n            var_120 = wp::load(var_118);\n            var_119 = wp::add(var_117, var_120);\n        }\n        var_121 = wp::where(var_112, var_117, var_119);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_123 = wp::address(var_a, var_0);\n        var_124 = wp::float(var_122);\n        var_126 = wp::load(var_123);\n        var_125 = wp::mul(var_126, var_124);\n        var_129 = (var_125 > var_128);\n        if (var_129) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_130 = wp::address(var_b, var_0);\n            var_132 = wp::load(var_130);\n            var_131 = wp::sin(var_132);\n            var_133 = wp::add(var_121, var_131);\n        }\n        var_134 = wp::where(var_129, var_133, var_121);\n        if (!var_129) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_135 = wp::address(var_b, var_0);\n            var_137 = wp::load(var_135);\n            var_136 = wp::add(var_134, var_137);\n        }\n        var_138 = wp::where(var_129, var_134, var_136);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_140 = wp::address(var_a, var_0);\n        var_141 = wp::float(var_139);\n        var_143 = wp::load(var_140);\n        var_142 = wp::mul(var_143, var_141);\n        var_146 = (var_142 > var_145);\n        if (var_146) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_147 = wp::address(var_b, var_0);\n            var_149 = wp::load(var_147);\n            var_148 = wp::sin(var_149);\n            var_150 = wp::add(var_138, var_148);\n        }\n        var_151 = wp::where(var_146, var_150, var_138);\n        if (!var_146) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_152 = wp::address(var_b, var_0);\n            var_154 = wp::load(var_152);\n            var_153 = wp::add(var_151, var_154);\n        }\n        var_155 = wp::where(var_146, var_151, var_153);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_157 = wp::address(var_a, var_0);\n        var_158 = wp::float(var_156);\n        var_160 = wp::load(var_157);\n        var_159 = wp::mul(var_160, var_158);\n        var_163 = (var_159 > var_162);\n        if (var_163) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_164 = wp::address(var_b, var_0);\n            var_166 = wp::load(var_164);\n            var_165 = wp::sin(var_166);\n            var_167 = wp::add(var_155, var_165);\n        }\n        var_168 = wp::where(var_163, var_167, var_155);\n        if (!var_163) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_169 = wp::address(var_b, var_0);\n            var_171 = wp::load(var_169);\n            var_170 = wp::add(var_168, var_171);\n        }\n        var_172 = wp::where(var_163, var_168, var_170);\n        // out[tid] = acc                                                                         <L 12>\n        wp::array_store(var_out, var_0, var_172);\n    }\n}\n\n\n\nextern \"C\" __global__ void combined_tnzoyd_757ee361_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.89;\n        const wp::float32 var_9 = -1.89;\n        bool var_10;\n        wp::float32* var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32* var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        const wp::int32 var_20 = 1;\n        wp::float32* var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        wp::float32 var_24;\n        const wp::float32 var_25 = 1.89;\n        const wp::float32 var_26 = -1.89;\n        bool var_27;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        wp::float32* var_33;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        wp::float32 var_36;\n        const wp::int32 var_37 = 2;\n        wp::float32* var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        wp::float32 var_41;\n        const wp::float32 var_42 = 1.89;\n        const wp::float32 var_43 = -1.89;\n        bool var_44;\n        wp::float32* var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32* var_50;\n        wp::float32 var_51;\n        wp::float32 var_52;\n        wp::float32 var_53;\n        const wp::int32 var_54 = 3;\n        wp::float32* var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::float32 var_59 = 1.89;\n        const wp::float32 var_60 = -1.89;\n        bool var_61;\n        wp::float32* var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32* var_67;\n        wp::float32 var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        const wp::int32 var_71 = 4;\n        wp::float32* var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        const wp::float32 var_76 = 1.89;\n        const wp::float32 var_77 = -1.89;\n        bool var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::int32 var_88 = 5;\n        wp::float32* var_89;\n        wp::float32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        const wp::float32 var_93 = 1.89;\n        const wp::float32 var_94 = -1.89;\n        bool var_95;\n        wp::float32* var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        wp::float32 var_99;\n        wp::float32 var_100;\n        wp::float32* var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 6;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        const wp::float32 var_110 = 1.89;\n        const wp::float32 var_111 = -1.89;\n        bool var_112;\n        wp::float32* var_113;\n        wp::float32 var_114;\n        wp::float32 var_115;\n        wp::float32 var_116;\n        wp::float32 var_117;\n        wp::float32* var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 7;\n        wp::float32* var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        const wp::float32 var_127 = 1.89;\n        const wp::float32 var_128 = -1.89;\n        bool var_129;\n        wp::float32* var_130;\n        wp::float32 var_131;\n        wp::float32 var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32* var_135;\n        wp::float32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        const wp::int32 var_139 = 8;\n        wp::float32* var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32 var_143;\n        const wp::float32 var_144 = 1.89;\n        const wp::float32 var_145 = -1.89;\n        bool var_146;\n        wp::float32* var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        wp::float32 var_150;\n        wp::float32 var_151;\n        wp::float32* var_152;\n        wp::float32 var_153;\n        wp::float32 var_154;\n        wp::float32 var_155;\n        const wp::int32 var_156 = 9;\n        wp::float32* var_157;\n        wp::float32 var_158;\n        wp::float32 var_159;\n        wp::float32 var_160;\n        const wp::float32 var_161 = 1.89;\n        const wp::float32 var_162 = -1.89;\n        bool var_163;\n        wp::float32* var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        wp::float32 var_168;\n        wp::float32* var_169;\n        wp::float32 var_170;\n        wp::float32 var_171;\n        wp::float32 var_172;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        bool adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::int32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        bool adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::float32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::int32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        bool adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        bool adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        bool adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::float32 adj_80 = {};\n        wp::float32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::float32 adj_89 = {};\n        wp::float32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        bool adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::float32 adj_99 = {};\n        wp::float32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::int32 adj_105 = {};\n        wp::float32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::float32 adj_108 = {};\n        wp::float32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        bool adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::float32 adj_115 = {};\n        wp::float32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::float32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::int32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::float32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::float32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        bool adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::float32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::float32 adj_136 = {};\n        wp::float32 adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::int32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::float32 adj_143 = {};\n        wp::float32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        bool adj_146 = {};\n        wp::float32 adj_147 = {};\n        wp::float32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::float32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::float32 adj_152 = {};\n        wp::float32 adj_153 = {};\n        wp::float32 adj_154 = {};\n        wp::float32 adj_155 = {};\n        wp::int32 adj_156 = {};\n        wp::float32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::float32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::float32 adj_161 = {};\n        wp::float32 adj_162 = {};\n        bool adj_163 = {};\n        wp::float32 adj_164 = {};\n        wp::float32 adj_165 = {};\n        wp::float32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::float32 adj_168 = {};\n        wp::float32 adj_169 = {};\n        wp::float32 adj_170 = {};\n        wp::float32 adj_171 = {};\n        wp::float32 adj_172 = {};\n        //---------\n        // forward\n        // def combined_tnzoyd(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(10):                                                                    <L 7>\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_10 = (var_6 > var_9);\n        if (var_10) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_11 = wp::address(var_b, var_0);\n            var_13 = wp::load(var_11);\n            var_12 = wp::sin(var_13);\n            var_14 = wp::add(var_2, var_12);\n        }\n        var_15 = wp::where(var_10, var_14, var_2);\n        if (!var_10) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_16 = wp::address(var_b, var_0);\n            var_18 = wp::load(var_16);\n            var_17 = wp::add(var_15, var_18);\n        }\n        var_19 = wp::where(var_10, var_15, var_17);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_21 = wp::address(var_a, var_0);\n        var_22 = wp::float(var_20);\n        var_24 = wp::load(var_21);\n        var_23 = wp::mul(var_24, var_22);\n        var_27 = (var_23 > var_26);\n        if (var_27) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_28 = wp::address(var_b, var_0);\n            var_30 = wp::load(var_28);\n            var_29 = wp::sin(var_30);\n            var_31 = wp::add(var_19, var_29);\n        }\n        var_32 = wp::where(var_27, var_31, var_19);\n        if (!var_27) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_33 = wp::address(var_b, var_0);\n            var_35 = wp::load(var_33);\n            var_34 = wp::add(var_32, var_35);\n        }\n        var_36 = wp::where(var_27, var_32, var_34);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_38 = wp::address(var_a, var_0);\n        var_39 = wp::float(var_37);\n        var_41 = wp::load(var_38);\n        var_40 = wp::mul(var_41, var_39);\n        var_44 = (var_40 > var_43);\n        if (var_44) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_45 = wp::address(var_b, var_0);\n            var_47 = wp::load(var_45);\n            var_46 = wp::sin(var_47);\n            var_48 = wp::add(var_36, var_46);\n        }\n        var_49 = wp::where(var_44, var_48, var_36);\n        if (!var_44) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_50 = wp::address(var_b, var_0);\n            var_52 = wp::load(var_50);\n            var_51 = wp::add(var_49, var_52);\n        }\n        var_53 = wp::where(var_44, var_49, var_51);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_55 = wp::address(var_a, var_0);\n        var_56 = wp::float(var_54);\n        var_58 = wp::load(var_55);\n        var_57 = wp::mul(var_58, var_56);\n        var_61 = (var_57 > var_60);\n        if (var_61) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_62 = wp::address(var_b, var_0);\n            var_64 = wp::load(var_62);\n            var_63 = wp::sin(var_64);\n            var_65 = wp::add(var_53, var_63);\n        }\n        var_66 = wp::where(var_61, var_65, var_53);\n        if (!var_61) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_67 = wp::address(var_b, var_0);\n            var_69 = wp::load(var_67);\n            var_68 = wp::add(var_66, var_69);\n        }\n        var_70 = wp::where(var_61, var_66, var_68);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_72 = wp::address(var_a, var_0);\n        var_73 = wp::float(var_71);\n        var_75 = wp::load(var_72);\n        var_74 = wp::mul(var_75, var_73);\n        var_78 = (var_74 > var_77);\n        if (var_78) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::sin(var_81);\n            var_82 = wp::add(var_70, var_80);\n        }\n        var_83 = wp::where(var_78, var_82, var_70);\n        if (!var_78) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_84 = wp::address(var_b, var_0);\n            var_86 = wp::load(var_84);\n            var_85 = wp::add(var_83, var_86);\n        }\n        var_87 = wp::where(var_78, var_83, var_85);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_89 = wp::address(var_a, var_0);\n        var_90 = wp::float(var_88);\n        var_92 = wp::load(var_89);\n        var_91 = wp::mul(var_92, var_90);\n        var_95 = (var_91 > var_94);\n        if (var_95) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_96 = wp::address(var_b, var_0);\n            var_98 = wp::load(var_96);\n            var_97 = wp::sin(var_98);\n            var_99 = wp::add(var_87, var_97);\n        }\n        var_100 = wp::where(var_95, var_99, var_87);\n        if (!var_95) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_101 = wp::address(var_b, var_0);\n            var_103 = wp::load(var_101);\n            var_102 = wp::add(var_100, var_103);\n        }\n        var_104 = wp::where(var_95, var_100, var_102);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_106 = wp::address(var_a, var_0);\n        var_107 = wp::float(var_105);\n        var_109 = wp::load(var_106);\n        var_108 = wp::mul(var_109, var_107);\n        var_112 = (var_108 > var_111);\n        if (var_112) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_113 = wp::address(var_b, var_0);\n            var_115 = wp::load(var_113);\n            var_114 = wp::sin(var_115);\n            var_116 = wp::add(var_104, var_114);\n        }\n        var_117 = wp::where(var_112, var_116, var_104);\n        if (!var_112) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_118 = wp::address(var_b, var_0);\n            var_120 = wp::load(var_118);\n            var_119 = wp::add(var_117, var_120);\n        }\n        var_121 = wp::where(var_112, var_117, var_119);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_123 = wp::address(var_a, var_0);\n        var_124 = wp::float(var_122);\n        var_126 = wp::load(var_123);\n        var_125 = wp::mul(var_126, var_124);\n        var_129 = (var_125 > var_128);\n        if (var_129) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_130 = wp::address(var_b, var_0);\n            var_132 = wp::load(var_130);\n            var_131 = wp::sin(var_132);\n            var_133 = wp::add(var_121, var_131);\n        }\n        var_134 = wp::where(var_129, var_133, var_121);\n        if (!var_129) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_135 = wp::address(var_b, var_0);\n            var_137 = wp::load(var_135);\n            var_136 = wp::add(var_134, var_137);\n        }\n        var_138 = wp::where(var_129, var_134, var_136);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_140 = wp::address(var_a, var_0);\n        var_141 = wp::float(var_139);\n        var_143 = wp::load(var_140);\n        var_142 = wp::mul(var_143, var_141);\n        var_146 = (var_142 > var_145);\n        if (var_146) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_147 = wp::address(var_b, var_0);\n            var_149 = wp::load(var_147);\n            var_148 = wp::sin(var_149);\n            var_150 = wp::add(var_138, var_148);\n        }\n        var_151 = wp::where(var_146, var_150, var_138);\n        if (!var_146) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_152 = wp::address(var_b, var_0);\n            var_154 = wp::load(var_152);\n            var_153 = wp::add(var_151, var_154);\n        }\n        var_155 = wp::where(var_146, var_151, var_153);\n        // if a[tid] * float(i) > -1.89:                                                          <L 8>\n        var_157 = wp::address(var_a, var_0);\n        var_158 = wp::float(var_156);\n        var_160 = wp::load(var_157);\n        var_159 = wp::mul(var_160, var_158);\n        var_163 = (var_159 > var_162);\n        if (var_163) {\n            // acc = acc + wp.sin(b[tid])                                                         <L 9>\n            var_164 = wp::address(var_b, var_0);\n            var_166 = wp::load(var_164);\n            var_165 = wp::sin(var_166);\n            var_167 = wp::add(var_155, var_165);\n        }\n        var_168 = wp::where(var_163, var_167, var_155);\n        if (!var_163) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_169 = wp::address(var_b, var_0);\n            var_171 = wp::load(var_169);\n            var_170 = wp::add(var_168, var_171);\n        }\n        var_172 = wp::where(var_163, var_168, var_170);\n        // out[tid] = acc                                                                         <L 12>\n        // wp::array_store(var_out, var_0, var_172);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_172, adj_out, adj_0, adj_172);\n        // adj: out[tid] = acc                                                                    <L 12>\n        wp::adj_where(var_163, var_168, var_170, adj_163, adj_168, adj_170, adj_172);\n        if (!var_163) {\n            wp::adj_add(var_168, var_171, adj_168, adj_169, adj_170);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_169);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_163, var_167, var_155, adj_163, adj_167, adj_155, adj_168);\n        if (var_163) {\n            wp::adj_add(var_155, var_165, adj_155, adj_165, adj_167);\n            wp::adj_sin(var_166, adj_164, adj_165);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_164);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_160, var_158, adj_157, adj_158, adj_159);\n        wp::adj_float(var_156, adj_156, adj_158);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_157);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_146, var_151, var_153, adj_146, adj_151, adj_153, adj_155);\n        if (!var_146) {\n            wp::adj_add(var_151, var_154, adj_151, adj_152, adj_153);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_152);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_146, var_150, var_138, adj_146, adj_150, adj_138, adj_151);\n        if (var_146) {\n            wp::adj_add(var_138, var_148, adj_138, adj_148, adj_150);\n            wp::adj_sin(var_149, adj_147, adj_148);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_147);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_143, var_141, adj_140, adj_141, adj_142);\n        wp::adj_float(var_139, adj_139, adj_141);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_140);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_129, var_134, var_136, adj_129, adj_134, adj_136, adj_138);\n        if (!var_129) {\n            wp::adj_add(var_134, var_137, adj_134, adj_135, adj_136);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_135);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_129, var_133, var_121, adj_129, adj_133, adj_121, adj_134);\n        if (var_129) {\n            wp::adj_add(var_121, var_131, adj_121, adj_131, adj_133);\n            wp::adj_sin(var_132, adj_130, adj_131);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_130);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_126, var_124, adj_123, adj_124, adj_125);\n        wp::adj_float(var_122, adj_122, adj_124);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_123);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_112, var_117, var_119, adj_112, adj_117, adj_119, adj_121);\n        if (!var_112) {\n            wp::adj_add(var_117, var_120, adj_117, adj_118, adj_119);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_118);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_112, var_116, var_104, adj_112, adj_116, adj_104, adj_117);\n        if (var_112) {\n            wp::adj_add(var_104, var_114, adj_104, adj_114, adj_116);\n            wp::adj_sin(var_115, adj_113, adj_114);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_113);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_109, var_107, adj_106, adj_107, adj_108);\n        wp::adj_float(var_105, adj_105, adj_107);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_106);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_95, var_100, var_102, adj_95, adj_100, adj_102, adj_104);\n        if (!var_95) {\n            wp::adj_add(var_100, var_103, adj_100, adj_101, adj_102);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_101);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_95, var_99, var_87, adj_95, adj_99, adj_87, adj_100);\n        if (var_95) {\n            wp::adj_add(var_87, var_97, adj_87, adj_97, adj_99);\n            wp::adj_sin(var_98, adj_96, adj_97);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_96);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_92, var_90, adj_89, adj_90, adj_91);\n        wp::adj_float(var_88, adj_88, adj_90);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_89);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_78, var_83, var_85, adj_78, adj_83, adj_85, adj_87);\n        if (!var_78) {\n            wp::adj_add(var_83, var_86, adj_83, adj_84, adj_85);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_84);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_78, var_82, var_70, adj_78, adj_82, adj_70, adj_83);\n        if (var_78) {\n            wp::adj_add(var_70, var_80, adj_70, adj_80, adj_82);\n            wp::adj_sin(var_81, adj_79, adj_80);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_79);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_75, var_73, adj_72, adj_73, adj_74);\n        wp::adj_float(var_71, adj_71, adj_73);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_72);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_61, var_66, var_68, adj_61, adj_66, adj_68, adj_70);\n        if (!var_61) {\n            wp::adj_add(var_66, var_69, adj_66, adj_67, adj_68);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_67);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_61, var_65, var_53, adj_61, adj_65, adj_53, adj_66);\n        if (var_61) {\n            wp::adj_add(var_53, var_63, adj_53, adj_63, adj_65);\n            wp::adj_sin(var_64, adj_62, adj_63);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_62);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_58, var_56, adj_55, adj_56, adj_57);\n        wp::adj_float(var_54, adj_54, adj_56);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_55);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_44, var_49, var_51, adj_44, adj_49, adj_51, adj_53);\n        if (!var_44) {\n            wp::adj_add(var_49, var_52, adj_49, adj_50, adj_51);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_50);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_44, var_48, var_36, adj_44, adj_48, adj_36, adj_49);\n        if (var_44) {\n            wp::adj_add(var_36, var_46, adj_36, adj_46, adj_48);\n            wp::adj_sin(var_47, adj_45, adj_46);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_45);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_41, var_39, adj_38, adj_39, adj_40);\n        wp::adj_float(var_37, adj_37, adj_39);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_38);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_27, var_32, var_34, adj_27, adj_32, adj_34, adj_36);\n        if (!var_27) {\n            wp::adj_add(var_32, var_35, adj_32, adj_33, adj_34);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_33);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_27, var_31, var_19, adj_27, adj_31, adj_19, adj_32);\n        if (var_27) {\n            wp::adj_add(var_19, var_29, adj_19, adj_29, adj_31);\n            wp::adj_sin(var_30, adj_28, adj_29);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_28);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_24, var_22, adj_21, adj_22, adj_23);\n        wp::adj_float(var_20, adj_20, adj_22);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_21);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        wp::adj_where(var_10, var_15, var_17, adj_10, adj_15, adj_17, adj_19);\n        if (!var_10) {\n            wp::adj_add(var_15, var_18, adj_15, adj_16, adj_17);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_16);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_10, var_14, var_2, adj_10, adj_14, adj_2, adj_15);\n        if (var_10) {\n            wp::adj_add(var_2, var_12, adj_2, adj_12, adj_14);\n            wp::adj_sin(var_13, adj_11, adj_12);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_11);\n            // adj: acc = acc + wp.sin(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_float(var_3, adj_3, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: if a[tid] * float(i) > -1.89:                                                     <L 8>\n        // adj: for i in range(10):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: acc = float(0.0)                                                                  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def combined_tnzoyd(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"combined_tnzoyd","mangled_name":"combined_tnzoyd_757ee361","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef combined_tnzoyd(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    acc = float(0.0)\n    for i in range(10):\n        if a[tid] * float(i) > -1.89:\n            acc = acc + wp.sin(b[tid])\n        else:\n            acc = acc + b[tid]\n    out[tid] = acc\n"}
{"id":"scalar_jxkfvt_620a8b6970","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=8.88, offset=-3.34)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"*","scale":8.88,"offset":-3.34,"seed":96},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_jxkfvt_d5773025_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_jxkfvt(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_jxkfvt_d5773025_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_jxkfvt(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_mul(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] * scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_jxkfvt(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_jxkfvt","mangled_name":"scalar_jxkfvt_d5773025","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_jxkfvt(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] * scale) + offset\n"}
{"id":"atom_fujvuo_8298055d2b","device":"cuda","category":"atomic","description":"Atomic max reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"max","seed":97},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_fujvuo_5a6d7ce2_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_fujvuo(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_max(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_fujvuo_5a6d7ce2_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_fujvuo(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_max(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_max(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_max(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_max(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_fujvuo(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_fujvuo","mangled_name":"atom_fujvuo_5a6d7ce2","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_fujvuo(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_max(result, 0, values[tid])\n"}
{"id":"arith_jvjbms_4930858331","device":"cuda","category":"arithmetic","description":"Arithmetic chain with 10 ops","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"num_ops":10,"seed":98},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void arith_jvjbms_5215bf29_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32* var_4;\n        const wp::float32 var_5 = 0.0001;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32* var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        const wp::float32 var_17 = 1.0;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32* var_23;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        wp::float32* var_27;\n        const wp::float32 var_28 = 0.0001;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        const wp::float32 var_33 = 1.0;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        //---------\n        // forward\n        // def arith_jvjbms(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.sin(a[tid])                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        // var_1 = var_0 / (b[tid] + 0.0001)                                                      <L 7>\n        var_4 = wp::address(var_b, var_0);\n        var_7 = wp::load(var_4);\n        var_6 = wp::add(var_7, var_5);\n        var_8 = wp::div(var_2, var_6);\n        // var_2 = wp.log(wp.abs(var_1) + 1.0)                                                    <L 8>\n        var_9 = wp::abs(var_8);\n        var_11 = wp::add(var_9, var_10);\n        var_12 = wp::log(var_11);\n        // var_3 = var_2 * b[tid]                                                                 <L 9>\n        var_13 = wp::address(var_b, var_0);\n        var_15 = wp::load(var_13);\n        var_14 = wp::mul(var_12, var_15);\n        // var_4 = wp.log(wp.abs(var_3) + 1.0)                                                    <L 10>\n        var_16 = wp::abs(var_14);\n        var_18 = wp::add(var_16, var_17);\n        var_19 = wp::log(var_18);\n        // var_5 = var_4 + b[tid]                                                                 <L 11>\n        var_20 = wp::address(var_b, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_19, var_22);\n        // var_6 = var_5 * b[tid]                                                                 <L 12>\n        var_23 = wp::address(var_b, var_0);\n        var_25 = wp::load(var_23);\n        var_24 = wp::mul(var_21, var_25);\n        // var_7 = wp.exp(var_6)                                                                  <L 13>\n        var_26 = wp::exp(var_24);\n        // var_8 = var_7 / (b[tid] + 0.0001)                                                      <L 14>\n        var_27 = wp::address(var_b, var_0);\n        var_30 = wp::load(var_27);\n        var_29 = wp::add(var_30, var_28);\n        var_31 = wp::div(var_26, var_29);\n        // var_9 = wp.log(wp.abs(var_8) + 1.0)                                                    <L 15>\n        var_32 = wp::abs(var_31);\n        var_34 = wp::add(var_32, var_33);\n        var_35 = wp::log(var_34);\n        // out[tid] = var_9                                                                       <L 16>\n        wp::array_store(var_out, var_0, var_35);\n    }\n}\n\n\n\nextern \"C\" __global__ void arith_jvjbms_5215bf29_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32* var_4;\n        const wp::float32 var_5 = 0.0001;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        wp::float32 var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32* var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        wp::float32 var_16;\n        const wp::float32 var_17 = 1.0;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32* var_23;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        wp::float32* var_27;\n        const wp::float32 var_28 = 0.0001;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        const wp::float32 var_33 = 1.0;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::float32 adj_35 = {};\n        //---------\n        // forward\n        // def arith_jvjbms(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // var_0 = wp.sin(a[tid])                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        // var_1 = var_0 / (b[tid] + 0.0001)                                                      <L 7>\n        var_4 = wp::address(var_b, var_0);\n        var_7 = wp::load(var_4);\n        var_6 = wp::add(var_7, var_5);\n        var_8 = wp::div(var_2, var_6);\n        // var_2 = wp.log(wp.abs(var_1) + 1.0)                                                    <L 8>\n        var_9 = wp::abs(var_8);\n        var_11 = wp::add(var_9, var_10);\n        var_12 = wp::log(var_11);\n        // var_3 = var_2 * b[tid]                                                                 <L 9>\n        var_13 = wp::address(var_b, var_0);\n        var_15 = wp::load(var_13);\n        var_14 = wp::mul(var_12, var_15);\n        // var_4 = wp.log(wp.abs(var_3) + 1.0)                                                    <L 10>\n        var_16 = wp::abs(var_14);\n        var_18 = wp::add(var_16, var_17);\n        var_19 = wp::log(var_18);\n        // var_5 = var_4 + b[tid]                                                                 <L 11>\n        var_20 = wp::address(var_b, var_0);\n        var_22 = wp::load(var_20);\n        var_21 = wp::add(var_19, var_22);\n        // var_6 = var_5 * b[tid]                                                                 <L 12>\n        var_23 = wp::address(var_b, var_0);\n        var_25 = wp::load(var_23);\n        var_24 = wp::mul(var_21, var_25);\n        // var_7 = wp.exp(var_6)                                                                  <L 13>\n        var_26 = wp::exp(var_24);\n        // var_8 = var_7 / (b[tid] + 0.0001)                                                      <L 14>\n        var_27 = wp::address(var_b, var_0);\n        var_30 = wp::load(var_27);\n        var_29 = wp::add(var_30, var_28);\n        var_31 = wp::div(var_26, var_29);\n        // var_9 = wp.log(wp.abs(var_8) + 1.0)                                                    <L 15>\n        var_32 = wp::abs(var_31);\n        var_34 = wp::add(var_32, var_33);\n        var_35 = wp::log(var_34);\n        // out[tid] = var_9                                                                       <L 16>\n        // wp::array_store(var_out, var_0, var_35);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_35, adj_out, adj_0, adj_35);\n        // adj: out[tid] = var_9                                                                  <L 16>\n        wp::adj_log(var_34, adj_34, adj_35);\n        wp::adj_add(var_32, var_33, adj_32, adj_33, adj_34);\n        wp::adj_abs(var_31, adj_31, adj_32);\n        // adj: var_9 = wp.log(wp.abs(var_8) + 1.0)                                               <L 15>\n        wp::adj_div(var_26, var_29, var_31, adj_26, adj_29, adj_31);\n        wp::adj_add(var_30, var_28, adj_27, adj_28, adj_29);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_27);\n        // adj: var_8 = var_7 / (b[tid] + 0.0001)                                                 <L 14>\n        wp::adj_exp(var_24, var_26, adj_24, adj_26);\n        // adj: var_7 = wp.exp(var_6)                                                             <L 13>\n        wp::adj_mul(var_21, var_25, adj_21, adj_23, adj_24);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_23);\n        // adj: var_6 = var_5 * b[tid]                                                            <L 12>\n        wp::adj_add(var_19, var_22, adj_19, adj_20, adj_21);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_20);\n        // adj: var_5 = var_4 + b[tid]                                                            <L 11>\n        wp::adj_log(var_18, adj_18, adj_19);\n        wp::adj_add(var_16, var_17, adj_16, adj_17, adj_18);\n        wp::adj_abs(var_14, adj_14, adj_16);\n        // adj: var_4 = wp.log(wp.abs(var_3) + 1.0)                                               <L 10>\n        wp::adj_mul(var_12, var_15, adj_12, adj_13, adj_14);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_13);\n        // adj: var_3 = var_2 * b[tid]                                                            <L 9>\n        wp::adj_log(var_11, adj_11, adj_12);\n        wp::adj_add(var_9, var_10, adj_9, adj_10, adj_11);\n        wp::adj_abs(var_8, adj_8, adj_9);\n        // adj: var_2 = wp.log(wp.abs(var_1) + 1.0)                                               <L 8>\n        wp::adj_div(var_2, var_6, var_8, adj_2, adj_6, adj_8);\n        wp::adj_add(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_4);\n        // adj: var_1 = var_0 / (b[tid] + 0.0001)                                                 <L 7>\n        wp::adj_sin(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: var_0 = wp.sin(a[tid])                                                            <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def arith_jvjbms(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"arith_jvjbms","mangled_name":"arith_jvjbms_5215bf29","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef arith_jvjbms(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    var_0 = wp.sin(a[tid])\n    var_1 = var_0 / (b[tid] + 0.0001)\n    var_2 = wp.log(wp.abs(var_1) + 1.0)\n    var_3 = var_2 * b[tid]\n    var_4 = wp.log(wp.abs(var_3) + 1.0)\n    var_5 = var_4 + b[tid]\n    var_6 = var_5 * b[tid]\n    var_7 = wp.exp(var_6)\n    var_8 = var_7 / (b[tid] + 0.0001)\n    var_9 = wp.log(wp.abs(var_8) + 1.0)\n    out[tid] = var_9\n"}
{"id":"combined_kfegtg_6ecf5202c1","device":"cuda","category":"combined","description":"Combined pattern (loop+cond+wp.exp)","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"iterations":9,"threshold":0.12,"function":"wp.exp","seed":99},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void combined_kfegtg_789943b8_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.12;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.12;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.12;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.12;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 0.12;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 0.12;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        const wp::int32 var_99 = 6;\n        wp::float32* var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::float32 var_104 = 0.12;\n        bool var_105;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32* var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 7;\n        wp::float32* var_116;\n        wp::float32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        const wp::float32 var_120 = 0.12;\n        bool var_121;\n        wp::float32* var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        wp::float32* var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 8;\n        wp::float32* var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32 var_135;\n        const wp::float32 var_136 = 0.12;\n        bool var_137;\n        wp::float32* var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32* var_143;\n        wp::float32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        //---------\n        // forward\n        // def combined_kfegtg(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(9):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::exp(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::exp(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::exp(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::exp(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::exp(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::exp(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_100 = wp::address(var_a, var_0);\n        var_101 = wp::float(var_99);\n        var_103 = wp::load(var_100);\n        var_102 = wp::mul(var_103, var_101);\n        var_105 = (var_102 > var_104);\n        if (var_105) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_106 = wp::address(var_b, var_0);\n            var_108 = wp::load(var_106);\n            var_107 = wp::exp(var_108);\n            var_109 = wp::add(var_98, var_107);\n        }\n        var_110 = wp::where(var_105, var_109, var_98);\n        if (!var_105) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_111 = wp::address(var_b, var_0);\n            var_113 = wp::load(var_111);\n            var_112 = wp::add(var_110, var_113);\n        }\n        var_114 = wp::where(var_105, var_110, var_112);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_116 = wp::address(var_a, var_0);\n        var_117 = wp::float(var_115);\n        var_119 = wp::load(var_116);\n        var_118 = wp::mul(var_119, var_117);\n        var_121 = (var_118 > var_120);\n        if (var_121) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_122 = wp::address(var_b, var_0);\n            var_124 = wp::load(var_122);\n            var_123 = wp::exp(var_124);\n            var_125 = wp::add(var_114, var_123);\n        }\n        var_126 = wp::where(var_121, var_125, var_114);\n        if (!var_121) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_127 = wp::address(var_b, var_0);\n            var_129 = wp::load(var_127);\n            var_128 = wp::add(var_126, var_129);\n        }\n        var_130 = wp::where(var_121, var_126, var_128);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_132 = wp::address(var_a, var_0);\n        var_133 = wp::float(var_131);\n        var_135 = wp::load(var_132);\n        var_134 = wp::mul(var_135, var_133);\n        var_137 = (var_134 > var_136);\n        if (var_137) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_138 = wp::address(var_b, var_0);\n            var_140 = wp::load(var_138);\n            var_139 = wp::exp(var_140);\n            var_141 = wp::add(var_130, var_139);\n        }\n        var_142 = wp::where(var_137, var_141, var_130);\n        if (!var_137) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_143 = wp::address(var_b, var_0);\n            var_145 = wp::load(var_143);\n            var_144 = wp::add(var_142, var_145);\n        }\n        var_146 = wp::where(var_137, var_142, var_144);\n        // out[tid] = acc                                                                         <L 12>\n        wp::array_store(var_out, var_0, var_146);\n    }\n}\n\n\n\nextern \"C\" __global__ void combined_kfegtg_789943b8_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 0.12;\n        bool var_9;\n        wp::float32* var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        wp::float32* var_15;\n        wp::float32 var_16;\n        wp::float32 var_17;\n        wp::float32 var_18;\n        const wp::int32 var_19 = 1;\n        wp::float32* var_20;\n        wp::float32 var_21;\n        wp::float32 var_22;\n        wp::float32 var_23;\n        const wp::float32 var_24 = 0.12;\n        bool var_25;\n        wp::float32* var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        wp::float32* var_31;\n        wp::float32 var_32;\n        wp::float32 var_33;\n        wp::float32 var_34;\n        const wp::int32 var_35 = 2;\n        wp::float32* var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::float32 var_40 = 0.12;\n        bool var_41;\n        wp::float32* var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32* var_47;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 3;\n        wp::float32* var_52;\n        wp::float32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        const wp::float32 var_56 = 0.12;\n        bool var_57;\n        wp::float32* var_58;\n        wp::float32 var_59;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        wp::float32* var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 4;\n        wp::float32* var_68;\n        wp::float32 var_69;\n        wp::float32 var_70;\n        wp::float32 var_71;\n        const wp::float32 var_72 = 0.12;\n        bool var_73;\n        wp::float32* var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        wp::float32 var_77;\n        wp::float32 var_78;\n        wp::float32* var_79;\n        wp::float32 var_80;\n        wp::float32 var_81;\n        wp::float32 var_82;\n        const wp::int32 var_83 = 5;\n        wp::float32* var_84;\n        wp::float32 var_85;\n        wp::float32 var_86;\n        wp::float32 var_87;\n        const wp::float32 var_88 = 0.12;\n        bool var_89;\n        wp::float32* var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        wp::float32* var_95;\n        wp::float32 var_96;\n        wp::float32 var_97;\n        wp::float32 var_98;\n        const wp::int32 var_99 = 6;\n        wp::float32* var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::float32 var_104 = 0.12;\n        bool var_105;\n        wp::float32* var_106;\n        wp::float32 var_107;\n        wp::float32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32* var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        wp::float32 var_114;\n        const wp::int32 var_115 = 7;\n        wp::float32* var_116;\n        wp::float32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        const wp::float32 var_120 = 0.12;\n        bool var_121;\n        wp::float32* var_122;\n        wp::float32 var_123;\n        wp::float32 var_124;\n        wp::float32 var_125;\n        wp::float32 var_126;\n        wp::float32* var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 8;\n        wp::float32* var_132;\n        wp::float32 var_133;\n        wp::float32 var_134;\n        wp::float32 var_135;\n        const wp::float32 var_136 = 0.12;\n        bool var_137;\n        wp::float32* var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        wp::float32 var_141;\n        wp::float32 var_142;\n        wp::float32* var_143;\n        wp::float32 var_144;\n        wp::float32 var_145;\n        wp::float32 var_146;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::int32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        bool adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        bool adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        bool adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::int32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::float32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        bool adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::float32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::float32 adj_79 = {};\n        wp::float32 adj_80 = {};\n        wp::float32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::int32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::float32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::float32 adj_88 = {};\n        bool adj_89 = {};\n        wp::float32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::float32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::float32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::float32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        bool adj_105 = {};\n        wp::float32 adj_106 = {};\n        wp::float32 adj_107 = {};\n        wp::float32 adj_108 = {};\n        wp::float32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::float32 adj_116 = {};\n        wp::float32 adj_117 = {};\n        wp::float32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        bool adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::float32 adj_125 = {};\n        wp::float32 adj_126 = {};\n        wp::float32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::int32 adj_131 = {};\n        wp::float32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::float32 adj_134 = {};\n        wp::float32 adj_135 = {};\n        wp::float32 adj_136 = {};\n        bool adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::float32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::float32 adj_143 = {};\n        wp::float32 adj_144 = {};\n        wp::float32 adj_145 = {};\n        wp::float32 adj_146 = {};\n        //---------\n        // forward\n        // def combined_kfegtg(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // acc = float(0.0)                                                                       <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(9):                                                                     <L 7>\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_5 = wp::float(var_3);\n        var_7 = wp::load(var_4);\n        var_6 = wp::mul(var_7, var_5);\n        var_9 = (var_6 > var_8);\n        if (var_9) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_10 = wp::address(var_b, var_0);\n            var_12 = wp::load(var_10);\n            var_11 = wp::exp(var_12);\n            var_13 = wp::add(var_2, var_11);\n        }\n        var_14 = wp::where(var_9, var_13, var_2);\n        if (!var_9) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_15 = wp::address(var_b, var_0);\n            var_17 = wp::load(var_15);\n            var_16 = wp::add(var_14, var_17);\n        }\n        var_18 = wp::where(var_9, var_14, var_16);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_20 = wp::address(var_a, var_0);\n        var_21 = wp::float(var_19);\n        var_23 = wp::load(var_20);\n        var_22 = wp::mul(var_23, var_21);\n        var_25 = (var_22 > var_24);\n        if (var_25) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_26 = wp::address(var_b, var_0);\n            var_28 = wp::load(var_26);\n            var_27 = wp::exp(var_28);\n            var_29 = wp::add(var_18, var_27);\n        }\n        var_30 = wp::where(var_25, var_29, var_18);\n        if (!var_25) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_31 = wp::address(var_b, var_0);\n            var_33 = wp::load(var_31);\n            var_32 = wp::add(var_30, var_33);\n        }\n        var_34 = wp::where(var_25, var_30, var_32);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_36 = wp::address(var_a, var_0);\n        var_37 = wp::float(var_35);\n        var_39 = wp::load(var_36);\n        var_38 = wp::mul(var_39, var_37);\n        var_41 = (var_38 > var_40);\n        if (var_41) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_42 = wp::address(var_b, var_0);\n            var_44 = wp::load(var_42);\n            var_43 = wp::exp(var_44);\n            var_45 = wp::add(var_34, var_43);\n        }\n        var_46 = wp::where(var_41, var_45, var_34);\n        if (!var_41) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_47 = wp::address(var_b, var_0);\n            var_49 = wp::load(var_47);\n            var_48 = wp::add(var_46, var_49);\n        }\n        var_50 = wp::where(var_41, var_46, var_48);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_52 = wp::address(var_a, var_0);\n        var_53 = wp::float(var_51);\n        var_55 = wp::load(var_52);\n        var_54 = wp::mul(var_55, var_53);\n        var_57 = (var_54 > var_56);\n        if (var_57) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_58 = wp::address(var_b, var_0);\n            var_60 = wp::load(var_58);\n            var_59 = wp::exp(var_60);\n            var_61 = wp::add(var_50, var_59);\n        }\n        var_62 = wp::where(var_57, var_61, var_50);\n        if (!var_57) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_63 = wp::address(var_b, var_0);\n            var_65 = wp::load(var_63);\n            var_64 = wp::add(var_62, var_65);\n        }\n        var_66 = wp::where(var_57, var_62, var_64);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_68 = wp::address(var_a, var_0);\n        var_69 = wp::float(var_67);\n        var_71 = wp::load(var_68);\n        var_70 = wp::mul(var_71, var_69);\n        var_73 = (var_70 > var_72);\n        if (var_73) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_74 = wp::address(var_b, var_0);\n            var_76 = wp::load(var_74);\n            var_75 = wp::exp(var_76);\n            var_77 = wp::add(var_66, var_75);\n        }\n        var_78 = wp::where(var_73, var_77, var_66);\n        if (!var_73) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_79 = wp::address(var_b, var_0);\n            var_81 = wp::load(var_79);\n            var_80 = wp::add(var_78, var_81);\n        }\n        var_82 = wp::where(var_73, var_78, var_80);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_84 = wp::address(var_a, var_0);\n        var_85 = wp::float(var_83);\n        var_87 = wp::load(var_84);\n        var_86 = wp::mul(var_87, var_85);\n        var_89 = (var_86 > var_88);\n        if (var_89) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_90 = wp::address(var_b, var_0);\n            var_92 = wp::load(var_90);\n            var_91 = wp::exp(var_92);\n            var_93 = wp::add(var_82, var_91);\n        }\n        var_94 = wp::where(var_89, var_93, var_82);\n        if (!var_89) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_95 = wp::address(var_b, var_0);\n            var_97 = wp::load(var_95);\n            var_96 = wp::add(var_94, var_97);\n        }\n        var_98 = wp::where(var_89, var_94, var_96);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_100 = wp::address(var_a, var_0);\n        var_101 = wp::float(var_99);\n        var_103 = wp::load(var_100);\n        var_102 = wp::mul(var_103, var_101);\n        var_105 = (var_102 > var_104);\n        if (var_105) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_106 = wp::address(var_b, var_0);\n            var_108 = wp::load(var_106);\n            var_107 = wp::exp(var_108);\n            var_109 = wp::add(var_98, var_107);\n        }\n        var_110 = wp::where(var_105, var_109, var_98);\n        if (!var_105) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_111 = wp::address(var_b, var_0);\n            var_113 = wp::load(var_111);\n            var_112 = wp::add(var_110, var_113);\n        }\n        var_114 = wp::where(var_105, var_110, var_112);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_116 = wp::address(var_a, var_0);\n        var_117 = wp::float(var_115);\n        var_119 = wp::load(var_116);\n        var_118 = wp::mul(var_119, var_117);\n        var_121 = (var_118 > var_120);\n        if (var_121) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_122 = wp::address(var_b, var_0);\n            var_124 = wp::load(var_122);\n            var_123 = wp::exp(var_124);\n            var_125 = wp::add(var_114, var_123);\n        }\n        var_126 = wp::where(var_121, var_125, var_114);\n        if (!var_121) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_127 = wp::address(var_b, var_0);\n            var_129 = wp::load(var_127);\n            var_128 = wp::add(var_126, var_129);\n        }\n        var_130 = wp::where(var_121, var_126, var_128);\n        // if a[tid] * float(i) > 0.12:                                                           <L 8>\n        var_132 = wp::address(var_a, var_0);\n        var_133 = wp::float(var_131);\n        var_135 = wp::load(var_132);\n        var_134 = wp::mul(var_135, var_133);\n        var_137 = (var_134 > var_136);\n        if (var_137) {\n            // acc = acc + wp.exp(b[tid])                                                         <L 9>\n            var_138 = wp::address(var_b, var_0);\n            var_140 = wp::load(var_138);\n            var_139 = wp::exp(var_140);\n            var_141 = wp::add(var_130, var_139);\n        }\n        var_142 = wp::where(var_137, var_141, var_130);\n        if (!var_137) {\n            // acc = acc + b[tid]                                                                 <L 11>\n            var_143 = wp::address(var_b, var_0);\n            var_145 = wp::load(var_143);\n            var_144 = wp::add(var_142, var_145);\n        }\n        var_146 = wp::where(var_137, var_142, var_144);\n        // out[tid] = acc                                                                         <L 12>\n        // wp::array_store(var_out, var_0, var_146);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_146, adj_out, adj_0, adj_146);\n        // adj: out[tid] = acc                                                                    <L 12>\n        wp::adj_where(var_137, var_142, var_144, adj_137, adj_142, adj_144, adj_146);\n        if (!var_137) {\n            wp::adj_add(var_142, var_145, adj_142, adj_143, adj_144);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_143);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_137, var_141, var_130, adj_137, adj_141, adj_130, adj_142);\n        if (var_137) {\n            wp::adj_add(var_130, var_139, adj_130, adj_139, adj_141);\n            wp::adj_exp(var_140, var_139, adj_138, adj_139);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_138);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_135, var_133, adj_132, adj_133, adj_134);\n        wp::adj_float(var_131, adj_131, adj_133);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_132);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_121, var_126, var_128, adj_121, adj_126, adj_128, adj_130);\n        if (!var_121) {\n            wp::adj_add(var_126, var_129, adj_126, adj_127, adj_128);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_127);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_121, var_125, var_114, adj_121, adj_125, adj_114, adj_126);\n        if (var_121) {\n            wp::adj_add(var_114, var_123, adj_114, adj_123, adj_125);\n            wp::adj_exp(var_124, var_123, adj_122, adj_123);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_122);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_119, var_117, adj_116, adj_117, adj_118);\n        wp::adj_float(var_115, adj_115, adj_117);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_116);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_105, var_110, var_112, adj_105, adj_110, adj_112, adj_114);\n        if (!var_105) {\n            wp::adj_add(var_110, var_113, adj_110, adj_111, adj_112);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_111);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_105, var_109, var_98, adj_105, adj_109, adj_98, adj_110);\n        if (var_105) {\n            wp::adj_add(var_98, var_107, adj_98, adj_107, adj_109);\n            wp::adj_exp(var_108, var_107, adj_106, adj_107);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_106);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_103, var_101, adj_100, adj_101, adj_102);\n        wp::adj_float(var_99, adj_99, adj_101);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_100);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_89, var_94, var_96, adj_89, adj_94, adj_96, adj_98);\n        if (!var_89) {\n            wp::adj_add(var_94, var_97, adj_94, adj_95, adj_96);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_95);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_89, var_93, var_82, adj_89, adj_93, adj_82, adj_94);\n        if (var_89) {\n            wp::adj_add(var_82, var_91, adj_82, adj_91, adj_93);\n            wp::adj_exp(var_92, var_91, adj_90, adj_91);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_90);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_87, var_85, adj_84, adj_85, adj_86);\n        wp::adj_float(var_83, adj_83, adj_85);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_84);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_73, var_78, var_80, adj_73, adj_78, adj_80, adj_82);\n        if (!var_73) {\n            wp::adj_add(var_78, var_81, adj_78, adj_79, adj_80);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_79);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_73, var_77, var_66, adj_73, adj_77, adj_66, adj_78);\n        if (var_73) {\n            wp::adj_add(var_66, var_75, adj_66, adj_75, adj_77);\n            wp::adj_exp(var_76, var_75, adj_74, adj_75);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_74);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_71, var_69, adj_68, adj_69, adj_70);\n        wp::adj_float(var_67, adj_67, adj_69);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_68);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_57, var_62, var_64, adj_57, adj_62, adj_64, adj_66);\n        if (!var_57) {\n            wp::adj_add(var_62, var_65, adj_62, adj_63, adj_64);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_63);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_57, var_61, var_50, adj_57, adj_61, adj_50, adj_62);\n        if (var_57) {\n            wp::adj_add(var_50, var_59, adj_50, adj_59, adj_61);\n            wp::adj_exp(var_60, var_59, adj_58, adj_59);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_58);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_55, var_53, adj_52, adj_53, adj_54);\n        wp::adj_float(var_51, adj_51, adj_53);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_41, var_46, var_48, adj_41, adj_46, adj_48, adj_50);\n        if (!var_41) {\n            wp::adj_add(var_46, var_49, adj_46, adj_47, adj_48);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_47);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_41, var_45, var_34, adj_41, adj_45, adj_34, adj_46);\n        if (var_41) {\n            wp::adj_add(var_34, var_43, adj_34, adj_43, adj_45);\n            wp::adj_exp(var_44, var_43, adj_42, adj_43);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_42);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_39, var_37, adj_36, adj_37, adj_38);\n        wp::adj_float(var_35, adj_35, adj_37);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_36);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_25, var_30, var_32, adj_25, adj_30, adj_32, adj_34);\n        if (!var_25) {\n            wp::adj_add(var_30, var_33, adj_30, adj_31, adj_32);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_31);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_25, var_29, var_18, adj_25, adj_29, adj_18, adj_30);\n        if (var_25) {\n            wp::adj_add(var_18, var_27, adj_18, adj_27, adj_29);\n            wp::adj_exp(var_28, var_27, adj_26, adj_27);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_26);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_23, var_21, adj_20, adj_21, adj_22);\n        wp::adj_float(var_19, adj_19, adj_21);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_20);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        wp::adj_where(var_9, var_14, var_16, adj_9, adj_14, adj_16, adj_18);\n        if (!var_9) {\n            wp::adj_add(var_14, var_17, adj_14, adj_15, adj_16);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_15);\n            // adj: acc = acc + b[tid]                                                            <L 11>\n        }\n        wp::adj_where(var_9, var_13, var_2, adj_9, adj_13, adj_2, adj_14);\n        if (var_9) {\n            wp::adj_add(var_2, var_11, adj_2, adj_11, adj_13);\n            wp::adj_exp(var_12, var_11, adj_10, adj_11);\n            wp::adj_address(var_b, var_0, adj_b, adj_0, adj_10);\n            // adj: acc = acc + wp.exp(b[tid])                                                    <L 9>\n        }\n        wp::adj_mul(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_float(var_3, adj_3, adj_5);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: if a[tid] * float(i) > 0.12:                                                      <L 8>\n        // adj: for i in range(9):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: acc = float(0.0)                                                                  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def combined_kfegtg(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"combined_kfegtg","mangled_name":"combined_kfegtg_789943b8","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef combined_kfegtg(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    acc = float(0.0)\n    for i in range(9):\n        if a[tid] * float(i) > 0.12:\n            acc = acc + wp.exp(b[tid])\n        else:\n            acc = acc + b[tid]\n    out[tid] = acc\n"}
{"id":"vec_dlustl_0e33857d8f","device":"cuda","category":"vector","description":"Vector op normalize on wp.vec2","arg_types":{"a":"wp.array(dtype=wp.vec2)","b":"wp.array(dtype=wp.vec2)","out":"wp.array(dtype=wp.vec2)"},"metadata":{"vec_type":"wp.vec2","operation":"normalize","seed":100},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_dlustl_946a19f2_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // forward\n        // def vec_dlustl(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_dlustl_946a19f2_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<2, wp::float32> adj_1 = {};\n        wp::vec_t<2, wp::float32> adj_2 = {};\n        wp::vec_t<2, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def vec_dlustl(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_normalize(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.normalize(a[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_dlustl(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_dlustl","mangled_name":"vec_dlustl_946a19f2","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec2f'>","b":"array<class 'warp._src.types.vec2f'>","out":"array<class 'warp._src.types.vec2f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_dlustl(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):\n    tid = wp.tid()\n    out[tid] = wp.normalize(a[tid])\n"}
{"id":"vec_pfzymr_e619672c52","device":"cuda","category":"vector","description":"Vector op normalize on wp.vec2","arg_types":{"a":"wp.array(dtype=wp.vec2)","b":"wp.array(dtype=wp.vec2)","out":"wp.array(dtype=wp.vec2)"},"metadata":{"vec_type":"wp.vec2","operation":"normalize","seed":101},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_pfzymr_2408ad36_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // forward\n        // def vec_pfzymr(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_pfzymr_2408ad36_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<2, wp::float32> adj_1 = {};\n        wp::vec_t<2, wp::float32> adj_2 = {};\n        wp::vec_t<2, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def vec_pfzymr(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_normalize(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.normalize(a[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_pfzymr(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_pfzymr","mangled_name":"vec_pfzymr_2408ad36","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec2f'>","b":"array<class 'warp._src.types.vec2f'>","out":"array<class 'warp._src.types.vec2f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_pfzymr(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):\n    tid = wp.tid()\n    out[tid] = wp.normalize(a[tid])\n"}
{"id":"mat_dqespj_19705aaecb","device":"cuda","category":"matrix","description":"Matrix-matrix multiply (wp.mat44)","arg_types":{"a":"wp.array(dtype=wp.mat44)","b":"wp.array(dtype=wp.mat44)","out":"wp.array(dtype=wp.mat44)"},"metadata":{"mat_type":"wp.mat44","operation":"mat_mat","seed":102},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_dqespj_8205b197_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<4, 4, wp::float32>* var_1;\n        wp::mat_t<4, 4, wp::float32>* var_2;\n        wp::mat_t<4, 4, wp::float32> var_3;\n        wp::mat_t<4, 4, wp::float32> var_4;\n        wp::mat_t<4, 4, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_dqespj(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_dqespj_8205b197_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_a,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_b,\n    wp::array_t<wp::mat_t<4, 4, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<4, 4, wp::float32>* var_1;\n        wp::mat_t<4, 4, wp::float32>* var_2;\n        wp::mat_t<4, 4, wp::float32> var_3;\n        wp::mat_t<4, 4, wp::float32> var_4;\n        wp::mat_t<4, 4, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<4, 4, wp::float32> adj_1 = {};\n        wp::mat_t<4, 4, wp::float32> adj_2 = {};\n        wp::mat_t<4, 4, wp::float32> adj_3 = {};\n        wp::mat_t<4, 4, wp::float32> adj_4 = {};\n        wp::mat_t<4, 4, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_dqespj(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = a[tid] * b[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_dqespj(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_dqespj","mangled_name":"mat_dqespj_8205b197","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.mat44f'>","b":"array<class 'warp._src.types.mat44f'>","out":"array<class 'warp._src.types.mat44f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_dqespj(a: wp.array(dtype=wp.mat44), b: wp.array(dtype=wp.mat44), out: wp.array(dtype=wp.mat44)):\n    tid = wp.tid()\n    out[tid] = a[tid] * b[tid]\n"}
{"id":"scalar_zlstfc_3c86ee6c72","device":"cuda","category":"scalar_param","description":"Scalar parameters (scale=7.42, offset=1.54)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)","scale":"float","offset":"float"},"metadata":{"operation":"*","scale":7.42,"offset":1.54,"seed":103},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void scalar_zlstfc_291380cb_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def scalar_zlstfc(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        wp::array_store(var_out, var_0, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void scalar_zlstfc_291380cb_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::float32 var_scale,\n    wp::float32 var_offset,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out,\n    wp::float32 adj_scale,\n    wp::float32 adj_offset)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def scalar_zlstfc(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = (x[tid] * scale) + offset                                                   <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::mul(var_3, var_scale);\n        var_4 = wp::add(var_2, var_offset);\n        // wp::array_store(var_out, var_0, var_4);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_4, adj_out, adj_0, adj_4);\n        wp::adj_add(var_2, var_offset, adj_2, adj_offset, adj_4);\n        wp::adj_mul(var_3, var_scale, adj_1, adj_scale, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: out[tid] = (x[tid] * scale) + offset                                              <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def scalar_zlstfc(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"scalar_zlstfc","mangled_name":"scalar_zlstfc_291380cb","device":"cuda","arg_names":["x","out","scale","offset"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>","scale":"<class 'float'>","offset":"<class 'float'>"},"has_backward":false},"python_source":"@wp.kernel\ndef scalar_zlstfc(x: wp.array(dtype=float), out: wp.array(dtype=float), scale: float, offset: float):\n    tid = wp.tid()\n    out[tid] = (x[tid] * scale) + offset\n"}
{"id":"multicond_ywtfis_653ea33f36","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: 3.07, 3.65)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":3.07,"threshold2":3.65,"seed":104},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_ywtfis_9f66ad25_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.07;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 3.65;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // forward\n        // def multicond_ywtfis(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 3.07:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 3.65:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                wp::array_store(var_out, var_0, var_13);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_ywtfis_9f66ad25_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.07;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 3.65;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        bool adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        //---------\n        // forward\n        // def multicond_ywtfis(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 3.07:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            // wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 3.65:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                // wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                // wp::array_store(var_out, var_0, var_13);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_5) {\n            if (!var_9) {\n                wp::adj_array_store(var_out, var_0, var_13, adj_out, adj_0, adj_13);\n                wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_9) {\n                wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n                wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 3.65:                                                              <L 9>\n        }\n        if (var_5) {\n            wp::adj_array_store(var_out, var_0, var_7, adj_out, adj_0, adj_7);\n            wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < 3.07:                                                                    <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_ywtfis(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_ywtfis","mangled_name":"multicond_ywtfis_9f66ad25","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_ywtfis(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < 3.07:\n        out[tid] = val * 0.5\n    elif val < 3.65:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"mat_wjuyit_8b2ef3cd8e","device":"cuda","category":"matrix","description":"Matrix-matrix multiply (wp.mat33)","arg_types":{"a":"wp.array(dtype=wp.mat33)","b":"wp.array(dtype=wp.mat33)","out":"wp.array(dtype=wp.mat33)"},"metadata":{"mat_type":"wp.mat33","operation":"mat_mat","seed":105},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_wjuyit_ed235e10_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::mat_t<3, 3, wp::float32>* var_2;\n        wp::mat_t<3, 3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::mat_t<3, 3, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_wjuyit(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_wjuyit_ed235e10_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_a,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_b,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::mat_t<3, 3, wp::float32>* var_2;\n        wp::mat_t<3, 3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::mat_t<3, 3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<3, 3, wp::float32> adj_1 = {};\n        wp::mat_t<3, 3, wp::float32> adj_2 = {};\n        wp::mat_t<3, 3, wp::float32> adj_3 = {};\n        wp::mat_t<3, 3, wp::float32> adj_4 = {};\n        wp::mat_t<3, 3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_wjuyit(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = a[tid] * b[tid]                                                             <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = a[tid] * b[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_wjuyit(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_wjuyit","mangled_name":"mat_wjuyit_ed235e10","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.mat33f'>","b":"array<class 'warp._src.types.mat33f'>","out":"array<class 'warp._src.types.mat33f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_wjuyit(a: wp.array(dtype=wp.mat33), b: wp.array(dtype=wp.mat33), out: wp.array(dtype=wp.mat33)):\n    tid = wp.tid()\n    out[tid] = a[tid] * b[tid]\n"}
{"id":"mat_sxayvb_73781121f8","device":"cuda","category":"matrix","description":"Matrix-vector multiply (wp.mat33 * wp.vec3)","arg_types":{"m":"wp.array(dtype=wp.mat33)","v":"wp.array(dtype=wp.vec3)","out":"wp.array(dtype=wp.vec3)"},"metadata":{"mat_type":"wp.mat33","operation":"mat_vec","seed":106},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void mat_sxayvb_aba0b516_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // forward\n        // def mat_sxayvb(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        wp::array_store(var_out, var_0, var_3);\n    }\n}\n\n\n\nextern \"C\" __global__ void mat_sxayvb_aba0b516_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> var_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> var_out,\n    wp::array_t<wp::mat_t<3, 3, wp::float32>> adj_m,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_v,\n    wp::array_t<wp::vec_t<3, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::mat_t<3, 3, wp::float32>* var_1;\n        wp::vec_t<3, wp::float32>* var_2;\n        wp::vec_t<3, wp::float32> var_3;\n        wp::mat_t<3, 3, wp::float32> var_4;\n        wp::vec_t<3, wp::float32> var_5;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::mat_t<3, 3, wp::float32> adj_1 = {};\n        wp::vec_t<3, wp::float32> adj_2 = {};\n        wp::vec_t<3, wp::float32> adj_3 = {};\n        wp::mat_t<3, 3, wp::float32> adj_4 = {};\n        wp::vec_t<3, wp::float32> adj_5 = {};\n        //---------\n        // forward\n        // def mat_sxayvb(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = m[tid] * v[tid]                                                             <L 6>\n        var_1 = wp::address(var_m, var_0);\n        var_2 = wp::address(var_v, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::mul(var_4, var_5);\n        // wp::array_store(var_out, var_0, var_3);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n        wp::adj_mul(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_v, var_0, adj_v, adj_0, adj_2);\n        wp::adj_address(var_m, var_0, adj_m, adj_0, adj_1);\n        // adj: out[tid] = m[tid] * v[tid]                                                        <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def mat_sxayvb(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"mat_sxayvb","mangled_name":"mat_sxayvb_aba0b516","device":"cuda","arg_names":["m","v","out"],"arg_types":{"m":"array<class 'warp._src.types.mat33f'>","v":"array<class 'warp._src.types.vec3f'>","out":"array<class 'warp._src.types.vec3f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef mat_sxayvb(m: wp.array(dtype=wp.mat33), v: wp.array(dtype=wp.vec3), out: wp.array(dtype=wp.vec3)):\n    tid = wp.tid()\n    out[tid] = m[tid] * v[tid]\n"}
{"id":"ctrl_gpzrmi_1e39fabe8f","device":"cuda","category":"control_flow","description":"Absolute difference","arg_types":{"a":"wp.array(dtype=float)","b":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"pattern":"abs_diff","seed":107},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_gpzrmi_f8bc4baf_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        const wp::float32 var_6 = 0.0;\n        bool var_7;\n        wp::float32 var_8;\n        //---------\n        // forward\n        // def ctrl_gpzrmi(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // diff = a[tid] - b[tid]                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::sub(var_4, var_5);\n        // if diff < 0.0:                                                                         <L 7>\n        var_7 = (var_3 < var_6);\n        if (var_7) {\n            // out[tid] = -diff                                                                   <L 8>\n            var_8 = wp::neg(var_3);\n            wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_7) {\n            // out[tid] = diff                                                                    <L 10>\n            wp::array_store(var_out, var_0, var_3);\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_gpzrmi_f8bc4baf_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_b,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_b,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        const wp::float32 var_6 = 0.0;\n        bool var_7;\n        wp::float32 var_8;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        bool adj_7 = {};\n        wp::float32 adj_8 = {};\n        //---------\n        // forward\n        // def ctrl_gpzrmi(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // diff = a[tid] - b[tid]                                                                 <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_2 = wp::address(var_b, var_0);\n        var_4 = wp::load(var_1);\n        var_5 = wp::load(var_2);\n        var_3 = wp::sub(var_4, var_5);\n        // if diff < 0.0:                                                                         <L 7>\n        var_7 = (var_3 < var_6);\n        if (var_7) {\n            // out[tid] = -diff                                                                   <L 8>\n            var_8 = wp::neg(var_3);\n            // wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_7) {\n            // out[tid] = diff                                                                    <L 10>\n            // wp::array_store(var_out, var_0, var_3);\n        }\n        //---------\n        // reverse\n        if (!var_7) {\n            wp::adj_array_store(var_out, var_0, var_3, adj_out, adj_0, adj_3);\n            // adj: out[tid] = diff                                                               <L 10>\n        }\n        if (var_7) {\n            wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n            wp::adj_neg(var_3, adj_3, adj_8);\n            // adj: out[tid] = -diff                                                              <L 8>\n        }\n        // adj: if diff < 0.0:                                                                    <L 7>\n        wp::adj_sub(var_4, var_5, adj_1, adj_2, adj_3);\n        wp::adj_address(var_b, var_0, adj_b, adj_0, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: diff = a[tid] - b[tid]                                                            <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_gpzrmi(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_gpzrmi","mangled_name":"ctrl_gpzrmi_f8bc4baf","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","b":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_gpzrmi(a: wp.array(dtype=float), b: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    diff = a[tid] - b[tid]\n    if diff < 0.0:\n        out[tid] = -diff\n    else:\n        out[tid] = diff\n"}
{"id":"nested_dvwkhf_ada05820a8","device":"cuda","category":"nested_loop","description":"Nested loops (3x5)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":3,"inner_iterations":5,"seed":108},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_dvwkhf_9a2c3e76_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 1;\n        const wp::int32 var_50 = 0;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 1;\n        wp::float32* var_60;\n        wp::int32 var_61;\n        const wp::int32 var_62 = 1;\n        wp::int32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        const wp::int32 var_68 = 2;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 3;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 4;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        const wp::int32 var_96 = 0;\n        wp::float32* var_97;\n        wp::int32 var_98;\n        const wp::int32 var_99 = 1;\n        wp::int32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 1;\n        wp::float32* var_106;\n        wp::int32 var_107;\n        const wp::int32 var_108 = 1;\n        wp::int32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        const wp::int32 var_114 = 2;\n        wp::float32* var_115;\n        wp::int32 var_116;\n        const wp::int32 var_117 = 1;\n        wp::int32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        const wp::int32 var_123 = 3;\n        wp::float32* var_124;\n        wp::int32 var_125;\n        const wp::int32 var_126 = 1;\n        wp::int32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        const wp::int32 var_132 = 4;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        //---------\n        // forward\n        // def nested_dvwkhf(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(3):                                                                     <L 7>\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_49, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_48, var_56);\n        var_60 = wp::address(var_data, var_0);\n        var_61 = wp::mul(var_49, var_59);\n        var_63 = wp::add(var_61, var_62);\n        var_64 = wp::float(var_63);\n        var_66 = wp::load(var_60);\n        var_65 = wp::mul(var_66, var_64);\n        var_67 = wp::add(var_58, var_65);\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_49, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_67, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_49, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_49, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_97 = wp::address(var_data, var_0);\n        var_98 = wp::mul(var_95, var_96);\n        var_100 = wp::add(var_98, var_99);\n        var_101 = wp::float(var_100);\n        var_103 = wp::load(var_97);\n        var_102 = wp::mul(var_103, var_101);\n        var_104 = wp::add(var_94, var_102);\n        var_106 = wp::address(var_data, var_0);\n        var_107 = wp::mul(var_95, var_105);\n        var_109 = wp::add(var_107, var_108);\n        var_110 = wp::float(var_109);\n        var_112 = wp::load(var_106);\n        var_111 = wp::mul(var_112, var_110);\n        var_113 = wp::add(var_104, var_111);\n        var_115 = wp::address(var_data, var_0);\n        var_116 = wp::mul(var_95, var_114);\n        var_118 = wp::add(var_116, var_117);\n        var_119 = wp::float(var_118);\n        var_121 = wp::load(var_115);\n        var_120 = wp::mul(var_121, var_119);\n        var_122 = wp::add(var_113, var_120);\n        var_124 = wp::address(var_data, var_0);\n        var_125 = wp::mul(var_95, var_123);\n        var_127 = wp::add(var_125, var_126);\n        var_128 = wp::float(var_127);\n        var_130 = wp::load(var_124);\n        var_129 = wp::mul(var_130, var_128);\n        var_131 = wp::add(var_122, var_129);\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_95, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_131, var_138);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_140);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_dvwkhf_9a2c3e76_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 1;\n        const wp::int32 var_50 = 0;\n        wp::float32* var_51;\n        wp::int32 var_52;\n        const wp::int32 var_53 = 1;\n        wp::int32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        wp::float32 var_58;\n        const wp::int32 var_59 = 1;\n        wp::float32* var_60;\n        wp::int32 var_61;\n        const wp::int32 var_62 = 1;\n        wp::int32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        const wp::int32 var_68 = 2;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 3;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 4;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 2;\n        const wp::int32 var_96 = 0;\n        wp::float32* var_97;\n        wp::int32 var_98;\n        const wp::int32 var_99 = 1;\n        wp::int32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        wp::float32 var_104;\n        const wp::int32 var_105 = 1;\n        wp::float32* var_106;\n        wp::int32 var_107;\n        const wp::int32 var_108 = 1;\n        wp::int32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        wp::float32 var_113;\n        const wp::int32 var_114 = 2;\n        wp::float32* var_115;\n        wp::int32 var_116;\n        const wp::int32 var_117 = 1;\n        wp::int32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        wp::float32 var_122;\n        const wp::int32 var_123 = 3;\n        wp::float32* var_124;\n        wp::int32 var_125;\n        const wp::int32 var_126 = 1;\n        wp::int32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        wp::float32 var_131;\n        const wp::int32 var_132 = 4;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::int32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::int32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::int32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::int32 adj_49 = {};\n        wp::int32 adj_50 = {};\n        wp::float32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::int32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::int32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::int32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::int32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::int32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::int32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::int32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::int32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::int32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::int32 adj_95 = {};\n        wp::int32 adj_96 = {};\n        wp::float32 adj_97 = {};\n        wp::int32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::int32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::float32 adj_104 = {};\n        wp::int32 adj_105 = {};\n        wp::float32 adj_106 = {};\n        wp::int32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::int32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::float32 adj_113 = {};\n        wp::int32 adj_114 = {};\n        wp::float32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::int32 adj_117 = {};\n        wp::int32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::float32 adj_122 = {};\n        wp::int32 adj_123 = {};\n        wp::float32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::int32 adj_126 = {};\n        wp::int32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::float32 adj_131 = {};\n        wp::int32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::int32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::float32 adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        //---------\n        // forward\n        // def nested_dvwkhf(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(3):                                                                     <L 7>\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_51 = wp::address(var_data, var_0);\n        var_52 = wp::mul(var_49, var_50);\n        var_54 = wp::add(var_52, var_53);\n        var_55 = wp::float(var_54);\n        var_57 = wp::load(var_51);\n        var_56 = wp::mul(var_57, var_55);\n        var_58 = wp::add(var_48, var_56);\n        var_60 = wp::address(var_data, var_0);\n        var_61 = wp::mul(var_49, var_59);\n        var_63 = wp::add(var_61, var_62);\n        var_64 = wp::float(var_63);\n        var_66 = wp::load(var_60);\n        var_65 = wp::mul(var_66, var_64);\n        var_67 = wp::add(var_58, var_65);\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_49, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_67, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_49, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_49, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        // for j in range(5):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_97 = wp::address(var_data, var_0);\n        var_98 = wp::mul(var_95, var_96);\n        var_100 = wp::add(var_98, var_99);\n        var_101 = wp::float(var_100);\n        var_103 = wp::load(var_97);\n        var_102 = wp::mul(var_103, var_101);\n        var_104 = wp::add(var_94, var_102);\n        var_106 = wp::address(var_data, var_0);\n        var_107 = wp::mul(var_95, var_105);\n        var_109 = wp::add(var_107, var_108);\n        var_110 = wp::float(var_109);\n        var_112 = wp::load(var_106);\n        var_111 = wp::mul(var_112, var_110);\n        var_113 = wp::add(var_104, var_111);\n        var_115 = wp::address(var_data, var_0);\n        var_116 = wp::mul(var_95, var_114);\n        var_118 = wp::add(var_116, var_117);\n        var_119 = wp::float(var_118);\n        var_121 = wp::load(var_115);\n        var_120 = wp::mul(var_121, var_119);\n        var_122 = wp::add(var_113, var_120);\n        var_124 = wp::address(var_data, var_0);\n        var_125 = wp::mul(var_95, var_123);\n        var_127 = wp::add(var_125, var_126);\n        var_128 = wp::float(var_127);\n        var_130 = wp::load(var_124);\n        var_129 = wp::mul(var_130, var_128);\n        var_131 = wp::add(var_122, var_129);\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_95, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_131, var_138);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_140);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_140, adj_out, adj_0, adj_140);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_131, var_138, adj_131, adj_138, adj_140);\n        wp::adj_mul(var_139, var_137, adj_133, adj_137, adj_138);\n        wp::adj_float(var_136, adj_136, adj_137);\n        wp::adj_add(var_134, var_135, adj_134, adj_135, adj_136);\n        wp::adj_mul(var_95, var_132, adj_95, adj_132, adj_134);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_133);\n        wp::adj_add(var_122, var_129, adj_122, adj_129, adj_131);\n        wp::adj_mul(var_130, var_128, adj_124, adj_128, adj_129);\n        wp::adj_float(var_127, adj_127, adj_128);\n        wp::adj_add(var_125, var_126, adj_125, adj_126, adj_127);\n        wp::adj_mul(var_95, var_123, adj_95, adj_123, adj_125);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_124);\n        wp::adj_add(var_113, var_120, adj_113, adj_120, adj_122);\n        wp::adj_mul(var_121, var_119, adj_115, adj_119, adj_120);\n        wp::adj_float(var_118, adj_118, adj_119);\n        wp::adj_add(var_116, var_117, adj_116, adj_117, adj_118);\n        wp::adj_mul(var_95, var_114, adj_95, adj_114, adj_116);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_115);\n        wp::adj_add(var_104, var_111, adj_104, adj_111, adj_113);\n        wp::adj_mul(var_112, var_110, adj_106, adj_110, adj_111);\n        wp::adj_float(var_109, adj_109, adj_110);\n        wp::adj_add(var_107, var_108, adj_107, adj_108, adj_109);\n        wp::adj_mul(var_95, var_105, adj_95, adj_105, adj_107);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_106);\n        wp::adj_add(var_94, var_102, adj_94, adj_102, adj_104);\n        wp::adj_mul(var_103, var_101, adj_97, adj_101, adj_102);\n        wp::adj_float(var_100, adj_100, adj_101);\n        wp::adj_add(var_98, var_99, adj_98, adj_99, adj_100);\n        wp::adj_mul(var_95, var_96, adj_95, adj_96, adj_98);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_97);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_85, var_92, adj_85, adj_92, adj_94);\n        wp::adj_mul(var_93, var_91, adj_87, adj_91, adj_92);\n        wp::adj_float(var_90, adj_90, adj_91);\n        wp::adj_add(var_88, var_89, adj_88, adj_89, adj_90);\n        wp::adj_mul(var_49, var_86, adj_49, adj_86, adj_88);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_87);\n        wp::adj_add(var_76, var_83, adj_76, adj_83, adj_85);\n        wp::adj_mul(var_84, var_82, adj_78, adj_82, adj_83);\n        wp::adj_float(var_81, adj_81, adj_82);\n        wp::adj_add(var_79, var_80, adj_79, adj_80, adj_81);\n        wp::adj_mul(var_49, var_77, adj_49, adj_77, adj_79);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_78);\n        wp::adj_add(var_67, var_74, adj_67, adj_74, adj_76);\n        wp::adj_mul(var_75, var_73, adj_69, adj_73, adj_74);\n        wp::adj_float(var_72, adj_72, adj_73);\n        wp::adj_add(var_70, var_71, adj_70, adj_71, adj_72);\n        wp::adj_mul(var_49, var_68, adj_49, adj_68, adj_70);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_69);\n        wp::adj_add(var_58, var_65, adj_58, adj_65, adj_67);\n        wp::adj_mul(var_66, var_64, adj_60, adj_64, adj_65);\n        wp::adj_float(var_63, adj_63, adj_64);\n        wp::adj_add(var_61, var_62, adj_61, adj_62, adj_63);\n        wp::adj_mul(var_49, var_59, adj_49, adj_59, adj_61);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_60);\n        wp::adj_add(var_48, var_56, adj_48, adj_56, adj_58);\n        wp::adj_mul(var_57, var_55, adj_51, adj_55, adj_56);\n        wp::adj_float(var_54, adj_54, adj_55);\n        wp::adj_add(var_52, var_53, adj_52, adj_53, adj_54);\n        wp::adj_mul(var_49, var_50, adj_49, adj_50, adj_52);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_51);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        wp::adj_add(var_39, var_46, adj_39, adj_46, adj_48);\n        wp::adj_mul(var_47, var_45, adj_41, adj_45, adj_46);\n        wp::adj_float(var_44, adj_44, adj_45);\n        wp::adj_add(var_42, var_43, adj_42, adj_43, adj_44);\n        wp::adj_mul(var_3, var_40, adj_3, adj_40, adj_42);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_41);\n        wp::adj_add(var_30, var_37, adj_30, adj_37, adj_39);\n        wp::adj_mul(var_38, var_36, adj_32, adj_36, adj_37);\n        wp::adj_float(var_35, adj_35, adj_36);\n        wp::adj_add(var_33, var_34, adj_33, adj_34, adj_35);\n        wp::adj_mul(var_3, var_31, adj_3, adj_31, adj_33);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_32);\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(5):                                                                <L 8>\n        // adj: for i in range(3):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_dvwkhf(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_dvwkhf","mangled_name":"nested_dvwkhf_9a2c3e76","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_dvwkhf(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(3):\n        for j in range(5):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
{"id":"ctrl_hlocny_9c881c4f2f","device":"cuda","category":"control_flow","description":"Loop product (12 iterations)","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"pattern":"loop_product","seed":109},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void ctrl_hlocny_e2d53217_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 1.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        const wp::float32 var_5 = 0.0001;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        const wp::int32 var_9 = 1;\n        wp::float32* var_10;\n        const wp::float32 var_11 = 0.0001;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 2;\n        wp::float32* var_16;\n        const wp::float32 var_17 = 0.0001;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        const wp::int32 var_21 = 3;\n        wp::float32* var_22;\n        const wp::float32 var_23 = 0.0001;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 4;\n        wp::float32* var_28;\n        const wp::float32 var_29 = 0.0001;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        const wp::int32 var_33 = 5;\n        wp::float32* var_34;\n        const wp::float32 var_35 = 0.0001;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 6;\n        wp::float32* var_40;\n        const wp::float32 var_41 = 0.0001;\n        wp::float32 var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        const wp::int32 var_45 = 7;\n        wp::float32* var_46;\n        const wp::float32 var_47 = 0.0001;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 8;\n        wp::float32* var_52;\n        const wp::float32 var_53 = 0.0001;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        const wp::int32 var_57 = 9;\n        wp::float32* var_58;\n        const wp::float32 var_59 = 0.0001;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        const wp::int32 var_63 = 10;\n        wp::float32* var_64;\n        const wp::float32 var_65 = 0.0001;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 11;\n        wp::float32* var_70;\n        const wp::float32 var_71 = 0.0001;\n        wp::float32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        //---------\n        // forward\n        // def ctrl_hlocny(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // prod = float(1.0)                                                                      <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(12):                                                                    <L 7>\n        // prod = prod * (a[tid] + 0.0001)                                                        <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_4);\n        var_6 = wp::add(var_7, var_5);\n        var_8 = wp::mul(var_2, var_6);\n        var_10 = wp::address(var_a, var_0);\n        var_13 = wp::load(var_10);\n        var_12 = wp::add(var_13, var_11);\n        var_14 = wp::mul(var_8, var_12);\n        var_16 = wp::address(var_a, var_0);\n        var_19 = wp::load(var_16);\n        var_18 = wp::add(var_19, var_17);\n        var_20 = wp::mul(var_14, var_18);\n        var_22 = wp::address(var_a, var_0);\n        var_25 = wp::load(var_22);\n        var_24 = wp::add(var_25, var_23);\n        var_26 = wp::mul(var_20, var_24);\n        var_28 = wp::address(var_a, var_0);\n        var_31 = wp::load(var_28);\n        var_30 = wp::add(var_31, var_29);\n        var_32 = wp::mul(var_26, var_30);\n        var_34 = wp::address(var_a, var_0);\n        var_37 = wp::load(var_34);\n        var_36 = wp::add(var_37, var_35);\n        var_38 = wp::mul(var_32, var_36);\n        var_40 = wp::address(var_a, var_0);\n        var_43 = wp::load(var_40);\n        var_42 = wp::add(var_43, var_41);\n        var_44 = wp::mul(var_38, var_42);\n        var_46 = wp::address(var_a, var_0);\n        var_49 = wp::load(var_46);\n        var_48 = wp::add(var_49, var_47);\n        var_50 = wp::mul(var_44, var_48);\n        var_52 = wp::address(var_a, var_0);\n        var_55 = wp::load(var_52);\n        var_54 = wp::add(var_55, var_53);\n        var_56 = wp::mul(var_50, var_54);\n        var_58 = wp::address(var_a, var_0);\n        var_61 = wp::load(var_58);\n        var_60 = wp::add(var_61, var_59);\n        var_62 = wp::mul(var_56, var_60);\n        var_64 = wp::address(var_a, var_0);\n        var_67 = wp::load(var_64);\n        var_66 = wp::add(var_67, var_65);\n        var_68 = wp::mul(var_62, var_66);\n        var_70 = wp::address(var_a, var_0);\n        var_73 = wp::load(var_70);\n        var_72 = wp::add(var_73, var_71);\n        var_74 = wp::mul(var_68, var_72);\n        // out[tid] = prod                                                                        <L 9>\n        wp::array_store(var_out, var_0, var_74);\n    }\n}\n\n\n\nextern \"C\" __global__ void ctrl_hlocny_e2d53217_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 1.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        wp::float32* var_4;\n        const wp::float32 var_5 = 0.0001;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        const wp::int32 var_9 = 1;\n        wp::float32* var_10;\n        const wp::float32 var_11 = 0.0001;\n        wp::float32 var_12;\n        wp::float32 var_13;\n        wp::float32 var_14;\n        const wp::int32 var_15 = 2;\n        wp::float32* var_16;\n        const wp::float32 var_17 = 0.0001;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        const wp::int32 var_21 = 3;\n        wp::float32* var_22;\n        const wp::float32 var_23 = 0.0001;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        wp::float32 var_26;\n        const wp::int32 var_27 = 4;\n        wp::float32* var_28;\n        const wp::float32 var_29 = 0.0001;\n        wp::float32 var_30;\n        wp::float32 var_31;\n        wp::float32 var_32;\n        const wp::int32 var_33 = 5;\n        wp::float32* var_34;\n        const wp::float32 var_35 = 0.0001;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        const wp::int32 var_39 = 6;\n        wp::float32* var_40;\n        const wp::float32 var_41 = 0.0001;\n        wp::float32 var_42;\n        wp::float32 var_43;\n        wp::float32 var_44;\n        const wp::int32 var_45 = 7;\n        wp::float32* var_46;\n        const wp::float32 var_47 = 0.0001;\n        wp::float32 var_48;\n        wp::float32 var_49;\n        wp::float32 var_50;\n        const wp::int32 var_51 = 8;\n        wp::float32* var_52;\n        const wp::float32 var_53 = 0.0001;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        const wp::int32 var_57 = 9;\n        wp::float32* var_58;\n        const wp::float32 var_59 = 0.0001;\n        wp::float32 var_60;\n        wp::float32 var_61;\n        wp::float32 var_62;\n        const wp::int32 var_63 = 10;\n        wp::float32* var_64;\n        const wp::float32 var_65 = 0.0001;\n        wp::float32 var_66;\n        wp::float32 var_67;\n        wp::float32 var_68;\n        const wp::int32 var_69 = 11;\n        wp::float32* var_70;\n        const wp::float32 var_71 = 0.0001;\n        wp::float32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::int32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::float32 adj_16 = {};\n        wp::float32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::int32 adj_21 = {};\n        wp::float32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::float32 adj_26 = {};\n        wp::int32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::float32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::int32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::float32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::int32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::int32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::float32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::float32 adj_52 = {};\n        wp::float32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::int32 adj_57 = {};\n        wp::float32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::float32 adj_60 = {};\n        wp::float32 adj_61 = {};\n        wp::float32 adj_62 = {};\n        wp::int32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::float32 adj_67 = {};\n        wp::float32 adj_68 = {};\n        wp::int32 adj_69 = {};\n        wp::float32 adj_70 = {};\n        wp::float32 adj_71 = {};\n        wp::float32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        //---------\n        // forward\n        // def ctrl_hlocny(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // prod = float(1.0)                                                                      <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(12):                                                                    <L 7>\n        // prod = prod * (a[tid] + 0.0001)                                                        <L 8>\n        var_4 = wp::address(var_a, var_0);\n        var_7 = wp::load(var_4);\n        var_6 = wp::add(var_7, var_5);\n        var_8 = wp::mul(var_2, var_6);\n        var_10 = wp::address(var_a, var_0);\n        var_13 = wp::load(var_10);\n        var_12 = wp::add(var_13, var_11);\n        var_14 = wp::mul(var_8, var_12);\n        var_16 = wp::address(var_a, var_0);\n        var_19 = wp::load(var_16);\n        var_18 = wp::add(var_19, var_17);\n        var_20 = wp::mul(var_14, var_18);\n        var_22 = wp::address(var_a, var_0);\n        var_25 = wp::load(var_22);\n        var_24 = wp::add(var_25, var_23);\n        var_26 = wp::mul(var_20, var_24);\n        var_28 = wp::address(var_a, var_0);\n        var_31 = wp::load(var_28);\n        var_30 = wp::add(var_31, var_29);\n        var_32 = wp::mul(var_26, var_30);\n        var_34 = wp::address(var_a, var_0);\n        var_37 = wp::load(var_34);\n        var_36 = wp::add(var_37, var_35);\n        var_38 = wp::mul(var_32, var_36);\n        var_40 = wp::address(var_a, var_0);\n        var_43 = wp::load(var_40);\n        var_42 = wp::add(var_43, var_41);\n        var_44 = wp::mul(var_38, var_42);\n        var_46 = wp::address(var_a, var_0);\n        var_49 = wp::load(var_46);\n        var_48 = wp::add(var_49, var_47);\n        var_50 = wp::mul(var_44, var_48);\n        var_52 = wp::address(var_a, var_0);\n        var_55 = wp::load(var_52);\n        var_54 = wp::add(var_55, var_53);\n        var_56 = wp::mul(var_50, var_54);\n        var_58 = wp::address(var_a, var_0);\n        var_61 = wp::load(var_58);\n        var_60 = wp::add(var_61, var_59);\n        var_62 = wp::mul(var_56, var_60);\n        var_64 = wp::address(var_a, var_0);\n        var_67 = wp::load(var_64);\n        var_66 = wp::add(var_67, var_65);\n        var_68 = wp::mul(var_62, var_66);\n        var_70 = wp::address(var_a, var_0);\n        var_73 = wp::load(var_70);\n        var_72 = wp::add(var_73, var_71);\n        var_74 = wp::mul(var_68, var_72);\n        // out[tid] = prod                                                                        <L 9>\n        // wp::array_store(var_out, var_0, var_74);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_74, adj_out, adj_0, adj_74);\n        // adj: out[tid] = prod                                                                   <L 9>\n        wp::adj_mul(var_68, var_72, adj_68, adj_72, adj_74);\n        wp::adj_add(var_73, var_71, adj_70, adj_71, adj_72);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_70);\n        wp::adj_mul(var_62, var_66, adj_62, adj_66, adj_68);\n        wp::adj_add(var_67, var_65, adj_64, adj_65, adj_66);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_64);\n        wp::adj_mul(var_56, var_60, adj_56, adj_60, adj_62);\n        wp::adj_add(var_61, var_59, adj_58, adj_59, adj_60);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_58);\n        wp::adj_mul(var_50, var_54, adj_50, adj_54, adj_56);\n        wp::adj_add(var_55, var_53, adj_52, adj_53, adj_54);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_52);\n        wp::adj_mul(var_44, var_48, adj_44, adj_48, adj_50);\n        wp::adj_add(var_49, var_47, adj_46, adj_47, adj_48);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_46);\n        wp::adj_mul(var_38, var_42, adj_38, adj_42, adj_44);\n        wp::adj_add(var_43, var_41, adj_40, adj_41, adj_42);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_40);\n        wp::adj_mul(var_32, var_36, adj_32, adj_36, adj_38);\n        wp::adj_add(var_37, var_35, adj_34, adj_35, adj_36);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_34);\n        wp::adj_mul(var_26, var_30, adj_26, adj_30, adj_32);\n        wp::adj_add(var_31, var_29, adj_28, adj_29, adj_30);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_28);\n        wp::adj_mul(var_20, var_24, adj_20, adj_24, adj_26);\n        wp::adj_add(var_25, var_23, adj_22, adj_23, adj_24);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_22);\n        wp::adj_mul(var_14, var_18, adj_14, adj_18, adj_20);\n        wp::adj_add(var_19, var_17, adj_16, adj_17, adj_18);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_16);\n        wp::adj_mul(var_8, var_12, adj_8, adj_12, adj_14);\n        wp::adj_add(var_13, var_11, adj_10, adj_11, adj_12);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_10);\n        wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_8);\n        wp::adj_add(var_7, var_5, adj_4, adj_5, adj_6);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_4);\n        // adj: prod = prod * (a[tid] + 0.0001)                                                   <L 8>\n        // adj: for i in range(12):                                                               <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: prod = float(1.0)                                                                 <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def ctrl_hlocny(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"ctrl_hlocny","mangled_name":"ctrl_hlocny_e2d53217","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef ctrl_hlocny(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    prod = float(1.0)\n    for i in range(12):\n        prod = prod * (a[tid] + 0.0001)\n    out[tid] = prod\n"}
{"id":"vec_ykvgmh_9d2f4160d3","device":"cuda","category":"vector","description":"Vector op normalize on wp.vec4","arg_types":{"a":"wp.array(dtype=wp.vec4)","b":"wp.array(dtype=wp.vec4)","out":"wp.array(dtype=wp.vec4)"},"metadata":{"vec_type":"wp.vec4","operation":"normalize","seed":110},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_ykvgmh_a9fd6f01_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32> var_2;\n        wp::vec_t<4, wp::float32> var_3;\n        //---------\n        // forward\n        // def vec_ykvgmh(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_ykvgmh_a9fd6f01_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<4, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<4, wp::float32>* var_1;\n        wp::vec_t<4, wp::float32> var_2;\n        wp::vec_t<4, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<4, wp::float32> adj_1 = {};\n        wp::vec_t<4, wp::float32> adj_2 = {};\n        wp::vec_t<4, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def vec_ykvgmh(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_normalize(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.normalize(a[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_ykvgmh(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_ykvgmh","mangled_name":"vec_ykvgmh_a9fd6f01","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec4f'>","b":"array<class 'warp._src.types.vec4f'>","out":"array<class 'warp._src.types.vec4f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_ykvgmh(a: wp.array(dtype=wp.vec4), b: wp.array(dtype=wp.vec4), out: wp.array(dtype=wp.vec4)):\n    tid = wp.tid()\n    out[tid] = wp.normalize(a[tid])\n"}
{"id":"vec_vfymkq_5098a6498e","device":"cuda","category":"vector","description":"Vector op normalize on wp.vec2","arg_types":{"a":"wp.array(dtype=wp.vec2)","b":"wp.array(dtype=wp.vec2)","out":"wp.array(dtype=wp.vec2)"},"metadata":{"vec_type":"wp.vec2","operation":"normalize","seed":111},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void vec_vfymkq_bc6a05b3_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // forward\n        // def vec_vfymkq(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        wp::array_store(var_out, var_0, var_2);\n    }\n}\n\n\n\nextern \"C\" __global__ void vec_vfymkq_bc6a05b3_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> var_out,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_a,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_b,\n    wp::array_t<wp::vec_t<2, wp::float32>> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::vec_t<2, wp::float32>* var_1;\n        wp::vec_t<2, wp::float32> var_2;\n        wp::vec_t<2, wp::float32> var_3;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::vec_t<2, wp::float32> adj_1 = {};\n        wp::vec_t<2, wp::float32> adj_2 = {};\n        wp::vec_t<2, wp::float32> adj_3 = {};\n        //---------\n        // forward\n        // def vec_vfymkq(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):       <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.normalize(a[tid])                                                        <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::normalize(var_3);\n        // wp::array_store(var_out, var_0, var_2);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_2, adj_out, adj_0, adj_2);\n        wp::adj_normalize(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.normalize(a[tid])                                                   <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def vec_vfymkq(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):  <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"vec_vfymkq","mangled_name":"vec_vfymkq_bc6a05b3","device":"cuda","arg_names":["a","b","out"],"arg_types":{"a":"array<class 'warp._src.types.vec2f'>","b":"array<class 'warp._src.types.vec2f'>","out":"array<class 'warp._src.types.vec2f'>"},"has_backward":false},"python_source":"@wp.kernel\ndef vec_vfymkq(a: wp.array(dtype=wp.vec2), b: wp.array(dtype=wp.vec2), out: wp.array(dtype=wp.vec2)):\n    tid = wp.tid()\n    out[tid] = wp.normalize(a[tid])\n"}
{"id":"multicond_mrqsxt_2eb542cfbd","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: -3.37, -1.88)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":-3.37,"threshold2":-1.88,"seed":112},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_mrqsxt_8dd9b3cd_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.37;\n        const wp::float32 var_5 = -3.37;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 1.88;\n        const wp::float32 var_10 = -1.88;\n        bool var_11;\n        const wp::float32 var_12 = 1.0;\n        wp::float32 var_13;\n        const wp::float32 var_14 = 2.0;\n        wp::float32 var_15;\n        //---------\n        // forward\n        // def multicond_mrqsxt(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -3.37:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < -1.88:                                                                  <L 9>\n            var_11 = (var_2 < var_10);\n            if (var_11) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_13 = wp::mul(var_2, var_12);\n                wp::array_store(var_out, var_0, var_13);\n            }\n            if (!var_11) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_15 = wp::mul(var_2, var_14);\n                wp::array_store(var_out, var_0, var_15);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_mrqsxt_8dd9b3cd_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.37;\n        const wp::float32 var_5 = -3.37;\n        bool var_6;\n        const wp::float32 var_7 = 0.5;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 1.88;\n        const wp::float32 var_10 = -1.88;\n        bool var_11;\n        const wp::float32 var_12 = 1.0;\n        wp::float32 var_13;\n        const wp::float32 var_14 = 2.0;\n        wp::float32 var_15;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        bool adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        bool adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        //---------\n        // forward\n        // def multicond_mrqsxt(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < -3.37:                                                                        <L 7>\n        var_6 = (var_2 < var_5);\n        if (var_6) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_8 = wp::mul(var_2, var_7);\n            // wp::array_store(var_out, var_0, var_8);\n        }\n        if (!var_6) {\n            // elif val < -1.88:                                                                  <L 9>\n            var_11 = (var_2 < var_10);\n            if (var_11) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_13 = wp::mul(var_2, var_12);\n                // wp::array_store(var_out, var_0, var_13);\n            }\n            if (!var_11) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_15 = wp::mul(var_2, var_14);\n                // wp::array_store(var_out, var_0, var_15);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_6) {\n            if (!var_11) {\n                wp::adj_array_store(var_out, var_0, var_15, adj_out, adj_0, adj_15);\n                wp::adj_mul(var_2, var_14, adj_2, adj_14, adj_15);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_11) {\n                wp::adj_array_store(var_out, var_0, var_13, adj_out, adj_0, adj_13);\n                wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < -1.88:                                                             <L 9>\n        }\n        if (var_6) {\n            wp::adj_array_store(var_out, var_0, var_8, adj_out, adj_0, adj_8);\n            wp::adj_mul(var_2, var_7, adj_2, adj_7, adj_8);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < -3.37:                                                                   <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_mrqsxt(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_mrqsxt","mangled_name":"multicond_mrqsxt_8dd9b3cd","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_mrqsxt(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < -3.37:\n        out[tid] = val * 0.5\n    elif val < -1.88:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"multicond_awsaog_0e05d8a7eb","device":"cuda","category":"multi_conditional","description":"Multiple conditions (thresholds: 3.82, 8.16)","arg_types":{"x":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"threshold1":3.82,"threshold2":8.16,"seed":113},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void multicond_awsaog_7ad77772_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.82;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 8.16;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // forward\n        // def multicond_awsaog(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 3.82:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 8.16:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                wp::array_store(var_out, var_0, var_13);\n            }\n        }\n    }\n}\n\n\n\nextern \"C\" __global__ void multicond_awsaog_7ad77772_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_x,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_x,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        const wp::float32 var_4 = 3.82;\n        bool var_5;\n        const wp::float32 var_6 = 0.5;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 8.16;\n        bool var_9;\n        const wp::float32 var_10 = 1.0;\n        wp::float32 var_11;\n        const wp::float32 var_12 = 2.0;\n        wp::float32 var_13;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        bool adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        bool adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::float32 adj_13 = {};\n        //---------\n        // forward\n        // def multicond_awsaog(x: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // val = x[tid]                                                                           <L 6>\n        var_1 = wp::address(var_x, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::copy(var_3);\n        // if val < 3.82:                                                                         <L 7>\n        var_5 = (var_2 < var_4);\n        if (var_5) {\n            // out[tid] = val * 0.5                                                               <L 8>\n            var_7 = wp::mul(var_2, var_6);\n            // wp::array_store(var_out, var_0, var_7);\n        }\n        if (!var_5) {\n            // elif val < 8.16:                                                                   <L 9>\n            var_9 = (var_2 < var_8);\n            if (var_9) {\n                // out[tid] = val * 1.0                                                           <L 10>\n                var_11 = wp::mul(var_2, var_10);\n                // wp::array_store(var_out, var_0, var_11);\n            }\n            if (!var_9) {\n                // out[tid] = val * 2.0                                                           <L 12>\n                var_13 = wp::mul(var_2, var_12);\n                // wp::array_store(var_out, var_0, var_13);\n            }\n        }\n        //---------\n        // reverse\n        if (!var_5) {\n            if (!var_9) {\n                wp::adj_array_store(var_out, var_0, var_13, adj_out, adj_0, adj_13);\n                wp::adj_mul(var_2, var_12, adj_2, adj_12, adj_13);\n                // adj: out[tid] = val * 2.0                                                      <L 12>\n            }\n            if (var_9) {\n                wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n                wp::adj_mul(var_2, var_10, adj_2, adj_10, adj_11);\n                // adj: out[tid] = val * 1.0                                                      <L 10>\n            }\n            // adj: elif val < 8.16:                                                              <L 9>\n        }\n        if (var_5) {\n            wp::adj_array_store(var_out, var_0, var_7, adj_out, adj_0, adj_7);\n            wp::adj_mul(var_2, var_6, adj_2, adj_6, adj_7);\n            // adj: out[tid] = val * 0.5                                                          <L 8>\n        }\n        // adj: if val < 3.82:                                                                    <L 7>\n        wp::adj_copy(var_3, adj_1, adj_2);\n        wp::adj_address(var_x, var_0, adj_x, adj_0, adj_1);\n        // adj: val = x[tid]                                                                      <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def multicond_awsaog(x: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"multicond_awsaog","mangled_name":"multicond_awsaog_7ad77772","device":"cuda","arg_names":["x","out"],"arg_types":{"x":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef multicond_awsaog(x: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    val = x[tid]\n    if val < 3.82:\n        out[tid] = val * 0.5\n    elif val < 8.16:\n        out[tid] = val * 1.0\n    else:\n        out[tid] = val * 2.0\n"}
{"id":"math_gcrgqd_fe8483a113","device":"cuda","category":"math","description":"Math chain: exp, cos, sqrt, neg, log, abs","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["exp","cos","sqrt","neg","log","abs"],"seed":114},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_gcrgqd_329c633a_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 1.0;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        //---------\n        // forward\n        // def math_gcrgqd(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.log(wp.abs(-wp.sqrt(wp.abs(wp.cos(wp.exp(a[tid]))))) + 1.0))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::exp(var_3);\n        var_4 = wp::cos(var_2);\n        var_5 = wp::abs(var_4);\n        var_6 = wp::sqrt(var_5);\n        var_7 = wp::neg(var_6);\n        var_8 = wp::abs(var_7);\n        var_10 = wp::add(var_8, var_9);\n        var_11 = wp::log(var_10);\n        var_12 = wp::abs(var_11);\n        wp::array_store(var_out, var_0, var_12);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_gcrgqd_329c633a_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        wp::float32 var_8;\n        const wp::float32 var_9 = 1.0;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        //---------\n        // forward\n        // def math_gcrgqd(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.abs(wp.log(wp.abs(-wp.sqrt(wp.abs(wp.cos(wp.exp(a[tid]))))) + 1.0))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::exp(var_3);\n        var_4 = wp::cos(var_2);\n        var_5 = wp::abs(var_4);\n        var_6 = wp::sqrt(var_5);\n        var_7 = wp::neg(var_6);\n        var_8 = wp::abs(var_7);\n        var_10 = wp::add(var_8, var_9);\n        var_11 = wp::log(var_10);\n        var_12 = wp::abs(var_11);\n        // wp::array_store(var_out, var_0, var_12);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_12, adj_out, adj_0, adj_12);\n        wp::adj_abs(var_11, adj_11, adj_12);\n        wp::adj_log(var_10, adj_10, adj_11);\n        wp::adj_add(var_8, var_9, adj_8, adj_9, adj_10);\n        wp::adj_abs(var_7, adj_7, adj_8);\n        wp::adj_neg(var_6, adj_6, adj_7);\n        wp::adj_sqrt(var_5, var_6, adj_5, adj_6);\n        wp::adj_abs(var_4, adj_4, adj_5);\n        wp::adj_cos(var_2, adj_2, adj_4);\n        wp::adj_exp(var_3, var_2, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.abs(wp.log(wp.abs(-wp.sqrt(wp.abs(wp.cos(wp.exp(a[tid]))))) + 1.0))  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_gcrgqd(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_gcrgqd","mangled_name":"math_gcrgqd_329c633a","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_gcrgqd(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.abs(wp.log(wp.abs(-wp.sqrt(wp.abs(wp.cos(wp.exp(a[tid]))))) + 1.0))\n"}
{"id":"atom_xfcctw_0b6a2f13cc","device":"cuda","category":"atomic","description":"Atomic min reduction","arg_types":{"values":"wp.array(dtype=float)","result":"wp.array(dtype=float)"},"metadata":{"operation":"min","seed":115},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void atom_xfcctw_2a556f10_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // forward\n        // def atom_xfcctw(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        var_3 = wp::atomic_min(var_result, var_1, var_4);\n    }\n}\n\n\n\nextern \"C\" __global__ void atom_xfcctw_2a556f10_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_values,\n    wp::array_t<wp::float32> var_result,\n    wp::array_t<wp::float32> adj_values,\n    wp::array_t<wp::float32> adj_result)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::int32 var_1 = 0;\n        wp::float32* var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        //---------\n        // forward\n        // def atom_xfcctw(values: wp.array(dtype=float), result: wp.array(dtype=float)):         <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // wp.atomic_min(result, 0, values[tid])                                                  <L 6>\n        var_2 = wp::address(var_values, var_0);\n        var_4 = wp::load(var_2);\n        // var_3 = wp::atomic_min(var_result, var_1, var_4);\n        //---------\n        // reverse\n        wp::adj_atomic_min(var_result, var_1, var_4, adj_result, adj_1, adj_2, adj_3);\n        wp::adj_address(var_values, var_0, adj_values, adj_0, adj_2);\n        // adj: wp.atomic_min(result, 0, values[tid])                                             <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def atom_xfcctw(values: wp.array(dtype=float), result: wp.array(dtype=float)):    <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"atom_xfcctw","mangled_name":"atom_xfcctw_2a556f10","device":"cuda","arg_names":["values","result"],"arg_types":{"values":"array<class 'warp._src.types.float32'>","result":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef atom_xfcctw(values: wp.array(dtype=float), result: wp.array(dtype=float)):\n    tid = wp.tid()\n    wp.atomic_min(result, 0, values[tid])\n"}
{"id":"math_vpsaqt_104bd409a2","device":"cuda","category":"math","description":"Math chain: sin, abs, sqrt, log, cos","arg_types":{"a":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"functions":["sin","abs","sqrt","log","cos"],"seed":116},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void math_vpsaqt_27647718_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.0;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        //---------\n        // forward\n        // def math_vpsaqt(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cos(wp.log(wp.abs(wp.sqrt(wp.abs(wp.abs(wp.sin(a[tid]))))) + 1.0))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::abs(var_4);\n        var_6 = wp::sqrt(var_5);\n        var_7 = wp::abs(var_6);\n        var_9 = wp::add(var_7, var_8);\n        var_10 = wp::log(var_9);\n        var_11 = wp::cos(var_10);\n        wp::array_store(var_out, var_0, var_11);\n    }\n}\n\n\n\nextern \"C\" __global__ void math_vpsaqt_27647718_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_a,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_a,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::float32* var_1;\n        wp::float32 var_2;\n        wp::float32 var_3;\n        wp::float32 var_4;\n        wp::float32 var_5;\n        wp::float32 var_6;\n        wp::float32 var_7;\n        const wp::float32 var_8 = 1.0;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::float32 adj_3 = {};\n        wp::float32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::float32 adj_6 = {};\n        wp::float32 adj_7 = {};\n        wp::float32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        //---------\n        // forward\n        // def math_vpsaqt(a: wp.array(dtype=float), out: wp.array(dtype=float)):                 <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // out[tid] = wp.cos(wp.log(wp.abs(wp.sqrt(wp.abs(wp.abs(wp.sin(a[tid]))))) + 1.0))       <L 6>\n        var_1 = wp::address(var_a, var_0);\n        var_3 = wp::load(var_1);\n        var_2 = wp::sin(var_3);\n        var_4 = wp::abs(var_2);\n        var_5 = wp::abs(var_4);\n        var_6 = wp::sqrt(var_5);\n        var_7 = wp::abs(var_6);\n        var_9 = wp::add(var_7, var_8);\n        var_10 = wp::log(var_9);\n        var_11 = wp::cos(var_10);\n        // wp::array_store(var_out, var_0, var_11);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_11, adj_out, adj_0, adj_11);\n        wp::adj_cos(var_10, adj_10, adj_11);\n        wp::adj_log(var_9, adj_9, adj_10);\n        wp::adj_add(var_7, var_8, adj_7, adj_8, adj_9);\n        wp::adj_abs(var_6, adj_6, adj_7);\n        wp::adj_sqrt(var_5, var_6, adj_5, adj_6);\n        wp::adj_abs(var_4, adj_4, adj_5);\n        wp::adj_abs(var_2, adj_2, adj_4);\n        wp::adj_sin(var_3, adj_1, adj_2);\n        wp::adj_address(var_a, var_0, adj_a, adj_0, adj_1);\n        // adj: out[tid] = wp.cos(wp.log(wp.abs(wp.sqrt(wp.abs(wp.abs(wp.sin(a[tid]))))) + 1.0))  <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def math_vpsaqt(a: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"math_vpsaqt","mangled_name":"math_vpsaqt_27647718","device":"cuda","arg_names":["a","out"],"arg_types":{"a":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef math_vpsaqt(a: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    out[tid] = wp.cos(wp.log(wp.abs(wp.sqrt(wp.abs(wp.abs(wp.sin(a[tid]))))) + 1.0))\n"}
{"id":"nested_gekekd_08fe4b76c4","device":"cuda","category":"nested_loop","description":"Nested loops (7x7)","arg_types":{"data":"wp.array(dtype=float)","out":"wp.array(dtype=float)"},"metadata":{"outer_iterations":7,"inner_iterations":7,"seed":117},"generated_code":"\n#define WP_TILE_BLOCK_DIM 256\n#define WP_NO_CRT\n#include \"builtin.h\"\n\n// Map wp.breakpoint() to a device brkpt at the call site so cuda-gdb attributes the stop to the generated .cu line\n#if defined(__CUDACC__) && !defined(_MSC_VER)\n#define __debugbreak() __brkpt()\n#endif\n\n// avoid namespacing of float type for casting to float type, this is to avoid wp::float(x), which is not valid in C++\n#define float(x) cast_float(x)\n#define adj_float(x, adj_x, adj_ret) adj_cast_float(x, adj_x, adj_ret)\n\n#define int(x) cast_int(x)\n#define adj_int(x, adj_x, adj_ret) adj_cast_int(x, adj_x, adj_ret)\n\n#define builtin_tid1d() wp::tid(_idx, dim)\n#define builtin_tid2d(x, y) wp::tid(x, y, _idx, dim)\n#define builtin_tid3d(x, y, z) wp::tid(x, y, z, _idx, dim)\n#define builtin_tid4d(x, y, z, w) wp::tid(x, y, z, w, _idx, dim)\n\n#define builtin_block_dim() wp::block_dim()\n\n\n\nextern \"C\" __global__ void nested_gekekd_3422eac9_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 5;\n        wp::float32* var_50;\n        wp::int32 var_51;\n        const wp::int32 var_52 = 1;\n        wp::int32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        const wp::int32 var_58 = 6;\n        wp::float32* var_59;\n        wp::int32 var_60;\n        const wp::int32 var_61 = 1;\n        wp::int32 var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 1;\n        const wp::int32 var_68 = 0;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 1;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 2;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 3;\n        wp::float32* var_96;\n        wp::int32 var_97;\n        const wp::int32 var_98 = 1;\n        wp::int32 var_99;\n        wp::float32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::int32 var_104 = 4;\n        wp::float32* var_105;\n        wp::int32 var_106;\n        const wp::int32 var_107 = 1;\n        wp::int32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        const wp::int32 var_113 = 5;\n        wp::float32* var_114;\n        wp::int32 var_115;\n        const wp::int32 var_116 = 1;\n        wp::int32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 6;\n        wp::float32* var_123;\n        wp::int32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::int32 var_126;\n        wp::float32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 2;\n        const wp::int32 var_132 = 0;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        const wp::int32 var_141 = 1;\n        wp::float32* var_142;\n        wp::int32 var_143;\n        const wp::int32 var_144 = 1;\n        wp::int32 var_145;\n        wp::float32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        const wp::int32 var_150 = 2;\n        wp::float32* var_151;\n        wp::int32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::int32 var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        const wp::int32 var_159 = 3;\n        wp::float32* var_160;\n        wp::int32 var_161;\n        const wp::int32 var_162 = 1;\n        wp::int32 var_163;\n        wp::float32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        const wp::int32 var_168 = 4;\n        wp::float32* var_169;\n        wp::int32 var_170;\n        const wp::int32 var_171 = 1;\n        wp::int32 var_172;\n        wp::float32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        const wp::int32 var_177 = 5;\n        wp::float32* var_178;\n        wp::int32 var_179;\n        const wp::int32 var_180 = 1;\n        wp::int32 var_181;\n        wp::float32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        const wp::int32 var_186 = 6;\n        wp::float32* var_187;\n        wp::int32 var_188;\n        const wp::int32 var_189 = 1;\n        wp::int32 var_190;\n        wp::float32 var_191;\n        wp::float32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        const wp::int32 var_195 = 3;\n        const wp::int32 var_196 = 0;\n        wp::float32* var_197;\n        wp::int32 var_198;\n        const wp::int32 var_199 = 1;\n        wp::int32 var_200;\n        wp::float32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        wp::float32 var_204;\n        const wp::int32 var_205 = 1;\n        wp::float32* var_206;\n        wp::int32 var_207;\n        const wp::int32 var_208 = 1;\n        wp::int32 var_209;\n        wp::float32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        wp::float32 var_213;\n        const wp::int32 var_214 = 2;\n        wp::float32* var_215;\n        wp::int32 var_216;\n        const wp::int32 var_217 = 1;\n        wp::int32 var_218;\n        wp::float32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        wp::float32 var_222;\n        const wp::int32 var_223 = 3;\n        wp::float32* var_224;\n        wp::int32 var_225;\n        const wp::int32 var_226 = 1;\n        wp::int32 var_227;\n        wp::float32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        const wp::int32 var_232 = 4;\n        wp::float32* var_233;\n        wp::int32 var_234;\n        const wp::int32 var_235 = 1;\n        wp::int32 var_236;\n        wp::float32 var_237;\n        wp::float32 var_238;\n        wp::float32 var_239;\n        wp::float32 var_240;\n        const wp::int32 var_241 = 5;\n        wp::float32* var_242;\n        wp::int32 var_243;\n        const wp::int32 var_244 = 1;\n        wp::int32 var_245;\n        wp::float32 var_246;\n        wp::float32 var_247;\n        wp::float32 var_248;\n        wp::float32 var_249;\n        const wp::int32 var_250 = 6;\n        wp::float32* var_251;\n        wp::int32 var_252;\n        const wp::int32 var_253 = 1;\n        wp::int32 var_254;\n        wp::float32 var_255;\n        wp::float32 var_256;\n        wp::float32 var_257;\n        wp::float32 var_258;\n        const wp::int32 var_259 = 4;\n        const wp::int32 var_260 = 0;\n        wp::float32* var_261;\n        wp::int32 var_262;\n        const wp::int32 var_263 = 1;\n        wp::int32 var_264;\n        wp::float32 var_265;\n        wp::float32 var_266;\n        wp::float32 var_267;\n        wp::float32 var_268;\n        const wp::int32 var_269 = 1;\n        wp::float32* var_270;\n        wp::int32 var_271;\n        const wp::int32 var_272 = 1;\n        wp::int32 var_273;\n        wp::float32 var_274;\n        wp::float32 var_275;\n        wp::float32 var_276;\n        wp::float32 var_277;\n        const wp::int32 var_278 = 2;\n        wp::float32* var_279;\n        wp::int32 var_280;\n        const wp::int32 var_281 = 1;\n        wp::int32 var_282;\n        wp::float32 var_283;\n        wp::float32 var_284;\n        wp::float32 var_285;\n        wp::float32 var_286;\n        const wp::int32 var_287 = 3;\n        wp::float32* var_288;\n        wp::int32 var_289;\n        const wp::int32 var_290 = 1;\n        wp::int32 var_291;\n        wp::float32 var_292;\n        wp::float32 var_293;\n        wp::float32 var_294;\n        wp::float32 var_295;\n        const wp::int32 var_296 = 4;\n        wp::float32* var_297;\n        wp::int32 var_298;\n        const wp::int32 var_299 = 1;\n        wp::int32 var_300;\n        wp::float32 var_301;\n        wp::float32 var_302;\n        wp::float32 var_303;\n        wp::float32 var_304;\n        const wp::int32 var_305 = 5;\n        wp::float32* var_306;\n        wp::int32 var_307;\n        const wp::int32 var_308 = 1;\n        wp::int32 var_309;\n        wp::float32 var_310;\n        wp::float32 var_311;\n        wp::float32 var_312;\n        wp::float32 var_313;\n        const wp::int32 var_314 = 6;\n        wp::float32* var_315;\n        wp::int32 var_316;\n        const wp::int32 var_317 = 1;\n        wp::int32 var_318;\n        wp::float32 var_319;\n        wp::float32 var_320;\n        wp::float32 var_321;\n        wp::float32 var_322;\n        const wp::int32 var_323 = 5;\n        const wp::int32 var_324 = 0;\n        wp::float32* var_325;\n        wp::int32 var_326;\n        const wp::int32 var_327 = 1;\n        wp::int32 var_328;\n        wp::float32 var_329;\n        wp::float32 var_330;\n        wp::float32 var_331;\n        wp::float32 var_332;\n        const wp::int32 var_333 = 1;\n        wp::float32* var_334;\n        wp::int32 var_335;\n        const wp::int32 var_336 = 1;\n        wp::int32 var_337;\n        wp::float32 var_338;\n        wp::float32 var_339;\n        wp::float32 var_340;\n        wp::float32 var_341;\n        const wp::int32 var_342 = 2;\n        wp::float32* var_343;\n        wp::int32 var_344;\n        const wp::int32 var_345 = 1;\n        wp::int32 var_346;\n        wp::float32 var_347;\n        wp::float32 var_348;\n        wp::float32 var_349;\n        wp::float32 var_350;\n        const wp::int32 var_351 = 3;\n        wp::float32* var_352;\n        wp::int32 var_353;\n        const wp::int32 var_354 = 1;\n        wp::int32 var_355;\n        wp::float32 var_356;\n        wp::float32 var_357;\n        wp::float32 var_358;\n        wp::float32 var_359;\n        const wp::int32 var_360 = 4;\n        wp::float32* var_361;\n        wp::int32 var_362;\n        const wp::int32 var_363 = 1;\n        wp::int32 var_364;\n        wp::float32 var_365;\n        wp::float32 var_366;\n        wp::float32 var_367;\n        wp::float32 var_368;\n        const wp::int32 var_369 = 5;\n        wp::float32* var_370;\n        wp::int32 var_371;\n        const wp::int32 var_372 = 1;\n        wp::int32 var_373;\n        wp::float32 var_374;\n        wp::float32 var_375;\n        wp::float32 var_376;\n        wp::float32 var_377;\n        const wp::int32 var_378 = 6;\n        wp::float32* var_379;\n        wp::int32 var_380;\n        const wp::int32 var_381 = 1;\n        wp::int32 var_382;\n        wp::float32 var_383;\n        wp::float32 var_384;\n        wp::float32 var_385;\n        wp::float32 var_386;\n        const wp::int32 var_387 = 6;\n        const wp::int32 var_388 = 0;\n        wp::float32* var_389;\n        wp::int32 var_390;\n        const wp::int32 var_391 = 1;\n        wp::int32 var_392;\n        wp::float32 var_393;\n        wp::float32 var_394;\n        wp::float32 var_395;\n        wp::float32 var_396;\n        const wp::int32 var_397 = 1;\n        wp::float32* var_398;\n        wp::int32 var_399;\n        const wp::int32 var_400 = 1;\n        wp::int32 var_401;\n        wp::float32 var_402;\n        wp::float32 var_403;\n        wp::float32 var_404;\n        wp::float32 var_405;\n        const wp::int32 var_406 = 2;\n        wp::float32* var_407;\n        wp::int32 var_408;\n        const wp::int32 var_409 = 1;\n        wp::int32 var_410;\n        wp::float32 var_411;\n        wp::float32 var_412;\n        wp::float32 var_413;\n        wp::float32 var_414;\n        const wp::int32 var_415 = 3;\n        wp::float32* var_416;\n        wp::int32 var_417;\n        const wp::int32 var_418 = 1;\n        wp::int32 var_419;\n        wp::float32 var_420;\n        wp::float32 var_421;\n        wp::float32 var_422;\n        wp::float32 var_423;\n        const wp::int32 var_424 = 4;\n        wp::float32* var_425;\n        wp::int32 var_426;\n        const wp::int32 var_427 = 1;\n        wp::int32 var_428;\n        wp::float32 var_429;\n        wp::float32 var_430;\n        wp::float32 var_431;\n        wp::float32 var_432;\n        const wp::int32 var_433 = 5;\n        wp::float32* var_434;\n        wp::int32 var_435;\n        const wp::int32 var_436 = 1;\n        wp::int32 var_437;\n        wp::float32 var_438;\n        wp::float32 var_439;\n        wp::float32 var_440;\n        wp::float32 var_441;\n        const wp::int32 var_442 = 6;\n        wp::float32* var_443;\n        wp::int32 var_444;\n        const wp::int32 var_445 = 1;\n        wp::int32 var_446;\n        wp::float32 var_447;\n        wp::float32 var_448;\n        wp::float32 var_449;\n        wp::float32 var_450;\n        //---------\n        // forward\n        // def nested_gekekd(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        var_50 = wp::address(var_data, var_0);\n        var_51 = wp::mul(var_3, var_49);\n        var_53 = wp::add(var_51, var_52);\n        var_54 = wp::float(var_53);\n        var_56 = wp::load(var_50);\n        var_55 = wp::mul(var_56, var_54);\n        var_57 = wp::add(var_48, var_55);\n        var_59 = wp::address(var_data, var_0);\n        var_60 = wp::mul(var_3, var_58);\n        var_62 = wp::add(var_60, var_61);\n        var_63 = wp::float(var_62);\n        var_65 = wp::load(var_59);\n        var_64 = wp::mul(var_65, var_63);\n        var_66 = wp::add(var_57, var_64);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_67, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_66, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_67, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_67, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        var_96 = wp::address(var_data, var_0);\n        var_97 = wp::mul(var_67, var_95);\n        var_99 = wp::add(var_97, var_98);\n        var_100 = wp::float(var_99);\n        var_102 = wp::load(var_96);\n        var_101 = wp::mul(var_102, var_100);\n        var_103 = wp::add(var_94, var_101);\n        var_105 = wp::address(var_data, var_0);\n        var_106 = wp::mul(var_67, var_104);\n        var_108 = wp::add(var_106, var_107);\n        var_109 = wp::float(var_108);\n        var_111 = wp::load(var_105);\n        var_110 = wp::mul(var_111, var_109);\n        var_112 = wp::add(var_103, var_110);\n        var_114 = wp::address(var_data, var_0);\n        var_115 = wp::mul(var_67, var_113);\n        var_117 = wp::add(var_115, var_116);\n        var_118 = wp::float(var_117);\n        var_120 = wp::load(var_114);\n        var_119 = wp::mul(var_120, var_118);\n        var_121 = wp::add(var_112, var_119);\n        var_123 = wp::address(var_data, var_0);\n        var_124 = wp::mul(var_67, var_122);\n        var_126 = wp::add(var_124, var_125);\n        var_127 = wp::float(var_126);\n        var_129 = wp::load(var_123);\n        var_128 = wp::mul(var_129, var_127);\n        var_130 = wp::add(var_121, var_128);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_131, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_130, var_138);\n        var_142 = wp::address(var_data, var_0);\n        var_143 = wp::mul(var_131, var_141);\n        var_145 = wp::add(var_143, var_144);\n        var_146 = wp::float(var_145);\n        var_148 = wp::load(var_142);\n        var_147 = wp::mul(var_148, var_146);\n        var_149 = wp::add(var_140, var_147);\n        var_151 = wp::address(var_data, var_0);\n        var_152 = wp::mul(var_131, var_150);\n        var_154 = wp::add(var_152, var_153);\n        var_155 = wp::float(var_154);\n        var_157 = wp::load(var_151);\n        var_156 = wp::mul(var_157, var_155);\n        var_158 = wp::add(var_149, var_156);\n        var_160 = wp::address(var_data, var_0);\n        var_161 = wp::mul(var_131, var_159);\n        var_163 = wp::add(var_161, var_162);\n        var_164 = wp::float(var_163);\n        var_166 = wp::load(var_160);\n        var_165 = wp::mul(var_166, var_164);\n        var_167 = wp::add(var_158, var_165);\n        var_169 = wp::address(var_data, var_0);\n        var_170 = wp::mul(var_131, var_168);\n        var_172 = wp::add(var_170, var_171);\n        var_173 = wp::float(var_172);\n        var_175 = wp::load(var_169);\n        var_174 = wp::mul(var_175, var_173);\n        var_176 = wp::add(var_167, var_174);\n        var_178 = wp::address(var_data, var_0);\n        var_179 = wp::mul(var_131, var_177);\n        var_181 = wp::add(var_179, var_180);\n        var_182 = wp::float(var_181);\n        var_184 = wp::load(var_178);\n        var_183 = wp::mul(var_184, var_182);\n        var_185 = wp::add(var_176, var_183);\n        var_187 = wp::address(var_data, var_0);\n        var_188 = wp::mul(var_131, var_186);\n        var_190 = wp::add(var_188, var_189);\n        var_191 = wp::float(var_190);\n        var_193 = wp::load(var_187);\n        var_192 = wp::mul(var_193, var_191);\n        var_194 = wp::add(var_185, var_192);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_197 = wp::address(var_data, var_0);\n        var_198 = wp::mul(var_195, var_196);\n        var_200 = wp::add(var_198, var_199);\n        var_201 = wp::float(var_200);\n        var_203 = wp::load(var_197);\n        var_202 = wp::mul(var_203, var_201);\n        var_204 = wp::add(var_194, var_202);\n        var_206 = wp::address(var_data, var_0);\n        var_207 = wp::mul(var_195, var_205);\n        var_209 = wp::add(var_207, var_208);\n        var_210 = wp::float(var_209);\n        var_212 = wp::load(var_206);\n        var_211 = wp::mul(var_212, var_210);\n        var_213 = wp::add(var_204, var_211);\n        var_215 = wp::address(var_data, var_0);\n        var_216 = wp::mul(var_195, var_214);\n        var_218 = wp::add(var_216, var_217);\n        var_219 = wp::float(var_218);\n        var_221 = wp::load(var_215);\n        var_220 = wp::mul(var_221, var_219);\n        var_222 = wp::add(var_213, var_220);\n        var_224 = wp::address(var_data, var_0);\n        var_225 = wp::mul(var_195, var_223);\n        var_227 = wp::add(var_225, var_226);\n        var_228 = wp::float(var_227);\n        var_230 = wp::load(var_224);\n        var_229 = wp::mul(var_230, var_228);\n        var_231 = wp::add(var_222, var_229);\n        var_233 = wp::address(var_data, var_0);\n        var_234 = wp::mul(var_195, var_232);\n        var_236 = wp::add(var_234, var_235);\n        var_237 = wp::float(var_236);\n        var_239 = wp::load(var_233);\n        var_238 = wp::mul(var_239, var_237);\n        var_240 = wp::add(var_231, var_238);\n        var_242 = wp::address(var_data, var_0);\n        var_243 = wp::mul(var_195, var_241);\n        var_245 = wp::add(var_243, var_244);\n        var_246 = wp::float(var_245);\n        var_248 = wp::load(var_242);\n        var_247 = wp::mul(var_248, var_246);\n        var_249 = wp::add(var_240, var_247);\n        var_251 = wp::address(var_data, var_0);\n        var_252 = wp::mul(var_195, var_250);\n        var_254 = wp::add(var_252, var_253);\n        var_255 = wp::float(var_254);\n        var_257 = wp::load(var_251);\n        var_256 = wp::mul(var_257, var_255);\n        var_258 = wp::add(var_249, var_256);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_261 = wp::address(var_data, var_0);\n        var_262 = wp::mul(var_259, var_260);\n        var_264 = wp::add(var_262, var_263);\n        var_265 = wp::float(var_264);\n        var_267 = wp::load(var_261);\n        var_266 = wp::mul(var_267, var_265);\n        var_268 = wp::add(var_258, var_266);\n        var_270 = wp::address(var_data, var_0);\n        var_271 = wp::mul(var_259, var_269);\n        var_273 = wp::add(var_271, var_272);\n        var_274 = wp::float(var_273);\n        var_276 = wp::load(var_270);\n        var_275 = wp::mul(var_276, var_274);\n        var_277 = wp::add(var_268, var_275);\n        var_279 = wp::address(var_data, var_0);\n        var_280 = wp::mul(var_259, var_278);\n        var_282 = wp::add(var_280, var_281);\n        var_283 = wp::float(var_282);\n        var_285 = wp::load(var_279);\n        var_284 = wp::mul(var_285, var_283);\n        var_286 = wp::add(var_277, var_284);\n        var_288 = wp::address(var_data, var_0);\n        var_289 = wp::mul(var_259, var_287);\n        var_291 = wp::add(var_289, var_290);\n        var_292 = wp::float(var_291);\n        var_294 = wp::load(var_288);\n        var_293 = wp::mul(var_294, var_292);\n        var_295 = wp::add(var_286, var_293);\n        var_297 = wp::address(var_data, var_0);\n        var_298 = wp::mul(var_259, var_296);\n        var_300 = wp::add(var_298, var_299);\n        var_301 = wp::float(var_300);\n        var_303 = wp::load(var_297);\n        var_302 = wp::mul(var_303, var_301);\n        var_304 = wp::add(var_295, var_302);\n        var_306 = wp::address(var_data, var_0);\n        var_307 = wp::mul(var_259, var_305);\n        var_309 = wp::add(var_307, var_308);\n        var_310 = wp::float(var_309);\n        var_312 = wp::load(var_306);\n        var_311 = wp::mul(var_312, var_310);\n        var_313 = wp::add(var_304, var_311);\n        var_315 = wp::address(var_data, var_0);\n        var_316 = wp::mul(var_259, var_314);\n        var_318 = wp::add(var_316, var_317);\n        var_319 = wp::float(var_318);\n        var_321 = wp::load(var_315);\n        var_320 = wp::mul(var_321, var_319);\n        var_322 = wp::add(var_313, var_320);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_325 = wp::address(var_data, var_0);\n        var_326 = wp::mul(var_323, var_324);\n        var_328 = wp::add(var_326, var_327);\n        var_329 = wp::float(var_328);\n        var_331 = wp::load(var_325);\n        var_330 = wp::mul(var_331, var_329);\n        var_332 = wp::add(var_322, var_330);\n        var_334 = wp::address(var_data, var_0);\n        var_335 = wp::mul(var_323, var_333);\n        var_337 = wp::add(var_335, var_336);\n        var_338 = wp::float(var_337);\n        var_340 = wp::load(var_334);\n        var_339 = wp::mul(var_340, var_338);\n        var_341 = wp::add(var_332, var_339);\n        var_343 = wp::address(var_data, var_0);\n        var_344 = wp::mul(var_323, var_342);\n        var_346 = wp::add(var_344, var_345);\n        var_347 = wp::float(var_346);\n        var_349 = wp::load(var_343);\n        var_348 = wp::mul(var_349, var_347);\n        var_350 = wp::add(var_341, var_348);\n        var_352 = wp::address(var_data, var_0);\n        var_353 = wp::mul(var_323, var_351);\n        var_355 = wp::add(var_353, var_354);\n        var_356 = wp::float(var_355);\n        var_358 = wp::load(var_352);\n        var_357 = wp::mul(var_358, var_356);\n        var_359 = wp::add(var_350, var_357);\n        var_361 = wp::address(var_data, var_0);\n        var_362 = wp::mul(var_323, var_360);\n        var_364 = wp::add(var_362, var_363);\n        var_365 = wp::float(var_364);\n        var_367 = wp::load(var_361);\n        var_366 = wp::mul(var_367, var_365);\n        var_368 = wp::add(var_359, var_366);\n        var_370 = wp::address(var_data, var_0);\n        var_371 = wp::mul(var_323, var_369);\n        var_373 = wp::add(var_371, var_372);\n        var_374 = wp::float(var_373);\n        var_376 = wp::load(var_370);\n        var_375 = wp::mul(var_376, var_374);\n        var_377 = wp::add(var_368, var_375);\n        var_379 = wp::address(var_data, var_0);\n        var_380 = wp::mul(var_323, var_378);\n        var_382 = wp::add(var_380, var_381);\n        var_383 = wp::float(var_382);\n        var_385 = wp::load(var_379);\n        var_384 = wp::mul(var_385, var_383);\n        var_386 = wp::add(var_377, var_384);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_389 = wp::address(var_data, var_0);\n        var_390 = wp::mul(var_387, var_388);\n        var_392 = wp::add(var_390, var_391);\n        var_393 = wp::float(var_392);\n        var_395 = wp::load(var_389);\n        var_394 = wp::mul(var_395, var_393);\n        var_396 = wp::add(var_386, var_394);\n        var_398 = wp::address(var_data, var_0);\n        var_399 = wp::mul(var_387, var_397);\n        var_401 = wp::add(var_399, var_400);\n        var_402 = wp::float(var_401);\n        var_404 = wp::load(var_398);\n        var_403 = wp::mul(var_404, var_402);\n        var_405 = wp::add(var_396, var_403);\n        var_407 = wp::address(var_data, var_0);\n        var_408 = wp::mul(var_387, var_406);\n        var_410 = wp::add(var_408, var_409);\n        var_411 = wp::float(var_410);\n        var_413 = wp::load(var_407);\n        var_412 = wp::mul(var_413, var_411);\n        var_414 = wp::add(var_405, var_412);\n        var_416 = wp::address(var_data, var_0);\n        var_417 = wp::mul(var_387, var_415);\n        var_419 = wp::add(var_417, var_418);\n        var_420 = wp::float(var_419);\n        var_422 = wp::load(var_416);\n        var_421 = wp::mul(var_422, var_420);\n        var_423 = wp::add(var_414, var_421);\n        var_425 = wp::address(var_data, var_0);\n        var_426 = wp::mul(var_387, var_424);\n        var_428 = wp::add(var_426, var_427);\n        var_429 = wp::float(var_428);\n        var_431 = wp::load(var_425);\n        var_430 = wp::mul(var_431, var_429);\n        var_432 = wp::add(var_423, var_430);\n        var_434 = wp::address(var_data, var_0);\n        var_435 = wp::mul(var_387, var_433);\n        var_437 = wp::add(var_435, var_436);\n        var_438 = wp::float(var_437);\n        var_440 = wp::load(var_434);\n        var_439 = wp::mul(var_440, var_438);\n        var_441 = wp::add(var_432, var_439);\n        var_443 = wp::address(var_data, var_0);\n        var_444 = wp::mul(var_387, var_442);\n        var_446 = wp::add(var_444, var_445);\n        var_447 = wp::float(var_446);\n        var_449 = wp::load(var_443);\n        var_448 = wp::mul(var_449, var_447);\n        var_450 = wp::add(var_441, var_448);\n        // out[tid] = total                                                                       <L 10>\n        wp::array_store(var_out, var_0, var_450);\n    }\n}\n\n\n\nextern \"C\" __global__ void nested_gekekd_3422eac9_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_data,\n    wp::array_t<wp::float32> var_out,\n    wp::array_t<wp::float32> adj_data,\n    wp::array_t<wp::float32> adj_out)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        const wp::float32 var_1 = 0.0;\n        wp::float32 var_2;\n        const wp::int32 var_3 = 0;\n        const wp::int32 var_4 = 0;\n        wp::float32* var_5;\n        wp::int32 var_6;\n        const wp::int32 var_7 = 1;\n        wp::int32 var_8;\n        wp::float32 var_9;\n        wp::float32 var_10;\n        wp::float32 var_11;\n        wp::float32 var_12;\n        const wp::int32 var_13 = 1;\n        wp::float32* var_14;\n        wp::int32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32 var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        wp::float32 var_21;\n        const wp::int32 var_22 = 2;\n        wp::float32* var_23;\n        wp::int32 var_24;\n        const wp::int32 var_25 = 1;\n        wp::int32 var_26;\n        wp::float32 var_27;\n        wp::float32 var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 3;\n        wp::float32* var_32;\n        wp::int32 var_33;\n        const wp::int32 var_34 = 1;\n        wp::int32 var_35;\n        wp::float32 var_36;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        const wp::int32 var_40 = 4;\n        wp::float32* var_41;\n        wp::int32 var_42;\n        const wp::int32 var_43 = 1;\n        wp::int32 var_44;\n        wp::float32 var_45;\n        wp::float32 var_46;\n        wp::float32 var_47;\n        wp::float32 var_48;\n        const wp::int32 var_49 = 5;\n        wp::float32* var_50;\n        wp::int32 var_51;\n        const wp::int32 var_52 = 1;\n        wp::int32 var_53;\n        wp::float32 var_54;\n        wp::float32 var_55;\n        wp::float32 var_56;\n        wp::float32 var_57;\n        const wp::int32 var_58 = 6;\n        wp::float32* var_59;\n        wp::int32 var_60;\n        const wp::int32 var_61 = 1;\n        wp::int32 var_62;\n        wp::float32 var_63;\n        wp::float32 var_64;\n        wp::float32 var_65;\n        wp::float32 var_66;\n        const wp::int32 var_67 = 1;\n        const wp::int32 var_68 = 0;\n        wp::float32* var_69;\n        wp::int32 var_70;\n        const wp::int32 var_71 = 1;\n        wp::int32 var_72;\n        wp::float32 var_73;\n        wp::float32 var_74;\n        wp::float32 var_75;\n        wp::float32 var_76;\n        const wp::int32 var_77 = 1;\n        wp::float32* var_78;\n        wp::int32 var_79;\n        const wp::int32 var_80 = 1;\n        wp::int32 var_81;\n        wp::float32 var_82;\n        wp::float32 var_83;\n        wp::float32 var_84;\n        wp::float32 var_85;\n        const wp::int32 var_86 = 2;\n        wp::float32* var_87;\n        wp::int32 var_88;\n        const wp::int32 var_89 = 1;\n        wp::int32 var_90;\n        wp::float32 var_91;\n        wp::float32 var_92;\n        wp::float32 var_93;\n        wp::float32 var_94;\n        const wp::int32 var_95 = 3;\n        wp::float32* var_96;\n        wp::int32 var_97;\n        const wp::int32 var_98 = 1;\n        wp::int32 var_99;\n        wp::float32 var_100;\n        wp::float32 var_101;\n        wp::float32 var_102;\n        wp::float32 var_103;\n        const wp::int32 var_104 = 4;\n        wp::float32* var_105;\n        wp::int32 var_106;\n        const wp::int32 var_107 = 1;\n        wp::int32 var_108;\n        wp::float32 var_109;\n        wp::float32 var_110;\n        wp::float32 var_111;\n        wp::float32 var_112;\n        const wp::int32 var_113 = 5;\n        wp::float32* var_114;\n        wp::int32 var_115;\n        const wp::int32 var_116 = 1;\n        wp::int32 var_117;\n        wp::float32 var_118;\n        wp::float32 var_119;\n        wp::float32 var_120;\n        wp::float32 var_121;\n        const wp::int32 var_122 = 6;\n        wp::float32* var_123;\n        wp::int32 var_124;\n        const wp::int32 var_125 = 1;\n        wp::int32 var_126;\n        wp::float32 var_127;\n        wp::float32 var_128;\n        wp::float32 var_129;\n        wp::float32 var_130;\n        const wp::int32 var_131 = 2;\n        const wp::int32 var_132 = 0;\n        wp::float32* var_133;\n        wp::int32 var_134;\n        const wp::int32 var_135 = 1;\n        wp::int32 var_136;\n        wp::float32 var_137;\n        wp::float32 var_138;\n        wp::float32 var_139;\n        wp::float32 var_140;\n        const wp::int32 var_141 = 1;\n        wp::float32* var_142;\n        wp::int32 var_143;\n        const wp::int32 var_144 = 1;\n        wp::int32 var_145;\n        wp::float32 var_146;\n        wp::float32 var_147;\n        wp::float32 var_148;\n        wp::float32 var_149;\n        const wp::int32 var_150 = 2;\n        wp::float32* var_151;\n        wp::int32 var_152;\n        const wp::int32 var_153 = 1;\n        wp::int32 var_154;\n        wp::float32 var_155;\n        wp::float32 var_156;\n        wp::float32 var_157;\n        wp::float32 var_158;\n        const wp::int32 var_159 = 3;\n        wp::float32* var_160;\n        wp::int32 var_161;\n        const wp::int32 var_162 = 1;\n        wp::int32 var_163;\n        wp::float32 var_164;\n        wp::float32 var_165;\n        wp::float32 var_166;\n        wp::float32 var_167;\n        const wp::int32 var_168 = 4;\n        wp::float32* var_169;\n        wp::int32 var_170;\n        const wp::int32 var_171 = 1;\n        wp::int32 var_172;\n        wp::float32 var_173;\n        wp::float32 var_174;\n        wp::float32 var_175;\n        wp::float32 var_176;\n        const wp::int32 var_177 = 5;\n        wp::float32* var_178;\n        wp::int32 var_179;\n        const wp::int32 var_180 = 1;\n        wp::int32 var_181;\n        wp::float32 var_182;\n        wp::float32 var_183;\n        wp::float32 var_184;\n        wp::float32 var_185;\n        const wp::int32 var_186 = 6;\n        wp::float32* var_187;\n        wp::int32 var_188;\n        const wp::int32 var_189 = 1;\n        wp::int32 var_190;\n        wp::float32 var_191;\n        wp::float32 var_192;\n        wp::float32 var_193;\n        wp::float32 var_194;\n        const wp::int32 var_195 = 3;\n        const wp::int32 var_196 = 0;\n        wp::float32* var_197;\n        wp::int32 var_198;\n        const wp::int32 var_199 = 1;\n        wp::int32 var_200;\n        wp::float32 var_201;\n        wp::float32 var_202;\n        wp::float32 var_203;\n        wp::float32 var_204;\n        const wp::int32 var_205 = 1;\n        wp::float32* var_206;\n        wp::int32 var_207;\n        const wp::int32 var_208 = 1;\n        wp::int32 var_209;\n        wp::float32 var_210;\n        wp::float32 var_211;\n        wp::float32 var_212;\n        wp::float32 var_213;\n        const wp::int32 var_214 = 2;\n        wp::float32* var_215;\n        wp::int32 var_216;\n        const wp::int32 var_217 = 1;\n        wp::int32 var_218;\n        wp::float32 var_219;\n        wp::float32 var_220;\n        wp::float32 var_221;\n        wp::float32 var_222;\n        const wp::int32 var_223 = 3;\n        wp::float32* var_224;\n        wp::int32 var_225;\n        const wp::int32 var_226 = 1;\n        wp::int32 var_227;\n        wp::float32 var_228;\n        wp::float32 var_229;\n        wp::float32 var_230;\n        wp::float32 var_231;\n        const wp::int32 var_232 = 4;\n        wp::float32* var_233;\n        wp::int32 var_234;\n        const wp::int32 var_235 = 1;\n        wp::int32 var_236;\n        wp::float32 var_237;\n        wp::float32 var_238;\n        wp::float32 var_239;\n        wp::float32 var_240;\n        const wp::int32 var_241 = 5;\n        wp::float32* var_242;\n        wp::int32 var_243;\n        const wp::int32 var_244 = 1;\n        wp::int32 var_245;\n        wp::float32 var_246;\n        wp::float32 var_247;\n        wp::float32 var_248;\n        wp::float32 var_249;\n        const wp::int32 var_250 = 6;\n        wp::float32* var_251;\n        wp::int32 var_252;\n        const wp::int32 var_253 = 1;\n        wp::int32 var_254;\n        wp::float32 var_255;\n        wp::float32 var_256;\n        wp::float32 var_257;\n        wp::float32 var_258;\n        const wp::int32 var_259 = 4;\n        const wp::int32 var_260 = 0;\n        wp::float32* var_261;\n        wp::int32 var_262;\n        const wp::int32 var_263 = 1;\n        wp::int32 var_264;\n        wp::float32 var_265;\n        wp::float32 var_266;\n        wp::float32 var_267;\n        wp::float32 var_268;\n        const wp::int32 var_269 = 1;\n        wp::float32* var_270;\n        wp::int32 var_271;\n        const wp::int32 var_272 = 1;\n        wp::int32 var_273;\n        wp::float32 var_274;\n        wp::float32 var_275;\n        wp::float32 var_276;\n        wp::float32 var_277;\n        const wp::int32 var_278 = 2;\n        wp::float32* var_279;\n        wp::int32 var_280;\n        const wp::int32 var_281 = 1;\n        wp::int32 var_282;\n        wp::float32 var_283;\n        wp::float32 var_284;\n        wp::float32 var_285;\n        wp::float32 var_286;\n        const wp::int32 var_287 = 3;\n        wp::float32* var_288;\n        wp::int32 var_289;\n        const wp::int32 var_290 = 1;\n        wp::int32 var_291;\n        wp::float32 var_292;\n        wp::float32 var_293;\n        wp::float32 var_294;\n        wp::float32 var_295;\n        const wp::int32 var_296 = 4;\n        wp::float32* var_297;\n        wp::int32 var_298;\n        const wp::int32 var_299 = 1;\n        wp::int32 var_300;\n        wp::float32 var_301;\n        wp::float32 var_302;\n        wp::float32 var_303;\n        wp::float32 var_304;\n        const wp::int32 var_305 = 5;\n        wp::float32* var_306;\n        wp::int32 var_307;\n        const wp::int32 var_308 = 1;\n        wp::int32 var_309;\n        wp::float32 var_310;\n        wp::float32 var_311;\n        wp::float32 var_312;\n        wp::float32 var_313;\n        const wp::int32 var_314 = 6;\n        wp::float32* var_315;\n        wp::int32 var_316;\n        const wp::int32 var_317 = 1;\n        wp::int32 var_318;\n        wp::float32 var_319;\n        wp::float32 var_320;\n        wp::float32 var_321;\n        wp::float32 var_322;\n        const wp::int32 var_323 = 5;\n        const wp::int32 var_324 = 0;\n        wp::float32* var_325;\n        wp::int32 var_326;\n        const wp::int32 var_327 = 1;\n        wp::int32 var_328;\n        wp::float32 var_329;\n        wp::float32 var_330;\n        wp::float32 var_331;\n        wp::float32 var_332;\n        const wp::int32 var_333 = 1;\n        wp::float32* var_334;\n        wp::int32 var_335;\n        const wp::int32 var_336 = 1;\n        wp::int32 var_337;\n        wp::float32 var_338;\n        wp::float32 var_339;\n        wp::float32 var_340;\n        wp::float32 var_341;\n        const wp::int32 var_342 = 2;\n        wp::float32* var_343;\n        wp::int32 var_344;\n        const wp::int32 var_345 = 1;\n        wp::int32 var_346;\n        wp::float32 var_347;\n        wp::float32 var_348;\n        wp::float32 var_349;\n        wp::float32 var_350;\n        const wp::int32 var_351 = 3;\n        wp::float32* var_352;\n        wp::int32 var_353;\n        const wp::int32 var_354 = 1;\n        wp::int32 var_355;\n        wp::float32 var_356;\n        wp::float32 var_357;\n        wp::float32 var_358;\n        wp::float32 var_359;\n        const wp::int32 var_360 = 4;\n        wp::float32* var_361;\n        wp::int32 var_362;\n        const wp::int32 var_363 = 1;\n        wp::int32 var_364;\n        wp::float32 var_365;\n        wp::float32 var_366;\n        wp::float32 var_367;\n        wp::float32 var_368;\n        const wp::int32 var_369 = 5;\n        wp::float32* var_370;\n        wp::int32 var_371;\n        const wp::int32 var_372 = 1;\n        wp::int32 var_373;\n        wp::float32 var_374;\n        wp::float32 var_375;\n        wp::float32 var_376;\n        wp::float32 var_377;\n        const wp::int32 var_378 = 6;\n        wp::float32* var_379;\n        wp::int32 var_380;\n        const wp::int32 var_381 = 1;\n        wp::int32 var_382;\n        wp::float32 var_383;\n        wp::float32 var_384;\n        wp::float32 var_385;\n        wp::float32 var_386;\n        const wp::int32 var_387 = 6;\n        const wp::int32 var_388 = 0;\n        wp::float32* var_389;\n        wp::int32 var_390;\n        const wp::int32 var_391 = 1;\n        wp::int32 var_392;\n        wp::float32 var_393;\n        wp::float32 var_394;\n        wp::float32 var_395;\n        wp::float32 var_396;\n        const wp::int32 var_397 = 1;\n        wp::float32* var_398;\n        wp::int32 var_399;\n        const wp::int32 var_400 = 1;\n        wp::int32 var_401;\n        wp::float32 var_402;\n        wp::float32 var_403;\n        wp::float32 var_404;\n        wp::float32 var_405;\n        const wp::int32 var_406 = 2;\n        wp::float32* var_407;\n        wp::int32 var_408;\n        const wp::int32 var_409 = 1;\n        wp::int32 var_410;\n        wp::float32 var_411;\n        wp::float32 var_412;\n        wp::float32 var_413;\n        wp::float32 var_414;\n        const wp::int32 var_415 = 3;\n        wp::float32* var_416;\n        wp::int32 var_417;\n        const wp::int32 var_418 = 1;\n        wp::int32 var_419;\n        wp::float32 var_420;\n        wp::float32 var_421;\n        wp::float32 var_422;\n        wp::float32 var_423;\n        const wp::int32 var_424 = 4;\n        wp::float32* var_425;\n        wp::int32 var_426;\n        const wp::int32 var_427 = 1;\n        wp::int32 var_428;\n        wp::float32 var_429;\n        wp::float32 var_430;\n        wp::float32 var_431;\n        wp::float32 var_432;\n        const wp::int32 var_433 = 5;\n        wp::float32* var_434;\n        wp::int32 var_435;\n        const wp::int32 var_436 = 1;\n        wp::int32 var_437;\n        wp::float32 var_438;\n        wp::float32 var_439;\n        wp::float32 var_440;\n        wp::float32 var_441;\n        const wp::int32 var_442 = 6;\n        wp::float32* var_443;\n        wp::int32 var_444;\n        const wp::int32 var_445 = 1;\n        wp::int32 var_446;\n        wp::float32 var_447;\n        wp::float32 var_448;\n        wp::float32 var_449;\n        wp::float32 var_450;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::float32 adj_1 = {};\n        wp::float32 adj_2 = {};\n        wp::int32 adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::float32 adj_5 = {};\n        wp::int32 adj_6 = {};\n        wp::int32 adj_7 = {};\n        wp::int32 adj_8 = {};\n        wp::float32 adj_9 = {};\n        wp::float32 adj_10 = {};\n        wp::float32 adj_11 = {};\n        wp::float32 adj_12 = {};\n        wp::int32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::int32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::float32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::int32 adj_24 = {};\n        wp::int32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::float32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::float32 adj_32 = {};\n        wp::int32 adj_33 = {};\n        wp::int32 adj_34 = {};\n        wp::int32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::int32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::int32 adj_42 = {};\n        wp::int32 adj_43 = {};\n        wp::int32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        wp::float32 adj_46 = {};\n        wp::float32 adj_47 = {};\n        wp::float32 adj_48 = {};\n        wp::int32 adj_49 = {};\n        wp::float32 adj_50 = {};\n        wp::int32 adj_51 = {};\n        wp::int32 adj_52 = {};\n        wp::int32 adj_53 = {};\n        wp::float32 adj_54 = {};\n        wp::float32 adj_55 = {};\n        wp::float32 adj_56 = {};\n        wp::float32 adj_57 = {};\n        wp::int32 adj_58 = {};\n        wp::float32 adj_59 = {};\n        wp::int32 adj_60 = {};\n        wp::int32 adj_61 = {};\n        wp::int32 adj_62 = {};\n        wp::float32 adj_63 = {};\n        wp::float32 adj_64 = {};\n        wp::float32 adj_65 = {};\n        wp::float32 adj_66 = {};\n        wp::int32 adj_67 = {};\n        wp::int32 adj_68 = {};\n        wp::float32 adj_69 = {};\n        wp::int32 adj_70 = {};\n        wp::int32 adj_71 = {};\n        wp::int32 adj_72 = {};\n        wp::float32 adj_73 = {};\n        wp::float32 adj_74 = {};\n        wp::float32 adj_75 = {};\n        wp::float32 adj_76 = {};\n        wp::int32 adj_77 = {};\n        wp::float32 adj_78 = {};\n        wp::int32 adj_79 = {};\n        wp::int32 adj_80 = {};\n        wp::int32 adj_81 = {};\n        wp::float32 adj_82 = {};\n        wp::float32 adj_83 = {};\n        wp::float32 adj_84 = {};\n        wp::float32 adj_85 = {};\n        wp::int32 adj_86 = {};\n        wp::float32 adj_87 = {};\n        wp::int32 adj_88 = {};\n        wp::int32 adj_89 = {};\n        wp::int32 adj_90 = {};\n        wp::float32 adj_91 = {};\n        wp::float32 adj_92 = {};\n        wp::float32 adj_93 = {};\n        wp::float32 adj_94 = {};\n        wp::int32 adj_95 = {};\n        wp::float32 adj_96 = {};\n        wp::int32 adj_97 = {};\n        wp::int32 adj_98 = {};\n        wp::int32 adj_99 = {};\n        wp::float32 adj_100 = {};\n        wp::float32 adj_101 = {};\n        wp::float32 adj_102 = {};\n        wp::float32 adj_103 = {};\n        wp::int32 adj_104 = {};\n        wp::float32 adj_105 = {};\n        wp::int32 adj_106 = {};\n        wp::int32 adj_107 = {};\n        wp::int32 adj_108 = {};\n        wp::float32 adj_109 = {};\n        wp::float32 adj_110 = {};\n        wp::float32 adj_111 = {};\n        wp::float32 adj_112 = {};\n        wp::int32 adj_113 = {};\n        wp::float32 adj_114 = {};\n        wp::int32 adj_115 = {};\n        wp::int32 adj_116 = {};\n        wp::int32 adj_117 = {};\n        wp::float32 adj_118 = {};\n        wp::float32 adj_119 = {};\n        wp::float32 adj_120 = {};\n        wp::float32 adj_121 = {};\n        wp::int32 adj_122 = {};\n        wp::float32 adj_123 = {};\n        wp::int32 adj_124 = {};\n        wp::int32 adj_125 = {};\n        wp::int32 adj_126 = {};\n        wp::float32 adj_127 = {};\n        wp::float32 adj_128 = {};\n        wp::float32 adj_129 = {};\n        wp::float32 adj_130 = {};\n        wp::int32 adj_131 = {};\n        wp::int32 adj_132 = {};\n        wp::float32 adj_133 = {};\n        wp::int32 adj_134 = {};\n        wp::int32 adj_135 = {};\n        wp::int32 adj_136 = {};\n        wp::float32 adj_137 = {};\n        wp::float32 adj_138 = {};\n        wp::float32 adj_139 = {};\n        wp::float32 adj_140 = {};\n        wp::int32 adj_141 = {};\n        wp::float32 adj_142 = {};\n        wp::int32 adj_143 = {};\n        wp::int32 adj_144 = {};\n        wp::int32 adj_145 = {};\n        wp::float32 adj_146 = {};\n        wp::float32 adj_147 = {};\n        wp::float32 adj_148 = {};\n        wp::float32 adj_149 = {};\n        wp::int32 adj_150 = {};\n        wp::float32 adj_151 = {};\n        wp::int32 adj_152 = {};\n        wp::int32 adj_153 = {};\n        wp::int32 adj_154 = {};\n        wp::float32 adj_155 = {};\n        wp::float32 adj_156 = {};\n        wp::float32 adj_157 = {};\n        wp::float32 adj_158 = {};\n        wp::int32 adj_159 = {};\n        wp::float32 adj_160 = {};\n        wp::int32 adj_161 = {};\n        wp::int32 adj_162 = {};\n        wp::int32 adj_163 = {};\n        wp::float32 adj_164 = {};\n        wp::float32 adj_165 = {};\n        wp::float32 adj_166 = {};\n        wp::float32 adj_167 = {};\n        wp::int32 adj_168 = {};\n        wp::float32 adj_169 = {};\n        wp::int32 adj_170 = {};\n        wp::int32 adj_171 = {};\n        wp::int32 adj_172 = {};\n        wp::float32 adj_173 = {};\n        wp::float32 adj_174 = {};\n        wp::float32 adj_175 = {};\n        wp::float32 adj_176 = {};\n        wp::int32 adj_177 = {};\n        wp::float32 adj_178 = {};\n        wp::int32 adj_179 = {};\n        wp::int32 adj_180 = {};\n        wp::int32 adj_181 = {};\n        wp::float32 adj_182 = {};\n        wp::float32 adj_183 = {};\n        wp::float32 adj_184 = {};\n        wp::float32 adj_185 = {};\n        wp::int32 adj_186 = {};\n        wp::float32 adj_187 = {};\n        wp::int32 adj_188 = {};\n        wp::int32 adj_189 = {};\n        wp::int32 adj_190 = {};\n        wp::float32 adj_191 = {};\n        wp::float32 adj_192 = {};\n        wp::float32 adj_193 = {};\n        wp::float32 adj_194 = {};\n        wp::int32 adj_195 = {};\n        wp::int32 adj_196 = {};\n        wp::float32 adj_197 = {};\n        wp::int32 adj_198 = {};\n        wp::int32 adj_199 = {};\n        wp::int32 adj_200 = {};\n        wp::float32 adj_201 = {};\n        wp::float32 adj_202 = {};\n        wp::float32 adj_203 = {};\n        wp::float32 adj_204 = {};\n        wp::int32 adj_205 = {};\n        wp::float32 adj_206 = {};\n        wp::int32 adj_207 = {};\n        wp::int32 adj_208 = {};\n        wp::int32 adj_209 = {};\n        wp::float32 adj_210 = {};\n        wp::float32 adj_211 = {};\n        wp::float32 adj_212 = {};\n        wp::float32 adj_213 = {};\n        wp::int32 adj_214 = {};\n        wp::float32 adj_215 = {};\n        wp::int32 adj_216 = {};\n        wp::int32 adj_217 = {};\n        wp::int32 adj_218 = {};\n        wp::float32 adj_219 = {};\n        wp::float32 adj_220 = {};\n        wp::float32 adj_221 = {};\n        wp::float32 adj_222 = {};\n        wp::int32 adj_223 = {};\n        wp::float32 adj_224 = {};\n        wp::int32 adj_225 = {};\n        wp::int32 adj_226 = {};\n        wp::int32 adj_227 = {};\n        wp::float32 adj_228 = {};\n        wp::float32 adj_229 = {};\n        wp::float32 adj_230 = {};\n        wp::float32 adj_231 = {};\n        wp::int32 adj_232 = {};\n        wp::float32 adj_233 = {};\n        wp::int32 adj_234 = {};\n        wp::int32 adj_235 = {};\n        wp::int32 adj_236 = {};\n        wp::float32 adj_237 = {};\n        wp::float32 adj_238 = {};\n        wp::float32 adj_239 = {};\n        wp::float32 adj_240 = {};\n        wp::int32 adj_241 = {};\n        wp::float32 adj_242 = {};\n        wp::int32 adj_243 = {};\n        wp::int32 adj_244 = {};\n        wp::int32 adj_245 = {};\n        wp::float32 adj_246 = {};\n        wp::float32 adj_247 = {};\n        wp::float32 adj_248 = {};\n        wp::float32 adj_249 = {};\n        wp::int32 adj_250 = {};\n        wp::float32 adj_251 = {};\n        wp::int32 adj_252 = {};\n        wp::int32 adj_253 = {};\n        wp::int32 adj_254 = {};\n        wp::float32 adj_255 = {};\n        wp::float32 adj_256 = {};\n        wp::float32 adj_257 = {};\n        wp::float32 adj_258 = {};\n        wp::int32 adj_259 = {};\n        wp::int32 adj_260 = {};\n        wp::float32 adj_261 = {};\n        wp::int32 adj_262 = {};\n        wp::int32 adj_263 = {};\n        wp::int32 adj_264 = {};\n        wp::float32 adj_265 = {};\n        wp::float32 adj_266 = {};\n        wp::float32 adj_267 = {};\n        wp::float32 adj_268 = {};\n        wp::int32 adj_269 = {};\n        wp::float32 adj_270 = {};\n        wp::int32 adj_271 = {};\n        wp::int32 adj_272 = {};\n        wp::int32 adj_273 = {};\n        wp::float32 adj_274 = {};\n        wp::float32 adj_275 = {};\n        wp::float32 adj_276 = {};\n        wp::float32 adj_277 = {};\n        wp::int32 adj_278 = {};\n        wp::float32 adj_279 = {};\n        wp::int32 adj_280 = {};\n        wp::int32 adj_281 = {};\n        wp::int32 adj_282 = {};\n        wp::float32 adj_283 = {};\n        wp::float32 adj_284 = {};\n        wp::float32 adj_285 = {};\n        wp::float32 adj_286 = {};\n        wp::int32 adj_287 = {};\n        wp::float32 adj_288 = {};\n        wp::int32 adj_289 = {};\n        wp::int32 adj_290 = {};\n        wp::int32 adj_291 = {};\n        wp::float32 adj_292 = {};\n        wp::float32 adj_293 = {};\n        wp::float32 adj_294 = {};\n        wp::float32 adj_295 = {};\n        wp::int32 adj_296 = {};\n        wp::float32 adj_297 = {};\n        wp::int32 adj_298 = {};\n        wp::int32 adj_299 = {};\n        wp::int32 adj_300 = {};\n        wp::float32 adj_301 = {};\n        wp::float32 adj_302 = {};\n        wp::float32 adj_303 = {};\n        wp::float32 adj_304 = {};\n        wp::int32 adj_305 = {};\n        wp::float32 adj_306 = {};\n        wp::int32 adj_307 = {};\n        wp::int32 adj_308 = {};\n        wp::int32 adj_309 = {};\n        wp::float32 adj_310 = {};\n        wp::float32 adj_311 = {};\n        wp::float32 adj_312 = {};\n        wp::float32 adj_313 = {};\n        wp::int32 adj_314 = {};\n        wp::float32 adj_315 = {};\n        wp::int32 adj_316 = {};\n        wp::int32 adj_317 = {};\n        wp::int32 adj_318 = {};\n        wp::float32 adj_319 = {};\n        wp::float32 adj_320 = {};\n        wp::float32 adj_321 = {};\n        wp::float32 adj_322 = {};\n        wp::int32 adj_323 = {};\n        wp::int32 adj_324 = {};\n        wp::float32 adj_325 = {};\n        wp::int32 adj_326 = {};\n        wp::int32 adj_327 = {};\n        wp::int32 adj_328 = {};\n        wp::float32 adj_329 = {};\n        wp::float32 adj_330 = {};\n        wp::float32 adj_331 = {};\n        wp::float32 adj_332 = {};\n        wp::int32 adj_333 = {};\n        wp::float32 adj_334 = {};\n        wp::int32 adj_335 = {};\n        wp::int32 adj_336 = {};\n        wp::int32 adj_337 = {};\n        wp::float32 adj_338 = {};\n        wp::float32 adj_339 = {};\n        wp::float32 adj_340 = {};\n        wp::float32 adj_341 = {};\n        wp::int32 adj_342 = {};\n        wp::float32 adj_343 = {};\n        wp::int32 adj_344 = {};\n        wp::int32 adj_345 = {};\n        wp::int32 adj_346 = {};\n        wp::float32 adj_347 = {};\n        wp::float32 adj_348 = {};\n        wp::float32 adj_349 = {};\n        wp::float32 adj_350 = {};\n        wp::int32 adj_351 = {};\n        wp::float32 adj_352 = {};\n        wp::int32 adj_353 = {};\n        wp::int32 adj_354 = {};\n        wp::int32 adj_355 = {};\n        wp::float32 adj_356 = {};\n        wp::float32 adj_357 = {};\n        wp::float32 adj_358 = {};\n        wp::float32 adj_359 = {};\n        wp::int32 adj_360 = {};\n        wp::float32 adj_361 = {};\n        wp::int32 adj_362 = {};\n        wp::int32 adj_363 = {};\n        wp::int32 adj_364 = {};\n        wp::float32 adj_365 = {};\n        wp::float32 adj_366 = {};\n        wp::float32 adj_367 = {};\n        wp::float32 adj_368 = {};\n        wp::int32 adj_369 = {};\n        wp::float32 adj_370 = {};\n        wp::int32 adj_371 = {};\n        wp::int32 adj_372 = {};\n        wp::int32 adj_373 = {};\n        wp::float32 adj_374 = {};\n        wp::float32 adj_375 = {};\n        wp::float32 adj_376 = {};\n        wp::float32 adj_377 = {};\n        wp::int32 adj_378 = {};\n        wp::float32 adj_379 = {};\n        wp::int32 adj_380 = {};\n        wp::int32 adj_381 = {};\n        wp::int32 adj_382 = {};\n        wp::float32 adj_383 = {};\n        wp::float32 adj_384 = {};\n        wp::float32 adj_385 = {};\n        wp::float32 adj_386 = {};\n        wp::int32 adj_387 = {};\n        wp::int32 adj_388 = {};\n        wp::float32 adj_389 = {};\n        wp::int32 adj_390 = {};\n        wp::int32 adj_391 = {};\n        wp::int32 adj_392 = {};\n        wp::float32 adj_393 = {};\n        wp::float32 adj_394 = {};\n        wp::float32 adj_395 = {};\n        wp::float32 adj_396 = {};\n        wp::int32 adj_397 = {};\n        wp::float32 adj_398 = {};\n        wp::int32 adj_399 = {};\n        wp::int32 adj_400 = {};\n        wp::int32 adj_401 = {};\n        wp::float32 adj_402 = {};\n        wp::float32 adj_403 = {};\n        wp::float32 adj_404 = {};\n        wp::float32 adj_405 = {};\n        wp::int32 adj_406 = {};\n        wp::float32 adj_407 = {};\n        wp::int32 adj_408 = {};\n        wp::int32 adj_409 = {};\n        wp::int32 adj_410 = {};\n        wp::float32 adj_411 = {};\n        wp::float32 adj_412 = {};\n        wp::float32 adj_413 = {};\n        wp::float32 adj_414 = {};\n        wp::int32 adj_415 = {};\n        wp::float32 adj_416 = {};\n        wp::int32 adj_417 = {};\n        wp::int32 adj_418 = {};\n        wp::int32 adj_419 = {};\n        wp::float32 adj_420 = {};\n        wp::float32 adj_421 = {};\n        wp::float32 adj_422 = {};\n        wp::float32 adj_423 = {};\n        wp::int32 adj_424 = {};\n        wp::float32 adj_425 = {};\n        wp::int32 adj_426 = {};\n        wp::int32 adj_427 = {};\n        wp::int32 adj_428 = {};\n        wp::float32 adj_429 = {};\n        wp::float32 adj_430 = {};\n        wp::float32 adj_431 = {};\n        wp::float32 adj_432 = {};\n        wp::int32 adj_433 = {};\n        wp::float32 adj_434 = {};\n        wp::int32 adj_435 = {};\n        wp::int32 adj_436 = {};\n        wp::int32 adj_437 = {};\n        wp::float32 adj_438 = {};\n        wp::float32 adj_439 = {};\n        wp::float32 adj_440 = {};\n        wp::float32 adj_441 = {};\n        wp::int32 adj_442 = {};\n        wp::float32 adj_443 = {};\n        wp::int32 adj_444 = {};\n        wp::int32 adj_445 = {};\n        wp::int32 adj_446 = {};\n        wp::float32 adj_447 = {};\n        wp::float32 adj_448 = {};\n        wp::float32 adj_449 = {};\n        wp::float32 adj_450 = {};\n        //---------\n        // forward\n        // def nested_gekekd(data: wp.array(dtype=float), out: wp.array(dtype=float)):            <L 4>\n        // tid = wp.tid()                                                                         <L 5>\n        var_0 = builtin_tid1d();\n        // total = float(0.0)                                                                     <L 6>\n        var_2 = wp::float(var_1);\n        // for i in range(7):                                                                     <L 7>\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_5 = wp::address(var_data, var_0);\n        var_6 = wp::mul(var_3, var_4);\n        var_8 = wp::add(var_6, var_7);\n        var_9 = wp::float(var_8);\n        var_11 = wp::load(var_5);\n        var_10 = wp::mul(var_11, var_9);\n        var_12 = wp::add(var_2, var_10);\n        var_14 = wp::address(var_data, var_0);\n        var_15 = wp::mul(var_3, var_13);\n        var_17 = wp::add(var_15, var_16);\n        var_18 = wp::float(var_17);\n        var_20 = wp::load(var_14);\n        var_19 = wp::mul(var_20, var_18);\n        var_21 = wp::add(var_12, var_19);\n        var_23 = wp::address(var_data, var_0);\n        var_24 = wp::mul(var_3, var_22);\n        var_26 = wp::add(var_24, var_25);\n        var_27 = wp::float(var_26);\n        var_29 = wp::load(var_23);\n        var_28 = wp::mul(var_29, var_27);\n        var_30 = wp::add(var_21, var_28);\n        var_32 = wp::address(var_data, var_0);\n        var_33 = wp::mul(var_3, var_31);\n        var_35 = wp::add(var_33, var_34);\n        var_36 = wp::float(var_35);\n        var_38 = wp::load(var_32);\n        var_37 = wp::mul(var_38, var_36);\n        var_39 = wp::add(var_30, var_37);\n        var_41 = wp::address(var_data, var_0);\n        var_42 = wp::mul(var_3, var_40);\n        var_44 = wp::add(var_42, var_43);\n        var_45 = wp::float(var_44);\n        var_47 = wp::load(var_41);\n        var_46 = wp::mul(var_47, var_45);\n        var_48 = wp::add(var_39, var_46);\n        var_50 = wp::address(var_data, var_0);\n        var_51 = wp::mul(var_3, var_49);\n        var_53 = wp::add(var_51, var_52);\n        var_54 = wp::float(var_53);\n        var_56 = wp::load(var_50);\n        var_55 = wp::mul(var_56, var_54);\n        var_57 = wp::add(var_48, var_55);\n        var_59 = wp::address(var_data, var_0);\n        var_60 = wp::mul(var_3, var_58);\n        var_62 = wp::add(var_60, var_61);\n        var_63 = wp::float(var_62);\n        var_65 = wp::load(var_59);\n        var_64 = wp::mul(var_65, var_63);\n        var_66 = wp::add(var_57, var_64);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_69 = wp::address(var_data, var_0);\n        var_70 = wp::mul(var_67, var_68);\n        var_72 = wp::add(var_70, var_71);\n        var_73 = wp::float(var_72);\n        var_75 = wp::load(var_69);\n        var_74 = wp::mul(var_75, var_73);\n        var_76 = wp::add(var_66, var_74);\n        var_78 = wp::address(var_data, var_0);\n        var_79 = wp::mul(var_67, var_77);\n        var_81 = wp::add(var_79, var_80);\n        var_82 = wp::float(var_81);\n        var_84 = wp::load(var_78);\n        var_83 = wp::mul(var_84, var_82);\n        var_85 = wp::add(var_76, var_83);\n        var_87 = wp::address(var_data, var_0);\n        var_88 = wp::mul(var_67, var_86);\n        var_90 = wp::add(var_88, var_89);\n        var_91 = wp::float(var_90);\n        var_93 = wp::load(var_87);\n        var_92 = wp::mul(var_93, var_91);\n        var_94 = wp::add(var_85, var_92);\n        var_96 = wp::address(var_data, var_0);\n        var_97 = wp::mul(var_67, var_95);\n        var_99 = wp::add(var_97, var_98);\n        var_100 = wp::float(var_99);\n        var_102 = wp::load(var_96);\n        var_101 = wp::mul(var_102, var_100);\n        var_103 = wp::add(var_94, var_101);\n        var_105 = wp::address(var_data, var_0);\n        var_106 = wp::mul(var_67, var_104);\n        var_108 = wp::add(var_106, var_107);\n        var_109 = wp::float(var_108);\n        var_111 = wp::load(var_105);\n        var_110 = wp::mul(var_111, var_109);\n        var_112 = wp::add(var_103, var_110);\n        var_114 = wp::address(var_data, var_0);\n        var_115 = wp::mul(var_67, var_113);\n        var_117 = wp::add(var_115, var_116);\n        var_118 = wp::float(var_117);\n        var_120 = wp::load(var_114);\n        var_119 = wp::mul(var_120, var_118);\n        var_121 = wp::add(var_112, var_119);\n        var_123 = wp::address(var_data, var_0);\n        var_124 = wp::mul(var_67, var_122);\n        var_126 = wp::add(var_124, var_125);\n        var_127 = wp::float(var_126);\n        var_129 = wp::load(var_123);\n        var_128 = wp::mul(var_129, var_127);\n        var_130 = wp::add(var_121, var_128);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_133 = wp::address(var_data, var_0);\n        var_134 = wp::mul(var_131, var_132);\n        var_136 = wp::add(var_134, var_135);\n        var_137 = wp::float(var_136);\n        var_139 = wp::load(var_133);\n        var_138 = wp::mul(var_139, var_137);\n        var_140 = wp::add(var_130, var_138);\n        var_142 = wp::address(var_data, var_0);\n        var_143 = wp::mul(var_131, var_141);\n        var_145 = wp::add(var_143, var_144);\n        var_146 = wp::float(var_145);\n        var_148 = wp::load(var_142);\n        var_147 = wp::mul(var_148, var_146);\n        var_149 = wp::add(var_140, var_147);\n        var_151 = wp::address(var_data, var_0);\n        var_152 = wp::mul(var_131, var_150);\n        var_154 = wp::add(var_152, var_153);\n        var_155 = wp::float(var_154);\n        var_157 = wp::load(var_151);\n        var_156 = wp::mul(var_157, var_155);\n        var_158 = wp::add(var_149, var_156);\n        var_160 = wp::address(var_data, var_0);\n        var_161 = wp::mul(var_131, var_159);\n        var_163 = wp::add(var_161, var_162);\n        var_164 = wp::float(var_163);\n        var_166 = wp::load(var_160);\n        var_165 = wp::mul(var_166, var_164);\n        var_167 = wp::add(var_158, var_165);\n        var_169 = wp::address(var_data, var_0);\n        var_170 = wp::mul(var_131, var_168);\n        var_172 = wp::add(var_170, var_171);\n        var_173 = wp::float(var_172);\n        var_175 = wp::load(var_169);\n        var_174 = wp::mul(var_175, var_173);\n        var_176 = wp::add(var_167, var_174);\n        var_178 = wp::address(var_data, var_0);\n        var_179 = wp::mul(var_131, var_177);\n        var_181 = wp::add(var_179, var_180);\n        var_182 = wp::float(var_181);\n        var_184 = wp::load(var_178);\n        var_183 = wp::mul(var_184, var_182);\n        var_185 = wp::add(var_176, var_183);\n        var_187 = wp::address(var_data, var_0);\n        var_188 = wp::mul(var_131, var_186);\n        var_190 = wp::add(var_188, var_189);\n        var_191 = wp::float(var_190);\n        var_193 = wp::load(var_187);\n        var_192 = wp::mul(var_193, var_191);\n        var_194 = wp::add(var_185, var_192);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_197 = wp::address(var_data, var_0);\n        var_198 = wp::mul(var_195, var_196);\n        var_200 = wp::add(var_198, var_199);\n        var_201 = wp::float(var_200);\n        var_203 = wp::load(var_197);\n        var_202 = wp::mul(var_203, var_201);\n        var_204 = wp::add(var_194, var_202);\n        var_206 = wp::address(var_data, var_0);\n        var_207 = wp::mul(var_195, var_205);\n        var_209 = wp::add(var_207, var_208);\n        var_210 = wp::float(var_209);\n        var_212 = wp::load(var_206);\n        var_211 = wp::mul(var_212, var_210);\n        var_213 = wp::add(var_204, var_211);\n        var_215 = wp::address(var_data, var_0);\n        var_216 = wp::mul(var_195, var_214);\n        var_218 = wp::add(var_216, var_217);\n        var_219 = wp::float(var_218);\n        var_221 = wp::load(var_215);\n        var_220 = wp::mul(var_221, var_219);\n        var_222 = wp::add(var_213, var_220);\n        var_224 = wp::address(var_data, var_0);\n        var_225 = wp::mul(var_195, var_223);\n        var_227 = wp::add(var_225, var_226);\n        var_228 = wp::float(var_227);\n        var_230 = wp::load(var_224);\n        var_229 = wp::mul(var_230, var_228);\n        var_231 = wp::add(var_222, var_229);\n        var_233 = wp::address(var_data, var_0);\n        var_234 = wp::mul(var_195, var_232);\n        var_236 = wp::add(var_234, var_235);\n        var_237 = wp::float(var_236);\n        var_239 = wp::load(var_233);\n        var_238 = wp::mul(var_239, var_237);\n        var_240 = wp::add(var_231, var_238);\n        var_242 = wp::address(var_data, var_0);\n        var_243 = wp::mul(var_195, var_241);\n        var_245 = wp::add(var_243, var_244);\n        var_246 = wp::float(var_245);\n        var_248 = wp::load(var_242);\n        var_247 = wp::mul(var_248, var_246);\n        var_249 = wp::add(var_240, var_247);\n        var_251 = wp::address(var_data, var_0);\n        var_252 = wp::mul(var_195, var_250);\n        var_254 = wp::add(var_252, var_253);\n        var_255 = wp::float(var_254);\n        var_257 = wp::load(var_251);\n        var_256 = wp::mul(var_257, var_255);\n        var_258 = wp::add(var_249, var_256);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_261 = wp::address(var_data, var_0);\n        var_262 = wp::mul(var_259, var_260);\n        var_264 = wp::add(var_262, var_263);\n        var_265 = wp::float(var_264);\n        var_267 = wp::load(var_261);\n        var_266 = wp::mul(var_267, var_265);\n        var_268 = wp::add(var_258, var_266);\n        var_270 = wp::address(var_data, var_0);\n        var_271 = wp::mul(var_259, var_269);\n        var_273 = wp::add(var_271, var_272);\n        var_274 = wp::float(var_273);\n        var_276 = wp::load(var_270);\n        var_275 = wp::mul(var_276, var_274);\n        var_277 = wp::add(var_268, var_275);\n        var_279 = wp::address(var_data, var_0);\n        var_280 = wp::mul(var_259, var_278);\n        var_282 = wp::add(var_280, var_281);\n        var_283 = wp::float(var_282);\n        var_285 = wp::load(var_279);\n        var_284 = wp::mul(var_285, var_283);\n        var_286 = wp::add(var_277, var_284);\n        var_288 = wp::address(var_data, var_0);\n        var_289 = wp::mul(var_259, var_287);\n        var_291 = wp::add(var_289, var_290);\n        var_292 = wp::float(var_291);\n        var_294 = wp::load(var_288);\n        var_293 = wp::mul(var_294, var_292);\n        var_295 = wp::add(var_286, var_293);\n        var_297 = wp::address(var_data, var_0);\n        var_298 = wp::mul(var_259, var_296);\n        var_300 = wp::add(var_298, var_299);\n        var_301 = wp::float(var_300);\n        var_303 = wp::load(var_297);\n        var_302 = wp::mul(var_303, var_301);\n        var_304 = wp::add(var_295, var_302);\n        var_306 = wp::address(var_data, var_0);\n        var_307 = wp::mul(var_259, var_305);\n        var_309 = wp::add(var_307, var_308);\n        var_310 = wp::float(var_309);\n        var_312 = wp::load(var_306);\n        var_311 = wp::mul(var_312, var_310);\n        var_313 = wp::add(var_304, var_311);\n        var_315 = wp::address(var_data, var_0);\n        var_316 = wp::mul(var_259, var_314);\n        var_318 = wp::add(var_316, var_317);\n        var_319 = wp::float(var_318);\n        var_321 = wp::load(var_315);\n        var_320 = wp::mul(var_321, var_319);\n        var_322 = wp::add(var_313, var_320);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_325 = wp::address(var_data, var_0);\n        var_326 = wp::mul(var_323, var_324);\n        var_328 = wp::add(var_326, var_327);\n        var_329 = wp::float(var_328);\n        var_331 = wp::load(var_325);\n        var_330 = wp::mul(var_331, var_329);\n        var_332 = wp::add(var_322, var_330);\n        var_334 = wp::address(var_data, var_0);\n        var_335 = wp::mul(var_323, var_333);\n        var_337 = wp::add(var_335, var_336);\n        var_338 = wp::float(var_337);\n        var_340 = wp::load(var_334);\n        var_339 = wp::mul(var_340, var_338);\n        var_341 = wp::add(var_332, var_339);\n        var_343 = wp::address(var_data, var_0);\n        var_344 = wp::mul(var_323, var_342);\n        var_346 = wp::add(var_344, var_345);\n        var_347 = wp::float(var_346);\n        var_349 = wp::load(var_343);\n        var_348 = wp::mul(var_349, var_347);\n        var_350 = wp::add(var_341, var_348);\n        var_352 = wp::address(var_data, var_0);\n        var_353 = wp::mul(var_323, var_351);\n        var_355 = wp::add(var_353, var_354);\n        var_356 = wp::float(var_355);\n        var_358 = wp::load(var_352);\n        var_357 = wp::mul(var_358, var_356);\n        var_359 = wp::add(var_350, var_357);\n        var_361 = wp::address(var_data, var_0);\n        var_362 = wp::mul(var_323, var_360);\n        var_364 = wp::add(var_362, var_363);\n        var_365 = wp::float(var_364);\n        var_367 = wp::load(var_361);\n        var_366 = wp::mul(var_367, var_365);\n        var_368 = wp::add(var_359, var_366);\n        var_370 = wp::address(var_data, var_0);\n        var_371 = wp::mul(var_323, var_369);\n        var_373 = wp::add(var_371, var_372);\n        var_374 = wp::float(var_373);\n        var_376 = wp::load(var_370);\n        var_375 = wp::mul(var_376, var_374);\n        var_377 = wp::add(var_368, var_375);\n        var_379 = wp::address(var_data, var_0);\n        var_380 = wp::mul(var_323, var_378);\n        var_382 = wp::add(var_380, var_381);\n        var_383 = wp::float(var_382);\n        var_385 = wp::load(var_379);\n        var_384 = wp::mul(var_385, var_383);\n        var_386 = wp::add(var_377, var_384);\n        // for j in range(7):                                                                     <L 8>\n        // total = total + data[tid] * float(i * j + 1)                                           <L 9>\n        var_389 = wp::address(var_data, var_0);\n        var_390 = wp::mul(var_387, var_388);\n        var_392 = wp::add(var_390, var_391);\n        var_393 = wp::float(var_392);\n        var_395 = wp::load(var_389);\n        var_394 = wp::mul(var_395, var_393);\n        var_396 = wp::add(var_386, var_394);\n        var_398 = wp::address(var_data, var_0);\n        var_399 = wp::mul(var_387, var_397);\n        var_401 = wp::add(var_399, var_400);\n        var_402 = wp::float(var_401);\n        var_404 = wp::load(var_398);\n        var_403 = wp::mul(var_404, var_402);\n        var_405 = wp::add(var_396, var_403);\n        var_407 = wp::address(var_data, var_0);\n        var_408 = wp::mul(var_387, var_406);\n        var_410 = wp::add(var_408, var_409);\n        var_411 = wp::float(var_410);\n        var_413 = wp::load(var_407);\n        var_412 = wp::mul(var_413, var_411);\n        var_414 = wp::add(var_405, var_412);\n        var_416 = wp::address(var_data, var_0);\n        var_417 = wp::mul(var_387, var_415);\n        var_419 = wp::add(var_417, var_418);\n        var_420 = wp::float(var_419);\n        var_422 = wp::load(var_416);\n        var_421 = wp::mul(var_422, var_420);\n        var_423 = wp::add(var_414, var_421);\n        var_425 = wp::address(var_data, var_0);\n        var_426 = wp::mul(var_387, var_424);\n        var_428 = wp::add(var_426, var_427);\n        var_429 = wp::float(var_428);\n        var_431 = wp::load(var_425);\n        var_430 = wp::mul(var_431, var_429);\n        var_432 = wp::add(var_423, var_430);\n        var_434 = wp::address(var_data, var_0);\n        var_435 = wp::mul(var_387, var_433);\n        var_437 = wp::add(var_435, var_436);\n        var_438 = wp::float(var_437);\n        var_440 = wp::load(var_434);\n        var_439 = wp::mul(var_440, var_438);\n        var_441 = wp::add(var_432, var_439);\n        var_443 = wp::address(var_data, var_0);\n        var_444 = wp::mul(var_387, var_442);\n        var_446 = wp::add(var_444, var_445);\n        var_447 = wp::float(var_446);\n        var_449 = wp::load(var_443);\n        var_448 = wp::mul(var_449, var_447);\n        var_450 = wp::add(var_441, var_448);\n        // out[tid] = total                                                                       <L 10>\n        // wp::array_store(var_out, var_0, var_450);\n        //---------\n        // reverse\n        wp::adj_array_store(var_out, var_0, var_450, adj_out, adj_0, adj_450);\n        // adj: out[tid] = total                                                                  <L 10>\n        wp::adj_add(var_441, var_448, adj_441, adj_448, adj_450);\n        wp::adj_mul(var_449, var_447, adj_443, adj_447, adj_448);\n        wp::adj_float(var_446, adj_446, adj_447);\n        wp::adj_add(var_444, var_445, adj_444, adj_445, adj_446);\n        wp::adj_mul(var_387, var_442, adj_387, adj_442, adj_444);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_443);\n        wp::adj_add(var_432, var_439, adj_432, adj_439, adj_441);\n        wp::adj_mul(var_440, var_438, adj_434, adj_438, adj_439);\n        wp::adj_float(var_437, adj_437, adj_438);\n        wp::adj_add(var_435, var_436, adj_435, adj_436, adj_437);\n        wp::adj_mul(var_387, var_433, adj_387, adj_433, adj_435);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_434);\n        wp::adj_add(var_423, var_430, adj_423, adj_430, adj_432);\n        wp::adj_mul(var_431, var_429, adj_425, adj_429, adj_430);\n        wp::adj_float(var_428, adj_428, adj_429);\n        wp::adj_add(var_426, var_427, adj_426, adj_427, adj_428);\n        wp::adj_mul(var_387, var_424, adj_387, adj_424, adj_426);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_425);\n        wp::adj_add(var_414, var_421, adj_414, adj_421, adj_423);\n        wp::adj_mul(var_422, var_420, adj_416, adj_420, adj_421);\n        wp::adj_float(var_419, adj_419, adj_420);\n        wp::adj_add(var_417, var_418, adj_417, adj_418, adj_419);\n        wp::adj_mul(var_387, var_415, adj_387, adj_415, adj_417);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_416);\n        wp::adj_add(var_405, var_412, adj_405, adj_412, adj_414);\n        wp::adj_mul(var_413, var_411, adj_407, adj_411, adj_412);\n        wp::adj_float(var_410, adj_410, adj_411);\n        wp::adj_add(var_408, var_409, adj_408, adj_409, adj_410);\n        wp::adj_mul(var_387, var_406, adj_387, adj_406, adj_408);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_407);\n        wp::adj_add(var_396, var_403, adj_396, adj_403, adj_405);\n        wp::adj_mul(var_404, var_402, adj_398, adj_402, adj_403);\n        wp::adj_float(var_401, adj_401, adj_402);\n        wp::adj_add(var_399, var_400, adj_399, adj_400, adj_401);\n        wp::adj_mul(var_387, var_397, adj_387, adj_397, adj_399);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_398);\n        wp::adj_add(var_386, var_394, adj_386, adj_394, adj_396);\n        wp::adj_mul(var_395, var_393, adj_389, adj_393, adj_394);\n        wp::adj_float(var_392, adj_392, adj_393);\n        wp::adj_add(var_390, var_391, adj_390, adj_391, adj_392);\n        wp::adj_mul(var_387, var_388, adj_387, adj_388, adj_390);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_389);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_377, var_384, adj_377, adj_384, adj_386);\n        wp::adj_mul(var_385, var_383, adj_379, adj_383, adj_384);\n        wp::adj_float(var_382, adj_382, adj_383);\n        wp::adj_add(var_380, var_381, adj_380, adj_381, adj_382);\n        wp::adj_mul(var_323, var_378, adj_323, adj_378, adj_380);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_379);\n        wp::adj_add(var_368, var_375, adj_368, adj_375, adj_377);\n        wp::adj_mul(var_376, var_374, adj_370, adj_374, adj_375);\n        wp::adj_float(var_373, adj_373, adj_374);\n        wp::adj_add(var_371, var_372, adj_371, adj_372, adj_373);\n        wp::adj_mul(var_323, var_369, adj_323, adj_369, adj_371);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_370);\n        wp::adj_add(var_359, var_366, adj_359, adj_366, adj_368);\n        wp::adj_mul(var_367, var_365, adj_361, adj_365, adj_366);\n        wp::adj_float(var_364, adj_364, adj_365);\n        wp::adj_add(var_362, var_363, adj_362, adj_363, adj_364);\n        wp::adj_mul(var_323, var_360, adj_323, adj_360, adj_362);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_361);\n        wp::adj_add(var_350, var_357, adj_350, adj_357, adj_359);\n        wp::adj_mul(var_358, var_356, adj_352, adj_356, adj_357);\n        wp::adj_float(var_355, adj_355, adj_356);\n        wp::adj_add(var_353, var_354, adj_353, adj_354, adj_355);\n        wp::adj_mul(var_323, var_351, adj_323, adj_351, adj_353);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_352);\n        wp::adj_add(var_341, var_348, adj_341, adj_348, adj_350);\n        wp::adj_mul(var_349, var_347, adj_343, adj_347, adj_348);\n        wp::adj_float(var_346, adj_346, adj_347);\n        wp::adj_add(var_344, var_345, adj_344, adj_345, adj_346);\n        wp::adj_mul(var_323, var_342, adj_323, adj_342, adj_344);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_343);\n        wp::adj_add(var_332, var_339, adj_332, adj_339, adj_341);\n        wp::adj_mul(var_340, var_338, adj_334, adj_338, adj_339);\n        wp::adj_float(var_337, adj_337, adj_338);\n        wp::adj_add(var_335, var_336, adj_335, adj_336, adj_337);\n        wp::adj_mul(var_323, var_333, adj_323, adj_333, adj_335);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_334);\n        wp::adj_add(var_322, var_330, adj_322, adj_330, adj_332);\n        wp::adj_mul(var_331, var_329, adj_325, adj_329, adj_330);\n        wp::adj_float(var_328, adj_328, adj_329);\n        wp::adj_add(var_326, var_327, adj_326, adj_327, adj_328);\n        wp::adj_mul(var_323, var_324, adj_323, adj_324, adj_326);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_325);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_313, var_320, adj_313, adj_320, adj_322);\n        wp::adj_mul(var_321, var_319, adj_315, adj_319, adj_320);\n        wp::adj_float(var_318, adj_318, adj_319);\n        wp::adj_add(var_316, var_317, adj_316, adj_317, adj_318);\n        wp::adj_mul(var_259, var_314, adj_259, adj_314, adj_316);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_315);\n        wp::adj_add(var_304, var_311, adj_304, adj_311, adj_313);\n        wp::adj_mul(var_312, var_310, adj_306, adj_310, adj_311);\n        wp::adj_float(var_309, adj_309, adj_310);\n        wp::adj_add(var_307, var_308, adj_307, adj_308, adj_309);\n        wp::adj_mul(var_259, var_305, adj_259, adj_305, adj_307);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_306);\n        wp::adj_add(var_295, var_302, adj_295, adj_302, adj_304);\n        wp::adj_mul(var_303, var_301, adj_297, adj_301, adj_302);\n        wp::adj_float(var_300, adj_300, adj_301);\n        wp::adj_add(var_298, var_299, adj_298, adj_299, adj_300);\n        wp::adj_mul(var_259, var_296, adj_259, adj_296, adj_298);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_297);\n        wp::adj_add(var_286, var_293, adj_286, adj_293, adj_295);\n        wp::adj_mul(var_294, var_292, adj_288, adj_292, adj_293);\n        wp::adj_float(var_291, adj_291, adj_292);\n        wp::adj_add(var_289, var_290, adj_289, adj_290, adj_291);\n        wp::adj_mul(var_259, var_287, adj_259, adj_287, adj_289);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_288);\n        wp::adj_add(var_277, var_284, adj_277, adj_284, adj_286);\n        wp::adj_mul(var_285, var_283, adj_279, adj_283, adj_284);\n        wp::adj_float(var_282, adj_282, adj_283);\n        wp::adj_add(var_280, var_281, adj_280, adj_281, adj_282);\n        wp::adj_mul(var_259, var_278, adj_259, adj_278, adj_280);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_279);\n        wp::adj_add(var_268, var_275, adj_268, adj_275, adj_277);\n        wp::adj_mul(var_276, var_274, adj_270, adj_274, adj_275);\n        wp::adj_float(var_273, adj_273, adj_274);\n        wp::adj_add(var_271, var_272, adj_271, adj_272, adj_273);\n        wp::adj_mul(var_259, var_269, adj_259, adj_269, adj_271);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_270);\n        wp::adj_add(var_258, var_266, adj_258, adj_266, adj_268);\n        wp::adj_mul(var_267, var_265, adj_261, adj_265, adj_266);\n        wp::adj_float(var_264, adj_264, adj_265);\n        wp::adj_add(var_262, var_263, adj_262, adj_263, adj_264);\n        wp::adj_mul(var_259, var_260, adj_259, adj_260, adj_262);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_261);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_249, var_256, adj_249, adj_256, adj_258);\n        wp::adj_mul(var_257, var_255, adj_251, adj_255, adj_256);\n        wp::adj_float(var_254, adj_254, adj_255);\n        wp::adj_add(var_252, var_253, adj_252, adj_253, adj_254);\n        wp::adj_mul(var_195, var_250, adj_195, adj_250, adj_252);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_251);\n        wp::adj_add(var_240, var_247, adj_240, adj_247, adj_249);\n        wp::adj_mul(var_248, var_246, adj_242, adj_246, adj_247);\n        wp::adj_float(var_245, adj_245, adj_246);\n        wp::adj_add(var_243, var_244, adj_243, adj_244, adj_245);\n        wp::adj_mul(var_195, var_241, adj_195, adj_241, adj_243);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_242);\n        wp::adj_add(var_231, var_238, adj_231, adj_238, adj_240);\n        wp::adj_mul(var_239, var_237, adj_233, adj_237, adj_238);\n        wp::adj_float(var_236, adj_236, adj_237);\n        wp::adj_add(var_234, var_235, adj_234, adj_235, adj_236);\n        wp::adj_mul(var_195, var_232, adj_195, adj_232, adj_234);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_233);\n        wp::adj_add(var_222, var_229, adj_222, adj_229, adj_231);\n        wp::adj_mul(var_230, var_228, adj_224, adj_228, adj_229);\n        wp::adj_float(var_227, adj_227, adj_228);\n        wp::adj_add(var_225, var_226, adj_225, adj_226, adj_227);\n        wp::adj_mul(var_195, var_223, adj_195, adj_223, adj_225);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_224);\n        wp::adj_add(var_213, var_220, adj_213, adj_220, adj_222);\n        wp::adj_mul(var_221, var_219, adj_215, adj_219, adj_220);\n        wp::adj_float(var_218, adj_218, adj_219);\n        wp::adj_add(var_216, var_217, adj_216, adj_217, adj_218);\n        wp::adj_mul(var_195, var_214, adj_195, adj_214, adj_216);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_215);\n        wp::adj_add(var_204, var_211, adj_204, adj_211, adj_213);\n        wp::adj_mul(var_212, var_210, adj_206, adj_210, adj_211);\n        wp::adj_float(var_209, adj_209, adj_210);\n        wp::adj_add(var_207, var_208, adj_207, adj_208, adj_209);\n        wp::adj_mul(var_195, var_205, adj_195, adj_205, adj_207);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_206);\n        wp::adj_add(var_194, var_202, adj_194, adj_202, adj_204);\n        wp::adj_mul(var_203, var_201, adj_197, adj_201, adj_202);\n        wp::adj_float(var_200, adj_200, adj_201);\n        wp::adj_add(var_198, var_199, adj_198, adj_199, adj_200);\n        wp::adj_mul(var_195, var_196, adj_195, adj_196, adj_198);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_197);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_185, var_192, adj_185, adj_192, adj_194);\n        wp::adj_mul(var_193, var_191, adj_187, adj_191, adj_192);\n        wp::adj_float(var_190, adj_190, adj_191);\n        wp::adj_add(var_188, var_189, adj_188, adj_189, adj_190);\n        wp::adj_mul(var_131, var_186, adj_131, adj_186, adj_188);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_187);\n        wp::adj_add(var_176, var_183, adj_176, adj_183, adj_185);\n        wp::adj_mul(var_184, var_182, adj_178, adj_182, adj_183);\n        wp::adj_float(var_181, adj_181, adj_182);\n        wp::adj_add(var_179, var_180, adj_179, adj_180, adj_181);\n        wp::adj_mul(var_131, var_177, adj_131, adj_177, adj_179);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_178);\n        wp::adj_add(var_167, var_174, adj_167, adj_174, adj_176);\n        wp::adj_mul(var_175, var_173, adj_169, adj_173, adj_174);\n        wp::adj_float(var_172, adj_172, adj_173);\n        wp::adj_add(var_170, var_171, adj_170, adj_171, adj_172);\n        wp::adj_mul(var_131, var_168, adj_131, adj_168, adj_170);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_169);\n        wp::adj_add(var_158, var_165, adj_158, adj_165, adj_167);\n        wp::adj_mul(var_166, var_164, adj_160, adj_164, adj_165);\n        wp::adj_float(var_163, adj_163, adj_164);\n        wp::adj_add(var_161, var_162, adj_161, adj_162, adj_163);\n        wp::adj_mul(var_131, var_159, adj_131, adj_159, adj_161);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_160);\n        wp::adj_add(var_149, var_156, adj_149, adj_156, adj_158);\n        wp::adj_mul(var_157, var_155, adj_151, adj_155, adj_156);\n        wp::adj_float(var_154, adj_154, adj_155);\n        wp::adj_add(var_152, var_153, adj_152, adj_153, adj_154);\n        wp::adj_mul(var_131, var_150, adj_131, adj_150, adj_152);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_151);\n        wp::adj_add(var_140, var_147, adj_140, adj_147, adj_149);\n        wp::adj_mul(var_148, var_146, adj_142, adj_146, adj_147);\n        wp::adj_float(var_145, adj_145, adj_146);\n        wp::adj_add(var_143, var_144, adj_143, adj_144, adj_145);\n        wp::adj_mul(var_131, var_141, adj_131, adj_141, adj_143);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_142);\n        wp::adj_add(var_130, var_138, adj_130, adj_138, adj_140);\n        wp::adj_mul(var_139, var_137, adj_133, adj_137, adj_138);\n        wp::adj_float(var_136, adj_136, adj_137);\n        wp::adj_add(var_134, var_135, adj_134, adj_135, adj_136);\n        wp::adj_mul(var_131, var_132, adj_131, adj_132, adj_134);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_133);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_121, var_128, adj_121, adj_128, adj_130);\n        wp::adj_mul(var_129, var_127, adj_123, adj_127, adj_128);\n        wp::adj_float(var_126, adj_126, adj_127);\n        wp::adj_add(var_124, var_125, adj_124, adj_125, adj_126);\n        wp::adj_mul(var_67, var_122, adj_67, adj_122, adj_124);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_123);\n        wp::adj_add(var_112, var_119, adj_112, adj_119, adj_121);\n        wp::adj_mul(var_120, var_118, adj_114, adj_118, adj_119);\n        wp::adj_float(var_117, adj_117, adj_118);\n        wp::adj_add(var_115, var_116, adj_115, adj_116, adj_117);\n        wp::adj_mul(var_67, var_113, adj_67, adj_113, adj_115);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_114);\n        wp::adj_add(var_103, var_110, adj_103, adj_110, adj_112);\n        wp::adj_mul(var_111, var_109, adj_105, adj_109, adj_110);\n        wp::adj_float(var_108, adj_108, adj_109);\n        wp::adj_add(var_106, var_107, adj_106, adj_107, adj_108);\n        wp::adj_mul(var_67, var_104, adj_67, adj_104, adj_106);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_105);\n        wp::adj_add(var_94, var_101, adj_94, adj_101, adj_103);\n        wp::adj_mul(var_102, var_100, adj_96, adj_100, adj_101);\n        wp::adj_float(var_99, adj_99, adj_100);\n        wp::adj_add(var_97, var_98, adj_97, adj_98, adj_99);\n        wp::adj_mul(var_67, var_95, adj_67, adj_95, adj_97);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_96);\n        wp::adj_add(var_85, var_92, adj_85, adj_92, adj_94);\n        wp::adj_mul(var_93, var_91, adj_87, adj_91, adj_92);\n        wp::adj_float(var_90, adj_90, adj_91);\n        wp::adj_add(var_88, var_89, adj_88, adj_89, adj_90);\n        wp::adj_mul(var_67, var_86, adj_67, adj_86, adj_88);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_87);\n        wp::adj_add(var_76, var_83, adj_76, adj_83, adj_85);\n        wp::adj_mul(var_84, var_82, adj_78, adj_82, adj_83);\n        wp::adj_float(var_81, adj_81, adj_82);\n        wp::adj_add(var_79, var_80, adj_79, adj_80, adj_81);\n        wp::adj_mul(var_67, var_77, adj_67, adj_77, adj_79);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_78);\n        wp::adj_add(var_66, var_74, adj_66, adj_74, adj_76);\n        wp::adj_mul(var_75, var_73, adj_69, adj_73, adj_74);\n        wp::adj_float(var_72, adj_72, adj_73);\n        wp::adj_add(var_70, var_71, adj_70, adj_71, adj_72);\n        wp::adj_mul(var_67, var_68, adj_67, adj_68, adj_70);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_69);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        wp::adj_add(var_57, var_64, adj_57, adj_64, adj_66);\n        wp::adj_mul(var_65, var_63, adj_59, adj_63, adj_64);\n        wp::adj_float(var_62, adj_62, adj_63);\n        wp::adj_add(var_60, var_61, adj_60, adj_61, adj_62);\n        wp::adj_mul(var_3, var_58, adj_3, adj_58, adj_60);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_59);\n        wp::adj_add(var_48, var_55, adj_48, adj_55, adj_57);\n        wp::adj_mul(var_56, var_54, adj_50, adj_54, adj_55);\n        wp::adj_float(var_53, adj_53, adj_54);\n        wp::adj_add(var_51, var_52, adj_51, adj_52, adj_53);\n        wp::adj_mul(var_3, var_49, adj_3, adj_49, adj_51);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_50);\n        wp::adj_add(var_39, var_46, adj_39, adj_46, adj_48);\n        wp::adj_mul(var_47, var_45, adj_41, adj_45, adj_46);\n        wp::adj_float(var_44, adj_44, adj_45);\n        wp::adj_add(var_42, var_43, adj_42, adj_43, adj_44);\n        wp::adj_mul(var_3, var_40, adj_3, adj_40, adj_42);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_41);\n        wp::adj_add(var_30, var_37, adj_30, adj_37, adj_39);\n        wp::adj_mul(var_38, var_36, adj_32, adj_36, adj_37);\n        wp::adj_float(var_35, adj_35, adj_36);\n        wp::adj_add(var_33, var_34, adj_33, adj_34, adj_35);\n        wp::adj_mul(var_3, var_31, adj_3, adj_31, adj_33);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_32);\n        wp::adj_add(var_21, var_28, adj_21, adj_28, adj_30);\n        wp::adj_mul(var_29, var_27, adj_23, adj_27, adj_28);\n        wp::adj_float(var_26, adj_26, adj_27);\n        wp::adj_add(var_24, var_25, adj_24, adj_25, adj_26);\n        wp::adj_mul(var_3, var_22, adj_3, adj_22, adj_24);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_23);\n        wp::adj_add(var_12, var_19, adj_12, adj_19, adj_21);\n        wp::adj_mul(var_20, var_18, adj_14, adj_18, adj_19);\n        wp::adj_float(var_17, adj_17, adj_18);\n        wp::adj_add(var_15, var_16, adj_15, adj_16, adj_17);\n        wp::adj_mul(var_3, var_13, adj_3, adj_13, adj_15);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_14);\n        wp::adj_add(var_2, var_10, adj_2, adj_10, adj_12);\n        wp::adj_mul(var_11, var_9, adj_5, adj_9, adj_10);\n        wp::adj_float(var_8, adj_8, adj_9);\n        wp::adj_add(var_6, var_7, adj_6, adj_7, adj_8);\n        wp::adj_mul(var_3, var_4, adj_3, adj_4, adj_6);\n        wp::adj_address(var_data, var_0, adj_data, adj_0, adj_5);\n        // adj: total = total + data[tid] * float(i * j + 1)                                      <L 9>\n        // adj: for j in range(7):                                                                <L 8>\n        // adj: for i in range(7):                                                                <L 7>\n        wp::adj_float(var_1, adj_1, adj_2);\n        // adj: total = float(0.0)                                                                <L 6>\n        // adj: tid = wp.tid()                                                                    <L 5>\n        // adj: def nested_gekekd(data: wp.array(dtype=float), out: wp.array(dtype=float)):       <L 4>\n        continue;\n    }\n}\n\n","warp_metadata":{"kernel_name":"nested_gekekd","mangled_name":"nested_gekekd_3422eac9","device":"cuda","arg_names":["data","out"],"arg_types":{"data":"array<class 'warp._src.types.float32'>","out":"array<class 'warp._src.types.float32'>"},"has_backward":false},"python_source":"@wp.kernel\ndef nested_gekekd(data: wp.array(dtype=float), out: wp.array(dtype=float)):\n    tid = wp.tid()\n    total = float(0.0)\n    for i in range(7):\n        for j in range(7):\n            total = total + data[tid] * float(i * j + 1)\n    out[tid] = total\n"}
