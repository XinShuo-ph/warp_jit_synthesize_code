# Warp Basics

## Kernel Compilation Flow
1. **Parsing**: Warp uses Python's `ast` module to parse functions decorated with `@wp.kernel` or `@wp.func`.
2. **Analysis**: Type inference and validation are performed on the AST.
3. **Code Generation**: `warp.codegen` module traverses the AST and generates C++ (for CPU) or CUDA C++ (for GPU) source code.
4. **Compilation**: The generated source code is compiled into a shared library (`.so` or `.dll`) using a backend compiler (`nvcc` for CUDA, `clang`/`gcc`/`msvc` for CPU).
5. **Loading**: The compiled shared library is loaded into the Python process.
6. **Execution**: The kernel is launched via the loaded function pointer.

## IR Location
The "Intermediate Representation" in Warp is primarily the **generated C++/CUDA source code**.
- It is generated by functions in `warp._src.codegen` (e.g., `codegen_kernel`).
- It lives transiently in strings during the build process.
- It is written to the kernel cache directory (usually `~/.cache/warp/VERSION/`) as `.cu` or `.cpp` files before compilation.
- For data synthesis, we can intercept this source code string from `warp._src.codegen`.
