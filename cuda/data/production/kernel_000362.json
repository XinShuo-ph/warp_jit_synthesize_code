{
  "python_source": "@wp.kernel\ndef grid2d_yelwvw(input: wp.array2d(dtype=float), output: wp.array2d(dtype=float), \n           width: int, height: int):\n    i, j = wp.tid()\n    \n    if i > 0 and i < height - 1 and j > 0 and j < width - 1:\n        center = input[i, j]\n        up = input[i - 1, j]\n        down = input[i + 1, j]\n        left = input[i, j - 1]\n        right = input[i, j + 1]\n        output[i, j] = (center * 2.0 + up + down + left + right) / 6.0\n    else:\n        output[i, j] = input[i, j]\n",
  "ir_forward": "void grid2d_yelwvw_6efed52c_cuda_kernel_forward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_input,\n    wp::array_t<wp::float32> var_output,\n    wp::int32 var_width,\n    wp::int32 var_height)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::int32 var_1;\n        const wp::int32 var_2 = 0;\n        bool var_3;\n        const wp::int32 var_4 = 1;\n        wp::int32 var_5;\n        bool var_6;\n        const wp::int32 var_7 = 0;\n        bool var_8;\n        const wp::int32 var_9 = 1;\n        wp::int32 var_10;\n        bool var_11;\n        bool var_12;\n        wp::float32* var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32* var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        const wp::int32 var_21 = 1;\n        wp::int32 var_22;\n        wp::float32* var_23;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        const wp::int32 var_26 = 1;\n        wp::int32 var_27;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        wp::int32 var_32;\n        wp::float32* var_33;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        const wp::float32 var_36 = 2.0;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        wp::float32 var_41;\n        const wp::float32 var_42 = 6.0;\n        wp::float32 var_43;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        //---------\n        // forward\n        // def grid2d_yelwvw(input: wp.array2d(dtype=float), output: wp.array2d(dtype=float),       <L 4>\n        // i, j = wp.tid()                                                                        <L 6>\n        builtin_tid2d(var_0, var_1);\n        // if i > 0 and i < height - 1 and j > 0 and j < width - 1:                               <L 8>\n        var_3 = (var_0 > var_2);\n        var_5 = wp::sub(var_height, var_4);\n        var_6 = (var_0 < var_5);\n        var_8 = (var_1 > var_7);\n        var_10 = wp::sub(var_width, var_9);\n        var_11 = (var_1 < var_10);\n        var_12 = var_3 && var_6 && var_8 && var_11;\n        if (var_12) {\n            // center = input[i, j]                                                               <L 9>\n            var_13 = wp::address(var_input, var_0, var_1);\n            var_15 = wp::load(var_13);\n            var_14 = wp::copy(var_15);\n            // up = input[i - 1, j]                                                               <L 10>\n            var_17 = wp::sub(var_0, var_16);\n            var_18 = wp::address(var_input, var_17, var_1);\n            var_20 = wp::load(var_18);\n            var_19 = wp::copy(var_20);\n            // down = input[i + 1, j]                                                             <L 11>\n            var_22 = wp::add(var_0, var_21);\n            var_23 = wp::address(var_input, var_22, var_1);\n            var_25 = wp::load(var_23);\n            var_24 = wp::copy(var_25);\n            // left = input[i, j - 1]                                                             <L 12>\n            var_27 = wp::sub(var_1, var_26);\n            var_28 = wp::address(var_input, var_0, var_27);\n            var_30 = wp::load(var_28);\n            var_29 = wp::copy(var_30);\n            // right = input[i, j + 1]                                                            <L 13>\n            var_32 = wp::add(var_1, var_31);\n            var_33 = wp::address(var_input, var_0, var_32);\n            var_35 = wp::load(var_33);\n            var_34 = wp::copy(var_35);\n            // output[i, j] = (center * 2.0 + up + down + left + right) / 6.0                     <L 14>\n            var_37 = wp::mul(var_14, var_36);\n            var_38 = wp::add(var_37, var_19);\n            var_39 = wp::add(var_38, var_24);\n            var_40 = wp::add(var_39, var_29);\n            var_41 = wp::add(var_40, var_34);\n            var_43 = wp::div(var_41, var_42);\n            wp::array_store(var_output, var_0, var_1, var_43);\n        }\n        if (!var_12) {\n            // output[i, j] = input[i, j]                                                         <L 16>\n            var_44 = wp::address(var_input, var_0, var_1);\n            var_45 = wp::load(var_44);\n            wp::array_store(var_output, var_0, var_1, var_45);\n        }\n    }\n}",
  "metadata": {
    "kernel_name": "grid2d_yelwvw",
    "category": "grid_2d",
    "description": "2D Gaussian blur approximation",
    "device": "cuda",
    "has_backward": true,
    "operation": "blur",
    "dimension": "2D",
    "seed": 489
  },
  "ir_backward": "void grid2d_yelwvw_6efed52c_cuda_kernel_backward(\n    wp::launch_bounds_t dim,\n    wp::array_t<wp::float32> var_input,\n    wp::array_t<wp::float32> var_output,\n    wp::int32 var_width,\n    wp::int32 var_height,\n    wp::array_t<wp::float32> adj_input,\n    wp::array_t<wp::float32> adj_output,\n    wp::int32 adj_width,\n    wp::int32 adj_height)\n{\n    wp::tile_shared_storage_t tile_mem;\n\n    for (size_t _idx = static_cast<size_t>(blockDim.x) * static_cast<size_t>(blockIdx.x) + static_cast<size_t>(threadIdx.x);\n         _idx < dim.size;\n         _idx += static_cast<size_t>(blockDim.x) * static_cast<size_t>(gridDim.x))\n    {\n            // reset shared memory allocator\n        wp::tile_shared_storage_t::init();\n\n        //---------\n        // primal vars\n        wp::int32 var_0;\n        wp::int32 var_1;\n        const wp::int32 var_2 = 0;\n        bool var_3;\n        const wp::int32 var_4 = 1;\n        wp::int32 var_5;\n        bool var_6;\n        const wp::int32 var_7 = 0;\n        bool var_8;\n        const wp::int32 var_9 = 1;\n        wp::int32 var_10;\n        bool var_11;\n        bool var_12;\n        wp::float32* var_13;\n        wp::float32 var_14;\n        wp::float32 var_15;\n        const wp::int32 var_16 = 1;\n        wp::int32 var_17;\n        wp::float32* var_18;\n        wp::float32 var_19;\n        wp::float32 var_20;\n        const wp::int32 var_21 = 1;\n        wp::int32 var_22;\n        wp::float32* var_23;\n        wp::float32 var_24;\n        wp::float32 var_25;\n        const wp::int32 var_26 = 1;\n        wp::int32 var_27;\n        wp::float32* var_28;\n        wp::float32 var_29;\n        wp::float32 var_30;\n        const wp::int32 var_31 = 1;\n        wp::int32 var_32;\n        wp::float32* var_33;\n        wp::float32 var_34;\n        wp::float32 var_35;\n        const wp::float32 var_36 = 2.0;\n        wp::float32 var_37;\n        wp::float32 var_38;\n        wp::float32 var_39;\n        wp::float32 var_40;\n        wp::float32 var_41;\n        const wp::float32 var_42 = 6.0;\n        wp::float32 var_43;\n        wp::float32* var_44;\n        wp::float32 var_45;\n        //---------\n        // dual vars\n        wp::int32 adj_0 = {};\n        wp::int32 adj_1 = {};\n        wp::int32 adj_2 = {};\n        bool adj_3 = {};\n        wp::int32 adj_4 = {};\n        wp::int32 adj_5 = {};\n        bool adj_6 = {};\n        wp::int32 adj_7 = {};\n        bool adj_8 = {};\n        wp::int32 adj_9 = {};\n        wp::int32 adj_10 = {};\n        bool adj_11 = {};\n        bool adj_12 = {};\n        wp::float32 adj_13 = {};\n        wp::float32 adj_14 = {};\n        wp::float32 adj_15 = {};\n        wp::int32 adj_16 = {};\n        wp::int32 adj_17 = {};\n        wp::float32 adj_18 = {};\n        wp::float32 adj_19 = {};\n        wp::float32 adj_20 = {};\n        wp::int32 adj_21 = {};\n        wp::int32 adj_22 = {};\n        wp::float32 adj_23 = {};\n        wp::float32 adj_24 = {};\n        wp::float32 adj_25 = {};\n        wp::int32 adj_26 = {};\n        wp::int32 adj_27 = {};\n        wp::float32 adj_28 = {};\n        wp::float32 adj_29 = {};\n        wp::float32 adj_30 = {};\n        wp::int32 adj_31 = {};\n        wp::int32 adj_32 = {};\n        wp::float32 adj_33 = {};\n        wp::float32 adj_34 = {};\n        wp::float32 adj_35 = {};\n        wp::float32 adj_36 = {};\n        wp::float32 adj_37 = {};\n        wp::float32 adj_38 = {};\n        wp::float32 adj_39 = {};\n        wp::float32 adj_40 = {};\n        wp::float32 adj_41 = {};\n        wp::float32 adj_42 = {};\n        wp::float32 adj_43 = {};\n        wp::float32 adj_44 = {};\n        wp::float32 adj_45 = {};\n        //---------\n        // forward\n        // def grid2d_yelwvw(input: wp.array2d(dtype=float), output: wp.array2d(dtype=float),       <L 4>\n        // i, j = wp.tid()                                                                        <L 6>\n        builtin_tid2d(var_0, var_1);\n        // if i > 0 and i < height - 1 and j > 0 and j < width - 1:                               <L 8>\n        var_3 = (var_0 > var_2);\n        var_5 = wp::sub(var_height, var_4);\n        var_6 = (var_0 < var_5);\n        var_8 = (var_1 > var_7);\n        var_10 = wp::sub(var_width, var_9);\n        var_11 = (var_1 < var_10);\n        var_12 = var_3 && var_6 && var_8 && var_11;\n        if (var_12) {\n            // center = input[i, j]                                                               <L 9>\n            var_13 = wp::address(var_input, var_0, var_1);\n            var_15 = wp::load(var_13);\n            var_14 = wp::copy(var_15);\n            // up = input[i - 1, j]                                                               <L 10>\n            var_17 = wp::sub(var_0, var_16);\n            var_18 = wp::address(var_input, var_17, var_1);\n            var_20 = wp::load(var_18);\n            var_19 = wp::copy(var_20);\n            // down = input[i + 1, j]                                                             <L 11>\n            var_22 = wp::add(var_0, var_21);\n            var_23 = wp::address(var_input, var_22, var_1);\n            var_25 = wp::load(var_23);\n            var_24 = wp::copy(var_25);\n            // left = input[i, j - 1]                                                             <L 12>\n            var_27 = wp::sub(var_1, var_26);\n            var_28 = wp::address(var_input, var_0, var_27);\n            var_30 = wp::load(var_28);\n            var_29 = wp::copy(var_30);\n            // right = input[i, j + 1]                                                            <L 13>\n            var_32 = wp::add(var_1, var_31);\n            var_33 = wp::address(var_input, var_0, var_32);\n            var_35 = wp::load(var_33);\n            var_34 = wp::copy(var_35);\n            // output[i, j] = (center * 2.0 + up + down + left + right) / 6.0                     <L 14>\n            var_37 = wp::mul(var_14, var_36);\n            var_38 = wp::add(var_37, var_19);\n            var_39 = wp::add(var_38, var_24);\n            var_40 = wp::add(var_39, var_29);\n            var_41 = wp::add(var_40, var_34);\n            var_43 = wp::div(var_41, var_42);\n            // wp::array_store(var_output, var_0, var_1, var_43);\n        }\n        if (!var_12) {\n            // output[i, j] = input[i, j]                                                         <L 16>\n            var_44 = wp::address(var_input, var_0, var_1);\n            var_45 = wp::load(var_44);\n            // wp::array_store(var_output, var_0, var_1, var_45);\n        }\n        //---------\n        // reverse\n        if (!var_12) {\n            wp::adj_array_store(var_output, var_0, var_1, var_45, adj_output, adj_0, adj_1, adj_44);\n            wp::adj_address(var_input, var_0, var_1, adj_input, adj_0, adj_1, adj_44);\n            // adj: output[i, j] = input[i, j]                                                    <L 16>\n        }\n        if (var_12) {\n            wp::adj_array_store(var_output, var_0, var_1, var_43, adj_output, adj_0, adj_1, adj_43);\n            wp::adj_div(var_41, var_42, var_43, adj_41, adj_42, adj_43);\n            wp::adj_add(var_40, var_34, adj_40, adj_34, adj_41);\n            wp::adj_add(var_39, var_29, adj_39, adj_29, adj_40);\n            wp::adj_add(var_38, var_24, adj_38, adj_24, adj_39);\n            wp::adj_add(var_37, var_19, adj_37, adj_19, adj_38);\n            wp::adj_mul(var_14, var_36, adj_14, adj_36, adj_37);\n            // adj: output[i, j] = (center * 2.0 + up + down + left + right) / 6.0                <L 14>\n            wp::adj_copy(var_35, adj_33, adj_34);\n            wp::adj_address(var_input, var_0, var_32, adj_input, adj_0, adj_32, adj_33);\n            wp::adj_add(var_1, var_31, adj_1, adj_31, adj_32);\n            // adj: right = input[i, j + 1]                                                       <L 13>\n            wp::adj_copy(var_30, adj_28, adj_29);\n            wp::adj_address(var_input, var_0, var_27, adj_input, adj_0, adj_27, adj_28);\n            wp::adj_sub(var_1, var_26, adj_1, adj_26, adj_27);\n            // adj: left = input[i, j - 1]                                                        <L 12>\n            wp::adj_copy(var_25, adj_23, adj_24);\n            wp::adj_address(var_input, var_22, var_1, adj_input, adj_22, adj_1, adj_23);\n            wp::adj_add(var_0, var_21, adj_0, adj_21, adj_22);\n            // adj: down = input[i + 1, j]                                                        <L 11>\n            wp::adj_copy(var_20, adj_18, adj_19);\n            wp::adj_address(var_input, var_17, var_1, adj_input, adj_17, adj_1, adj_18);\n            wp::adj_sub(var_0, var_16, adj_0, adj_16, adj_17);\n            // adj: up = input[i - 1, j]                                                          <L 10>\n            wp::adj_copy(var_15, adj_13, adj_14);\n            wp::adj_address(var_input, var_0, var_1, adj_input, adj_0, adj_1, adj_13);\n            // adj: center = input[i, j]                                                          <L 9>\n        }\n        wp::adj_sub(var_width, var_9, adj_width, adj_9, adj_10);\n        wp::adj_sub(var_height, var_4, adj_height, adj_4, adj_5);\n        // adj: if i > 0 and i < height - 1 and j > 0 and j < width - 1:                          <L 8>\n        // adj: i, j = wp.tid()                                                                   <L 6>\n        // adj: def grid2d_yelwvw(input: wp.array2d(dtype=float), output: wp.array2d(dtype=float),  <L 4>\n        continue;\n    }\n}"
}